<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DS_COMPROBANTES" targetNamespace="http://tempuri.org/DS_COMPROBANTES.xsd" xmlns:mstns="http://tempuri.org/DS_COMPROBANTES.xsd" xmlns="http://tempuri.org/DS_COMPROBANTES.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="MySettings" AppSettingsPropertyName="cn" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="cn (MySettings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.SISPACAL.DL.My.MySettings.GlobalReference.Default.cn" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="COMPROBANTE_RETENCIONTableAdapter" GeneratorDataComponentClassName="COMPROBANTE_RETENCIONTableAdapter" Name="COMPROBANTE_RETENCION" UserDataComponentName="COMPROBANTE_RETENCIONTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.PLANILLA" DbObjectType="Table" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
	WHEN 7 THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
	ELSE CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
END AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, (SELECT B.FECHA_PAGO FROM PLANILLA_BASE B WHERE B.ID_PLANILLA_BASE = P.ID_PLANILLA_BASE) AS FECHA_PAGO, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	ELSE (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, P.RETENCION_IVA, 0 AS IVA, (P.VALOR + P.RETENCION_IVA) AS TOTAL,
CASE P.ID_TIPO_PLANILLA
	WHEN 7 THEN 'Valor retenido 1% IVA compensacion de $' + REPLACE(FORMAT(P.VALOR_UNIT_PAGO,'0.00######'),',','.') + ' por tonelada en zafra ' + P.NOMBRE_ZAFRA
	ELSE 'Valor retenido 1% IVA Corte # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' ZAFRA ' + P.NOMBRE_ZAFRA
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.RETENCION_IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO, 
0.00 AS RENTA, 0.00 AS SUBTOTAL, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 1
AND P.RETENCION_IVA &gt; 0
AND @TIPO = 1
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0

UNION ALL

SELECT 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
	WHEN 7 THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
	ELSE CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
END AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, (SELECT B.FECHA_PAGO FROM PLANILLA_BASE B WHERE B.ID_PLANILLA_BASE = P.ID_PLANILLA_BASE) AS FECHA_PAGO,  
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN ''
	WHEN 4 THEN ''
	ELSE (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, 0 AS RETENCION_IVA, P.IVA, (P.VALOR + P.IVA) AS TOTAL, 
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + CAST(Z.PRECIO_LIBRA_AZUCAR AS VARCHAR)
	WHEN 2 THEN 'Valor de flete de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña' + ' Corte # ' + CAST(CZ.CATORCENA AS VARCHAR)
	WHEN 9 THEN 'Valor de flete de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña' + ' Corte # ' + CAST(CZ.CATORCENA AS VARCHAR)
	WHEN 3 THEN 'Compra de frente de roza para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 6 THEN 'Complemento al valor final de pago zafra ' + Z.NOMBRE_ZAFRA
	WHEN 7 THEN 'Compensacion de $' + REPLACE(FORMAT(P.VALOR_UNIT_PAGO,'0.00######'),',','.') + ' por tonelada en zafra ' + Z.NOMBRE_ZAFRA
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.VALOR + P.IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
0.00 AS RENTA, 0.00 AS SUBTOTAL, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, ZAFRA Z
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 0 
AND @TIPO = 2
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9 
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )
	) &gt; 0</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TIPO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIGOPROVEEDOR" DataSetColumn="CODIGOPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEE_TRANS" DataSetColumn="NOMBRE_PROVEE_TRANS" />
              <Mapping SourceColumn="FECHA_PAGO" DataSetColumn="FECHA_PAGO" />
              <Mapping SourceColumn="REGISTRO" DataSetColumn="REGISTRO" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="VALOR" DataSetColumn="VALOR" />
              <Mapping SourceColumn="RETENCION_IVA" DataSetColumn="RETENCION_IVA" />
              <Mapping SourceColumn="IVA" DataSetColumn="IVA" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
              <Mapping SourceColumn="CONCEPTO" DataSetColumn="CONCEPTO" />
              <Mapping SourceColumn="MONTO_LETRAS" DataSetColumn="MONTO_LETRAS" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="RENTA" DataSetColumn="RENTA" />
              <Mapping SourceColumn="SUBTOTAL" DataSetColumn="SUBTOTAL" />
              <Mapping SourceColumn="DUI" DataSetColumn="DUI" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="GIRO" DataSetColumn="GIRO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorAnticipo" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorAnticipo" GeneratorSourceName="FillPorAnticipo" GetMethodModifier="Public" GetMethodName="GetPorAnticipo" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorAnticipo" UserSourceName="FillPorAnticipo">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>

SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, A.FECHA_PAGO, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN ''
	WHEN 4 THEN ''
	WHEN 5 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 5 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, P.RETENCION_IVA, 0 AS IVA, (P.VALOR + P.RETENCION_IVA) AS TOTAL,
CASE 
WHEN P.ID_TIPO_PLANILLA = 5 THEN 'Valor retenido 1% IVA DE ANTICIPO DE LIQUIDACION AL VALOR FINAL DE PAGO POR COMPRA DE CAÑA ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 6 THEN 'Valor retenido 1% IVA DE COMPLEMENTO AL VALOR FINAL DE PAGO ZAFRA ' + P.NOMBRE_ZAFRA
ELSE ('Valor retenido 1% IVA Corte # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' ZAFRA ' + P.NOMBRE_ZAFRA) 
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.RETENCION_IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, PLANILLA_BASE A
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND CZ.ID_CATORCENA = A.ID_CATORCENA
AND P.ID_TIPO_PLANILLA = A.ID_TIPO_PLANILLA
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 1
AND P.RETENCION_IVA &gt; 0
AND @TIPO = 1
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )
	) &gt; 0


UNION ALL

SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, A.FECHA_PAGO, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN ''
	WHEN 4 THEN ''
	WHEN 5 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, 0 AS RETENCION_IVA, P.IVA, (P.VALOR + P.IVA) AS TOTAL, 
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + CAST(Z.PRECIO_LIBRA_AZUCAR AS VARCHAR)
	WHEN 2 THEN 'Valor de flete de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña' + ' Corte # ' + CAST(CZ.CATORCENA AS VARCHAR)
	WHEN 3 THEN 'Compra de frente de roza para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 5 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + LEFT(CAST(ROUND(A.VALOR_UNIT_PAGO,14) AS VARCHAR),16)
	WHEN 6 THEN 'Complemento al valor final de pago 13% ' + P.NOMBRE_ZAFRA 
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.VALOR + P.IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, ZAFRA Z, PLANILLA_BASE A
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND CZ.ID_CATORCENA = A.ID_CATORCENA
AND P.ID_TIPO_PLANILLA = A.ID_TIPO_PLANILLA
AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 0 
AND @TIPO = 2
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )
	) &gt; 0
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TIPO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCompensacion" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCompensacion" GeneratorSourceName="FillPorCompensacion" GetMethodModifier="Public" GetMethodName="GetPorCompensacion" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCompensacion" UserSourceName="FillPorCompensacion">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, B.FECHA_PAGO, 
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)	
END AS REGISTRO,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN ''
	WHEN P.ID_TIPO_PLANILLA = 4 THEN ''
END AS DIRECCION,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
END AS NIT, P.VALOR, P.RETENCION_IVA, 0 AS IVA, (P.VALOR + P.RETENCION_IVA) AS TOTAL,
CASE 
WHEN P.ID_TIPO_PLANILLA = 5 THEN 'Valor retenido 1% IVA DE ' + (SELECT A.NO_ANTICIPO_LETRAS FROM ANTICIPO_CANA A WHERE A.ID_CATORCENA = CZ.ID_CATORCENA AND A.ES_COMP_VFP = 0) + ' ANTICIPO AL VALOR FINAL DE PAGO ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 6 THEN 'Valor retenido 1% IVA DE COMPLEMENTO AL VALOR FINAL DE PAGO ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 7 THEN 'Valor retenido 1% IVA Compensacion de $' + FORMAT(P.VALOR_UNIT_PAGO,'0.00########') + ' por tonelada zafra ' + P.NOMBRE_ZAFRA
ELSE ('Valor retenido 1% IVA Corte # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' ZAFRA ' + P.NOMBRE_ZAFRA) 
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.RETENCION_IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, PLANILLA_BASE B
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND P.ID_PLANILLA_BASE = B.ID_PLANILLA_BASE
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 1
AND P.RETENCION_IVA &gt; 0
AND @TIPO = 1
AND (EXISTS(SELECT 1 FROM RANGO_COMPENSACION R 
		WHERE R.ID_CATORCENA = @ID_CATORCENA AND R.ID_RANGO_COMPE = @ID_RANGO_COMPE AND R.VALOR_UNIT_PAGO = P.VALOR_UNIT_PAGO) OR @ID_RANGO_COMPE = -1)

UNION ALL

SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, B.FECHA_PAGO, 
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN ''
	WHEN P.ID_TIPO_PLANILLA = 4 THEN ''
END AS DIRECCION,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7) THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, 0 AS RETENCION_IVA, P.IVA, (P.VALOR + P.IVA) AS TOTAL, 
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + CAST(Z.PRECIO_LIBRA_AZUCAR AS VARCHAR)
	WHEN 2 THEN 'Valor de flete de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña' + ' Corte # ' + CAST(CZ.CATORCENA AS VARCHAR)
	WHEN 3 THEN 'Compra de frente de roza para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 5 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + LEFT(CAST(ROUND(B.VALOR_UNIT_PAGO,14) AS VARCHAR),16)
	WHEN 6 THEN 'Complemento al valor final de pago 13% ' + P.NOMBRE_ZAFRA 	
	WHEN 7 THEN 'Compensacion de $' + FORMAT(P.VALOR_UNIT_PAGO,'0.00########') + ' por tonelada zafra ' + P.NOMBRE_ZAFRA
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.VALOR + P.IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, ZAFRA Z, PLANILLA_BASE B
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND B.ID_PLANILLA_BASE = P.ID_PLANILLA_BASE
AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 0 
AND @TIPO = 2
AND (EXISTS(SELECT 1 FROM RANGO_COMPENSACION R 
		WHERE R.ID_CATORCENA = @ID_CATORCENA AND R.ID_RANGO_COMPE = @ID_RANGO_COMPE AND R.VALOR_UNIT_PAGO = P.VALOR_UNIT_PAGO) OR @ID_RANGO_COMPE = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TIPO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_RANGO_COMPE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ID_RANGO_COMPE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorComplementoVFP" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorComplementoVFP" GeneratorSourceName="FillPorComplementoVFP" GetMethodModifier="Public" GetMethodName="GetPorComplementoVFP" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorComplementoVFP" UserSourceName="FillPorComplementoVFP">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, B.FECHA_PAGO, 
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)	
END AS REGISTRO,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN ''
	WHEN P.ID_TIPO_PLANILLA = 4 THEN ''
END AS DIRECCION,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
END AS NIT, P.VALOR, P.RETENCION_IVA, 0 AS IVA, (P.VALOR + P.RETENCION_IVA) AS TOTAL,
CASE 
WHEN P.ID_TIPO_PLANILLA = 5 THEN 'Valor retenido 1% IVA DE ' + (SELECT A.NO_ANTICIPO_LETRAS FROM ANTICIPO_CANA A WHERE A.ID_CATORCENA = CZ.ID_CATORCENA AND A.ES_COMP_VFP = 0) + ' ANTICIPO AL VALOR FINAL DE PAGO ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 6 THEN 'Valor retenido 1% IVA DE COMPLEMENTO AL VALOR FINAL DE PAGO ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 7 THEN 'Valor retenido 1% IVA Corte # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' COMPENSACION DE $ ' + CAST(CAST(P.VALOR_UNIT_PAGO AS NUMERIC(6,3)) AS VARCHAR) + ' POR TONELADA ZAFRA ' + P.NOMBRE_ZAFRA
WHEN P.ID_TIPO_PLANILLA = 8 THEN 'Valor retenido 1% POR INCENTIVO A LOS PRODUCTORES DE CAÑA ZAFRA ' + P.NOMBRE_ZAFRA
ELSE ('Valor retenido 1% IVA Corte # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' ZAFRA ' + P.NOMBRE_ZAFRA) 
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.RETENCION_IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, PLANILLA_BASE B
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND P.ID_PLANILLA_BASE = B.ID_PLANILLA_BASE
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 1
AND P.RETENCION_IVA &gt; 0
AND @TIPO = 1
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0

UNION ALL

SELECT 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS, B.FECHA_PAGO, 
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN ''
	WHEN P.ID_TIPO_PLANILLA = 4 THEN ''
END AS DIRECCION,
CASE 
	WHEN P.ID_TIPO_PLANILLA in(1,5,6,7,8) THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN P.ID_TIPO_PLANILLA = 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, P.VALOR, 0 AS RETENCION_IVA, P.IVA, (P.VALOR + P.IVA) AS TOTAL, 
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + CAST(Z.PRECIO_LIBRA_AZUCAR AS VARCHAR)
	WHEN 2 THEN 'Valor de flete de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña' + ' Corte # ' + CAST(CZ.CATORCENA AS VARCHAR)
	WHEN 3 THEN 'Compra de frente de roza para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 4 THEN 'Valor de carga para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 5 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + LEFT(CAST(ROUND(B.VALOR_UNIT_PAGO,14) AS VARCHAR),16)
	WHEN 6 THEN 'Complemento al valor final de pago 13% ' + P.NOMBRE_ZAFRA 
	WHEN 7 THEN 'COMPENSACION EN CORTE # ' + CAST(CZ.CATORCENA AS VARCHAR) + ' DE $ ' + CAST(CAST(P.VALOR_UNIT_PAGO AS NUMERIC(6,3)) AS VARCHAR) + ' POR TONELADA ZAFRA ' + P.NOMBRE_ZAFRA	
	WHEN 8 THEN 'INCENTIVO A LOS PRODUCTORES DE CAÑA ZAFRA ' + P.NOMBRE_ZAFRA	
END AS CONCEPTO,
dbo.fNumero_a_Letras(P.VALOR + P.IVA,'US DOLARES') AS MONTO_LETRAS, @TIPO AS TIPO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DUI,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DEPARTAMENTO,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS MUNICIPIO,
CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS GIRO
FROM PLANILLA P, CATORCENA_ZAFRA CZ, ZAFRA Z, PLANILLA_BASE B
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND B.ID_PLANILLA_BASE = P.ID_PLANILLA_BASE
AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = 0 
AND @TIPO = 2
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 9
		AND PC.ESTADO = 'E'
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TIPO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSujetoExcluido" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSujetoExcluido" GeneratorSourceName="FillPorSujetoExcluido" GetMethodModifier="Public" GetMethodName="GetPorSujetoExcluido" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSujetoExcluido" UserSourceName="FillPorSujetoExcluido">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
CASE P.ID_TIPO_PLANILLA
	WHEN 2 THEN CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
	WHEN 9 THEN CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
	ELSE CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)	
END AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS,
B.FECHA_PAGO, NULL AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 5 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 8 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 9 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	ELSE (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN dbo.FormatearNIT((SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 2 THEN dbo.FormatearNIT((SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 5 THEN dbo.FormatearNIT((SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 8 THEN dbo.FormatearNIT((SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 9 THEN dbo.FormatearNIT((SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA))
	ELSE dbo.FormatearNIT((SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
END AS NIT, 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN dbo.FormatearDUI((SELECT N.DUI FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 2 THEN dbo.FormatearDUI((SELECT N.DUI FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA))	
	WHEN 5 THEN dbo.FormatearDUI((SELECT N.DUI FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 8 THEN dbo.FormatearDUI((SELECT N.DUI FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
	WHEN 9 THEN dbo.FormatearDUI((SELECT N.DUI FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA))
	ELSE dbo.FormatearDUI((SELECT N.DUI FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA))
END AS DUI,
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(CAST(P.AZUCAR_CATORCENA_REAL AS NUMERIC(20,2)) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' +  LEFT(CAST(ROUND((SELECT A.VALOR_UNIT_PAGO FROM PLANILLA_BASE A WHERE A.ID_CATORCENA = P.ID_CATORCENA AND A.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA ),14) AS VARCHAR),7) + ' del '
		+ FORMAT( (SELECT CZ.FECHA_INICIO FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' al ' 
		+ FORMAT( (SELECT CZ.FECHA_FIN FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' Corte #' + CAST((SELECT CZ.CATORCENA FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) AS VARCHAR) + ' ZAFRA ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)
	WHEN 2 THEN 'Servicio de transporte de caña de azucar por ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' toneladas transportadas durante el periodo del '	
		+ FORMAT( (SELECT CZ.FECHA_INICIO FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' al ' 
		+ FORMAT( (SELECT CZ.FECHA_FIN FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' Corte #' + CAST((SELECT CZ.CATORCENA FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) AS VARCHAR) + ' ZAFRA ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)	
	WHEN 5 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' +  LEFT(CAST(ROUND((SELECT A.VALOR_UNIT_PAGO FROM PLANILLA_BASE A WHERE A.ID_CATORCENA = P.ID_CATORCENA AND A.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA ),14) AS VARCHAR),16)
	WHEN 6 THEN 'Complemento al valor final de pago zafra ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)
	WHEN 8 THEN 'Incentivo a productores de caña en $0.25 por ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' toneladas en zafra ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)
	WHEN 7 THEN 'Compensacion de $' + REPLACE(FORMAT(P.VALOR_UNIT_PAGO,'0.00######'),',','.') + ' por tonelada en zafra ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)
	WHEN 9 THEN 'Servicio de transporte de caña de azucar por ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' toneladas transportadas durante el periodo del '	
		+ FORMAT( (SELECT CZ.FECHA_INICIO FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' al ' 
		+ FORMAT( (SELECT CZ.FECHA_FIN FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) , 'dd/MMMM/yyyy') 
		+ ' Corte #' + CAST((SELECT CZ.CATORCENA FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = B.ID_CATORCENA) AS VARCHAR) + ' ZAFRA ' + (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = B.ID_ZAFRA)
END AS CONCEPTO,
P.VALOR, P.IVA, (P.VALOR + P.IVA) AS SUBTOTAL, 
CASE WHEN P.ID_TIPO_PLANILLA IN(2,9) THEN ROUND(P.VALOR * 0.10,2) ELSE NULL END AS RENTA, 
(P.VALOR - CASE WHEN P.ID_TIPO_PLANILLA IN(2,9)  THEN ROUND(P.VALOR * 0.10,2) ELSE 0 END) AS TOTAL,
dbo.fNumero_a_Letras((P.VALOR - CASE WHEN P.ID_TIPO_PLANILLA IN(2,9) THEN ROUND(P.VALOR * 0.10,2) ELSE 0 END), 'DOLARES') AS MONTO_LETRAS,
0.00 AS RETENCION_IVA, 0 AS TIPO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS TELEFONO,
CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DEPARTAMENTO,
	CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS MUNICIPIO,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO
FROM PLANILLA_BASE B, PLANILLA P 
WHERE B.ID_PLANILLA_BASE = P.ID_PLANILLA_BASE
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = @ES_CONTRIBUYENTE 
AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB = 10
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="INJIBOA.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="INJIBOA.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ES_CONTRIBUYENTE" ColumnName="ES_CONTRIBUYENTE" DataSourceName="INJIBOA.dbo.PLANILLA" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_CONTRIBUYENTE" Precision="0" ProviderType="Bit" Scale="0" Size="1" SourceColumn="ES_CONTRIBUYENTE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="FACTURACION_SERVICIOS_DEL _INGENIOTableAdapter" GeneratorDataComponentClassName="FACTURACION_SERVICIOS_DEL__INGENIOTableAdapter" Name="FACTURACION_SERVICIOS_DEL _INGENIO" UserDataComponentName="FACTURACION_SERVICIOS_DEL _INGENIOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	E.ID_CATORCENA, E.ID_TIPO_PLANILLA, E.CODIPROVEEDOR_TRANSPORTISTA, E.CODIGOPROVEEDOR, E.NOMBRE_PROVEE_TRANS,
	CASE 
	WHEN E.ID_TIPO_PLANILLA  &lt;&gt; 5 AND E.ID_TIPO_PLANILLA  &lt;&gt; 6 THEN E.FECHA_PAGO
	WHEN E.ID_TIPO_PLANILLA = 5 THEN (SELECT A.FECHA_PAGO FROM PLANILLA_BASE A WHERE A.ID_PLANILLA_BASE = E.ID_PLANILLA_BASE) 
	WHEN E.ID_TIPO_PLANILLA = 6 THEN (SELECT A.FECHA_PAGO FROM PLANILLA_BASE A WHERE A.ID_PLANILLA_BASE = E.ID_PLANILLA_BASE) 
	END AS FECHA_PAGO, E.REGISTRO, E.DIRECCION, E.NIT, E.GIRO,
	D.ORDEN, D.CONCEPTO, D.VALOR, D.IVA, (D.VALOR + D.IVA) AS TOTAL, 
	dbo.fNumero_a_Letras((	SELECT SUM(T.VALOR) + SUM(T.IVA) 
							FROM (									
								SELECT D.ID_CATORCENA, D.ID_TIPO_PLANILLA, D.CODIPROVEEDOR_TRANSPORTISTA, GD.ORDEN, 
									TD.CUENTA_DESCRIPCION AS CONCEPTO, D.MONTO_DESCUENTO AS VALOR, D.IVA
								FROM DESCUENTOS_PLANILLA D, TIPO_DESCUENTO TD, GRUPO_DESCUENTOS GD  
								WHERE D.ID_TIPO_DESCTO = TD.ID_TIPO_DESCTO 
								AND TD.ID_GRUPO_DESC = GD.ID_GRUPO_DESC 
								AND D.ID_CATORCENA = @ID_CATORCENA 
								AND D.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
								AND GD.ID_GRUPO_DESC IN(1,2,3,10)
								AND TD.NOMBRE_TIPO_DESCTO &lt;&gt; 'FERTILIZANTE JIBOA'
								AND TD.ID_TIPO_DESCTO &lt;&gt; 32
								AND (SELECT COUNT(1) FROM CREDITO_ENCA E WHERE E.ID_CREDITO_ENCA = D.ID_CREDITO_ENCA AND E.ID_PROVEE &lt;&gt; 4 AND D.ID_TIPO_DESCTO = 3) = 0
							) T
							WHERE T.ID_CATORCENA = E.ID_CATORCENA
							AND T.ID_TIPO_PLANILLA = E.ID_TIPO_PLANILLA	
							AND T.CODIPROVEEDOR_TRANSPORTISTA = E.CODIPROVEEDOR_TRANSPORTISTA													
							),'US DOLARES') AS MONTO_LETRAS, DUI, TELEFONO, DEPARTAMENTO, MUNICIPIO
FROM 
(
	SELECT 
	P.ID_CATORCENA, P.ID_TIPO_PLANILLA, P.CODIPROVEEDOR_TRANSPORTISTA,
	CASE 
		WHEN P.ID_TIPO_PLANILLA IN(1,5,6) THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
		ELSE CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
	END AS CODIGOPROVEEDOR,
	P.NOMBRE_PROVEE_TRANS, CZ.FECHA_PAGO, 
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 4 THEN (SELECT N.CREDITO_FISCAL FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS REGISTRO,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 3 THEN ''
		WHEN 4 THEN ''
		WHEN 5 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DIRECCION,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS NIT,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS GIRO, P.ID_PLANILLA_BASE,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)			
		WHEN 5 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT dbo.FormatearDUI(R.DUI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DUI,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS TELEFONO,
	CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DEPARTAMENTO,
	CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS MUNICIPIO
	FROM PLANILLA P, CATORCENA_ZAFRA CZ
	WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
	AND P.ID_CATORCENA = @ID_CATORCENA 
	AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
	AND P.ES_CONTRIBUYENTE = @ES_CONTRIBUYENTE
	AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB in(1,2)
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0
) E,
(
	SELECT D.ID_CATORCENA, D.ID_TIPO_PLANILLA, D.CODIPROVEEDOR_TRANSPORTISTA, GD.ORDEN, 
		TD.CUENTA_DESCRIPCION AS CONCEPTO, D.MONTO_DESCUENTO AS VALOR, D.IVA
	FROM DESCUENTOS_PLANILLA D, TIPO_DESCUENTO TD, GRUPO_DESCUENTOS GD  
	WHERE D.ID_TIPO_DESCTO = TD.ID_TIPO_DESCTO 
	AND TD.ID_GRUPO_DESC = GD.ID_GRUPO_DESC 
	AND D.ID_CATORCENA = @ID_CATORCENA 
	AND D.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA	
	AND GD.ID_GRUPO_DESC IN(1,2,3,10)
	AND TD.NOMBRE_TIPO_DESCTO &lt;&gt; 'FERTILIZANTE JIBOA'
	AND TD.ID_TIPO_DESCTO &lt;&gt; 32
) D
WHERE E.ID_CATORCENA = D.ID_CATORCENA 
AND E.ID_TIPO_PLANILLA = D.ID_TIPO_PLANILLA AND 
E.CODIPROVEEDOR_TRANSPORTISTA = D.CODIPROVEEDOR_TRANSPORTISTA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ES_CONTRIBUYENTE" ColumnName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_CONTRIBUYENTE" Precision="0" Scale="0" Size="1" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_CATORCENA" DataSetColumn="ID_CATORCENA" />
              <Mapping SourceColumn="ID_TIPO_PLANILLA" DataSetColumn="ID_TIPO_PLANILLA" />
              <Mapping SourceColumn="CODIPROVEEDOR_TRANSPORTISTA" DataSetColumn="CODIPROVEEDOR_TRANSPORTISTA" />
              <Mapping SourceColumn="CODIGOPROVEEDOR" DataSetColumn="CODIGOPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEE_TRANS" DataSetColumn="NOMBRE_PROVEE_TRANS" />
              <Mapping SourceColumn="FECHA_PAGO" DataSetColumn="FECHA_PAGO" />
              <Mapping SourceColumn="REGISTRO" DataSetColumn="REGISTRO" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="GIRO" DataSetColumn="GIRO" />
              <Mapping SourceColumn="ORDEN" DataSetColumn="ORDEN" />
              <Mapping SourceColumn="CONCEPTO" DataSetColumn="CONCEPTO" />
              <Mapping SourceColumn="VALOR" DataSetColumn="VALOR" />
              <Mapping SourceColumn="IVA" DataSetColumn="IVA" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
              <Mapping SourceColumn="MONTO_LETRAS" DataSetColumn="MONTO_LETRAS" />
              <Mapping SourceColumn="DUI" DataSetColumn="DUI" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillServicioTransportista" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetServicioTransportista" GeneratorSourceName="FillServicioTransportista" GetMethodModifier="Public" GetMethodName="GetServicioTransportista" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetServicioTransportista" UserSourceName="FillServicioTransportista">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	E.ID_CATORCENA, E.ID_TIPO_PLANILLA, E.CODIPROVEEDOR_TRANSPORTISTA, E.CODIGOPROVEEDOR, E.NOMBRE_PROVEE_TRANS,	
	(SELECT A.FECHA_PAGO FROM PLANILLA_BASE A WHERE A.ID_PLANILLA_BASE = E.ID_PLANILLA_BASE) AS FECHA_PAGO, E.REGISTRO, E.DIRECCION, E.NIT, E.GIRO,
	D.ORDEN, D.CONCEPTO, D.VALOR, D.IVA, (D.VALOR + D.IVA) AS TOTAL, 
	dbo.fNumero_a_Letras((	SELECT SUM(T.VALOR) + SUM(T.IVA) 
							FROM (									
								SELECT D.ID_CATORCENA, D.ID_TIPO_PLANILLA, D.CODIPROVEEDOR_TRANSPORTISTA, GD.ORDEN, 
									TD.CUENTA_DESCRIPCION AS CONCEPTO, D.MONTO_DESCUENTO AS VALOR, D.IVA
								FROM DESCUENTOS_PLANILLA D, TIPO_DESCUENTO TD, GRUPO_DESCUENTOS GD  
								WHERE D.ID_TIPO_DESCTO = TD.ID_TIPO_DESCTO 
								AND TD.ID_GRUPO_DESC = GD.ID_GRUPO_DESC 
								AND D.ID_CATORCENA = @ID_CATORCENA 
								AND D.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
								AND GD.ID_GRUPO_DESC IN(23,24)
							) T
							WHERE T.ID_CATORCENA = E.ID_CATORCENA
							AND T.ID_TIPO_PLANILLA = E.ID_TIPO_PLANILLA	
							AND T.CODIPROVEEDOR_TRANSPORTISTA = E.CODIPROVEEDOR_TRANSPORTISTA													
							),'US DOLARES') AS MONTO_LETRAS, DUI, TELEFONO, DEPARTAMENTO, MUNICIPIO
FROM 
(
	SELECT 
	P.ID_CATORCENA, P.ID_TIPO_PLANILLA, P.CODIPROVEEDOR_TRANSPORTISTA,
	CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT) AS CODIGOPROVEEDOR,
	P.NOMBRE_PROVEE_TRANS, CZ.FECHA_PAGO, 
	(SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA) AS REGISTRO,
	(SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA) AS DIRECCION,
	(SELECT dbo.FormatearNIT(N.NIT) FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA) AS NIT,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.ACTIVIDAD FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT R.ACTIVIDAD FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
	END AS GIRO, P.ID_PLANILLA_BASE,
	(SELECT dbo.FormatearDUI(R.DUI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA) AS DUI,
	CASE P.ID_TIPO_PLANILLA
		WHEN 1 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)	
		WHEN 5 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT R.TELEFONO FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		ELSE (SELECT R.TELEFONO FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS TELEFONO,
	CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = R.CODI_DEPTO) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DEPARTAMENTO,
	CASE P.ID_TIPO_PLANILLA 
		WHEN 1 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 2 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 5 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 6 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN 9 THEN (SELECT (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = R.CODI_DEPTO AND M.CODI_MUNI = R.CODI_MUNI) FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS MUNICIPIO
	FROM PLANILLA P, CATORCENA_ZAFRA CZ
	WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
	AND P.ID_CATORCENA = @ID_CATORCENA 
	AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
	AND P.ES_CONTRIBUYENTE = @ES_CONTRIBUYENTE
	AND (	SELECT COUNT(1) FROM PLANILLA_COMPROB PC 
		WHERE PC.ID_CATORCENA = P.ID_CATORCENA AND PC.CODIPROVEEDOR_TRANSPORTISTA = P.CODIPROVEEDOR_TRANSPORTISTA AND PC.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA
		AND PC.ID_TIPO_COMPROB in(1,2)
		AND PC.ESTADO = 'E' 
		AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
		AND ( (PC.NO_DOCTO &gt;= @NO_DOCTO_INI AND PC.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	
	) &gt; 0
) E,
(
	SELECT D.ID_CATORCENA, D.ID_TIPO_PLANILLA, D.CODIPROVEEDOR_TRANSPORTISTA, GD.ORDEN, 
		TD.CUENTA_DESCRIPCION AS CONCEPTO, D.MONTO_DESCUENTO AS VALOR, D.IVA
	FROM DESCUENTOS_PLANILLA D, TIPO_DESCUENTO TD, GRUPO_DESCUENTOS GD  
	WHERE D.ID_TIPO_DESCTO = TD.ID_TIPO_DESCTO 
	AND TD.ID_GRUPO_DESC = GD.ID_GRUPO_DESC 
	AND D.ID_CATORCENA = @ID_CATORCENA 
	AND D.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA	
	AND GD.ID_GRUPO_DESC IN(23,24)
) D
WHERE E.ID_CATORCENA = D.ID_CATORCENA 
AND E.ID_TIPO_PLANILLA = D.ID_TIPO_PLANILLA AND 
E.CODIPROVEEDOR_TRANSPORTISTA = D.CODIPROVEEDOR_TRANSPORTISTA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ES_CONTRIBUYENTE" ColumnName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_CONTRIBUYENTE" Precision="0" Scale="0" Size="1" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="FACTURACION_SERVICIOS_PROVEEDORESTableAdapter" GeneratorDataComponentClassName="FACTURACION_SERVICIOS_PROVEEDORESTableAdapter" Name="FACTURACION_SERVICIOS_PROVEEDORES" UserDataComponentName="FACTURACION_SERVICIOS_PROVEEDORESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.PLANILLA" DbObjectType="Table" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT)
	ELSE CAST(P.CODIPROVEEDOR_TRANSPORTISTA AS INT)
END AS CODIGOPROVEEDOR,
P.NOMBRE_PROVEE_TRANS,
CASE 
	WHEN P.ID_TIPO_PLANILLA  &lt;&gt; 5 THEN CZ.FECHA_PAGO
	ELSE (SELECT A.FECHA_PAGO FROM PLANILLA_BASE A WHERE A.ID_CATORCENA = P.ID_CATORCENA AND A.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA) END AS FECHA_PAGO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.CREDITO_FISCAL FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_ROZA R WHERE R.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT R.CREDITO_FISCAL FROM PROVEEDOR_CARGA R WHERE R.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT R.CREDITFISCAL FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS REGISTRO,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT R.DIRECCION FROM TRANSPORTISTA R WHERE R.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN ''
	WHEN 4 THEN ''
	WHEN 5 THEN (SELECT R.DIRECCION FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS DIRECCION,
CASE P.ID_TIPO_PLANILLA
	WHEN 1 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 2 THEN (SELECT N.NIT FROM TRANSPORTISTA N WHERE N.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 3 THEN (SELECT N.NIT FROM PROVEEDOR_ROZA N WHERE N.ID_PROVEEDOR_ROZA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 4 THEN (SELECT N.NIT FROM PROVEEDOR_CARGA N WHERE N.ID_PROVEEDOR_CARGA = P.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN 5 THEN (SELECT N.NIT FROM PROVEEDOR N WHERE N.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
END AS NIT, 
CASE P.ID_TIPO_PLANILLA 
	WHEN 1 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' + CAST(Z.PRECIO_LIBRA_AZUCAR AS VARCHAR)
	WHEN 2 THEN 'Compra de transporte de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 3 THEN 'Compra de frente de roza para ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 4 THEN 'Compra de carga de ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Toneladas de caña'
	WHEN 5 THEN 'Compra de ' + CAST(ROUND(P.AZUCAR_CATORCENA_REAL,2) AS VARCHAR) + ' libras de azucar, contenidas en ' + CAST(P.TONEL_CANA_ENTREGADA AS VARCHAR) + ' Tons de caña a precio inicial de US$ ' +  LEFT(CAST(ROUND((SELECT A.VALOR_UNIT_PAGO FROM PLANILLA_BASE A WHERE A.ID_CATORCENA = P.ID_CATORCENA AND A.ID_TIPO_PLANILLA = P.ID_TIPO_PLANILLA ),14) AS VARCHAR),16)
END AS CONCEPTO,
P.VALOR, P.IVA
FROM PLANILLA P, CATORCENA_ZAFRA CZ, ZAFRA Z
WHERE P.ID_CATORCENA = CZ.ID_CATORCENA 
AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
AND P.ID_CATORCENA = @ID_CATORCENA 
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND P.ES_CONTRIBUYENTE = @ES_CONTRIBUYENTE </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="INJIBOA2.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="INJIBOA2.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ES_CONTRIBUYENTE" ColumnName="ES_CONTRIBUYENTE" DataSourceName="INJIBOA2.dbo.PLANILLA" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_CONTRIBUYENTE" Precision="0" ProviderType="Bit" Scale="0" Size="1" SourceColumn="ES_CONTRIBUYENTE" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIGOPROVEEDOR" DataSetColumn="CODIGOPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEE_TRANS" DataSetColumn="NOMBRE_PROVEE_TRANS" />
              <Mapping SourceColumn="FECHA_PAGO" DataSetColumn="FECHA_PAGO" />
              <Mapping SourceColumn="REGISTRO" DataSetColumn="REGISTRO" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="CONCEPTO" DataSetColumn="CONCEPTO" />
              <Mapping SourceColumn="VALOR" DataSetColumn="VALOR" />
              <Mapping SourceColumn="IVA" DataSetColumn="IVA" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="REPO_COMPROBANTESTableAdapter" GeneratorDataComponentClassName="REPO_COMPROBANTESTableAdapter" Name="REPO_COMPROBANTES" UserDataComponentName="REPO_COMPROBANTESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	1225 AS CODIGO, 'XXXXXX' AS NOMBRE_CLIENTE, 5454.23 AS AFECTO, 4545.12 AS IVA, 5454.54 AS RENTA, 4552.01 AS RETENCION, 45454.12 AS TOTAL, 'XXXX' AS SERIE,
	54554 AS NO_DOCTO, 'XXXXX' AS NOMBRE_TIPO, 10 AS TIPO_CONTRIBUYENTE ,
'XXX' AS DUI, 'XXXX' AS NIT, 'XXXX' AS NRC
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_CLIENTE" DataSetColumn="NOMBRE_CLIENTE" />
              <Mapping SourceColumn="AFECTO" DataSetColumn="AFECTO" />
              <Mapping SourceColumn="IVA" DataSetColumn="IVA" />
              <Mapping SourceColumn="RENTA" DataSetColumn="RENTA" />
              <Mapping SourceColumn="RETENCION" DataSetColumn="RETENCION" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
              <Mapping SourceColumn="SERIE" DataSetColumn="SERIE" />
              <Mapping SourceColumn="NO_DOCTO" DataSetColumn="NO_DOCTO" />
              <Mapping SourceColumn="NOMBRE_TIPO" DataSetColumn="NOMBRE_TIPO" />
              <Mapping SourceColumn="TIPO_CONTRIBUYENTE" DataSetColumn="TIPO_CONTRIBUYENTE" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="DUI" DataSetColumn="DUI" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="NRC" DataSetColumn="NRC" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGO,
	C.NOMBRE_CLIENTE,  C.AFECTO, C.IVA, C.RENTA, C.RETENCION, C.TOTAL, C.SERIE, C.NO_DOCTO, T.NOMBRE_TIPO, C.TIPO_CONTRIBUYENTE,
	CASE 
	WHEN P.ID_TIPO_PLANILLA in(2,9) THEN (SELECT dbo.FormatearDUI(T.DUI) FROM TRANSPORTISTA T WHERE T.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT dbo.FormatearDUI(T.DUI) FROM PROVEEDOR T WHERE T.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS DUI,
	CASE 
	WHEN P.ID_TIPO_PLANILLA in(2,9) THEN (SELECT dbo.FormatearNIT(T.NIT) FROM TRANSPORTISTA T WHERE T.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT dbo.FormatearNIT(T.NIT) FROM PROVEEDOR T WHERE T.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS NIT,
	CASE 
	WHEN P.ID_TIPO_PLANILLA in(2,9) THEN (SELECT T.CREDITO_FISCAL FROM TRANSPORTISTA T WHERE T.CODTRANSPORT = P.CODIPROVEEDOR_TRANSPORTISTA)
	ELSE (SELECT T.CREDITFISCAL FROM PROVEEDOR T WHERE T.CODIPROVEEDOR = P.CODIPROVEEDOR_TRANSPORTISTA)
	END AS NRC
FROM PLANILLA P, PLANILLA_COMPROB C, TIPO_COMPROB T
WHERE P.ID_CATORCENA = C.ID_CATORCENA
AND P.CODIPROVEEDOR_TRANSPORTISTA = C.CODIPROVEEDOR_TRANSPORTISTA
AND P.ID_TIPO_PLANILLA = C.ID_TIPO_PLANILLA
AND T.ID_TIPO_COMPROB = C.ID_TIPO_COMPROB
AND P.ID_CATORCENA = @ID_CATORCENA
AND P.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND C.ID_TIPO_COMPROB = @ID_TIPO_COMPROB
AND C.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
AND (C.TIPO_CONTRIBUYENTE = @ES_CONTRIBUYENTE OR @ES_CONTRIBUYENTE = -1)
AND C.ESTADO = 'E'
AND ( (C.NO_DOCTO &gt;= @NO_DOCTO_INI AND C.NO_DOCTO &lt;= @NO_DOCTO_FIN) OR (@NO_DOCTO_INI = -1 AND @NO_DOCTO_FIN = -1) )	</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="DESAINJIBOA.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="DESAINJIBOA.dbo.PLANILLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_COMPROB" ColumnName="ID_TIPO_COMPROB" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_COMPROB" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_COMPROB" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="ID_COMPROB_CONCE" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_COMPROB_CONCE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ES_CONTRIBUYENTE" ColumnName="TIPO_CONTRIBUYENTE" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ES_CONTRIBUYENTE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="TIPO_CONTRIBUYENTE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_INI" ColumnName="NO_DOCTO" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_INI" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="NO_DOCTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NO_DOCTO_FIN" ColumnName="NO_DOCTO" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@NO_DOCTO_FIN" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="NO_DOCTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="LISTADO_COMPROBANTESTableAdapter" GeneratorDataComponentClassName="LISTADO_COMPROBANTESTableAdapter" Name="LISTADO_COMPROBANTES" UserDataComponentName="LISTADO_COMPROBANTESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 5454 AS ID_PLANILLA_COMPROB,
		41 AS CATORCENA,
		'XXXXXXXX' AS TIPO_PLANILLA,
		545454 AS CODIGO,
		'XXXXXXXX' AS NOMBRE_CLIENTE,
		'XXXXXXXX' AS NOMBRE_TIPO,
		'XXXXXXXX' AS SERIE,
		54545 AS NO_DOCTO,
		'XXXXXXXX' AS ESTADO,
		545454.12 AS TOTAL
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_PLANILLA_COMPROB" DataSetColumn="ID_PLANILLA_COMPROB" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="TIPO_PLANILLA" DataSetColumn="TIPO_PLANILLA" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="NOMBRE_CLIENTE" DataSetColumn="NOMBRE_CLIENTE" />
              <Mapping SourceColumn="NOMBRE_TIPO" DataSetColumn="NOMBRE_TIPO" />
              <Mapping SourceColumn="SERIE" DataSetColumn="SERIE" />
              <Mapping SourceColumn="NO_DOCTO" DataSetColumn="NO_DOCTO" />
              <Mapping SourceColumn="ESTADO" DataSetColumn="ESTADO" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	PC.ID_PLANILLA_COMPROB, 
	(SELECT CZ.CATORCENA FROM CATORCENA_ZAFRA CZ WHERE CZ.ID_CATORCENA = PC.ID_CATORCENA) AS CATORCENA,
	(SELECT TP.NOMBRE_TIPO_PLANILLA FROM TIPO_PLANILLA TP WHERE TP.ID_TIPO_PLANILLA = PC.ID_TIPO_PLANILLA) AS TIPO_PLANILLA,
	CAST(dbo.QuitarFormatoCODIPROVEEDOR(PC.CODIPROVEEDOR_TRANSPORTISTA) AS INT) AS CODIGO,
	PC.NOMBRE_CLIENTE, T.NOMBRE_TIPO,
	PC.SERIE, PC.NO_DOCTO, PC.ESTADO,
	PC.TOTAL
FROM PLANILLA_COMPROB PC, TIPO_COMPROB T
WHERE PC.ID_TIPO_COMPROB = T.ID_TIPO_COMPROB
AND PC.ID_CATORCENA = @ID_CATORCENA
AND PC.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND PC.ID_TIPO_COMPROB = @ID_TIPO_COMPROB
AND PC.ID_COMPROB_CONCE = @ID_COMPROB_CONCE
AND (PC.TIPO_CONTRIBUYENTE = @TIPO_CONTRIBUYENTE OR @TIPO_CONTRIBUYENTE = -1)
ORDER BY 4</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_COMPROB" ColumnName="ID_TIPO_COMPROB" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_COMPROB" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_COMPROB" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_COMPROB_CONCE" ColumnName="ID_COMPROB_CONCE" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_COMPROB_CONCE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_COMPROB_CONCE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TIPO_CONTRIBUYENTE" ColumnName="TIPO_CONTRIBUYENTE" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TIPO_CONTRIBUYENTE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="TIPO_CONTRIBUYENTE" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ARCHIVOS_PH_CCF_FATableAdapter" GeneratorDataComponentClassName="ARCHIVOS_PH_CCF_FATableAdapter" Name="ARCHIVOS_PH_CCF_FA" UserDataComponentName="ARCHIVOS_PH_CCF_FATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>select
'CCF' AS "tipofact",
	300 AS "numero",
	getdate() AS "fecha",
	'XXXXXXXX' AS "cliente",
	'10014' AS "registro",
	'1001445454' AS "dui",
	'ACODANAGE DE R.L.' AS "nombre",
	3 AS "clascontri",
	1634.64 AS "afecta",
	1634.64 AS "exento",
	1634.64 AS "iva",
	1634.64 AS "retencion",
	1634.64 AS "percepcion",
	1634.64 AS "exenta2",
	1634.64 AS "total"
where 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="tipofact" DataSetColumn="tipofact" />
              <Mapping SourceColumn="numero" DataSetColumn="numero" />
              <Mapping SourceColumn="fecha" DataSetColumn="fecha" />
              <Mapping SourceColumn="cliente" DataSetColumn="cliente" />
              <Mapping SourceColumn="registro" DataSetColumn="registro" />
              <Mapping SourceColumn="dui" DataSetColumn="dui" />
              <Mapping SourceColumn="nombre" DataSetColumn="nombre" />
              <Mapping SourceColumn="clascontri" DataSetColumn="clascontri" />
              <Mapping SourceColumn="afecta" DataSetColumn="afecta" />
              <Mapping SourceColumn="exento" DataSetColumn="exento" />
              <Mapping SourceColumn="iva" DataSetColumn="iva" />
              <Mapping SourceColumn="retencion" DataSetColumn="retencion" />
              <Mapping SourceColumn="percepcion" DataSetColumn="percepcion" />
              <Mapping SourceColumn="exenta2" DataSetColumn="exenta2" />
              <Mapping SourceColumn="total" DataSetColumn="total" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPlanillaNormal" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPlanillaNormal" GeneratorSourceName="FillPlanillaNormal" GetMethodModifier="Public" GetMethodName="GetPlanillaNormal" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPlanillaNormal" UserSourceName="FillPlanillaNormal">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	T.CODIGO_TIPO AS "tipofact",
	C.NO_DOCTO AS "numero",
	C.FECHA_EMISION AS "fecha",
	CASE 
	WHEN C.ID_TIPO_PLANILLA = 1 THEN (SELECT dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA)
	WHEN C.ID_TIPO_PLANILLA = 2 THEN C.CODIPROVEEDOR_TRANSPORTISTA
	END AS cliente,	
	C.NRC AS "registro",
	CASE 
	WHEN C.ID_TIPO_COMPROB = 1 THEN
		null
	ELSE 
		CASE 
		WHEN C.ID_TIPO_PLANILLA = 1 THEN (SELECT dbo.FormatearDUI(P.DUI) FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA)
		WHEN C.ID_TIPO_PLANILLA = 2 THEN (SELECT dbo.FormatearDUI(P.DUI) FROM TRANSPORTISTA P WHERE P.CODTRANSPORT = C.CODIPROVEEDOR_TRANSPORTISTA)
		END		
	END AS dui,	
	LEFT(C.NOMBRE_CLIENTE,120) AS "nombre",
	CASE 
	WHEN C.ID_TIPO_PLANILLA = 1 THEN (SELECT P.TIPO_CONTRIBUYENTE FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA) 
	WHEN C.ID_TIPO_PLANILLA = 2 AND RTRIM(ISNULL(C.NRC,'')) &lt;&gt; '' THEN  1
	WHEN C.ID_TIPO_PLANILLA = 2 AND RTRIM(ISNULL(C.NRC,'')) = '' THEN  0
	END AS "clascontri",
	CAST(C.AFECTO AS NUMERIC(20,2)) AS "afecta",
	CAST(C.EXENTO AS NUMERIC(20,2)) AS "exento",
	CAST(C.IVA AS NUMERIC(20,2)) AS "iva",
	CAST(C.RETENCION AS NUMERIC(20,2)) AS "retencion",
	CAST(C.PERCEPCION AS NUMERIC(20,2)) AS "percepcion",
	CAST(0 AS NUMERIC(20,2)) AS "exenta2",
	CAST(C.TOTAL AS NUMERIC(20,2)) AS "total"
FROM PLANILLA_COMPROB C, TIPO_COMPROB T                                                                                                                                                  
WHERE C.ID_CATORCENA = @ID_CATORCENA
AND C.ID_TIPO_PLANILLA IN (1,2)
AND C.ID_TIPO_COMPROB = T.ID_TIPO_COMPROB
AND C.ID_TIPO_COMPROB IN (1,2)
ORDER BY 1, 2</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	T.CODIGO_TIPO AS "tipofact",
	C.NO_DOCTO AS "numero",
	C.FECHA_EMISION AS "fecha",
	(SELECT dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA) AS cliente,
	C.NRC AS "registro",
	CASE 
	WHEN C.ID_TIPO_COMPROB = 1 THEN
		null
	ELSE 
		(SELECT dbo.FormatearDUI(P.DUI) FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA)
	END AS dui,	
	LEFT(C.NOMBRE_CLIENTE,120) AS "nombre",
	(SELECT P.TIPO_CONTRIBUYENTE FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA) AS "clascontri",
	CAST(C.AFECTO AS NUMERIC(20,2)) AS "afecta",
	CAST(C.EXENTO AS NUMERIC(20,2)) AS "exento",
	CAST(C.IVA AS NUMERIC(20,2)) AS "iva",
	CAST(C.RETENCION AS NUMERIC(20,2)) AS "retencion",
	CAST(C.PERCEPCION AS NUMERIC(20,2)) AS "percepcion",
	CAST(0 AS NUMERIC(20,2)) AS "exenta2",
	CAST(C.TOTAL AS NUMERIC(20,2)) AS "total"
FROM PLANILLA_COMPROB C, TIPO_COMPROB T                                                                                                                                                  
WHERE C.ID_CATORCENA = @ID_CATORCENA
AND C.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA
AND (SELECT COUNT(1) FROM PROVEEDOR P WHERE P.CODIPROVEEDOR = C.CODIPROVEEDOR_TRANSPORTISTA) &gt; 0
AND C.ID_TIPO_COMPROB = T.ID_TIPO_COMPROB
AND C.ID_TIPO_COMPROB IN (1,2)
ORDER BY 1, 2
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ARCHIVOS_PH_CCF_FA_DETATableAdapter" GeneratorDataComponentClassName="ARCHIVOS_PH_CCF_FA_DETATableAdapter" Name="ARCHIVOS_PH_CCF_FA_DETA" UserDataComponentName="ARCHIVOS_PH_CCF_FA_DETATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>select 
	'XXXXXX' AS "tipofact", 54545454 AS "numero",
	getdate() AS "fecha", 'XXXXXX' AS "codigoart",
	'XXXXXXXXXXXXXXX' AS "detalle", 2121 AS "cantidad", 45523.36 AS "afecta", 45523.36 AS "exento", 45523.36 AS "total"
where 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="tipofact" DataSetColumn="tipofact" />
              <Mapping SourceColumn="numero" DataSetColumn="numero" />
              <Mapping SourceColumn="fecha" DataSetColumn="fecha" />
              <Mapping SourceColumn="codigoart" DataSetColumn="codigoart" />
              <Mapping SourceColumn="detalle" DataSetColumn="detalle" />
              <Mapping SourceColumn="cantidad" DataSetColumn="cantidad" />
              <Mapping SourceColumn="afecta" DataSetColumn="afecta" />
              <Mapping SourceColumn="exento" DataSetColumn="exento" />
              <Mapping SourceColumn="total" DataSetColumn="total" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPlanillaNormal" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPlanillaNormal" GeneratorSourceName="FillPlanillaNormal" GetMethodModifier="Public" GetMethodName="GetPlanillaNormal" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPlanillaNormal" UserSourceName="FillPlanillaNormal">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	T.CODIGO_TIPO AS "tipofact", E.NO_DOCTO AS "numero",
	E.FECHA_EMISION AS "fecha", D.CODIGOART AS "codigoart",
	D.DETALLE AS "detalle", D.CANTIDAD AS "cantidad", D.AFECTO AS "afecta", D.EXENTO AS "exento", D.TOTAL AS "total"
FROM PLANILLA_COMPROB E, PLANILLA_COMPROB_DETA D, TIPO_COMPROB T
WHERE E.ID_PLANILLA_COMPROB = D.ID_PLANILLA_COMPROB
AND E.ID_TIPO_COMPROB = T.ID_TIPO_COMPROB
AND E.ID_CATORCENA = @ID_CATORCENA
AND E.ID_TIPO_PLANILLA in(1,2)
AND E.ID_TIPO_COMPROB IN (1,2)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="DESAINJIBOA.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	T.CODIGO_TIPO AS "tipofact", E.NO_DOCTO AS "numero",
	E.FECHA_EMISION AS "fecha", D.CODIGOART AS "codigoart",
	D.DETALLE AS "detalle", D.CANTIDAD AS "cantidad", D.AFECTO AS "afecta", D.EXENTO AS "exento", D.TOTAL AS "total"
FROM PLANILLA_COMPROB E, PLANILLA_COMPROB_DETA D, TIPO_COMPROB T
WHERE E.ID_PLANILLA_COMPROB = D.ID_PLANILLA_COMPROB
AND E.ID_TIPO_COMPROB = T.ID_TIPO_COMPROB
AND E.ID_CATORCENA = @ID_CATORCENA
AND E.ID_TIPO_PLANILLA = @ID_TIPO_PLANILLA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CATORCENA" ColumnName="ID_CATORCENA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_PLANILLA" ColumnName="ID_TIPO_PLANILLA" DataSourceName="INJIBOA2.dbo.PLANILLA_COMPROB" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_PLANILLA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_TIPO_PLANILLA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DS_COMPROBANTES" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="DS_COMPROBANTES" msprop:Generator_UserDSName="DS_COMPROBANTES">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="COMPROBANTE_RETENCION" msprop:Generator_TableClassName="COMPROBANTE_RETENCIONDataTable" msprop:Generator_TableVarName="tableCOMPROBANTE_RETENCION" msprop:Generator_RowChangedName="COMPROBANTE_RETENCIONRowChanged" msprop:Generator_TablePropName="COMPROBANTE_RETENCION" msprop:Generator_RowDeletingName="COMPROBANTE_RETENCIONRowDeleting" msprop:Generator_RowChangingName="COMPROBANTE_RETENCIONRowChanging" msprop:Generator_RowEvHandlerName="COMPROBANTE_RETENCIONRowChangeEventHandler" msprop:Generator_RowDeletedName="COMPROBANTE_RETENCIONRowDeleted" msprop:Generator_RowClassName="COMPROBANTE_RETENCIONRow" msprop:Generator_UserTableName="COMPROBANTE_RETENCION" msprop:Generator_RowEvArgName="COMPROBANTE_RETENCIONRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIGOPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIGOPROVEEDORColumn" msprop:Generator_UserColumnName="CODIGOPROVEEDOR" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEE_TRANS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEE_TRANSColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEE_TRANS" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_PAGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_PAGO" msprop:Generator_ColumnPropNameInRow="FECHA_PAGO" msprop:Generator_ColumnPropNameInTable="FECHA_PAGOColumn" msprop:Generator_UserColumnName="FECHA_PAGO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="REGISTRO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGISTRO" msprop:Generator_ColumnPropNameInRow="REGISTRO" msprop:Generator_ColumnPropNameInTable="REGISTROColumn" msprop:Generator_UserColumnName="REGISTRO" type="xs:string" minOccurs="0" />
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="VALOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR" msprop:Generator_ColumnPropNameInRow="VALOR" msprop:Generator_ColumnPropNameInTable="VALORColumn" msprop:Generator_UserColumnName="VALOR" type="xs:decimal" minOccurs="0" />
              <xs:element name="RETENCION_IVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRETENCION_IVA" msprop:Generator_ColumnPropNameInRow="RETENCION_IVA" msprop:Generator_ColumnPropNameInTable="RETENCION_IVAColumn" msprop:Generator_UserColumnName="RETENCION_IVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnIVA" msprop:Generator_ColumnPropNameInRow="IVA" msprop:Generator_ColumnPropNameInTable="IVAColumn" msprop:Generator_UserColumnName="IVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="CONCEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCONCEPTO" msprop:Generator_ColumnPropNameInRow="CONCEPTO" msprop:Generator_ColumnPropNameInTable="CONCEPTOColumn" msprop:Generator_UserColumnName="CONCEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="MONTO_LETRAS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMONTO_LETRAS" msprop:Generator_ColumnPropNameInRow="MONTO_LETRAS" msprop:Generator_ColumnPropNameInTable="MONTO_LETRASColumn" msprop:Generator_UserColumnName="MONTO_LETRAS" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="RENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENTA" msprop:Generator_ColumnPropNameInRow="RENTA" msprop:Generator_ColumnPropNameInTable="RENTAColumn" msprop:Generator_UserColumnName="RENTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="SUBTOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUBTOTAL" msprop:Generator_ColumnPropNameInRow="SUBTOTAL" msprop:Generator_ColumnPropNameInTable="SUBTOTALColumn" msprop:Generator_UserColumnName="SUBTOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="DUI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDUI" msprop:Generator_ColumnPropNameInRow="DUI" msprop:Generator_ColumnPropNameInTable="DUIColumn" msprop:Generator_UserColumnName="DUI" type="xs:string" minOccurs="0" />
              <xs:element name="TELEFONO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" type="xs:string" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" type="xs:string" minOccurs="0" />
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" type="xs:string" minOccurs="0" />
              <xs:element name="GIRO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnGIRO" msprop:Generator_ColumnPropNameInRow="GIRO" msprop:Generator_ColumnPropNameInTable="GIROColumn" msprop:Generator_UserColumnName="GIRO" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="FACTURACION_SERVICIOS_DEL_x0020__INGENIO" msprop:Generator_TableClassName="FACTURACION_SERVICIOS_DEL__INGENIODataTable" msprop:Generator_TableVarName="tableFACTURACION_SERVICIOS_DEL__INGENIO" msprop:Generator_RowChangedName="FACTURACION_SERVICIOS_DEL__INGENIORowChanged" msprop:Generator_TablePropName="FACTURACION_SERVICIOS_DEL__INGENIO" msprop:Generator_RowDeletingName="FACTURACION_SERVICIOS_DEL__INGENIORowDeleting" msprop:Generator_RowChangingName="FACTURACION_SERVICIOS_DEL__INGENIORowChanging" msprop:Generator_RowEvHandlerName="FACTURACION_SERVICIOS_DEL__INGENIORowChangeEventHandler" msprop:Generator_RowDeletedName="FACTURACION_SERVICIOS_DEL__INGENIORowDeleted" msprop:Generator_RowClassName="FACTURACION_SERVICIOS_DEL__INGENIORow" msprop:Generator_UserTableName="FACTURACION_SERVICIOS_DEL _INGENIO" msprop:Generator_RowEvArgName="FACTURACION_SERVICIOS_DEL__INGENIORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_CATORCENA" msprop:Generator_ColumnVarNameInTable="columnID_CATORCENA" msprop:Generator_ColumnPropNameInRow="ID_CATORCENA" msprop:Generator_ColumnPropNameInTable="ID_CATORCENAColumn" msprop:Generator_UserColumnName="ID_CATORCENA" type="xs:int" />
              <xs:element name="ID_TIPO_PLANILLA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_PLANILLA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_PLANILLA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_PLANILLAColumn" msprop:Generator_UserColumnName="ID_TIPO_PLANILLA" type="xs:int" />
              <xs:element name="CODIPROVEEDOR_TRANSPORTISTA" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR_TRANSPORTISTA" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR_TRANSPORTISTA" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDOR_TRANSPORTISTAColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR_TRANSPORTISTA" type="xs:string" />
              <xs:element name="CODIGOPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIGOPROVEEDORColumn" msprop:Generator_UserColumnName="CODIGOPROVEEDOR" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEE_TRANS" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEE_TRANSColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEE_TRANS" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_PAGO" msprop:Generator_ColumnVarNameInTable="columnFECHA_PAGO" msprop:Generator_ColumnPropNameInRow="FECHA_PAGO" msprop:Generator_ColumnPropNameInTable="FECHA_PAGOColumn" msprop:Generator_UserColumnName="FECHA_PAGO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="REGISTRO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGISTRO" msprop:Generator_ColumnPropNameInRow="REGISTRO" msprop:Generator_ColumnPropNameInTable="REGISTROColumn" msprop:Generator_UserColumnName="REGISTRO" type="xs:string" minOccurs="0" />
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="GIRO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnGIRO" msprop:Generator_ColumnPropNameInRow="GIRO" msprop:Generator_ColumnPropNameInTable="GIROColumn" msprop:Generator_UserColumnName="GIRO" type="xs:string" minOccurs="0" />
              <xs:element name="ORDEN" msprop:Generator_ColumnVarNameInTable="columnORDEN" msprop:Generator_ColumnPropNameInRow="ORDEN" msprop:Generator_ColumnPropNameInTable="ORDENColumn" msprop:Generator_UserColumnName="ORDEN" type="xs:int" />
              <xs:element name="CONCEPTO" msprop:Generator_ColumnVarNameInTable="columnCONCEPTO" msprop:Generator_ColumnPropNameInRow="CONCEPTO" msprop:Generator_ColumnPropNameInTable="CONCEPTOColumn" msprop:Generator_UserColumnName="CONCEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="VALOR" msprop:Generator_ColumnVarNameInTable="columnVALOR" msprop:Generator_ColumnPropNameInRow="VALOR" msprop:Generator_ColumnPropNameInTable="VALORColumn" msprop:Generator_UserColumnName="VALOR" type="xs:decimal" />
              <xs:element name="IVA" msprop:Generator_ColumnVarNameInTable="columnIVA" msprop:Generator_ColumnPropNameInRow="IVA" msprop:Generator_ColumnPropNameInTable="IVAColumn" msprop:Generator_UserColumnName="IVA" type="xs:decimal" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="MONTO_LETRAS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMONTO_LETRAS" msprop:Generator_ColumnPropNameInRow="MONTO_LETRAS" msprop:Generator_ColumnPropNameInTable="MONTO_LETRASColumn" msprop:Generator_UserColumnName="MONTO_LETRAS" type="xs:string" minOccurs="0" />
              <xs:element name="DUI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDUI" msprop:Generator_ColumnPropNameInRow="DUI" msprop:Generator_ColumnPropNameInTable="DUIColumn" msprop:Generator_UserColumnName="DUI" type="xs:string" minOccurs="0" />
              <xs:element name="TELEFONO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" type="xs:string" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" type="xs:string" minOccurs="0" />
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="FACTURACION_SERVICIOS_PROVEEDORES" msprop:Generator_TableClassName="FACTURACION_SERVICIOS_PROVEEDORESDataTable" msprop:Generator_TableVarName="tableFACTURACION_SERVICIOS_PROVEEDORES" msprop:Generator_RowChangedName="FACTURACION_SERVICIOS_PROVEEDORESRowChanged" msprop:Generator_TablePropName="FACTURACION_SERVICIOS_PROVEEDORES" msprop:Generator_RowDeletingName="FACTURACION_SERVICIOS_PROVEEDORESRowDeleting" msprop:Generator_RowChangingName="FACTURACION_SERVICIOS_PROVEEDORESRowChanging" msprop:Generator_RowEvHandlerName="FACTURACION_SERVICIOS_PROVEEDORESRowChangeEventHandler" msprop:Generator_RowDeletedName="FACTURACION_SERVICIOS_PROVEEDORESRowDeleted" msprop:Generator_RowClassName="FACTURACION_SERVICIOS_PROVEEDORESRow" msprop:Generator_UserTableName="FACTURACION_SERVICIOS_PROVEEDORES" msprop:Generator_RowEvArgName="FACTURACION_SERVICIOS_PROVEEDORESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIGOPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIGOPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIGOPROVEEDORColumn" msprop:Generator_UserColumnName="CODIGOPROVEEDOR" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEE_TRANS" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEE_TRANS" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEE_TRANSColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEE_TRANS" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_PAGO" msprop:Generator_ColumnVarNameInTable="columnFECHA_PAGO" msprop:Generator_ColumnPropNameInRow="FECHA_PAGO" msprop:Generator_ColumnPropNameInTable="FECHA_PAGOColumn" msprop:Generator_UserColumnName="FECHA_PAGO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="REGISTRO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGISTRO" msprop:Generator_ColumnPropNameInRow="REGISTRO" msprop:Generator_ColumnPropNameInTable="REGISTROColumn" msprop:Generator_UserColumnName="REGISTRO" type="xs:string" minOccurs="0" />
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="CONCEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCONCEPTO" msprop:Generator_ColumnPropNameInRow="CONCEPTO" msprop:Generator_ColumnPropNameInTable="CONCEPTOColumn" msprop:Generator_UserColumnName="CONCEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="VALOR" msprop:Generator_ColumnVarNameInTable="columnVALOR" msprop:Generator_ColumnPropNameInRow="VALOR" msprop:Generator_ColumnPropNameInTable="VALORColumn" msprop:Generator_UserColumnName="VALOR" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA" msprop:Generator_ColumnVarNameInTable="columnIVA" msprop:Generator_ColumnPropNameInRow="IVA" msprop:Generator_ColumnPropNameInTable="IVAColumn" msprop:Generator_UserColumnName="IVA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="REPO_COMPROBANTES" msprop:Generator_TableClassName="REPO_COMPROBANTESDataTable" msprop:Generator_TableVarName="tableREPO_COMPROBANTES" msprop:Generator_TablePropName="REPO_COMPROBANTES" msprop:Generator_RowDeletingName="REPO_COMPROBANTESRowDeleting" msprop:Generator_RowChangingName="REPO_COMPROBANTESRowChanging" msprop:Generator_RowEvHandlerName="REPO_COMPROBANTESRowChangeEventHandler" msprop:Generator_RowDeletedName="REPO_COMPROBANTESRowDeleted" msprop:Generator_UserTableName="REPO_COMPROBANTES" msprop:Generator_RowChangedName="REPO_COMPROBANTESRowChanged" msprop:Generator_RowEvArgName="REPO_COMPROBANTESRowChangeEvent" msprop:Generator_RowClassName="REPO_COMPROBANTESRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_CLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CLIENTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_CLIENTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_CLIENTEColumn" msprop:Generator_UserColumnName="NOMBRE_CLIENTE" type="xs:string" minOccurs="0" />
              <xs:element name="AFECTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAFECTO" msprop:Generator_ColumnPropNameInRow="AFECTO" msprop:Generator_ColumnPropNameInTable="AFECTOColumn" msprop:Generator_UserColumnName="AFECTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnIVA" msprop:Generator_ColumnPropNameInRow="IVA" msprop:Generator_ColumnPropNameInTable="IVAColumn" msprop:Generator_UserColumnName="IVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="RENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENTA" msprop:Generator_ColumnPropNameInRow="RENTA" msprop:Generator_ColumnPropNameInTable="RENTAColumn" msprop:Generator_UserColumnName="RENTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="RETENCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRETENCION" msprop:Generator_ColumnPropNameInRow="RETENCION" msprop:Generator_ColumnPropNameInTable="RETENCIONColumn" msprop:Generator_UserColumnName="RETENCION" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="SERIE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSERIE" msprop:Generator_ColumnPropNameInRow="SERIE" msprop:Generator_ColumnPropNameInTable="SERIEColumn" msprop:Generator_UserColumnName="SERIE" type="xs:string" minOccurs="0" />
              <xs:element name="NO_DOCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_DOCTO" msprop:Generator_ColumnPropNameInRow="NO_DOCTO" msprop:Generator_ColumnPropNameInTable="NO_DOCTOColumn" msprop:Generator_UserColumnName="NO_DOCTO" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_TIPO" msprop:Generator_ColumnPropNameInRow="NOMBRE_TIPO" msprop:Generator_ColumnPropNameInTable="NOMBRE_TIPOColumn" msprop:Generator_UserColumnName="NOMBRE_TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO_CONTRIBUYENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CONTRIBUYENTE" msprop:Generator_ColumnPropNameInRow="TIPO_CONTRIBUYENTE" msprop:Generator_ColumnPropNameInTable="TIPO_CONTRIBUYENTEColumn" msprop:Generator_UserColumnName="TIPO_CONTRIBUYENTE" type="xs:int" minOccurs="0" />
              <xs:element name="CODIGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" type="xs:int" minOccurs="0" />
              <xs:element name="DUI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDUI" msprop:Generator_ColumnPropNameInRow="DUI" msprop:Generator_ColumnPropNameInTable="DUIColumn" msprop:Generator_UserColumnName="DUI" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="NRC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNRC" msprop:Generator_ColumnPropNameInRow="NRC" msprop:Generator_ColumnPropNameInTable="NRCColumn" msprop:Generator_UserColumnName="NRC" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="LISTADO_COMPROBANTES" msprop:Generator_TableClassName="LISTADO_COMPROBANTESDataTable" msprop:Generator_TableVarName="tableLISTADO_COMPROBANTES" msprop:Generator_RowChangedName="LISTADO_COMPROBANTESRowChanged" msprop:Generator_TablePropName="LISTADO_COMPROBANTES" msprop:Generator_RowDeletingName="LISTADO_COMPROBANTESRowDeleting" msprop:Generator_RowChangingName="LISTADO_COMPROBANTESRowChanging" msprop:Generator_RowEvHandlerName="LISTADO_COMPROBANTESRowChangeEventHandler" msprop:Generator_RowDeletedName="LISTADO_COMPROBANTESRowDeleted" msprop:Generator_RowClassName="LISTADO_COMPROBANTESRow" msprop:Generator_UserTableName="LISTADO_COMPROBANTES" msprop:Generator_RowEvArgName="LISTADO_COMPROBANTESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_PLANILLA_COMPROB" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_PLANILLA_COMPROB" msprop:Generator_ColumnPropNameInRow="ID_PLANILLA_COMPROB" msprop:Generator_ColumnPropNameInTable="ID_PLANILLA_COMPROBColumn" msprop:Generator_UserColumnName="ID_PLANILLA_COMPROB" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="TIPO_PLANILLA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_PLANILLA" msprop:Generator_ColumnPropNameInRow="TIPO_PLANILLA" msprop:Generator_ColumnPropNameInTable="TIPO_PLANILLAColumn" msprop:Generator_UserColumnName="TIPO_PLANILLA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_CLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CLIENTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_CLIENTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_CLIENTEColumn" msprop:Generator_UserColumnName="NOMBRE_CLIENTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_TIPO" msprop:Generator_ColumnPropNameInRow="NOMBRE_TIPO" msprop:Generator_ColumnPropNameInTable="NOMBRE_TIPOColumn" msprop:Generator_UserColumnName="NOMBRE_TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="SERIE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSERIE" msprop:Generator_ColumnPropNameInRow="SERIE" msprop:Generator_ColumnPropNameInTable="SERIEColumn" msprop:Generator_UserColumnName="SERIE" type="xs:string" minOccurs="0" />
              <xs:element name="NO_DOCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_DOCTO" msprop:Generator_ColumnPropNameInRow="NO_DOCTO" msprop:Generator_ColumnPropNameInTable="NO_DOCTOColumn" msprop:Generator_UserColumnName="NO_DOCTO" type="xs:int" minOccurs="0" />
              <xs:element name="ESTADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnESTADO" msprop:Generator_ColumnPropNameInRow="ESTADO" msprop:Generator_ColumnPropNameInTable="ESTADOColumn" msprop:Generator_UserColumnName="ESTADO" type="xs:string" minOccurs="0" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ARCHIVOS_PH_CCF_FA" msprop:Generator_TableClassName="ARCHIVOS_PH_CCF_FADataTable" msprop:Generator_TableVarName="tableARCHIVOS_PH_CCF_FA" msprop:Generator_TablePropName="ARCHIVOS_PH_CCF_FA" msprop:Generator_RowDeletingName="ARCHIVOS_PH_CCF_FARowDeleting" msprop:Generator_RowChangingName="ARCHIVOS_PH_CCF_FARowChanging" msprop:Generator_RowEvHandlerName="ARCHIVOS_PH_CCF_FARowChangeEventHandler" msprop:Generator_RowDeletedName="ARCHIVOS_PH_CCF_FARowDeleted" msprop:Generator_UserTableName="ARCHIVOS_PH_CCF_FA" msprop:Generator_RowChangedName="ARCHIVOS_PH_CCF_FARowChanged" msprop:Generator_RowEvArgName="ARCHIVOS_PH_CCF_FARowChangeEvent" msprop:Generator_RowClassName="ARCHIVOS_PH_CCF_FARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="tipofact" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntipofact" msprop:Generator_ColumnPropNameInRow="tipofact" msprop:Generator_ColumnPropNameInTable="tipofactColumn" msprop:Generator_UserColumnName="tipofact" type="xs:string" minOccurs="0" />
              <xs:element name="numero" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnnumero" msprop:Generator_ColumnPropNameInRow="numero" msprop:Generator_ColumnPropNameInTable="numeroColumn" msprop:Generator_UserColumnName="numero" type="xs:int" minOccurs="0" />
              <xs:element name="fecha" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnfecha" msprop:Generator_ColumnPropNameInRow="fecha" msprop:Generator_ColumnPropNameInTable="fechaColumn" msprop:Generator_UserColumnName="fecha" type="xs:dateTime" minOccurs="0" />
              <xs:element name="cliente" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncliente" msprop:Generator_ColumnPropNameInRow="cliente" msprop:Generator_ColumnPropNameInTable="clienteColumn" msprop:Generator_UserColumnName="cliente" type="xs:string" minOccurs="0" />
              <xs:element name="registro" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnregistro" msprop:Generator_ColumnPropNameInRow="registro" msprop:Generator_ColumnPropNameInTable="registroColumn" msprop:Generator_UserColumnName="registro" type="xs:string" minOccurs="0" />
              <xs:element name="dui" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columndui" msprop:Generator_ColumnPropNameInRow="dui" msprop:Generator_ColumnPropNameInTable="duiColumn" msprop:Generator_UserColumnName="dui" type="xs:string" minOccurs="0" />
              <xs:element name="nombre" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnnombre" msprop:Generator_ColumnPropNameInRow="nombre" msprop:Generator_ColumnPropNameInTable="nombreColumn" msprop:Generator_UserColumnName="nombre" type="xs:string" minOccurs="0" />
              <xs:element name="clascontri" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnclascontri" msprop:Generator_ColumnPropNameInRow="clascontri" msprop:Generator_ColumnPropNameInTable="clascontriColumn" msprop:Generator_UserColumnName="clascontri" type="xs:int" minOccurs="0" />
              <xs:element name="afecta" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnafecta" msprop:Generator_ColumnPropNameInRow="afecta" msprop:Generator_ColumnPropNameInTable="afectaColumn" msprop:Generator_UserColumnName="afecta" type="xs:decimal" minOccurs="0" />
              <xs:element name="exento" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnexento" msprop:Generator_ColumnPropNameInRow="exento" msprop:Generator_ColumnPropNameInTable="exentoColumn" msprop:Generator_UserColumnName="exento" type="xs:decimal" minOccurs="0" />
              <xs:element name="iva" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columniva" msprop:Generator_ColumnPropNameInRow="iva" msprop:Generator_ColumnPropNameInTable="ivaColumn" msprop:Generator_UserColumnName="iva" type="xs:decimal" minOccurs="0" />
              <xs:element name="retencion" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnretencion" msprop:Generator_ColumnPropNameInRow="retencion" msprop:Generator_ColumnPropNameInTable="retencionColumn" msprop:Generator_UserColumnName="retencion" type="xs:decimal" minOccurs="0" />
              <xs:element name="percepcion" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnpercepcion" msprop:Generator_ColumnPropNameInRow="percepcion" msprop:Generator_ColumnPropNameInTable="percepcionColumn" msprop:Generator_UserColumnName="percepcion" type="xs:decimal" minOccurs="0" />
              <xs:element name="exenta2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnexenta2" msprop:Generator_ColumnPropNameInRow="exenta2" msprop:Generator_ColumnPropNameInTable="exenta2Column" msprop:Generator_UserColumnName="exenta2" type="xs:decimal" minOccurs="0" />
              <xs:element name="total" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntotal" msprop:Generator_ColumnPropNameInRow="total" msprop:Generator_ColumnPropNameInTable="totalColumn" msprop:Generator_UserColumnName="total" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ARCHIVOS_PH_CCF_FA_DETA" msprop:Generator_TableClassName="ARCHIVOS_PH_CCF_FA_DETADataTable" msprop:Generator_TableVarName="tableARCHIVOS_PH_CCF_FA_DETA" msprop:Generator_TablePropName="ARCHIVOS_PH_CCF_FA_DETA" msprop:Generator_RowDeletingName="ARCHIVOS_PH_CCF_FA_DETARowDeleting" msprop:Generator_RowChangingName="ARCHIVOS_PH_CCF_FA_DETARowChanging" msprop:Generator_RowEvHandlerName="ARCHIVOS_PH_CCF_FA_DETARowChangeEventHandler" msprop:Generator_RowDeletedName="ARCHIVOS_PH_CCF_FA_DETARowDeleted" msprop:Generator_UserTableName="ARCHIVOS_PH_CCF_FA_DETA" msprop:Generator_RowChangedName="ARCHIVOS_PH_CCF_FA_DETARowChanged" msprop:Generator_RowEvArgName="ARCHIVOS_PH_CCF_FA_DETARowChangeEvent" msprop:Generator_RowClassName="ARCHIVOS_PH_CCF_FA_DETARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="tipofact" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntipofact" msprop:Generator_ColumnPropNameInRow="tipofact" msprop:Generator_ColumnPropNameInTable="tipofactColumn" msprop:Generator_UserColumnName="tipofact" type="xs:string" minOccurs="0" />
              <xs:element name="numero" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnnumero" msprop:Generator_ColumnPropNameInRow="numero" msprop:Generator_ColumnPropNameInTable="numeroColumn" msprop:Generator_UserColumnName="numero" type="xs:int" minOccurs="0" />
              <xs:element name="fecha" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnfecha" msprop:Generator_ColumnPropNameInRow="fecha" msprop:Generator_ColumnPropNameInTable="fechaColumn" msprop:Generator_UserColumnName="fecha" type="xs:dateTime" minOccurs="0" />
              <xs:element name="codigoart" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncodigoart" msprop:Generator_ColumnPropNameInRow="codigoart" msprop:Generator_ColumnPropNameInTable="codigoartColumn" msprop:Generator_UserColumnName="codigoart" type="xs:string" minOccurs="0" />
              <xs:element name="detalle" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columndetalle" msprop:Generator_ColumnPropNameInRow="detalle" msprop:Generator_ColumnPropNameInTable="detalleColumn" msprop:Generator_UserColumnName="detalle" type="xs:string" minOccurs="0" />
              <xs:element name="cantidad" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncantidad" msprop:Generator_ColumnPropNameInRow="cantidad" msprop:Generator_ColumnPropNameInTable="cantidadColumn" msprop:Generator_UserColumnName="cantidad" type="xs:int" minOccurs="0" />
              <xs:element name="afecta" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnafecta" msprop:Generator_ColumnPropNameInRow="afecta" msprop:Generator_ColumnPropNameInTable="afectaColumn" msprop:Generator_UserColumnName="afecta" type="xs:decimal" minOccurs="0" />
              <xs:element name="exento" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnexento" msprop:Generator_ColumnPropNameInRow="exento" msprop:Generator_ColumnPropNameInTable="exentoColumn" msprop:Generator_UserColumnName="exento" type="xs:decimal" minOccurs="0" />
              <xs:element name="total" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntotal" msprop:Generator_ColumnPropNameInRow="total" msprop:Generator_ColumnPropNameInTable="totalColumn" msprop:Generator_UserColumnName="total" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>