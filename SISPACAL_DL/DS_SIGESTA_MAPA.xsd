<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DS_SIGESTA_MAPA" targetNamespace="http://tempuri.org/DS_SIGESTA_MAPA.xsd" xmlns:mstns="http://tempuri.org/DS_SIGESTA_MAPA.xsd" xmlns="http://tempuri.org/DS_SIGESTA_MAPA.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="MySettings" AppSettingsPropertyName="cn" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="cn (MySettings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.SISPACAL.DL.My.MySettings.GlobalReference.Default.cn" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="MapaTerciosTableAdapter" GeneratorDataComponentClassName="MapaTerciosTableAdapter" Name="MapaTercios" UserDataComponentName="MapaTerciosTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, TERCIO, SUM(TONEL_CENSO) AS TONEL, NOMBRE_CANTON
FROM (
	SELECT 
		CASE 
			WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1
			WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3
			ELSE TERCIO 
		END AS TERCIO,	
		CASE 
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO'
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO'
			ELSE SUB_TERCIO 
		END AS SUB_TERCIO,
		TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO 
	FROM
	(
		SELECT 
			(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO,
			(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO,
			(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, 
			(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO,
			V.ID_TIPO,
			V.ID_SUB_TIPO,
			CL.TONEL_CENSO,
			LC.FECHA_ROZA,			
			C.CODI_DEPTO,
            C.CODI_MUNI,
            C.CODI_CANTON,
			c.NOMBRE_CANTON,
			C.POSICION_GEO
		FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V
		WHERE CL.ACCESLOTE	= L.ACCESLOTE 
		AND LC.ACCESLOTE	= CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA
		AND L.ID_MAESTRO	= ML.ID_MAESTRO
		AND ML.CODI_DEPTO	= C.CODI_DEPTO
		AND ML.CODI_MUNI	= C.CODI_MUNI
		AND ML.CODI_CANTON	= C.CODI_CANTON
		AND L.CODIVARIEDA	= V.CODIVARIEDA	
	) A	
) B
GROUP BY CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, TERCIO, NOMBRE_CANTON</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="POSICION_GEO" DataSetColumn="POSICION_GEO" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="TONEL" DataSetColumn="TONEL" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillTercioPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetTercioPorCriterios" GeneratorSourceName="FillTercioPorCriterios" GetMethodModifier="Public" GetMethodName="GetTercioPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetTercioPorCriterios" UserSourceName="FillTercioPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, TERCIO, SUM(TONEL_CENSO) AS TONEL, NOMBRE_CANTON
FROM (
	SELECT 
		CASE 
			WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1
			WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3
			ELSE ISNULL(TERCIO,1)
		END AS TERCIO,	
		CASE 
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO'
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO'
			ELSE SUB_TERCIO 
		END AS SUB_TERCIO,
		TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO 
	FROM
	(
		SELECT 
			(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO,
			(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO,
			(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, 
			(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO,
			V.ID_TIPO,
			V.ID_SUB_TIPO,
			CL.TONEL_CENSO,
			LC.FECHA_ROZA,			
			C.CODI_DEPTO,
            C.CODI_MUNI,
            C.CODI_CANTON,
			c.NOMBRE_CANTON,
			C.POSICION_GEO
		FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V
		WHERE CL.ACCESLOTE	= L.ACCESLOTE 
		AND LC.ACCESLOTE	= CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA
		AND L.ID_MAESTRO	= ML.ID_MAESTRO
		AND ML.CODI_DEPTO	= C.CODI_DEPTO
		AND ML.CODI_MUNI	= C.CODI_MUNI
		AND ML.CODI_CANTON	= C.CODI_CANTON
		AND L.CODIVARIEDA	= V.CODIVARIEDA
		AND CL.ID_CENSO = @ID_CENSO
	) A	
) B
WHERE (TERCIO = @TERCIO OR @TERCIO =-1) AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '') 
	AND (ID_TIPO = @ID_TIPO OR @ID_TIPO=-1) AND (ID_SUB_TIPO = @ID_SUB_TIPO OR @ID_SUB_TIPO=-1)
GROUP BY CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, TERCIO, NOMBRE_CANTON
ORDER BY CODI_DEPTO, CODI_MUNI, CODI_CANTON, 6 DESC</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO" ColumnName="ID_TIPO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SUB_TIPO" ColumnName="ID_SUB_TIPO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO" Precision="0" Scale="0" Size="0" SourceColumn="ID_SUB_TIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillTipoCanaPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetTipoCanaPorCriterios" GeneratorSourceName="FillTipoCanaPorCriterios" GetMethodModifier="Public" GetMethodName="GetTipoCanaPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetTipoCanaPorCriterios" UserSourceName="FillTipoCanaPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, ID_TIPO AS TERCIO, SUM(TONEL_CENSO) AS TONEL, NOMBRE_CANTON
FROM (
	SELECT 
		CASE 
			WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1
			WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3
			ELSE ISNULL(TERCIO,1)
		END AS TERCIO,	
		CASE 
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO'
			WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO'
			ELSE SUB_TERCIO 
		END AS SUB_TERCIO,
		TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO 
	FROM
	(
		SELECT 
			(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO,
			(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO,
			(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, 
			(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO,
			V.ID_TIPO,
			V.ID_SUB_TIPO,
			CL.TONEL_CENSO,
			LC.FECHA_ROZA,			
			C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON,
			c.NOMBRE_CANTON,
			C.POSICION_GEO
		FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V
		WHERE CL.ACCESLOTE	= L.ACCESLOTE 
		AND LC.ACCESLOTE	= CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA
		AND L.ID_MAESTRO	= ML.ID_MAESTRO
		AND ML.CODI_DEPTO	= C.CODI_DEPTO
		AND ML.CODI_MUNI	= C.CODI_MUNI
		AND ML.CODI_CANTON	= C.CODI_CANTON
		AND L.CODIVARIEDA	= V.CODIVARIEDA
		AND CL.ID_CENSO = @ID_CENSO
	) A	
) B

WHERE (TERCIO = @TERCIO OR @TERCIO =-1) AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '') 
	AND (ID_TIPO = @ID_TIPO OR @ID_TIPO=-1) AND (ID_SUB_TIPO = @ID_SUB_TIPO OR @ID_SUB_TIPO=-1)
GROUP BY CODI_DEPTO, CODI_MUNI, CODI_CANTON, POSICION_GEO, ID_TIPO, NOMBRE_CANTON
ORDER BY CODI_DEPTO, CODI_MUNI, CODI_CANTON, 6 DESC</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO" ColumnName="ID_TIPO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO" Precision="0" Scale="0" Size="0" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SUB_TIPO" ColumnName="ID_SUB_TIPO" DataSourceName="SELECT CASE WHEN TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 3 ELSE ISNULL(TERCIO,1) END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, TONEL_CENSO, ID_TIPO, ID_SUB_TIPO, CODI_DEPTO, CODI_MUNI, CODI_CANTON, NOMBRE_CANTON, POSICION_GEO FROM ( SELECT (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = CL.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, V.ID_TIPO, V.ID_SUB_TIPO, CL.TONEL_CENSO, LC.FECHA_ROZA, C.CODI_DEPTO, C.CODI_MUNI, C.CODI_CANTON, c.NOMBRE_CANTON, C.POSICION_GEO FROM CENSO_LOTES CL, LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, VARIEDAD V WHERE CL.ACCESLOTE = L.ACCESLOTE AND LC.ACCESLOTE = CL.ACCESLOTE AND LC.ID_ZAFRA = CL.ID_ZAFRA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON AND L.CODIVARIEDA = V.CODIVARIEDA AND CL.ID_CENSO = @ID_CENSO ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO" Precision="0" Scale="0" Size="0" SourceColumn="ID_SUB_TIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DS_SIGESTA_MAPA" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="DS_SIGESTA_MAPA" msprop:Generator_UserDSName="DS_SIGESTA_MAPA">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="MapaTercios" msprop:Generator_TableClassName="MapaTerciosDataTable" msprop:Generator_TableVarName="tableMapaTercios" msprop:Generator_TablePropName="MapaTercios" msprop:Generator_RowDeletingName="MapaTerciosRowDeleting" msprop:Generator_UserTableName="MapaTercios" msprop:Generator_RowChangingName="MapaTerciosRowChanging" msprop:Generator_RowEvHandlerName="MapaTerciosRowChangeEventHandler" msprop:Generator_RowDeletedName="MapaTerciosRowDeleted" msprop:Generator_RowEvArgName="MapaTerciosRowChangeEvent" msprop:Generator_RowChangedName="MapaTerciosRowChanged" msprop:Generator_RowClassName="MapaTerciosRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="POSICION_GEO" msprop:Generator_ColumnVarNameInTable="columnPOSICION_GEO" msprop:Generator_ColumnPropNameInRow="POSICION_GEO" msprop:Generator_ColumnPropNameInTable="POSICION_GEOColumn" msprop:Generator_UserColumnName="POSICION_GEO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="500" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TERCIO" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL" msprop:Generator_ColumnPropNameInRow="TONEL" msprop:Generator_ColumnPropNameInTable="TONELColumn" msprop:Generator_UserColumnName="TONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>