<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DS_SIGESTA" targetNamespace="http://tempuri.org/DS_SIGESTA.xsd" xmlns:mstns="http://tempuri.org/DS_SIGESTA.xsd" xmlns="http://tempuri.org/DS_SIGESTA.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="MySettings" AppSettingsPropertyName="cn" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="cn (MySettings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.SISPACAL.DL.My.MySettings.GlobalReference.Default.cn" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_REND_ESTIMADOTableAdapter" GeneratorDataComponentClassName="CONTRATO_REND_ESTIMADOTableAdapter" Name="CONTRATO_REND_ESTIMADO" UserDataComponentName="CONTRATO_REND_ESTIMADOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT (SELECT Z.NOMBRE_ZAFRA  FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_CONTRATADO, 
	ISNULL(L.TONELADAS,0) AS TC_MZ_CONTRATADO, ISNULL(L.TONEL_TC,0) AS TC_CONTRATADO, ISNULL(LC.LBS_CENSO,0) AS LBS_CONTRATADO, 
	ISNULL(LC.VALOR_CENSO,0) AS VALOR_CONTRATADO,
	0 AS CANT_LOTES, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	(SELECT SUBSTRING(MIN(F.NOMBRE_ZAFRA),3,2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) +
	'-' + 
	(SELECT RIGHT(MAX(F.NOMBRE_ZAFRA),2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) AS VIGENCIA
FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODICONTRATO = CZ.CODICONTRATO
AND L.ZONA = N.ZONA
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
	AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
	AND L.ACCESLOTE = LC.ACCESLOTE	
	AND CZ.ID_ZAFRA = LC.ID_ZAFRA
	AND CZ.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="REND_CONTRATADO" DataSetColumn="REND_CONTRATADO" />
              <Mapping SourceColumn="MZ_CONTRATADO" DataSetColumn="MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_MZ_CONTRATADO" DataSetColumn="TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_CONTRATADO" DataSetColumn="TC_CONTRATADO" />
              <Mapping SourceColumn="LBS_CONTRATADO" DataSetColumn="LBS_CONTRATADO" />
              <Mapping SourceColumn="VALOR_CONTRATADO" DataSetColumn="VALOR_CONTRATADO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ANIOZAFRA" DataSetColumn="ANIOZAFRA" />
              <Mapping SourceColumn="CANT_LOTES" DataSetColumn="CANT_LOTES" />
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="CANT_CONTRATOS" DataSetColumn="CANT_CONTRATOS" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="VIGENCIA" DataSetColumn="VIGENCIA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT (SELECT Z.NOMBRE_ZAFRA  FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(	
				ISNULL(CASE 
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA) &gt; 0 THEN 
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA)
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA - 1)) &gt; 0 THEN
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA -1 ))
							ELSE (SELECT AVG(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ZONA = L.ZONA AND T.ACCESLOTE = LC.ACCESLOTE AND LC.REND_COSECHA &gt; 0 AND LC.ID_ZAFRA = (@ID_ZAFRA -1)) 
						END 
				, 0)				
			,0) AS REND_CONTRATADO, 
	ISNULL(L.AREA,0) AS MZ_CONTRATADO, 
	ISNULL(L.TONELADAS,0) AS TC_MZ_CONTRATADO, ISNULL(L.TONEL_TC,0) AS TC_CONTRATADO, 
	ISNULL(	
				ISNULL(CASE 
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA) &gt; 0 THEN 
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA)
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA - 1)) &gt; 0 THEN
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA -1 ))
							ELSE (SELECT AVG(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ZONA = L.ZONA AND T.ACCESLOTE = LC.ACCESLOTE AND LC.REND_COSECHA &gt; 0 AND LC.ID_ZAFRA = (@ID_ZAFRA -1)) 
						END 
				, 0)
				* 
				L.TONEL_TC
			,0) AS LBS_CONTRATADO, 
	ISNULL(	
				ISNULL(CASE 
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA) &gt; 0 THEN 
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA)
							WHEN (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA - 1)) &gt; 0 THEN
								 (SELECT MAX(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ID_MAESTRO = L.ID_MAESTRO AND T.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = (@ID_ZAFRA -1 ))
							ELSE (SELECT AVG(LC.REND_COSECHA) FROM LOTES T, LOTES_COSECHA LC WHERE T.ZONA = L.ZONA AND T.ACCESLOTE = LC.ACCESLOTE AND LC.REND_COSECHA &gt; 0 AND LC.ID_ZAFRA = (@ID_ZAFRA -1)) 
						END 
				, 0)
				* 
				L.TONEL_TC
				*
				Z.PRECIO_LIBRA_AZUCAR
			,0)	 AS VALOR_CONTRATADO,
	0 AS CANT_LOTES, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	(SELECT SUBSTRING(MIN(F.NOMBRE_ZAFRA),3,2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) +
	'-' + 
	(SELECT RIGHT(MAX(F.NOMBRE_ZAFRA),2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) AS VIGENCIA
FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, ZAFRA Z
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODICONTRATO = CZ.CODICONTRATO
AND L.ZONA = N.ZONA
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
	AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
	AND ML.CODI_DEPTO = D.CODI_DEPTO	
	AND CZ.ID_ZAFRA = Z.ID_ZAFRA
	AND CZ.ID_ZAFRA = @ID_ZAFRA
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
AND ( 
		(SELECT COUNT(1) FROM LOTES_TRASPASO TS WHERE TS.ACCESLOTE = L.ACCESLOTE) = 0 
		OR ( (SELECT COUNT(1) FROM LOTES_TRASPASO TS WHERE TS.ACCESLOTE = L.ACCESLOTE) &gt; 0 AND L.ID_LOTE_TRASPASO IS NULL) 
	)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA2.dbo.CONTRATO_ZAFRAS" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA2.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA2.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA2.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA2.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA2.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByEsticana" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByEsticana" GeneratorSourceName="FillByEsticana" GetMethodModifier="Public" GetMethodName="GetDataByEsticana" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByEsticana" UserSourceName="FillByEsticana">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, 
	ISNULL(LC.MZ_CENSO,0) AS MZ_CONTRATADO, 
	ISNULL(LC.TONEL_MZ_CENSO,0) AS TC_MZ_CONTRATADO, ISNULL(LC.TONEL_CENSO,0) AS TC_CONTRATADO, 
	ISNULL(LC.LBS_CENSO,0) AS LBS_CONTRATADO, 
	ISNULL(LC.LBS_CENSO	* Z.PRECIO_LIBRA_AZUCAR ,0)	 AS VALOR_CONTRATADO,
	0 AS CANT_LOTES, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	(SELECT SUBSTRING(MIN(F.NOMBRE_ZAFRA),3,2) + '/' + SUBSTRING(MIN(F.NOMBRE_ZAFRA),8,2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) +
	'-' + 
	(SELECT SUBSTRING(MAX(F.NOMBRE_ZAFRA),3,2) + '/' + SUBSTRING(MAX(F.NOMBRE_ZAFRA),8,2) FROM CONTRATO_ZAFRAS ZA, ZAFRA F WHERE ZA.ID_ZAFRA = F.ID_ZAFRA AND ZA.CODICONTRATO = L.CODICONTRATO) AS VIGENCIA
FROM LOTES L, PROVEEDOR P, LOTES_COSECHA LC, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, ZAFRA Z
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ZONA = N.ZONA
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
	AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
	AND ML.CODI_DEPTO = D.CODI_DEPTO		
	AND (L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA)
	AND LC.ID_ZAFRA = Z.ID_ZAFRA
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
AND ( 
		(SELECT COUNT(1) FROM LOTES_TRASPASO TS WHERE TS.ACCESLOTE = L.ACCESLOTE) = 0 
		OR ( (SELECT COUNT(1) FROM LOTES_TRASPASO TS WHERE TS.ACCESLOTE = L.ACCESLOTE) &gt; 0 AND L.ID_LOTE_TRASPASO IS NULL) 
	)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA.dbo.LOTES_COSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, ISNULL(L.TONEL_TC,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = CZ.CODICONTRATO AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND CZ.ID_ZAFRA = @ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContrato" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContrato" GeneratorSourceName="FillPorContrato" GetMethodModifier="Public" GetMethodName="GetPorContrato" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContrato" UserSourceName="FillPorContrato">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT	ANIOZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
		NOMBRE_PROVEEDOR, CODICONTRATO, 
		'' AS CODILOTE, '' AS NOMBLOTE, 
		ISNULL(dbo.fDividir(SUM(LBS_CONTRATADO),SUM(TC_CONTRATADO)),0) AS REND_CONTRATADO, ISNULL(SUM(MZ_CONTRATADO),0) AS MZ_CONTRATADO, 
		dbo.fDividir(SUM(TC_CONTRATADO),SUM(MZ_CONTRATADO)) AS TC_MZ_CONTRATADO, ISNULL(SUM(TC_CONTRATADO),0) AS TC_CONTRATADO, 
		ISNULL(SUM(LBS_CONTRATADO),0) AS LBS_CONTRATADO, ISNULL(SUM(VALOR_CONTRATADO),0) AS VALOR_CONTRATADO,
		COUNT(CODILOTE) AS CANT_LOTES, DESCRIP_ZONA, 0 AS CANT_CONTRATOS, SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO
FROM(
	SELECT (SELECT Z.NOMBRE_ZAFRA  FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, ISNULL(L.TONEL_TC,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO,
	N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   	 
	FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.CODICONTRATO = CZ.CODICONTRATO
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND L.ACCESLOTE = LC.ACCESLOTE	
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA
		AND CZ.ID_ZAFRA = Z.ID_ZAFRA
		AND CZ.ID_ZAFRA = @ID_ZAFRA
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
    AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY ANIOZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODICONTRATO, DESCRIP_ZONA, 
SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, ISNULL(L.TONEL_TC,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = CZ.CODICONTRATO AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND CZ.ID_ZAFRA = @ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, ISNULL(LC.TONEL_CENSO,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA AND LC.ID_ZAFRA = Z.ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoEsticana" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoEsticana" GeneratorSourceName="FillPorContratoEsticana" GetMethodModifier="Public" GetMethodName="GetPorContratoEsticana" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoEsticana" UserSourceName="FillPorContratoEsticana">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT	ANIOZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
		NOMBRE_PROVEEDOR, CODICONTRATO, 
		'' AS CODILOTE, '' AS NOMBLOTE, 
		ISNULL(dbo.fDividir(SUM(LBS_CONTRATADO),SUM(TC_CONTRATADO)),0) AS REND_CONTRATADO, ISNULL(SUM(MZ_CONTRATADO),0) AS MZ_CONTRATADO, 
		dbo.fDividir(SUM(TC_CONTRATADO),SUM(MZ_CONTRATADO)) AS TC_MZ_CONTRATADO, ISNULL(SUM(TC_CONTRATADO),0) AS TC_CONTRATADO, 
		ISNULL(SUM(LBS_CONTRATADO),0) AS LBS_CONTRATADO, ISNULL(SUM(VALOR_CONTRATADO),0) AS VALOR_CONTRATADO,
		COUNT(CODILOTE) AS CANT_LOTES, DESCRIP_ZONA, 0 AS CANT_CONTRATOS, SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO
FROM(
	SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, ISNULL(LC.TONEL_CENSO,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO,
	N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   	 
	FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR	
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND L.ACCESLOTE = LC.ACCESLOTE			
		AND LC.ID_ZAFRA = @ID_ZAFRA
		AND LC.ID_ZAFRA = Z.ID_ZAFRA
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
    AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY ANIOZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODICONTRATO, DESCRIP_ZONA, 
SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, ISNULL(LC.TONEL_CENSO,0) AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*LC.TONEL_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA AND LC.ID_ZAFRA = Z.ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = CZ.CODICONTRATO AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND CZ.ID_ZAFRA = @ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZona" GeneratorSourceName="FillPorZona" GetMethodModifier="Public" GetMethodName="GetPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZona" UserSourceName="FillPorZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT	ANIOZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
		'' AS NOMBRE_PROVEEDOR, CODICONTRATO, 
		'' AS CODILOTE, '' AS NOMBLOTE, 
		ISNULL(dbo.fDividir(SUM(LBS_CONTRATADO),SUM(TC_CONTRATADO)),0) AS REND_CONTRATADO, ISNULL(SUM(MZ_CONTRATADO),0) AS MZ_CONTRATADO, 
		dbo.fDividir(SUM(TC_CONTRATADO),SUM(MZ_CONTRATADO)) AS TC_MZ_CONTRATADO, ISNULL(SUM(TC_CONTRATADO),0) AS TC_CONTRATADO, 
		ISNULL(SUM(LBS_CONTRATADO),0) AS LBS_CONTRATADO, ISNULL(SUM(VALOR_CONTRATADO),0) AS VALOR_CONTRATADO,
		COUNT(CODILOTE) AS CANT_LOTES, DESCRIP_ZONA, COUNT( DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
		SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO   	
FROM(
	SELECT (SELECT Z.NOMBRE_ZAFRA  FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO,
	N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   	 
	FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.CODICONTRATO = CZ.CODICONTRATO
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND L.ACCESLOTE = LC.ACCESLOTE	
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA
		AND CZ.ID_ZAFRA = Z.ID_ZAFRA
		AND CZ.ID_ZAFRA = @ID_ZAFRA	
	AND (L.ZONA = @ZONA OR @ZONA = '')	
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY ANIOZAFRA, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC,0) AS LBS_CONTRATADO, ISNULL(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = CZ.CODICONTRATO AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND CZ.ID_ZAFRA = @ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, LC.TONEL_CENSO AS TC_CONTRATADO, ISNULL(LC.LBS_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.LBS_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA AND LC.ID_ZAFRA = Z.ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaEsticana" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaEsticana" GeneratorSourceName="FillPorZonaEsticana" GetMethodModifier="Public" GetMethodName="GetPorZonaEsticana" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaEsticana" UserSourceName="FillPorZonaEsticana">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT	ANIOZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
		'' AS NOMBRE_PROVEEDOR, CODICONTRATO, 
		'' AS CODILOTE, '' AS NOMBLOTE, 
		ISNULL(dbo.fDividir(SUM(LBS_CONTRATADO),SUM(TC_CONTRATADO)),0) AS REND_CONTRATADO, ISNULL(SUM(MZ_CONTRATADO),0) AS MZ_CONTRATADO, 
		dbo.fDividir(SUM(TC_CONTRATADO),SUM(MZ_CONTRATADO)) AS TC_MZ_CONTRATADO, ISNULL(SUM(TC_CONTRATADO),0) AS TC_CONTRATADO, 
		ISNULL(SUM(LBS_CONTRATADO),0) AS LBS_CONTRATADO, ISNULL(SUM(VALOR_CONTRATADO),0) AS VALOR_CONTRATADO,
		COUNT(CODILOTE) AS CANT_LOTES, DESCRIP_ZONA, COUNT( DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
		SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO   	
FROM(
	SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, LC.TONEL_CENSO AS TC_CONTRATADO, ISNULL(LC.LBS_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.LBS_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO,
	N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   	 
	FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR	
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND L.ACCESLOTE = LC.ACCESLOTE			
		AND LC.ID_ZAFRA = @ID_ZAFRA	
		AND LC.ID_ZAFRA = Z.ID_ZAFRA
	AND (L.ZONA = @ZONA OR @ZONA = '')	
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY ANIOZAFRA, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA AS ANIOZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, LC.MZ_CENSO AS MZ_CONTRATADO, LC.TONEL_MZ_CENSO AS TC_MZ_CONTRATADO, LC.TONEL_CENSO AS TC_CONTRATADO, ISNULL(LC.LBS_CENSO,0) AS LBS_CONTRATADO, ISNULL(LC.LBS_CENSO*Z.PRECIO_LIBRA_AZUCAR,0) AS VALOR_CONTRATADO, N.DESCRIP_ZONA, L.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA AND LC.ID_ZAFRA = Z.ID_ZAFRA AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CENSO_XTableAdapter" GeneratorDataComponentClassName="CENSO_XTableAdapter" Name="CENSO_X" UserDataComponentName="CENSO_XTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	'' AS OBSERVACION, 0 AS MZ_ZAFRA_COMPA, 0 AS TC_MZ_ZAFRA_COMPA, 0 AS TC_ZAFRA_COMPA,
	'' AS VARIEDAD, '' AS TIPO, GETDATE() AS FECHA_COSECHA, 100 AS SEMANA, 100 AS CATORCENA, 100 AS TERCIO, '' AS SUB_TIPO_CANA, '' AS SUB_TERCIO    
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND L.CODIPROVEEDOR = '-'</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="REND_CONTRATADO" DataSetColumn="REND_CONTRATADO" />
              <Mapping SourceColumn="MZ_CONTRATADO" DataSetColumn="MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_MZ_CONTRATADO" DataSetColumn="TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_CONTRATADO" DataSetColumn="TC_CONTRATADO" />
              <Mapping SourceColumn="LBS_CONTRATADO" DataSetColumn="LBS_CONTRATADO" />
              <Mapping SourceColumn="VALOR_CONTRATADO" DataSetColumn="VALOR_CONTRATADO" />
              <Mapping SourceColumn="MZ_ENTREGAR" DataSetColumn="MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGAR" DataSetColumn="TONEL_MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="LBS_ENTREGAR" DataSetColumn="LBS_ENTREGAR" />
              <Mapping SourceColumn="VALOR_ENTREGAR" DataSetColumn="VALOR_ENTREGAR" />
              <Mapping SourceColumn="MZ_ENTREGADA" DataSetColumn="MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGADA" DataSetColumn="TONEL_MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="LBS_ENTREGADA" DataSetColumn="LBS_ENTREGADA" />
              <Mapping SourceColumn="VALOR_ENTREGADA" DataSetColumn="VALOR_ENTREGADA" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="LBS_CENSO" DataSetColumn="LBS_CENSO" />
              <Mapping SourceColumn="VALOR_CENSO" DataSetColumn="VALOR_CENSO" />
              <Mapping SourceColumn="REND_HISTO" DataSetColumn="REND_HISTO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="CANT_LOTES" DataSetColumn="CANT_LOTES" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="FECHA_VERIFICACION" DataSetColumn="FECHA_VERIFICACION" />
              <Mapping SourceColumn="MZ_VAR" DataSetColumn="MZ_VAR" />
              <Mapping SourceColumn="TC_MZ_VAR" DataSetColumn="TC_MZ_VAR" />
              <Mapping SourceColumn="TC_VAR" DataSetColumn="TC_VAR" />
              <Mapping SourceColumn="LBS_VAR" DataSetColumn="LBS_VAR" />
              <Mapping SourceColumn="TOTAL_VAR" DataSetColumn="TOTAL_VAR" />
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="CANT_CONTRATOS" DataSetColumn="CANT_CONTRATOS" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="OBSERVACION" DataSetColumn="OBSERVACION" />
              <Mapping SourceColumn="MZ_ZAFRA_COMPA" DataSetColumn="MZ_ZAFRA_COMPA1" />
              <Mapping SourceColumn="TC_MZ_ZAFRA_COMPA" DataSetColumn="TC_MZ_ZAFRA_COMPA1" />
              <Mapping SourceColumn="TC_ZAFRA_COMPA" DataSetColumn="TC_ZAFRA_COMPA1" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="FECHA_COSECHA" DataSetColumn="FECHA_COSECHA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="SUB_TIPO_CANA" DataSetColumn="SUB_TIPO_CANA" />
              <Mapping SourceColumn="SUB_TERCIO" DataSetColumn="SUB_TERCIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	'' AS OBSERVACION, 0 AS MZ_ZAFRA_COMPA, 0 AS TC_MZ_ZAFRA_COMPA, 0 AS TC_ZAFRA_COMPA   
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillLoteCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetLoteCierreZafraSdoEnt" GeneratorSourceName="FillLoteCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetLoteCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetLoteCierreZafraSdoEnt" UserSourceName="FillLoteCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	
	(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
	CASE 
	WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, 
	(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
	(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
	(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,		
	L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
	C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,	
	(C.MZ_CENSO - L.MZ_ENTREGADA) AS MZ_VAR, (C.TONEL_MZ_CENSO - L.TONEL_MZ_ENTREGADA) AS TC_MZ_VAR,
	(C.TONEL_CENSO - L.TONEL_ENTREGADA) AS TC_VAR, (C.LBS_CENSO - L.LBS_ENTREGADA) AS LBS_VAR,
	(C.VALOR_CENSO - L.VALOR_ENTREGADA) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContrato" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContrato" GeneratorSourceName="FillPorContrato" GetMethodModifier="Public" GetMethodName="GetPorContrato" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContrato" UserSourceName="FillPorContrato">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO   
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoCierreZafra" GeneratorSourceName="FillPorContratoCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorContratoCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoCierreZafra" UserSourceName="FillPorContratoCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	
	(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
	CASE 
	WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, 
	(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
	(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
	(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,
	L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (C.MZ_CENSO - L.MZ_ENTREGADA) AS MZ_VAR, (C.TONEL_MZ_CENSO - L.TONEL_MZ_ENTREGADA) AS TC_MZ_VAR, (C.TONEL_CENSO - L.TONEL_ENTREGADA) AS TC_VAR, (C.LBS_CENSO - L.LBS_ENTREGADA) AS LBS_VAR, (C.VALOR_CENSO - L.VALOR_ENTREGADA) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoCierreZafraSdoEnt" GeneratorSourceName="FillPorContratoCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetPorContratoCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoCierreZafraSdoEnt" UserSourceName="FillPorContratoCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO   
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	
	(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
	CASE 
	WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, 
	(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
	(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
	(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,
	L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(C.MZ_CENSO - L.MZ_ENTREGADA) AS MZ_VAR, (C.TONEL_MZ_CENSO - L.TONEL_MZ_ENTREGADA) AS TC_MZ_VAR,
	(C.TONEL_CENSO - L.TONEL_ENTREGADA) AS TC_VAR, (C.LBS_CENSO - L.LBS_ENTREGADA) AS LBS_VAR,
	(C.VALOR_CENSO - L.VALOR_ENTREGADA) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (C.MZ_CENSO - L.MZ_ENTREGADA) AS MZ_VAR, (C.TONEL_MZ_CENSO - L.TONEL_MZ_ENTREGADA) AS TC_MZ_VAR, (C.TONEL_CENSO - L.TONEL_ENTREGADA) AS TC_VAR, (C.LBS_CENSO - L.LBS_ENTREGADA) AS LBS_VAR, (C.VALOR_CENSO - L.VALOR_ENTREGADA) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCierreZafra" GeneratorSourceName="FillPorLoteCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorLoteCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCierreZafra" UserSourceName="FillPorLoteCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	
	(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
	CASE 
	WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, 
	(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
	(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
	(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,
		
	L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
	C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,	
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO  
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaFueraRango" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaFueraRango" GeneratorSourceName="FillPorLoteCompaFueraRango" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaFueraRango" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaFueraRango" UserSourceName="FillPorLoteCompaFueraRango">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A,
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(L.REND_CONTRATADO,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA,
		(L.TONEL_TC + (L.TONEL_TC * 0.2)) AS LIMITE_SUP, (L.TONEL_TC - (L.TONEL_TC * 0.2)) AS LIMITE_INF
		FROM LOTES L, CONTRATO T
		WHERE L.CODICONTRATO = T.CODICONTRATO		
		AND EXISTS(SELECT 1 FROM CONTRATO_ZAFRAS CZ WHERE CZ.CODICONTRATO = T.CODICONTRATO AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA)				
	) C, 
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 	
		(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
		CASE 
		WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
		ELSE 0
		END AS TONEL_MZ_ENTREGAR, 
		(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
		(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
		(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,		
		L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
		(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_CENSO = @ID_CENSO	
	) B 
WHERE A.ID_MAESTRO = C.ID_MAESTRO 
	AND A.ID_MAESTRO = B.ID_MAESTRO
	AND NOT (B.TONEL_ENTREGADA &lt;= C.LIMITE_SUP AND B.TONEL_ENTREGADA &gt;= C.LIMITE_INF)
	AND(A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaZafra" GeneratorSourceName="FillPorLoteCompaZafra" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaZafra" UserSourceName="FillPorLoteCompaZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA 
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 	
		(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
		CASE 
		WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
		ELSE 0
		END AS TONEL_MZ_ENTREGAR, 
		(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
		(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
		(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,		
		L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
		(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_CENSO = @ID_CENSO	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(L.REND_CONTRATADO,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA
		FROM LOTES L, CONTRATO T
		WHERE L.CODICONTRATO = T.CODICONTRATO		
		AND EXISTS(SELECT 1 FROM CONTRATO_ZAFRAS CZ WHERE CZ.CODICONTRATO = T.CODICONTRATO AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA)				
	) C ON A.ID_MAESTRO = C.ID_MAESTRO
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaZafraEnRango" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaZafraEnRango" GeneratorSourceName="FillPorLoteCompaZafraEnRango" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaZafraEnRango" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaZafraEnRango" UserSourceName="FillPorLoteCompaZafraEnRango">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A,
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(L.REND_CONTRATADO,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA,
		(L.TONEL_TC + (L.TONEL_TC * 0.2)) AS LIMITE_SUP, (L.TONEL_TC - (L.TONEL_TC * 0.2)) AS LIMITE_INF
		FROM LOTES L, CONTRATO T
		WHERE L.CODICONTRATO = T.CODICONTRATO		
		AND EXISTS(SELECT 1 FROM CONTRATO_ZAFRAS CZ WHERE CZ.CODICONTRATO = T.CODICONTRATO AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA)				
	) C, 
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 	
		(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
		CASE 
		WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
		ELSE 0
		END AS TONEL_MZ_ENTREGAR, 
		(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
		(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
		(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,		
		L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
		(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_CENSO = @ID_CENSO	
	) B 
WHERE A.ID_MAESTRO = C.ID_MAESTRO 
	AND A.ID_MAESTRO = B.ID_MAESTRO
	AND (B.TONEL_ENTREGADA &lt;= C.LIMITE_SUP AND B.TONEL_ENTREGADA &gt;= C.LIMITE_INF)
	AND(A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteEstimacion" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteEstimacion" GeneratorSourceName="FillPorLoteEstimacion" GetMethodModifier="Public" GetMethodName="GetPorLoteEstimacion" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteEstimacion" UserSourceName="FillPorLoteEstimacion">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
		(LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
		LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR,			
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR,
		((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z
		WHERE L.CODICONTRATO = CZ.CODICONTRATO		
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA 		
		AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
		AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
		(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
		((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR,
		(SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA,
		(SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA,
		(CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA,
		(CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE,
		(CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE,
		(CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA
		FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND C.ID_ZAFRA = Z.ID_ZAFRA 
		AND S.ID_CENSO = @ID_CENSO	
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaFabricaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaFabricaPorFecha" GeneratorSourceName="FillPorPlanCosechaFabricaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaFabricaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaFabricaPorFecha" UserSourceName="FillPorPlanCosechaFabricaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))
	AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) 
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaFabricaPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaFabricaPorLote" GeneratorSourceName="FillPorPlanCosechaFabricaPorLote" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaFabricaPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaFabricaPorLote" UserSourceName="FillPorPlanCosechaFabricaPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO, A.CODICANTON
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO,
		(ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorCanton" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorCanton" GeneratorSourceName="FillPorPlanCosechaPorCanton" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorCanton" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorCanton" UserSourceName="FillPorPlanCosechaPorCanton">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorFecha" GeneratorSourceName="FillPorPlanCosechaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorFecha" UserSourceName="FillPorPlanCosechaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))
	AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) 
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorLote" GeneratorSourceName="FillPorPlanCosechaPorLote" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorLote" UserSourceName="FillPorPlanCosechaPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorSubZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorSubZona" GeneratorSourceName="FillPorPlanCosechaPorSubZona" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorSubZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorSubZona" UserSourceName="FillPorPlanCosechaPorSubZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, SUB_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, SUB_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorZona" GeneratorSourceName="FillPorPlanCosechaPorZona" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorZona" UserSourceName="FillPorPlanCosechaPorZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND S.ID_ZAFRA = @ID_ZAFRA_COMPA	
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = S.ID_ZAFRA 
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = @ID_ZAFRA_COMPA AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZona" GeneratorSourceName="FillPorZona" GetMethodModifier="Public" GetMethodName="GetPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZona" UserSourceName="FillPorZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY NOMBRE_ZAFRA, FECHA_VERIFICACION, DESCRIP_ZONA, CODICONTRATO, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCierreZafra" GeneratorSourceName="FillPorZonaCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorZonaCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCierreZafra" UserSourceName="FillPorZonaCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(LBS_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_VAR) &gt; 0 THEN ABS(SUM(TC_VAR)/SUM(MZ_VAR))
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	
	(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, 
	CASE 
	WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA))
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, 
	(C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, 
	(C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, 
	(C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR,
	L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY  NOMBRE_ZAFRA, FECHA_VERIFICACION, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) AS MZ_ENTREGAR, CASE WHEN (C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) &gt; 0 THEN (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA))/(C.MZ_ENTREGAR - (L.MZ_ENTREGADA - C.MZ_ENTREGADA)) ELSE 0 END AS TONEL_MZ_ENTREGAR, (C.TONEL_ENTREGAR - (L.TONEL_ENTREGADA - C.TONEL_ENTREGADA)) AS TONEL_ENTREGAR, (C.LBS_ENTREGAR - (L.LBS_ENTREGADA - C.LBS_ENTREGADA)) AS LBS_ENTREGAR, (C.VALOR_ENTREGAR - (L.VALOR_ENTREGADA - C.VALOR_ENTREGADA))AS VALOR_ENTREGAR, L.MZ_ENTREGADA, L.TONEL_MZ_ENTREGADA, L.TONEL_ENTREGADA, L.LBS_ENTREGADA, L.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCierreZafraSdoEnt" GeneratorSourceName="FillPorZonaCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetPorZonaCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCierreZafraSdoEnt" UserSourceName="FillPorZonaCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR,
	(L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY NOMBRE_ZAFRA, FECHA_VERIFICACION, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, L.REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, L.LBS_CONTRATADO, L.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, (L.LBS_CONTRATADO - C.LBS_CENSO) AS LBS_VAR, (L.VALOR_CONTRATADO - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CENSO_RESUMENTableAdapter" GeneratorDataComponentClassName="CENSO_RESUMENTableAdapter" Name="CENSO_RESUMEN" UserDataComponentName="CENSO_RESUMENTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
SUM(C.MZ_CENSO) AS MZ_CENSO, 
CASE 
WHEN SUM(C.MZ_CENSO) &gt; 0 THEN ROUND(SUM(C.TONEL_CENSO)/SUM(C.MZ_CENSO),2)
ELSE 0
END AS TONEL_MZ_CENSO, SUM(C.TONEL_CENSO) AS TONEL_CENSO, SUM(C.LBS_CENSO) AS LBS_CENSO, SUM(C.VALOR_CENSO) AS VALOR_CENSO, 	
SUM(C.MZ_ENTREGAR) AS MZ_ENTREGAR, 
CASE 
WHEN SUM(C.MZ_ENTREGAR) &gt; 0 THEN ROUND(SUM(C.TONEL_ENTREGAR)/SUM(C.MZ_ENTREGAR),2)
ELSE 0
END AS TONEL_MZ_ENTREGAR, SUM(C.TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(C.LBS_ENTREGAR) AS LBS_ENTREGAR, SUM(C.VALOR_ENTREGAR) AS VALOR_ENTREGAR,
SUM(C.MZ_ENTREGADA) AS MZ_ENTREGADA, 
CASE 
WHEN SUM(C.MZ_ENTREGADA) &gt; 0 THEN ROUND(SUM(C.TONEL_ENTREGADA)/SUM(C.MZ_ENTREGADA),2)
ELSE 0
END AS TONEL_MZ_ENTREGADA, SUM(C.TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(C.LBS_ENTREGADA) AS LBS_ENTREGADA, SUM(C.VALOR_ENTREGADA) AS VALOR_ENTREGADA
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="LBS_CENSO" DataSetColumn="LBS_CENSO" />
              <Mapping SourceColumn="VALOR_CENSO" DataSetColumn="VALOR_CENSO" />
              <Mapping SourceColumn="MZ_ENTREGAR" DataSetColumn="MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGAR" DataSetColumn="TONEL_MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="LBS_ENTREGAR" DataSetColumn="LBS_ENTREGAR" />
              <Mapping SourceColumn="VALOR_ENTREGAR" DataSetColumn="VALOR_ENTREGAR" />
              <Mapping SourceColumn="MZ_ENTREGADA" DataSetColumn="MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGADA" DataSetColumn="TONEL_MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="LBS_ENTREGADA" DataSetColumn="LBS_ENTREGADA" />
              <Mapping SourceColumn="VALOR_ENTREGADA" DataSetColumn="VALOR_ENTREGADA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCierreZafra" GeneratorSourceName="FillPorCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCierreZafra" UserSourceName="FillPorCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
SUM(C.MZ_CENSO) AS MZ_CENSO, 
CASE 
WHEN SUM(C.MZ_CENSO) &gt; 0 THEN ROUND(SUM(C.TONEL_CENSO)/SUM(C.MZ_CENSO),2)
ELSE 0
END AS TONEL_MZ_CENSO, SUM(C.TONEL_CENSO) AS TONEL_CENSO, SUM(C.LBS_CENSO) AS LBS_CENSO, SUM(C.VALOR_CENSO) AS VALOR_CENSO, 
SUM(C.MZ_ENTREGAR) AS MZ_ENTREGAR, 
CASE 
WHEN SUM(C.MZ_ENTREGAR) &gt; 0 THEN ROUND(SUM(C.TONEL_ENTREGAR)/SUM(C.MZ_ENTREGAR),2)
ELSE 0
END AS TONEL_MZ_ENTREGAR, SUM(C.TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(C.LBS_ENTREGAR) AS LBS_ENTREGAR, 
SUM(C.VALOR_ENTREGAR) AS VALOR_ENTREGAR,
SUM(C.MZ_ENTREGADA) AS MZ_ENTREGADA, 
CASE 
WHEN SUM(C.MZ_ENTREGADA) &gt; 0 THEN ROUND(SUM(C.TONEL_ENTREGADA)/SUM(C.MZ_ENTREGADA),2)
ELSE 0
END AS TONEL_MZ_ENTREGADA, SUM(C.TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(C.LBS_ENTREGADA) AS LBS_ENTREGADA, SUM(C.VALOR_ENTREGADA) AS VALOR_ENTREGADA
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_RESUMENTableAdapter" GeneratorDataComponentClassName="CONTRATO_RESUMENTableAdapter" Name="CONTRATO_RESUMEN" UserDataComponentName="CONTRATO_RESUMENTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT (SELECT Z.NOMBRE_ZAFRA  FROM ZAFRA Z WHERE Z.ID_ZAFRA = CZ.ID_ZAFRA) AS ANIOZAFRA, 
	CASE 
	WHEN SUM(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR) &gt; 0 THEN ROUND(SUM(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR)/SUM(L.TONEL_TC),4)
	ELSE 0
	END AS REND_CONTRATADO, 
    SUM(L.AREA) AS MZ_CONTRATADO, 
    CASE 
	WHEN SUM(L.AREA) &gt; 0 THEN ROUND(SUM(L.TONEL_TC)/SUM(L.AREA),2)
	ELSE NULL
	END AS TC_MZ_CONTRATADO,      
    ISNULL(SUM(L.TONEL_TC),0) AS TC_CONTRATADO, 
    ISNULL(SUM(LC.REND_COSECHA*L.TONEL_TC),0) AS LBS_CONTRATADO, 
    ISNULL(SUM(LC.REND_COSECHA*L.TONEL_TC*Z.PRECIO_LIBRA_AZUCAR),0) AS VALOR_CONTRATADO,
	COUNT(L.ACCESLOTE) AS CANT_LOTES, COUNT(DISTINCT L.CODICONTRATO) AS CANT_CONTRATOS 	
FROM LOTES L, PROVEEDOR P, CONTRATO_ZAFRAS CZ, ZONAS N, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, LOTES_COSECHA LC, ZAFRA Z
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODICONTRATO = CZ.CODICONTRATO
AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND L.ACCESLOTE = LC.ACCESLOTE	
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA
		AND CZ.ID_ZAFRA = Z.ID_ZAFRA
		AND CZ.ID_ZAFRA = @ID_ZAFRA
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (P.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
AND (P.CODISOCIO  = @CODISOCIO OR @CODISOCIO = '')
GROUP BY CZ.ID_ZAFRA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA.dbo.CONTRATO_ZAFRAS" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="INJIBOA.dbo.PROVEEDOR" DataTypeServer="char(6)" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="Char" Scale="0" Size="6" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="INJIBOA.dbo.PROVEEDOR" DataTypeServer="char(4)" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="Char" Scale="0" Size="4" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ANIOZAFRA" DataSetColumn="ANIOZAFRA" />
              <Mapping SourceColumn="REND_CONTRATADO" DataSetColumn="REND_CONTRATADO" />
              <Mapping SourceColumn="MZ_CONTRATADO" DataSetColumn="MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_MZ_CONTRATADO" DataSetColumn="TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_CONTRATADO" DataSetColumn="TC_CONTRATADO" />
              <Mapping SourceColumn="LBS_CONTRATADO" DataSetColumn="LBS_CONTRATADO" />
              <Mapping SourceColumn="VALOR_CONTRATADO" DataSetColumn="VALOR_CONTRATADO" />
              <Mapping SourceColumn="CANT_LOTES" DataSetColumn="CANT_LOTES" />
              <Mapping SourceColumn="CANT_CONTRATOS" DataSetColumn="CANT_CONTRATOS" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="MAESTRO_LOTESTableAdapter" GeneratorDataComponentClassName="MAESTRO_LOTESTableAdapter" Name="MAESTRO_LOTES" UserDataComponentName="MAESTRO_LOTESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ML.ZONA, ML.SUB_ZONA, ML.CUI, D.NOMBRE_DEPTO, M.NOMBRE_MUNI,
C.NOMBRE_CANTON, CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE, 
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, 
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS PROVEEDOR,
ML.CODICONTRATO, ML.NOMBRE_COMER, ML.CODILOTE_COMER
FROM MAESTRO_LOTES ML, PROVEEDOR P, DEPARTAMENTO D, MUNICIPIO M, CANTON C
WHERE ML.CODIPROVEEDOR = P.CODIPROVEEDOR
AND ML.CODI_DEPTO = D.CODI_DEPTO
AND ML.CODI_DEPTO = M.CODI_DEPTO
AND ML.CODI_MUNI = M.CODI_MUNI
AND ML.CODI_DEPTO = C.CODI_DEPTO
AND ML.CODI_MUNI = C.CODI_MUNI
AND ML.CODI_CANTON = C.CODI_CANTON</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NOMBRE_COMER" DataSetColumn="NOMBRE_COMER" />
              <Mapping SourceColumn="CODILOTE_COMER" DataSetColumn="CODILOTE_COMER" />
              <Mapping SourceColumn="CUI" DataSetColumn="CUI" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ML.ZONA, ML.SUB_ZONA, ML.CUI, D.NOMBRE_DEPTO, M.NOMBRE_MUNI,
C.NOMBRE_CANTON, CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE, 
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, 
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS PROVEEDOR,
ML.CODICONTRATO, ML.NOMBRE_COMER, ML.CODILOTE_COMER
FROM MAESTRO_LOTES ML, PROVEEDOR P, DEPARTAMENTO D, MUNICIPIO M, CANTON C
WHERE ML.CODIPROVEEDOR = P.CODIPROVEEDOR
AND ML.CODI_DEPTO = D.CODI_DEPTO
AND ML.CODI_DEPTO = M.CODI_DEPTO
AND ML.CODI_MUNI = M.CODI_MUNI
AND ML.CODI_DEPTO = C.CODI_DEPTO
AND ML.CODI_MUNI = C.CODI_MUNI
AND ML.CODI_CANTON = C.CODI_CANTON
AND (ML.ZONA = @ZONA OR @ZONA = '')
AND (ML.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND (D.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '')
AND (M.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')
AND (C.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
AND (dbo.QuitarFormatoCODICONTRATO(ML.CODICONTRATO) = @CODICONTRATO OR @CODICONTRATO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.DEPARTAMENTO" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MUNICIPIO" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.CANTON" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODICONTRATO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODICONTRATO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ORDEN_ANALISIS_PRECOSECHATableAdapter" GeneratorDataComponentClassName="ORDEN_ANALISIS_PRECOSECHATableAdapter" Name="ORDEN_ANALISIS_PRECOSECHA" UserDataComponentName="ORDEN_ANALISIS_PRECOSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     A.ID_ANALISIS_PRE, A.NO_ANALISIS, A.FECHA_MUESTRA, A.NO_MUESTRA, A.AREA_MUESTRA, dbo.USUARIO.NOMBRE AS NOMBRE_USUARIO, L.CODILOTE, L.NOMBLOTE, 
	dbo.VARIEDAD.NOM_VARIEDAD, 
	L.EDAD_LOTE, 
	P.CODIPROVEE AS CODIPROVEE_CONTRATO,
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN PL.CODIPROVEE
	ELSE ''
	END AS CODIPROVEE_LOTE,	
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN PL.CODISOCIO
	ELSE ''
	END AS CODISOCIO_LOTE,		
	RTRIM(ISNULL(P.NOMBRES, '')) + ' ' + RTRIM(ISNULL(P.APELLIDOS, '')) AS NOMBRE_PROVEEDOR_CONTRATO, 
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN RTRIM(ISNULL(PL.NOMBRES, '')) + ' ' + RTRIM(ISNULL(PL.APELLIDOS, ''))
	ELSE ''
	END AS NOMBRE_PROVEEDOR_LOTE,
	L.ZONA, L.SUB_ZONA, DE.NOMBRE_DEPTO, MU.NOMBRE_MUNI, CA.NOMBRE_CANTON
FROM  dbo.ANALISIS_PRECOSECHA AS A INNER JOIN
dbo.LOTES AS L ON A.ACCESLOTE = L.ACCESLOTE INNER JOIN
dbo.CONTRATO AS C ON L.CODICONTRATO = C.CODICONTRATO INNER JOIN
dbo.PROVEEDOR AS P ON C.CODIPROVEEDOR = P.CODIPROVEEDOR INNER JOIN
dbo.USUARIO ON A.USUARIO_CREA = dbo.USUARIO.USUARIO INNER JOIN
dbo.VARIEDAD ON L.CODIVARIEDA = dbo.VARIEDAD.CODIVARIEDA INNER JOIN
dbo.PROVEEDOR AS PL ON L.CODIPROVEEDOR = PL.CODIPROVEEDOR INNER JOIN
dbo.MAESTRO_LOTES ML ON L.ID_MAESTRO = ML.ID_MAESTRO INNER JOIN 
dbo.CANTON CA ON ML.CODI_DEPTO = CA.CODI_DEPTO AND ML.CODI_MUNI = CA.CODI_MUNI AND ML.CODI_CANTON = CA.CODI_CANTON INNER JOIN 
dbo.MUNICIPIO MU ON MU.CODI_DEPTO = CA.CODI_DEPTO AND MU.CODI_MUNI = CA.CODI_MUNI INNER JOIN
dbo.DEPARTAMENTO DE ON DE.CODI_DEPTO = MU.CODI_DEPTO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_ANALISIS_PRE" DataSetColumn="ID_ANALISIS_PRE" />
              <Mapping SourceColumn="NO_ANALISIS" DataSetColumn="NO_ANALISIS" />
              <Mapping SourceColumn="FECHA_MUESTRA" DataSetColumn="FECHA_MUESTRA" />
              <Mapping SourceColumn="NO_MUESTRA" DataSetColumn="NO_MUESTRA" />
              <Mapping SourceColumn="AREA_MUESTRA" DataSetColumn="AREA_MUESTRA" />
              <Mapping SourceColumn="NOMBRE_USUARIO" DataSetColumn="NOMBRE_USUARIO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="CODIPROVEE_CONTRATO" DataSetColumn="CODIPROVEE_CONTRATO" />
              <Mapping SourceColumn="CODIPROVEE_LOTE" DataSetColumn="CODIPROVEE_LOTE" />
              <Mapping SourceColumn="CODISOCIO_LOTE" DataSetColumn="CODISOCIO_LOTE" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR_CONTRATO" DataSetColumn="NOMBRE_PROVEEDOR_CONTRATO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR_LOTE" DataSetColumn="NOMBRE_PROVEEDOR_LOTE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorID_ORDEN" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorID_ORDEN" GeneratorSourceName="FillPorID_ORDEN" GetMethodModifier="Public" GetMethodName="GetPorID_ORDEN" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorID_ORDEN" UserSourceName="FillPorID_ORDEN">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     A.ID_ANALISIS_PRE, A.NO_ANALISIS, A.FECHA_MUESTRA, A.NO_MUESTRA, A.AREA_MUESTRA, dbo.USUARIO.NOMBRE AS NOMBRE_USUARIO, L.CODILOTE, L.NOMBLOTE, 
	dbo.VARIEDAD.NOM_VARIEDAD, 
	L.EDAD_LOTE, 
	P.CODIPROVEE AS CODIPROVEE_CONTRATO,
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN PL.CODIPROVEE
	ELSE ''
	END AS CODIPROVEE_LOTE,	
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN PL.CODISOCIO
	ELSE ''
	END AS CODISOCIO_LOTE,		
	RTRIM(ISNULL(P.NOMBRES, '')) + ' ' + RTRIM(ISNULL(P.APELLIDOS, '')) AS NOMBRE_PROVEEDOR_CONTRATO, 
	CASE 
	WHEN L.CODIPROVEEDOR &lt;&gt; C.CODIPROVEEDOR THEN RTRIM(ISNULL(PL.NOMBRES, '')) + ' ' + RTRIM(ISNULL(PL.APELLIDOS, ''))
	ELSE ''
	END AS NOMBRE_PROVEEDOR_LOTE,
	L.ZONA, L.SUB_ZONA, DE.NOMBRE_DEPTO, MU.NOMBRE_MUNI, CA.NOMBRE_CANTON
FROM  dbo.ANALISIS_PRECOSECHA AS A INNER JOIN
dbo.LOTES AS L ON A.ACCESLOTE = L.ACCESLOTE INNER JOIN
dbo.CONTRATO AS C ON L.CODICONTRATO = C.CODICONTRATO INNER JOIN
dbo.PROVEEDOR AS P ON C.CODIPROVEEDOR = P.CODIPROVEEDOR INNER JOIN
dbo.USUARIO ON A.USUARIO_CREA = dbo.USUARIO.USUARIO INNER JOIN
dbo.VARIEDAD ON L.CODIVARIEDA = dbo.VARIEDAD.CODIVARIEDA INNER JOIN
dbo.PROVEEDOR AS PL ON L.CODIPROVEEDOR = PL.CODIPROVEEDOR INNER JOIN
dbo.MAESTRO_LOTES ML ON L.ID_MAESTRO = ML.ID_MAESTRO INNER JOIN 
dbo.CANTON CA ON ML.CODI_DEPTO = CA.CODI_DEPTO AND ML.CODI_MUNI = CA.CODI_MUNI AND ML.CODI_CANTON = CA.CODI_CANTON INNER JOIN 
dbo.MUNICIPIO MU ON MU.CODI_DEPTO = CA.CODI_DEPTO AND MU.CODI_MUNI = CA.CODI_MUNI INNER JOIN
dbo.DEPARTAMENTO DE ON DE.CODI_DEPTO = MU.CODI_DEPTO
WHERE A.ID_ANALISIS_PRE = @ID_ANALISIS_PRE
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ANALISIS_PRE" ColumnName="ID_ANALISIS_PRE" DataSourceName="INJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ANALISIS_PRE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ANALISIS_PRE" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="REQUERIMIENTO_FABRICATableAdapter" GeneratorDataComponentClassName="REQUERIMIENTO_FABRICATableAdapter" Name="REQUERIMIENTO_FABRICA" UserDataComponentName="REQUERIMIENTO_FABRICATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT SUM(P.TC_DIA) AS TC_DIA
FROM CICLO C , CICLO_PERIODO P 
WHERE C.ID_CICLO = P.ID_CICLO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TC_DIA" DataSetColumn="TC_DIA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ISNULL(SUM(P.TC_DIA),0) AS TC_DIA
FROM CICLO C , CICLO_PERIODO P 
WHERE C.ID_CICLO = P.ID_CICLO
AND (C.ID_CICLO = @ID_CICLO)
AND (P.SEMANA = @SEMANA OR @SEMANA = -1)
AND (P.CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (P.SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (P.TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="ID_CICLO" DataSourceName="INJIBOA.dbo.CICLO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CICLO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="INJIBOA.dbo.CICLO_PERIODO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="INJIBOA.dbo.CICLO_PERIODO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="INJIBOA.dbo.CICLO_PERIODO" DataTypeServer="varchar(20)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="20" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="INJIBOA.dbo.CICLO_PERIODO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PLAN_CATTableAdapter" GeneratorDataComponentClassName="PLAN_CATTableAdapter" Name="PLAN_CAT" UserDataComponentName="PLAN_CATTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, ML.ID_TIPO_CANA, ML.ID_TIPO_ROZA, ML.ID_TIPO_ALZA, ML.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = -1 ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, ML.ID_TIPO_CANA, ML.ID_TIPO_ROZA, ML.ID_TIPO_ALZA, ML.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = ML.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = 2) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO  
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = -1
	) A
) B</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="FECHA_ROZA_SH" DataSetColumn="FECHA_ROZA_SH" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ID_TIPO_CANA" DataSetColumn="ID_TIPO_CANA" />
              <Mapping SourceColumn="ID_TIPO_ROZA" DataSetColumn="ID_TIPO_ROZA" />
              <Mapping SourceColumn="ID_TIPO_ALZA" DataSetColumn="ID_TIPO_ALZA" />
              <Mapping SourceColumn="ID_TIPO_TRANS" DataSetColumn="ID_TIPO_TRANS" />
              <Mapping SourceColumn="TIPO_ROZA" DataSetColumn="TIPO_ROZA" />
              <Mapping SourceColumn="TIPO_ALZA" DataSetColumn="TIPO_ALZA" />
              <Mapping SourceColumn="TIPO_TRANSPORTE" DataSetColumn="TIPO_TRANSPORTE" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="SUB_TERCIO" DataSetColumn="SUB_TERCIO" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="TIPO_CANA" DataSetColumn="TIPO_CANA" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonAlza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonAlza" GeneratorSourceName="FillPorCantonAlza" GetMethodModifier="Public" GetMethodName="GetPorCantonAlza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonAlza" UserSourceName="FillPorCantonAlza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonAlzaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonAlzaPorFecha" GeneratorSourceName="FillPorCantonAlzaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorCantonAlzaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonAlzaPorFecha" UserSourceName="FillPorCantonAlzaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2) 
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonRoza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonRoza" GeneratorSourceName="FillPorCantonRoza" GetMethodModifier="Public" GetMethodName="GetPorCantonRoza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonRoza" UserSourceName="FillPorCantonRoza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonRozaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonRozaPorFecha" GeneratorSourceName="FillPorCantonRozaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorCantonRozaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonRozaPorFecha" UserSourceName="FillPorCantonRozaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonTrans" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonTrans" GeneratorSourceName="FillPorCantonTrans" GetMethodModifier="Public" GetMethodName="GetPorCantonTrans" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonTrans" UserSourceName="FillPorCantonTrans">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCantonTransPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCantonTransPorFecha" GeneratorSourceName="FillPorCantonTransPorFecha" GetMethodModifier="Public" GetMethodName="GetPorCantonTransPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCantonTransPorFecha" UserSourceName="FillPorCantonTransPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLote" GeneratorSourceName="FillPorLote" GetMethodModifier="Public" GetMethodName="GetPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLote" UserSourceName="FillPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteFecha" GeneratorSourceName="FillPorLoteFecha" GetMethodModifier="Public" GetMethodName="GetPorLoteFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteFecha" UserSourceName="FillPorLoteFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2) </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaAlza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaAlza" GeneratorSourceName="FillPorSubZonaAlza" GetMethodModifier="Public" GetMethodName="GetPorSubZonaAlza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaAlza" UserSourceName="FillPorSubZonaAlza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaAlzaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaAlzaPorFecha" GeneratorSourceName="FillPorSubZonaAlzaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorSubZonaAlzaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaAlzaPorFecha" UserSourceName="FillPorSubZonaAlzaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaRoza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaRoza" GeneratorSourceName="FillPorSubZonaRoza" GetMethodModifier="Public" GetMethodName="GetPorSubZonaRoza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaRoza" UserSourceName="FillPorSubZonaRoza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaRozaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaRozaPorFecha" GeneratorSourceName="FillPorSubZonaRozaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorSubZonaRozaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaRozaPorFecha" UserSourceName="FillPorSubZonaRozaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaTrans" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaTrans" GeneratorSourceName="FillPorSubZonaTrans" GetMethodModifier="Public" GetMethodName="GetPorSubZonaTrans" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaTrans" UserSourceName="FillPorSubZonaTrans">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	   SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSubZonaTransPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSubZonaTransPorFecha" GeneratorSourceName="FillPorSubZonaTransPorFecha" GetMethodModifier="Public" GetMethodName="GetPorSubZonaTransPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSubZonaTransPorFecha" UserSourceName="FillPorSubZonaTransPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, SUB_ZONA, TIPO_CANA, TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	   SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, SUB_ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaAlza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaAlza" GeneratorSourceName="FillPorZonaAlza" GetMethodModifier="Public" GetMethodName="GetPorZonaAlza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaAlza" UserSourceName="FillPorZonaAlza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaAlzaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaAlzaPorFecha" GeneratorSourceName="FillPorZonaAlzaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorZonaAlzaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaAlzaPorFecha" UserSourceName="FillPorZonaAlzaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, TIPO_CANA , TIPO_ALZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaRoza" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaRoza" GeneratorSourceName="FillPorZonaRoza" GetMethodModifier="Public" GetMethodName="GetPorZonaRoza" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaRoza" UserSourceName="FillPorZonaRoza">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaRozaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaRozaPorFecha" GeneratorSourceName="FillPorZonaRozaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorZonaRozaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaRozaPorFecha" UserSourceName="FillPorZonaRozaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	 SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, TIPO_CANA , TIPO_ROZA, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaTrans" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaTrans" GeneratorSourceName="FillPorZonaTrans" GetMethodModifier="Public" GetMethodName="GetPorZonaTrans" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaTrans" UserSourceName="FillPorZonaTrans">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
GROUP BY ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaTransPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaTransPorFecha" GeneratorSourceName="FillPorZonaTransPorFecha" GetMethodModifier="Public" GetMethodName="GetPorZonaTransPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaTransPorFecha" UserSourceName="FillPorZonaTransPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO, SUM(TONEL_CENSO) AS TONEL_CENSO,
	  SUM(MZ_CENSO) AS MZ_CENSO, 
	  CASE 
	  WHEN SUM(MZ_CENSO)&gt; 0 THEN ROUND(SUM(TONEL_CENSO)/SUM(MZ_CENSO),2)
	  ELSE 0
	  END AS TONEL_MZ_CENSO
FROM
(
	SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR,
		CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, 
		ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS,
		TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, 
		CASE 
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0
		WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1
		ELSE SEMANA
		END AS SEMANA,
		CASE 
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1
		ELSE CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1
		WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3
		ELSE TERCIO 
		END AS TERCIO,
		CASE 
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO'
		ELSE SUB_TERCIO 
		END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO,
		MZ_CENSO, TONEL_MZ_CENSO
	FROM
	(
		SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON,    
		P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
		L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO,
		LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA,
		(SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE,	
		LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, 
		CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P 
		WHERE L.ACCESLOTE = LC.ACCESLOTE
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI
		AND C.CODI_DEPTO = D.CODI_DEPTO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND LC.ID_ZAFRA = @ID_ZAFRA
	) A
) B
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = CODI_DEPTO AND FC.CODI_MUNI = CODI_MUNI AND FC.CODI_CANTON = CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (ZONA = @ZONA OR @ZONA = '')
	AND (SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (CODISOCIO = @CODISOCIO OR @CODISOCIO = '')	
	AND (NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (ID_TIPO_ROZA = @ID_TIPO_ROZA OR @ID_TIPO_ROZA = -1)
	AND (ID_TIPO_ALZA = @ID_TIPO_ALZA OR @ID_TIPO_ALZA = -1)
	AND (ID_TIPO_TRANS = @ID_TIPO_TRANS OR @ID_TIPO_TRANS = -1)
	AND (SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)
	AND (FECHA_ROZA_SH &gt;= @FECHA1 AND FECHA_ROZA_SH &lt;= @FECHA2)
GROUP BY ZONA, TIPO_CANA , TIPO_TRANSPORTE, TERCIO, SUB_TERCIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="1024" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ROZA" ColumnName="ID_TIPO_ROZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ROZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_ALZA" ColumnName="ID_TIPO_ALZA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_ALZA" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_ALZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_TIPO_TRANS" ColumnName="ID_TIPO_TRANS" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_TRANS" Precision="0" Scale="0" Size="0" SourceColumn="ID_TIPO_TRANS" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA_SH" DataSourceName="SELECT ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODILOTE, NOMBLOTE, FECHA_ROZA, FECHA_ROZA_SH, TONEL_CENSO, ACCESLOTE, ID_TIPO_CANA, ID_TIPO_ROZA, ID_TIPO_ALZA, ID_TIPO_TRANS, TIPO_CANA, TIPO_ROZA, TIPO_ALZA, TIPO_TRANSPORTE, CASE WHEN SEMANA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 0 WHEN SEMANA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN SEMANA_FIN_CICLO + 1 ELSE SEMANA END AS SEMANA, CASE WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN CATORCENA IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN CATORCENA_FIN + 1 ELSE CATORCENA END AS CATORCENA, CASE WHEN TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 1 WHEN TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 3 ELSE TERCIO END AS TERCIO, CASE WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &lt; FEC_INI_CICLO THEN 'TEMPRANO' WHEN SUB_TERCIO IS NULL AND FECHA_ROZA_SH &gt; FEC_FIN_CICLO THEN 'TARDIO' ELSE SUB_TERCIO END AS SUB_TERCIO, CODI_CANTON, CODI_MUNI, CODI_DEPTO, MZ_CENSO, TONEL_MZ_CENSO FROM ( SELECT L.ZONA, L.SUB_ZONA,D.NOMBRE_DEPTO, M.NOMBRE_MUNI, C.NOMBRE_CANTON, P.CODIPROVEE, P.CODISOCIO, RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, L.CODILOTE, L.NOMBLOTE, LC.TONEL_CENSO, LC.ACCESLOTE, LC.ID_TIPO_CANA, LC.ID_TIPO_ROZA, LC.ID_TIPO_ALZA, LC.ID_TIPO_TRANS, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ROZA) AS TIPO_ROZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_ALZA) AS TIPO_ALZA, (SELECT TG.NOM_TIPO FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = LC.ID_TIPO_TRANS) AS TIPO_TRANSPORTE, LC.FECHA_ROZA, CAST(LC.FECHA_ROZA AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST(LC.FECHA_ROZA AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = LC.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, C.CODI_CANTON, C.CODI_MUNI, C.CODI_DEPTO, LC.MZ_CENSO, LC.TONEL_MZ_CENSO FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, CANTON C, MUNICIPIO M, DEPARTAMENTO D, PROVEEDOR P WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND C.CODI_DEPTO = M.CODI_DEPTO AND C.CODI_MUNI = M.CODI_MUNI AND C.CODI_DEPTO = D.CODI_DEPTO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = @ID_ZAFRA ) A" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="FECHA_ROZA_SH" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RESULTADOS_ANALISIS_PRECOSECHATableAdapter" GeneratorDataComponentClassName="RESULTADOS_ANALISIS_PRECOSECHATableAdapter" Name="RESULTADOS_ANALISIS_PRECOSECHA" UserDataComponentName="RESULTADOS_ANALISIS_PRECOSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.FECHA_LEE_BAGAZO_BRUTO, A.NO_ANALISIS, L.ZONA,
(SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO,
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
LC.TONEL_CENSO, A.AZUCAR_REDUCTORES, A.POL_JUGO, A.BRIX, A.DEXTRANA, (A.DEXTRANA/A.BRIX)*100 AS DEXTRA_BRIZ, A.ALMIDON_JUGO, A.FECHA_LEE_POL, POL,
A.BAGAZO_NETO, A.FIBRA_CANA, A.JUGO_CANA, A.POL_CANA, A.PUREZA_JUGO, A.PUREZA_AZUCAR, A.SJM, A.PH, A.RENDIA_CALC2, L.CODILOTE, L.NOMBLOTE
FROM ANALISIS_PRECOSECHA A, LOTES L, LOTES_COSECHA LC, PROVEEDOR P, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE 
AND L.ACCESLOTE = LC.ACCESLOTE AND A.ID_ZAFRA = LC.ID_ZAFRA 
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="FECHA_LEE_BAGAZO_BRUTO" DataSetColumn="FECHA_LEE_BAGAZO_BRUTO" />
              <Mapping SourceColumn="NO_ANALISIS" DataSetColumn="NO_ANALISIS" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="AZUCAR_REDUCTORES" DataSetColumn="AZUCAR_REDUCTORES" />
              <Mapping SourceColumn="POL_JUGO" DataSetColumn="POL_JUGO" />
              <Mapping SourceColumn="BRIX" DataSetColumn="BRIX" />
              <Mapping SourceColumn="DEXTRANA" DataSetColumn="DEXTRANA" />
              <Mapping SourceColumn="DEXTRA_BRIZ" DataSetColumn="DEXTRA_BRIZ" />
              <Mapping SourceColumn="ALMIDON_JUGO" DataSetColumn="ALMIDON_JUGO" />
              <Mapping SourceColumn="FECHA_LEE_POL" DataSetColumn="FECHA_LEE_POL" />
              <Mapping SourceColumn="POL" DataSetColumn="POL" />
              <Mapping SourceColumn="BAGAZO_NETO" DataSetColumn="BAGAZO_NETO" />
              <Mapping SourceColumn="FIBRA_CANA" DataSetColumn="FIBRA_CANA" />
              <Mapping SourceColumn="JUGO_CANA" DataSetColumn="JUGO_CANA" />
              <Mapping SourceColumn="POL_CANA" DataSetColumn="POL_CANA" />
              <Mapping SourceColumn="PUREZA_JUGO" DataSetColumn="PUREZA_JUGO" />
              <Mapping SourceColumn="PUREZA_AZUCAR" DataSetColumn="PUREZA_AZUCAR" />
              <Mapping SourceColumn="SJM" DataSetColumn="SJM" />
              <Mapping SourceColumn="PH" DataSetColumn="PH" />
              <Mapping SourceColumn="RENDIA_CALC2" DataSetColumn="RENDIA_CALC2" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorFechas" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorFechas" GeneratorSourceName="FillPorFechas" GetMethodModifier="Public" GetMethodName="GetPorFechas" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorFechas" UserSourceName="FillPorFechas">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.FECHA_LEE_BAGAZO_BRUTO, A.NO_ANALISIS, L.ZONA,
(SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO,
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
LC.TONEL_CENSO, A.AZUCAR_REDUCTORES, A.POL_JUGO, A.BRIX, A.DEXTRANA, (A.DEXTRANA/A.BRIX)*100 AS DEXTRA_BRIZ, A.ALMIDON_JUGO, A.FECHA_LEE_POL, POL,
A.BAGAZO_NETO, A.FIBRA_CANA, A.JUGO_CANA, A.POL_CANA, A.PUREZA_JUGO, A.PUREZA_AZUCAR, A.SJM, A.PH, A.RENDIA_CALC2, L.CODILOTE, L.NOMBLOTE
FROM ANALISIS_PRECOSECHA A, LOTES L, LOTES_COSECHA LC, PROVEEDOR P, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE 
AND L.ACCESLOTE = LC.ACCESLOTE AND A.ID_ZAFRA = LC.ID_ZAFRA 
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.FECHA_LEE_POL BETWEEN @FECHA1 AND @FECHA2
AND A.ID_ZAFRA = @ID_ZAFRA
AND (L.ZONA = @ZONA OR @ZONA = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA1" ColumnName="FECHA_LEE_POL" DataSourceName="INJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_LEE_POL" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA2" ColumnName="FECHA_LEE_POL" DataSourceName="INJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_LEE_POL" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLICITUD_AGRICOLA_MADURANTETableAdapter" GeneratorDataComponentClassName="SOLICITUD_AGRICOLA_MADURANTETableAdapter" Name="SOLIC_AGRICOLA_MADURANTE" UserDataComponentName="SOLICITUD_AGRICOLA_MADURANTETableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT SA.NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODIPROVEEDOR(SA.CODIPROVEEDOR) AS CODIPROVEE,
(SELECT MAX(L.ZONA) FROM SOLIC_AGRICOLA_LOTE SL, LOTES L WHERE SL.ID_SOLICITUD = SA.ID_SOLICITUD AND SL.ACCESLOTE = L.ACCESLOTE) AS ZONA,
SA.NIT, SA.NRC, SA.ACTIVIDAD,
(SELECT PA.NOMBRE FROM PROVEEDOR_AGRICOLA PA WHERE PA.ID_PROVEE= SV.ID_PROVEE) AS PROVEEDOR_VUELO, SV.NOMBRE_PILOTO, 
CASE SV.MEDIO_APLICA  
WHEN 'A' THEN 'AVION'
WHEN 'H' THEN 'HELICOPTERO'
ELSE ''
END AS MEDIO, SV.DESCRIP_AERONAVE,
(SELECT A.NOMBRE_AGRONOMO + ' ' + A.APELLIDO_AGRONOMO FROM AGRONOMO A WHERE A.CODIAGRON = SA.CODIAGRON) AS NOMBRE_AGRONOMO,
SA.FECHA_APLICA, SA.FECHA_SOLIC, SA.ZAFRA,
(SELECT MAX(L.CODIPROVEEDOR) FROM SOLIC_AGRICOLA_LOTE SL, LOTES L WHERE SL.ID_SOLICITUD = SA.ID_SOLICITUD AND SL.ACCESLOTE = L.ACCESLOTE) AS CODISOCIO 
FROM SOLIC_AGRICOLA SA, SOLIC_AGRICOLA_VUELO SV
WHERE SA.ID_SOLICITUD = SV.ID_SOLICITUD
AND SA.ID_SOLICITUD = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="NRC" DataSetColumn="NRC" />
              <Mapping SourceColumn="ACTIVIDAD" DataSetColumn="ACTIVIDAD" />
              <Mapping SourceColumn="PROVEEDOR_VUELO" DataSetColumn="PROVEEDOR_VUELO" />
              <Mapping SourceColumn="NOMBRE_PILOTO" DataSetColumn="NOMBRE_PILOTO" />
              <Mapping SourceColumn="MEDIO" DataSetColumn="MEDIO" />
              <Mapping SourceColumn="DESCRIP_AERONAVE" DataSetColumn="DESCRIP_AERONAVE" />
              <Mapping SourceColumn="NOMBRE_AGRONOMO" DataSetColumn="NOMBRE_AGRONOMO" />
              <Mapping SourceColumn="FECHA_APLICA" DataSetColumn="FECHA_APLICA" />
              <Mapping SourceColumn="FECHA_SOLIC" DataSetColumn="FECHA_SOLIC" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSolicitud" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSolicitud" GeneratorSourceName="FillPorSolicitud" GetMethodModifier="Public" GetMethodName="GetPorSolicitud" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSolicitud" UserSourceName="FillPorSolicitud">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT SA.NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODIPROVEEDOR(SA.CODIPROVEEDOR) AS CODIPROVEE,
(SELECT MAX(L.ZONA) FROM SOLIC_AGRICOLA_LOTE SL, LOTES L WHERE SL.ID_SOLICITUD = SA.ID_SOLICITUD AND SL.ACCESLOTE = L.ACCESLOTE) AS ZONA,
SA.NIT, SA.NRC, SA.ACTIVIDAD,
(SELECT RTRIM(ISNULL(PA.NOMBRE,'')) + ' ' + RTRIM(ISNULL(PA.APELLIDOS,'')) FROM PROVEEDOR_AGRICOLA PA WHERE PA.ID_PROVEE= SV.ID_PROVEE) AS PROVEEDOR_VUELO, SV.NOMBRE_PILOTO, 
CASE SV.MEDIO_APLICA  
WHEN 'A' THEN 'AVION'
WHEN 'H' THEN 'HELICOPTERO'
ELSE ''
END AS MEDIO, SV.DESCRIP_AERONAVE,
(SELECT A.NOMBRE_AGRONOMO + ' ' + A.APELLIDO_AGRONOMO FROM AGRONOMO A WHERE A.CODIAGRON = SA.CODIAGRON) AS NOMBRE_AGRONOMO,
SA.FECHA_APLICA, SA.FECHA_SOLIC, SA.ZAFRA,
(SELECT MAX(L.CODIPROVEEDOR) FROM SOLIC_AGRICOLA_LOTE SL, LOTES L WHERE SL.ID_SOLICITUD = SA.ID_SOLICITUD AND SL.ACCESLOTE = L.ACCESLOTE) AS CODISOCIO 
FROM SOLIC_AGRICOLA SA LEFT OUTER JOIN SOLIC_AGRICOLA_VUELO SV ON SA.ID_SOLICITUD = SV.ID_SOLICITUD
WHERE SA.ID_SOLICITUD = @ID_SOLICITUD</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SOLICITUD" ColumnName="ID_SOLICITUD" DataSourceName="INJIBOA.dbo.SOLIC_AGRICOLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SOLICITUD" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_SOLICITUD" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLIC_AGRICOLA_LOTESTableAdapter" GeneratorDataComponentClassName="SOLIC_AGRICOLA_LOTESTableAdapter" Name="SOLIC_AGRICOLA_LOTES" UserDataComponentName="SOLIC_AGRICOLA_LOTESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT S.ID_SOLICITUD,
ROW_NUMBER() OVER(ORDER BY SL.ID_SOLIC_AGRI_LOTE) AS CORRELATIVO,
L.NOMBLOTE, SL.MZ, SL.TONEL_ESTI, V.NOM_VARIEDAD, C.NOMBRE_CANTON 
FROM SOLIC_AGRICOLA S, SOLIC_AGRICOLA_LOTE SL, LOTES L, VARIEDAD V,
MAESTRO_LOTES ML, CANTON C 
WHERE S.ID_SOLICITUD = SL.ID_SOLICITUD
AND SL.ACCESLOTE = L.ACCESLOTE
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON 
AND S.ID_SOLICITUD = -1
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="MZ" DataSetColumn="MZ" />
              <Mapping SourceColumn="TONEL_ESTI" DataSetColumn="TONEL_ESTI" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="ID_SOLICITUD" DataSetColumn="ID_SOLICITUD" />
              <Mapping SourceColumn="CORRELATIVO" DataSetColumn="CORRELATIVO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSolicitud" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSolicitud" GeneratorSourceName="FillPorSolicitud" GetMethodModifier="Public" GetMethodName="GetPorSolicitud" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSolicitud" UserSourceName="FillPorSolicitud">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT S.ID_SOLICITUD,
ROW_NUMBER() OVER(ORDER BY SL.ID_SOLIC_AGRI_LOTE) AS CORRELATIVO,
L.NOMBLOTE, SL.MZ, SL.TONEL_ESTI, V.NOM_VARIEDAD, C.NOMBRE_CANTON 
FROM SOLIC_AGRICOLA S, SOLIC_AGRICOLA_LOTE SL, LOTES L, VARIEDAD V,
MAESTRO_LOTES ML, CANTON C 
WHERE S.ID_SOLICITUD = SL.ID_SOLICITUD
AND SL.ACCESLOTE = L.ACCESLOTE
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_CANTON = C.CODI_CANTON 
AND S.ID_SOLICITUD = @ID_SOLICITUD
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SOLICITUD" ColumnName="ID_SOLICITUD" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SOLICITUD" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_SOLICITUD" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLIC_AGRICOLA_PRODUCTOTableAdapter" GeneratorDataComponentClassName="SOLIC_AGRICOLA_PRODUCTOTableAdapter" Name="SOLIC_AGRICOLA_PRODUCTO" UserDataComponentName="SOLIC_AGRICOLA_PRODUCTOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
10000 AS CORRELATIVO,
S.ID_SOLICITUD, P.NOMBRE_PRODUCTO, SP.CANT_X_MZ, SP.TOTAL_PRODUCTO, SP.PRECIO_UNITARIO, SP.PRECIO_TOTAL,
(SELECT G.NOMBRE FROM PROVEEDOR_AGRICOLA G WHERE G.ID_PROVEE = SP.ID_PROVEE) AS PROVEEDOR
FROM SOLIC_AGRICOLA S, SOLIC_AGRICOLA_PRODUCTO SP, PRODUCTO P
WHERE S.ID_SOLICITUD = SP.ID_SOLICITUD
AND SP.ID_PRODUCTO = P.ID_PRODUCTO
AND S.ID_SOLICITUD = -1
ORDER BY SP.ID_SOLIC_AGRI_PROD
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_PRODUCTO" DataSetColumn="NOMBRE_PRODUCTO" />
              <Mapping SourceColumn="CANT_X_MZ" DataSetColumn="CANT_X_MZ" />
              <Mapping SourceColumn="TOTAL_PRODUCTO" DataSetColumn="TOTAL_PRODUCTO" />
              <Mapping SourceColumn="PRECIO_UNITARIO" DataSetColumn="PRECIO_UNITARIO" />
              <Mapping SourceColumn="PRECIO_TOTAL" DataSetColumn="PRECIO_TOTAL" />
              <Mapping SourceColumn="ID_SOLICITUD" DataSetColumn="ID_SOLICITUD" />
              <Mapping SourceColumn="CORRELATIVO" DataSetColumn="CORRELATIVO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSolicitud" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSolicitud" GeneratorSourceName="FillPorSolicitud" GetMethodModifier="Public" GetMethodName="GetPorSolicitud" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSolicitud" UserSourceName="FillPorSolicitud">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
ROW_NUMBER() OVER(ORDER BY SP.ID_SOLIC_AGRI_PROD) AS CORRELATIVO,
S.ID_SOLICITUD, P.NOMBRE_PRODUCTO, SP.CANT_X_MZ, SP.TOTAL_PRODUCTO, SP.PRECIO_UNITARIO, SP.PRECIO_TOTAL,
(SELECT G.NOMBRE FROM PROVEEDOR_AGRICOLA G WHERE G.ID_PROVEE = SP.ID_PROVEE) AS PROVEEDOR
FROM SOLIC_AGRICOLA S, SOLIC_AGRICOLA_PRODUCTO SP, PRODUCTO P
WHERE S.ID_SOLICITUD = SP.ID_SOLICITUD
AND SP.ID_PRODUCTO = P.ID_PRODUCTO
AND S.ID_SOLICITUD = @ID_SOLICITUD
ORDER BY SP.ID_SOLIC_AGRI_PROD</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SOLICITUD" ColumnName="ID_SOLICITUD" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SOLICITUD" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_SOLICITUD" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_FINANTableAdapter" GeneratorDataComponentClassName="CONTRATO_FINANTableAdapter" Name="CONTRATO_FINAN" UserDataComponentName="CONTRATO_FINANTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CF.*, C.NO_CONTRATO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS CODIPROVEE
FROM CONTRATO_FINAN CF, CONTRATO C, PROVEEDOR P 
WHERE CF.CODICONTRATO = C.CODICONTRATO AND C.CODIPROVEEDOR = P.CODIPROVEEDOR AND CF.ID_CONTRATO_FINAN = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_CONTRATO_FINAN" DataSetColumn="ID_CONTRATO_FINAN" />
              <Mapping SourceColumn="ID_ZAFRA" DataSetColumn="ID_ZAFRA" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="MZ" DataSetColumn="MZ" />
              <Mapping SourceColumn="TONEL_MZ" DataSetColumn="TONEL_MZ" />
              <Mapping SourceColumn="TONEL" DataSetColumn="TONEL" />
              <Mapping SourceColumn="REND_COSECHA" DataSetColumn="REND_COSECHA" />
              <Mapping SourceColumn="LIBRAS" DataSetColumn="LIBRAS" />
              <Mapping SourceColumn="VIP" DataSetColumn="VIP" />
              <Mapping SourceColumn="VALOR_CONTRA" DataSetColumn="VALOR_CONTRA" />
              <Mapping SourceColumn="PROVI_ROZA" DataSetColumn="PROVI_ROZA" />
              <Mapping SourceColumn="PROVI_ALZA" DataSetColumn="PROVI_ALZA" />
              <Mapping SourceColumn="PROVI_TRANS" DataSetColumn="PROVI_TRANS" />
              <Mapping SourceColumn="PROVISION" DataSetColumn="PROVISION" />
              <Mapping SourceColumn="MONTO_FINAN" DataSetColumn="MONTO_FINAN" />
              <Mapping SourceColumn="ABONO_FINAN" DataSetColumn="ABONO_FINAN" />
              <Mapping SourceColumn="SALDO_FINAN" DataSetColumn="SALDO_FINAN" />
              <Mapping SourceColumn="SALDO_DISPO" DataSetColumn="SALDO_DISPO" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="USUARIO_CREA" DataSetColumn="USUARIO_CREA" />
              <Mapping SourceColumn="FECHA_CREA" DataSetColumn="FECHA_CREA" />
              <Mapping SourceColumn="USUARIO_ACT" DataSetColumn="USUARIO_ACT" />
              <Mapping SourceColumn="FECHA_ACT" DataSetColumn="FECHA_ACT" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorId" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorId" GeneratorSourceName="FillPorId" GetMethodModifier="Public" GetMethodName="GetPorId" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorId" UserSourceName="FillPorId">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CF.*, C.NO_CONTRATO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS CODIPROVEE
FROM CONTRATO_FINAN CF, CONTRATO C, PROVEEDOR P 
WHERE CF.CODICONTRATO = C.CODICONTRATO AND C.CODIPROVEEDOR = P.CODIPROVEEDOR AND CF.ID_CONTRATO_FINAN = @ID_CONTRATO_FINAN</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_CONTRATO_FINAN" ColumnName="ID_CONTRATO_FINAN" DataSourceName="INJIBOA.dbo.CONTRATO_FINAN" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CONTRATO_FINAN" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CONTRATO_FINAN" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZafraContrato" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafraContrato" GeneratorSourceName="FillPorZafraContrato" GetMethodModifier="Public" GetMethodName="GetPorZafraContrato" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafraContrato" UserSourceName="FillPorZafraContrato">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CF.*, C.NO_CONTRATO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS CODIPROVEE
FROM CONTRATO_FINAN CF, CONTRATO C, PROVEEDOR P 
WHERE CF.CODICONTRATO = C.CODICONTRATO AND C.CODIPROVEEDOR = P.CODIPROVEEDOR AND CF.ID_ZAFRA = @ID_ZAFRA AND CF.CODICONTRATO = @CODICONTRATO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA.dbo.CONTRATO_FINAN" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODICONTRATO" ColumnName="CODICONTRATO" DataSourceName="INJIBOA.dbo.CONTRATO_FINAN" DataTypeServer="char(13)" DbType="AnsiString" Direction="Input" ParameterName="@CODICONTRATO" Precision="0" ProviderType="Char" Scale="0" Size="13" SourceColumn="CODICONTRATO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="HOJA_ANALISIS_LOTETableAdapter" GeneratorDataComponentClassName="HOJA_ANALISIS_LOTETableAdapter" Name="HOJA_ANALISIS_LOTE" UserDataComponentName="HOJA_ANALISIS_LOTETableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NO_ANALISIS, A.NO_MUESTRA, A.FECHA_MUESTRA, A.FECHA_LEE_POL, 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS INT) AS CODIPROVEEDOR,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, 
C.NO_CONTRATO, V.NOM_VARIEDAD, L.ZONA, L.SUB_ZONA, L.EDAD_LOTE, 
A.BAGAZO_NETO, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO,
A.AZUCAR_REDUCTORES, A.PH, (SELECT U.NOMBRE FROM USUARIO U WHERE U.USUARIO = A.USUARIO_LEE_POL) AS ANALISTA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS ZAFRA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
L.NOMBLOTE, L.CODILOTE,
(SELECT MAX(SA.NOMBRE_PRODUCTO) FROM SOLIC_APLICA_LOTE SA, PRODUCTO P WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS MADURANTE, 
(SELECT MAX(SA.FECHA_APLICA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS FECHA_APLICA,
(SELECT MAX(SA.FECHA_INI_VENTANA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS VENTANA_FECHA_INI,
(SELECT MAX(SA.FECHA_FIN_VENTANA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS VENTANA_FECHA_FIN
FROM ANALISIS_PRECOSECHA A, LOTES L, CONTRATO C, PROVEEDOR P, VARIEDAD V, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODICONTRATO = C.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.ID_ANALISIS_PRE = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NO_ANALISIS" DataSetColumn="NO_ANALISIS" />
              <Mapping SourceColumn="NO_MUESTRA" DataSetColumn="NO_MUESTRA" />
              <Mapping SourceColumn="FECHA_MUESTRA" DataSetColumn="FECHA_MUESTRA" />
              <Mapping SourceColumn="FECHA_LEE_POL" DataSetColumn="FECHA_LEE_POL" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="BAGAZO_NETO" DataSetColumn="BAGAZO_NETO" />
              <Mapping SourceColumn="BRIX" DataSetColumn="BRIX" />
              <Mapping SourceColumn="POL" DataSetColumn="POL" />
              <Mapping SourceColumn="PUREZA_JUGO" DataSetColumn="PUREZA_JUGO" />
              <Mapping SourceColumn="FIBRA_CANA" DataSetColumn="FIBRA_CANA" />
              <Mapping SourceColumn="DEXTRANA" DataSetColumn="DEXTRANA" />
              <Mapping SourceColumn="HUMEDAD" DataSetColumn="HUMEDAD" />
              <Mapping SourceColumn="ALMIDON_JUGO" DataSetColumn="ALMIDON_JUGO" />
              <Mapping SourceColumn="AZUCAR_REDUCTORES" DataSetColumn="AZUCAR_REDUCTORES" />
              <Mapping SourceColumn="PH" DataSetColumn="PH" />
              <Mapping SourceColumn="ANALISTA" DataSetColumn="ANALISTA" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="MADURANTE" DataSetColumn="MADURANTE" />
              <Mapping SourceColumn="FECHA_APLICA" DataSetColumn="FECHA_APLICA" />
              <Mapping SourceColumn="VENTANA_FECHA_INI" DataSetColumn="VENTANA_FECHA_INI" />
              <Mapping SourceColumn="VENTANA_FECHA_FIN" DataSetColumn="VENTANA_FECHA_FIN" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorAnalisis" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorAnalisis" GeneratorSourceName="FillPorAnalisis" GetMethodModifier="Public" GetMethodName="GetPorAnalisis" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorAnalisis" UserSourceName="FillPorAnalisis">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NO_ANALISIS, A.NO_MUESTRA, A.FECHA_MUESTRA, A.FECHA_LEE_POL, 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS INT) AS CODIPROVEEDOR,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, 
C.NO_CONTRATO, V.NOM_VARIEDAD, L.ZONA, L.SUB_ZONA, L.EDAD_LOTE, 
A.BAGAZO_NETO, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO,
A.AZUCAR_REDUCTORES, A.PH, (SELECT U.NOMBRE FROM USUARIO U WHERE U.USUARIO = A.USUARIO_LEE_POL) AS ANALISTA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS ZAFRA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
L.NOMBLOTE, L.CODILOTE,
(SELECT MAX(SA.NOMBRE_PRODUCTO) FROM SOLIC_APLICA_LOTE SA, PRODUCTO P WHERE SA.ID_PRODUCTO = P.ID_PRODUCTO AND SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE AND P.ID_CATEGORIA &lt;&gt; 6) AS MADURANTE, 
(SELECT MAX(SA.FECHA_APLICA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS FECHA_APLICA,
(SELECT MAX(SA.FECHA_INI_VENTANA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS VENTANA_FECHA_INI,
(SELECT MAX(SA.FECHA_FIN_VENTANA) FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE) AS VENTANA_FECHA_FIN
FROM ANALISIS_PRECOSECHA A, LOTES L, CONTRATO C, PROVEEDOR P, VARIEDAD V, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODICONTRATO = C.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.ID_ANALISIS_PRE = @ID_ANALISIS_PRE</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ANALISIS_PRE" ColumnName="ID_ANALISIS_PRE" DataSourceName="INJIBOA2.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ANALISIS_PRE" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ANALISIS_PRE" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZafraConMadurante" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafraConMadurante" GeneratorSourceName="FillPorZafraConMadurante" GetMethodModifier="Public" GetMethodName="GetPorZafraConMadurante" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafraConMadurante" UserSourceName="FillPorZafraConMadurante">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NO_ANALISIS, A.NO_MUESTRA, A.FECHA_MUESTRA, A.FECHA_LEE_POL, 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS INT) AS CODIPROVEEDOR,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, 
C.NO_CONTRATO, V.NOM_VARIEDAD, L.ZONA, L.SUB_ZONA, L.EDAD_LOTE, 
A.BAGAZO_NETO, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO,
A.AZUCAR_REDUCTORES, A.PH, (SELECT U.NOMBRE FROM USUARIO U WHERE U.USUARIO = A.USUARIO_LEE_POL) AS ANALISTA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS ZAFRA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
L.NOMBLOTE, L.CODILOTE,
(SELECT TOP 1 SA.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE SA, PRODUCTO P WHERE SA.ID_PRODUCTO = P.ID_PRODUCTO AND SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE AND P.ID_CATEGORIA &lt;&gt; 6 ORDER BY SA.FECHA_APLICA DESC) AS MADURANTE,
(SELECT TOP 1 SA.FECHA_APLICA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS FECHA_APLICA,
(SELECT TOP 1 SA.FECHA_INI_VENTANA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS VENTANA_FECHA_INI,
(SELECT TOP 1 SA.FECHA_FIN_VENTANA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS VENTANA_FECHA_FIN
FROM ANALISIS_PRECOSECHA A, LOTES L, CONTRATO C, PROVEEDOR P, VARIEDAD V, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODICONTRATO = C.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.ID_ZAFRA = @ID_ZAFRA
AND NOT A.FECHA_LEE_POL IS NULL
AND EXISTS(SELECT 1 FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE)
ORDER BY A.FECHA_MUESTRA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA2.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZafraSinMadurante" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafraSinMadurante" GeneratorSourceName="FillPorZafraSinMadurante" GetMethodModifier="Public" GetMethodName="GetPorZafraSinMadurante" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafraSinMadurante" UserSourceName="FillPorZafraSinMadurante">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NO_ANALISIS, A.NO_MUESTRA, A.FECHA_MUESTRA, A.FECHA_LEE_POL, 
CAST(dbo.QuitarFormatoCODIPROVEEDOR(P.CODIPROVEEDOR) AS INT) AS CODIPROVEEDOR,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS NOMBRE_PROVEEDOR, 
C.NO_CONTRATO, V.NOM_VARIEDAD, L.ZONA, L.SUB_ZONA, L.EDAD_LOTE, 
A.BAGAZO_NETO, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO,
A.AZUCAR_REDUCTORES, A.PH, (SELECT U.NOMBRE FROM USUARIO U WHERE U.USUARIO = A.USUARIO_LEE_POL) AS ANALISTA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS ZAFRA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO,
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
L.NOMBLOTE, L.CODILOTE,
(SELECT TOP 1 SA.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS MADURANTE,
(SELECT TOP 1 SA.FECHA_APLICA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS FECHA_APLICA,
(SELECT TOP 1 SA.FECHA_INI_VENTANA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS VENTANA_FECHA_INI,
(SELECT TOP 1 SA.FECHA_FIN_VENTANA FROM SOLIC_APLICA_LOTE SA WHERE SA.ID_ZAFRA = A.ID_ZAFRA AND SA.ACCESLOTE = A.ACCESLOTE ORDER BY SA.FECHA_APLICA DESC) AS VENTANA_FECHA_FIN
FROM ANALISIS_PRECOSECHA A, LOTES L, CONTRATO C, PROVEEDOR P, VARIEDAD V, MAESTRO_LOTES ML
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODICONTRATO = C.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND A.ID_ZAFRA = @ID_ZAFRA
AND NOT A.FECHA_LEE_POL IS NULL
AND NOT EXISTS(SELECT 1 FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE)
ORDER BY A.FECHA_MUESTRA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="CONSULTA_INJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PLAN_COSECHA_ACTUALTableAdapter" GeneratorDataComponentClassName="PLAN_COSECHA_ACTUALTableAdapter" Name="PLAN_COSECHA_ACTUAL" UserDataComponentName="PLAN_COSECHA_ACTUALTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = -1" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT 
		(SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA,
		ML.SUB_ZONA,
		(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO,
		(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI,
		(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON,
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
		dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR,
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE,
		L.CODIVARIEDA,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA,
		LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO,
		ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA
	FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V
	WHERE L.ACCESLOTE = LC.ACCESLOTE 
	AND L.ID_MAESTRO = ML.ID_MAESTRO 
	AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.CODICONTRATO = C.CODICONTRATO
	AND L.CODIVARIEDA = V.CODIVARIEDA
	AND LC.ID_ZAFRA = -1
) T</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODIVARIEDA" DataSetColumn="CODIVARIEDA" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="SUB_TIPO_CANA" DataSetColumn="SUB_TIPO_CANA" />
              <Mapping SourceColumn="ID_TIPO" DataSetColumn="ID_TIPO" />
              <Mapping SourceColumn="ID_SUB_TIPO" DataSetColumn="ID_SUB_TIPO" />
              <Mapping SourceColumn="REND_COSECHA" DataSetColumn="REND_COSECHA" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="SUB_TERCIO" DataSetColumn="SUB_TERCIO" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="ID_TIPO_CANA" DataSetColumn="ID_TIPO_CANA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLote" GeneratorSourceName="FillPorLote" GetMethodModifier="Public" GetMethodName="GetPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLote" UserSourceName="FillPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT 
		(SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA,
		ML.SUB_ZONA,
		(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO,
		(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI,
		(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON,
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
		dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR,
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE,
		L.CODIVARIEDA,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA,
		LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO,
		ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA
	FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V
	WHERE L.ACCESLOTE = LC.ACCESLOTE 
	AND L.ID_MAESTRO = ML.ID_MAESTRO 
	AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.CODICONTRATO = C.CODICONTRATO
	AND L.CODIVARIEDA = V.CODIVARIEDA
	AND LC.ID_ZAFRA = @ID_ZAFRA
) T
WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = T.CODI_DEPTO AND FC.CODI_MUNI = T.CODI_MUNI AND FC.CODI_CANTON = T.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (T.ZONA = @ZONA OR @ZONA = '')
	AND (T.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((T.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (T.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (T.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (T.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (T.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (T.ID_TIPO_CANA = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (T.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (T.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (T.SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIVARIEDA" ColumnName="CODIVARIEDA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="CODIVARIEDA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="ID_TIPO_CANA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="ID_TIPO_CANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="ID_SUB_TIPO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="ID_SUB_TIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="4" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(20)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="20" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="4" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteFecha" GeneratorSourceName="FillPorLoteFecha" GetMethodModifier="Public" GetMethodName="GetPorLoteFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteFecha" UserSourceName="FillPorLoteFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM
(
	SELECT 
		(SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA,
		ML.SUB_ZONA,
		(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO,
		(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI,
		(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON,
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
		dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR,
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE,
		L.CODIVARIEDA,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA,
		LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO,
		ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA
	FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V
	WHERE L.ACCESLOTE = LC.ACCESLOTE 
	AND L.ID_MAESTRO = ML.ID_MAESTRO 
	AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.CODICONTRATO = C.CODICONTRATO
	AND L.CODIVARIEDA = V.CODIVARIEDA
	AND LC.ID_ZAFRA = @ID_ZAFRA
) T
WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = T.CODI_DEPTO AND FC.CODI_MUNI = T.CODI_MUNI AND FC.CODI_CANTON = T.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (T.ZONA = @ZONA OR @ZONA = '')
	AND (T.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((T.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (T.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (T.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (T.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (T.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (T.ID_TIPO_CANA = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (T.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)
	AND (T.FECHA_ROZA &gt;= @FECHA1 AND T.FECHA_ROZA &lt;= @FECHA2) 	
	AND (T.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
	AND (T.SEMANA = @SEMANA OR @SEMANA = -1)
	AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
	AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
	AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIVARIEDA" ColumnName="CODIVARIEDA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="CODIVARIEDA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="ID_TIPO_CANA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="ID_TIPO_CANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="ID_SUB_TIPO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="ID_SUB_TIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA1" ColumnName="FECHA_ROZA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="8" SourceColumn="FECHA_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA2" ColumnName="FECHA_ROZA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="8" SourceColumn="FECHA_ROZA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="4" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="4" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="varchar(20)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="20" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT (SELECT Z.DESCRIP_ZONA FROM ZONAS Z WHERE Z.ZONA = ML.ZONA) AS DESCRIP_ZONA, ML.SUB_ZONA, (SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO, (SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, C.CODICONTRATO, C.NO_CONTRATO, L.EDAD_LOTE, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, LC.REND_COSECHA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.FECHA_ROZA, LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, LC.FAB_SUBTERCIO AS SUB_TERCIO, LC.FAB_TERCIO AS TERCIO, ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ZONA, ML.ID_TIPO_CANA FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIVARIEDA = V.CODIVARIEDA AND LC.ID_ZAFRA = @ID_ZAFRA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="4" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CENSOTableAdapter" GeneratorDataComponentClassName="CENSOTableAdapter" Name="CENSO" UserDataComponentName="CENSOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	'' AS OBSERVACION, 0.02 AS MZ_ZAFRA_COMPA, 0.02 AS TC_MZ_ZAFRA_COMPA, 0.02 AS TC_ZAFRA_COMPA,
	'' AS VARIEDAD, '' AS TIPO, GETDATE() AS FECHA_COSECHA, 100 AS SEMANA, 100 AS CATORCENA, 100 AS TERCIO, '' AS SUB_TIPO_CANA, '' AS SUB_TERCIO,
	GETDATE() AS INICIO_COSECHA, GETDATE() AS FIN_COSECHA, 
	'S' AS CANA_QUEMADA, 'S' AS CANA_VERDE, 'S' AS ES_MADURANTE, 'S' AS ES_PRE_COSECHA,
	0.009 AS REND_COSECHA_ANT, 'X' AS TIPO_CANA, 0 AS EDAD_LOTE_ANT, 0 AS EDAD_LOTE
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO	
AND L.CODIPROVEEDOR = '-'</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="REND_CONTRATADO" DataSetColumn="REND_CONTRATADO" />
              <Mapping SourceColumn="MZ_CONTRATADO" DataSetColumn="MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_MZ_CONTRATADO" DataSetColumn="TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_CONTRATADO" DataSetColumn="TC_CONTRATADO" />
              <Mapping SourceColumn="LBS_CONTRATADO" DataSetColumn="LBS_CONTRATADO" />
              <Mapping SourceColumn="VALOR_CONTRATADO" DataSetColumn="VALOR_CONTRATADO" />
              <Mapping SourceColumn="MZ_ENTREGAR" DataSetColumn="MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGAR" DataSetColumn="TONEL_MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="LBS_ENTREGAR" DataSetColumn="LBS_ENTREGAR" />
              <Mapping SourceColumn="VALOR_ENTREGAR" DataSetColumn="VALOR_ENTREGAR" />
              <Mapping SourceColumn="MZ_ENTREGADA" DataSetColumn="MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGADA" DataSetColumn="TONEL_MZ_ENTREGADA" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="LBS_ENTREGADA" DataSetColumn="LBS_ENTREGADA" />
              <Mapping SourceColumn="VALOR_ENTREGADA" DataSetColumn="VALOR_ENTREGADA" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="LBS_CENSO" DataSetColumn="LBS_CENSO" />
              <Mapping SourceColumn="VALOR_CENSO" DataSetColumn="VALOR_CENSO" />
              <Mapping SourceColumn="REND_HISTO" DataSetColumn="REND_HISTO" />
              <Mapping SourceColumn="CANT_LOTES" DataSetColumn="CANT_LOTES" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="FECHA_VERIFICACION" DataSetColumn="FECHA_VERIFICACION" />
              <Mapping SourceColumn="MZ_VAR" DataSetColumn="MZ_VAR" />
              <Mapping SourceColumn="TC_MZ_VAR" DataSetColumn="TC_MZ_VAR" />
              <Mapping SourceColumn="TC_VAR" DataSetColumn="TC_VAR" />
              <Mapping SourceColumn="LBS_VAR" DataSetColumn="LBS_VAR" />
              <Mapping SourceColumn="TOTAL_VAR" DataSetColumn="TOTAL_VAR" />
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="CANT_CONTRATOS" DataSetColumn="CANT_CONTRATOS" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="OBSERVACION" DataSetColumn="OBSERVACION" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="FECHA_COSECHA" DataSetColumn="FECHA_COSECHA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="SUB_TIPO_CANA" DataSetColumn="SUB_TIPO_CANA" />
              <Mapping SourceColumn="SUB_TERCIO" DataSetColumn="SUB_TERCIO" />
              <Mapping SourceColumn="MZ_ZAFRA_COMPA" DataSetColumn="MZ_ZAFRA_COMPA" />
              <Mapping SourceColumn="TC_MZ_ZAFRA_COMPA" DataSetColumn="TC_MZ_ZAFRA_COMPA" />
              <Mapping SourceColumn="TC_ZAFRA_COMPA" DataSetColumn="TC_ZAFRA_COMPA" />
              <Mapping SourceColumn="INICIO_COSECHA" DataSetColumn="INICIO_COSECHA" />
              <Mapping SourceColumn="FIN_COSECHA" DataSetColumn="FIN_COSECHA" />
              <Mapping SourceColumn="CANA_QUEMADA" DataSetColumn="CANA_QUEMADA" />
              <Mapping SourceColumn="CANA_VERDE" DataSetColumn="CANA_VERDE" />
              <Mapping SourceColumn="ES_MADURANTE" DataSetColumn="ES_MADURANTE" />
              <Mapping SourceColumn="ES_PRE_COSECHA" DataSetColumn="ES_PRE_COSECHA" />
              <Mapping SourceColumn="REND_COSECHA_ANT" DataSetColumn="REND_COSECHA_ANT" />
              <Mapping SourceColumn="TIPO_CANA" DataSetColumn="TIPO_CANA" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="EDAD_LOTE_ANT" DataSetColumn="EDAD_LOTE_ANT" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 0 AS CANT_CONTRATOS,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
	'' AS OBSERVACION, 0 AS MZ_ZAFRA_COMPA, 0 AS TC_MZ_ZAFRA_COMPA, 0 AS TC_ZAFRA_COMPA   
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE	
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillLoteCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetLoteCierreZafraSdoEnt" GeneratorSourceName="FillLoteCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetLoteCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetLoteCierreZafraSdoEnt" UserSourceName="FillLoteCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
	C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,	
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCierreZafra" GeneratorSourceName="FillPorCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCierreZafra" UserSourceName="FillPorCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(LBS_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_VAR) &gt; 0 THEN ABS(SUM(TC_VAR)/SUM(MZ_VAR))
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY  NOMBRE_ZAFRA, FECHA_VERIFICACION, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContrato" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContrato" GeneratorSourceName="FillPorContrato" GetMethodModifier="Public" GetMethodName="GetPorContrato" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContrato" UserSourceName="FillPorContrato">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO   
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoCierreZafra" GeneratorSourceName="FillPorContratoCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorContratoCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoCierreZafra" UserSourceName="FillPorContratoCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,	
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoCierreZafraSdoEnt" GeneratorSourceName="FillPorContratoCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetPorContratoCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoCierreZafraSdoEnt" UserSourceName="FillPorContratoCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &lt;&gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,	
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA,
	SUB_ZONA, '' AS NOMBRE_CANTON, '' AS NOMBRE_MUNI, '' AS NOMBRE_DEPTO   
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO   
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
	AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')
) T
GROUP BY NOMBRE_ZAFRA, CODIPROVEEDOR, CODIPROVEE, CODISOCIO,
	NOMBRE_PROVEEDOR, CODICONTRATO, FECHA_VERIFICACION, DESCRIP_ZONA, SUB_ZONA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '') AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCierreZafra" GeneratorSourceName="FillPorLoteCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorLoteCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCierreZafra" UserSourceName="FillPorLoteCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 		
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,				
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
	C.REND_HISTO, 0 AS CANT_LOTES, L.ACCESLOTE,
	C.FECHA_VERIFICACION,	
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, 
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO  
FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.ACCESLOTE = C.ACCESLOTE
AND C.ID_CENSO = S.ID_CENSO
AND S.ID_ZAFRA = Z.ID_ZAFRA
AND L.ZONA = N.ZONA 
	AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
	AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
	AND M.CODI_DEPTO = D.CODI_DEPTO
AND S.ID_CENSO = @ID_CENSO
AND (L.ZONA = @ZONA OR @ZONA = '')
AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
AND (dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) = @CODIPROVEE OR @CODIPROVEE = '')
AND (dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="ID_CENSO" DataSourceName="INJIBOA.dbo.CENSO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CENSO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="INJIBOA.dbo.LOTES" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="INJIBOA.dbo.MAESTRO_LOTES" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="Char" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaFueraRango" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaFueraRango" GeneratorSourceName="FillPorLoteCompaFueraRango" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaFueraRango" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaFueraRango" UserSourceName="FillPorLoteCompaFueraRango">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A,
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA,
		(L.TONEL_TC + (L.TONEL_TC * 0.2)) AS LIMITE_SUP, (L.TONEL_TC - (L.TONEL_TC * 0.2)) AS LIMITE_INF
		FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC
		WHERE L.CODICONTRATO = CZ.CODICONTRATO		
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA 
		AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA		
	) C, 
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
		(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
		((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND C.ID_ZAFRA = Z.ID_ZAFRA 
		AND S.ID_CENSO = @ID_CENSO	
	) B 
WHERE A.ID_MAESTRO = C.ID_MAESTRO 
	AND A.ID_MAESTRO = B.ID_MAESTRO
	AND NOT (B.TONEL_ENTREGADA &lt;= C.LIMITE_SUP AND B.TONEL_ENTREGADA &gt;= C.LIMITE_INF)
	AND(A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaZafra" GeneratorSourceName="FillPorLoteCompaZafra" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaZafra" UserSourceName="FillPorLoteCompaZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA 
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
		(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
		((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND C.ID_ZAFRA = Z.ID_ZAFRA 	
		AND S.ID_CENSO = @ID_CENSO	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA
		FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC
		WHERE L.CODICONTRATO = CZ.CODICONTRATO		
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA 
		AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA					
	) C ON A.ID_MAESTRO = C.ID_MAESTRO
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteCompaZafraEnRango" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteCompaZafraEnRango" GeneratorSourceName="FillPorLoteCompaZafraEnRango" GetMethodModifier="Public" GetMethodName="GetPorLoteCompaZafraEnRango" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteCompaZafraEnRango" UserSourceName="FillPorLoteCompaZafraEnRango">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		B.REND_CONTRATADO, 
		B.MZ_CONTRATADO, B.TC_MZ_CONTRATADO, B.TC_CONTRATADO, B.LBS_CONTRATADO, B.VALOR_CONTRATADO,
		B.MZ_ENTREGAR, B.TONEL_MZ_ENTREGAR, B.TONEL_ENTREGAR, B.LBS_ENTREGAR, B.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		B.MZ_CENSO, B.TONEL_MZ_CENSO, B.TONEL_CENSO, B.LBS_CENSO, B.VALOR_CENSO, 	
		B.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, B.FECHA_VERIFICACION, 	
		B.MZ_VAR, B.TC_MZ_VAR, B.TC_VAR, B.LBS_VAR, B.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, C.MZ_ZAFRA_COMPA, C.TC_MZ_ZAFRA_COMPA, C.TC_ZAFRA_COMPA
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A,
	(
		SELECT L.ID_MAESTRO, 
		ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, ISNULL(L.AREA,0) AS MZ_ZAFRA_COMPA, 
		ISNULL(L.TONELADAS,0) AS TC_MZ_ZAFRA_COMPA, ISNULL(L.TONEL_TC,0) AS TC_ZAFRA_COMPA,
		(L.TONEL_TC + (L.TONEL_TC * 0.2)) AS LIMITE_SUP, (L.TONEL_TC - (L.TONEL_TC * 0.2)) AS LIMITE_INF
		FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC
		WHERE L.CODICONTRATO = CZ.CODICONTRATO		
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND CZ.ID_ZAFRA = LC.ID_ZAFRA 
		AND CZ.ID_ZAFRA = @ID_ZAFRA_COMPA					
	) C, 
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
		(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
		((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR
		FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO			
		AND C.ID_ZAFRA = Z.ID_ZAFRA 
		AND S.ID_CENSO = @ID_CENSO	
	) B 
WHERE A.ID_MAESTRO = C.ID_MAESTRO 
	AND A.ID_MAESTRO = B.ID_MAESTRO
	AND (B.TONEL_ENTREGADA &lt;= C.LIMITE_SUP AND B.TONEL_ENTREGADA &gt;= C.LIMITE_INF)
	AND(A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="CODI_DEPTO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="CODI_DEPTO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="CODI_MUNI" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="CODI_MUNI" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="CODI_CANTON" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="CODI_CANTON" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.NOM_VARIEDAD AS VARIEDAD, B.REND_HISTO AS REND_COSECHA_ANT, B.EDAD_LOTE_ANT, INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA, C.TIPO_CANA, C.EDAD_LOTE FROM ( SELECT DISTINCT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, L.ACCESLOTE, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, L.CODILOTE AS CODILOTE, L.NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, L.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM LOTES L, MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR, ((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR, L.EDAD_LOTE AS EDAD_LOTE_ANT FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODICONTRATO = CZ.CODICONTRATO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ACCESLOTE = B.ACCESLOTE AND A.CODIPROVEEDOR = B.CODIPROVEEDOR LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, CASE WHEN L.TONEL_TC IS NULL OR L.TONEL_TC = 0 OR C.REND_HISTO IS NULL OR C.REND_HISTO = 0 THEN 0 ELSE C.REND_HISTO END AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, CASE WHEN C.TONEL_ENTREGADA = 0 THEN 0 ELSE C.REND_HISTO END AS REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, V.NOM_VARIEDAD, (SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA, (SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE, (CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE, (CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA, (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_TIPO) + '-' + (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_SUB_TIPO) AS TIPO_CANA, L.EDAD_LOTE FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z, VARIEDAD V WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND C.ID_ZAFRA = Z.ID_ZAFRA AND L.CODIVARIEDA = V.CODIVARIEDA AND S.ID_CENSO = @ID_CENSO ) C ON A.ACCESLOTE = C.ACCESLOTE AND A.CODIPROVEEDOR = C.CODIPROVEEDOR WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorLoteEstimacion" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorLoteEstimacion" GeneratorSourceName="FillPorLoteEstimacion" GetMethodModifier="Public" GetMethodName="GetPorLoteEstimacion" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorLoteEstimacion" UserSourceName="FillPorLoteEstimacion">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>/*
DECLARE
	@ID_ZAFRA_COMPA INT,
	@ID_CENSO INT,
	@CODIPROVEE VARCHAR(100),
	@ZONA VARCHAR(100),
	@SUB_ZONA VARCHAR(100),
	@CODI_DEPTO VARCHAR(100),
	@CODI_MUNI VARCHAR(100),
	@CODI_CANTON VARCHAR(100),
	@CODISOCIO VARCHAR(100)	

	SET @ID_ZAFRA_COMPA = 1
	SET @ID_CENSO = 6
	SET @CODIPROVEE = '' --'14159'
	SET @ZONA = ''
	SET @SUB_ZONA = ''
	SET @CODI_DEPTO = ''
	SET @CODI_MUNI = ''
	SET @CODI_CANTON = ''
	SET @CODISOCIO = ''
*/
SELECT 
 NOMBRE_ZAFRA,
 CODIPROVEEDOR, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODICONTRATO, 
 CODILOTE, NOMBLOTE, MAX(REND_CONTRATADO) AS REND_CONTRATADO, 
 SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, dbo.fDividir(SUM(TC_CONTRATADO), SUM(MZ_CONTRATADO)) as TC_MZ_CONTRATADO, SUM(TC_CONTRATADO) AS TC_CONTRATADO, 
 SUM(LBS_CONTRATADO) AS LBS_CONTRATADO, SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
 SUM(MZ_ENTREGAR) AS MZ_ENTREGAR,  dbo.fDividir(SUM(TONEL_ENTREGAR), SUM(MZ_ENTREGAR)) AS TONEL_MZ_ENTREGAR,
 SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR, SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR, 
 SUM(MZ_ENTREGADA) AS MZ_ENTREGADA,  dbo.fDividir(SUM(TONEL_ENTREGADA), SUM(MZ_ENTREGADA)) AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
 SUM(LBS_ENTREGADA) AS LBS_ENTREGADA, SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA, 
 SUM(MZ_CENSO) AS MZ_CENSO, dbo.fDividir(SUM(TONEL_CENSO), SUM(MZ_CENSO)) AS TONEL_MZ_CENSO, 
 SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO, SUM(VALOR_CENSO) AS VALOR_CENSO, 
 MAX(REND_HISTO) AS REND_HISTO, 0 AS CANT_LOTES, MAX(FECHA_VERIFICACION) AS FECHA_VERIFICACION, 
 SUM(MZ_VAR) AS	MZ_VAR, dbo.fDividir(SUM(TC_VAR), SUM(MZ_VAR)) AS TC_MZ_VAR, SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) TOTAL_VAR, 	
 DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO, NULL AS OBSERVACION, 
 SUM(MZ_ZAFRA_COMPA) AS MZ_ZAFRA_COMPA, dbo.fDividir(SUM(TC_ZAFRA_COMPA), SUM(MZ_ZAFRA_COMPA)) AS TC_MZ_ZAFRA_COMPA, 
 SUM(TC_ZAFRA_COMPA) AS TC_ZAFRA_COMPA, MAX(VARIEDAD) AS VARIEDAD, MAX(REND_COSECHA_ANT) AS REND_COSECHA_ANT, 
 MAX(EDAD_LOTE_ANT) AS EDAD_LOTE_ANT, (MAX(INICIO_COSECHA)) AS INICIO_COSECHA, 
 MAX(FIN_COSECHA) FIN_COSECHA, MAX(CANA_QUEMADA) AS CANA_QUEMADA, 
 MAX(CANA_VERDE) AS CANA_VERDE, MAX(ES_MADURANTE) AS ES_MADURANTE, MAX(ES_PRE_COSECHA) AS ES_PRE_COSECHA, 
 MAX(TIPO_CANA) AS TIPO_CANA, SUM(EDAD_LOTE) AS EDAD_LOTE
FROM (
		SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
				C.REND_CONTRATADO, 
				C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
				C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
				C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
				C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
				C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
				C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
				A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
				CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
				ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
				C.NOM_VARIEDAD AS VARIEDAD,
				B.REND_HISTO AS REND_COSECHA_ANT,
				B.EDAD_LOTE_ANT,
				INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA,
				C.TIPO_CANA, C.EDAD_LOTE
		FROM 
			(
				SELECT DISTINCT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, L.ACCESLOTE,
				dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
				NULL AS CODICONTRATO, L.CODILOTE AS CODILOTE, L.NOMBLOTE, 
				ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
				L.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
				ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
				FROM LOTES L, MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P	
				WHERE L.ID_MAESTRO = ML.ID_MAESTRO
				AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
				AND L.ZONA = Z.ZONA 
				AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
				AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
				AND ML.CODI_DEPTO = D.CODI_DEPTO
			) A LEFT OUTER JOIN
			(
				SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE,
				ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
				(LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
				LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR,			
				LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
				LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
				LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, 	
				(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
				(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR,
				((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR, L.EDAD_LOTE AS EDAD_LOTE_ANT
				FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z
				WHERE L.CODICONTRATO = CZ.CODICONTRATO		
				AND L.ACCESLOTE = LC.ACCESLOTE 
				AND CZ.ID_ZAFRA = LC.ID_ZAFRA 		
				AND CZ.ID_ZAFRA = Z.ID_ZAFRA 
				AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA
			) B ON A.ACCESLOTE = B.ACCESLOTE AND A.CODIPROVEEDOR = B.CODIPROVEEDOR
			LEFT OUTER JOIN
			(
				SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE,
				CASE 
				 WHEN  L.TONEL_TC IS NULL OR  L.TONEL_TC = 0 OR C.REND_HISTO IS NULL OR C.REND_HISTO = 0 THEN 0
				 ELSE C.REND_HISTO
				END AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
				(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
				C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,		
				C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
				C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
				CASE 
				 WHEN C.TONEL_ENTREGADA = 0 THEN 0
				 ELSE C.REND_HISTO
				END AS REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
				(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
				(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
				((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR,
				V.NOM_VARIEDAD,				
				(SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA,
				(SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA,
				(CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA,
				(CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE,
				(CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE,
				(CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA,		
				(SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_TIPO) + '-' + (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_SUB_TIPO) AS TIPO_CANA, 
				L.EDAD_LOTE
				FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z, VARIEDAD V
				WHERE L.ACCESLOTE = C.ACCESLOTE	
				AND C.ID_CENSO = S.ID_CENSO			
				AND C.ID_ZAFRA = Z.ID_ZAFRA 
				and L.CODIVARIEDA = V.CODIVARIEDA
				AND S.ID_CENSO = @ID_CENSO	
			) C ON A.ACCESLOTE = C.ACCESLOTE AND A.CODIPROVEEDOR = C.CODIPROVEEDOR
		WHERE (A.ZONA = @ZONA OR @ZONA = '')
			AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
			AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
			AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
			AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
) AS T
GROUP BY 
 NOMBRE_ZAFRA,
 CODIPROVEEDOR, CODIPROVEE, CODISOCIO, NOMBRE_PROVEEDOR, CODICONTRATO, 
 CODILOTE, NOMBLOTE, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.NOM_VARIEDAD AS VARIEDAD, B.REND_HISTO AS REND_COSECHA_ANT, B.EDAD_LOTE_ANT, INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA, C.TIPO_CANA, C.EDAD_LOTE FROM ( SELECT DISTINCT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, L.ACCESLOTE, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, L.CODILOTE AS CODILOTE, L.NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, L.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM LOTES L, MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR, ((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR, L.EDAD_LOTE AS EDAD_LOTE_ANT FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODICONTRATO = CZ.CODICONTRATO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ACCESLOTE = B.ACCESLOTE AND A.CODIPROVEEDOR = B.CODIPROVEEDOR LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, CASE WHEN L.TONEL_TC IS NULL OR L.TONEL_TC = 0 OR C.REND_HISTO IS NULL OR C.REND_HISTO = 0 THEN 0 ELSE C.REND_HISTO END AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, CASE WHEN C.TONEL_ENTREGADA = 0 THEN 0 ELSE C.REND_HISTO END AS REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, V.NOM_VARIEDAD, (SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA, (SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE, (CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE, (CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA, (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_TIPO) + '-' + (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_SUB_TIPO) AS TIPO_CANA, L.EDAD_LOTE FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z, VARIEDAD V WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND C.ID_ZAFRA = Z.ID_ZAFRA AND L.CODIVARIEDA = V.CODIVARIEDA AND S.ID_CENSO = @ID_CENSO ) C ON A.ACCESLOTE = C.ACCESLOTE AND A.CODIPROVEEDOR = C.CODIPROVEEDOR WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.NOM_VARIEDAD AS VARIEDAD, B.REND_HISTO AS REND_COSECHA_ANT, B.EDAD_LOTE_ANT, INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA, C.TIPO_CANA, C.EDAD_LOTE FROM ( SELECT DISTINCT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, L.ACCESLOTE, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, L.CODILOTE AS CODILOTE, L.NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, L.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM LOTES L, MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR, ((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR, L.EDAD_LOTE AS EDAD_LOTE_ANT FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODICONTRATO = CZ.CODICONTRATO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ACCESLOTE = B.ACCESLOTE AND A.CODIPROVEEDOR = B.CODIPROVEEDOR LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, CASE WHEN L.TONEL_TC IS NULL OR L.TONEL_TC = 0 OR C.REND_HISTO IS NULL OR C.REND_HISTO = 0 THEN 0 ELSE C.REND_HISTO END AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, CASE WHEN C.TONEL_ENTREGADA = 0 THEN 0 ELSE C.REND_HISTO END AS REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, V.NOM_VARIEDAD, (SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA, (SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE, (CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE, (CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA, (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_TIPO) + '-' + (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_SUB_TIPO) AS TIPO_CANA, L.EDAD_LOTE FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z, VARIEDAD V WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND C.ID_ZAFRA = Z.ID_ZAFRA AND L.CODIVARIEDA = V.CODIVARIEDA AND S.ID_CENSO = @ID_CENSO ) C ON A.ACCESLOTE = C.ACCESLOTE AND A.CODIPROVEEDOR = C.CODIPROVEEDOR WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.NOM_VARIEDAD AS VARIEDAD, B.REND_HISTO AS REND_COSECHA_ANT, B.EDAD_LOTE_ANT, INICIO_COSECHA, FIN_COSECHA, CANA_QUEMADA, CANA_VERDE, ES_MADURANTE, ES_PRE_COSECHA, C.TIPO_CANA, C.EDAD_LOTE FROM ( SELECT DISTINCT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, L.ACCESLOTE, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, L.CODILOTE AS CODILOTE, L.NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, L.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM LOTES L, MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE L.ID_MAESTRO = ML.ID_MAESTRO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, ISNULL(LC.REND_COSECHA,0) AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC) AS LBS_CONTRATADO, (LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, LC.LBS_ENTREGAR, LC.VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, GETDATE() AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, ((LC.REND_COSECHA * L.TONEL_TC) - LC.LBS_CENSO) AS LBS_VAR, ((LC.REND_COSECHA * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - LC.VALOR_CENSO) AS TOTAL_VAR, L.EDAD_LOTE AS EDAD_LOTE_ANT FROM LOTES L, CONTRATO_ZAFRAS CZ, LOTES_COSECHA LC, ZAFRA Z WHERE L.CODICONTRATO = CZ.CODICONTRATO AND L.ACCESLOTE = LC.ACCESLOTE AND CZ.ID_ZAFRA = LC.ID_ZAFRA AND CZ.ID_ZAFRA = Z.ID_ZAFRA AND Z.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ACCESLOTE = B.ACCESLOTE AND A.CODIPROVEEDOR = B.CODIPROVEEDOR LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, L.ACCESLOTE, CASE WHEN L.TONEL_TC IS NULL OR L.TONEL_TC = 0 OR C.REND_HISTO IS NULL OR C.REND_HISTO = 0 THEN 0 ELSE C.REND_HISTO END AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, CASE WHEN C.TONEL_ENTREGADA = 0 THEN 0 ELSE C.REND_HISTO END AS REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, V.NOM_VARIEDAD, (SELECT MIN(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS INICIO_COSECHA, (SELECT MAX(E.FECHA_CORTA) FROM ENVIO E, BASCULA B WHERE E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE) AS FIN_COSECHA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = S.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) &gt; 0 THEN 'S' ELSE 'N' END) AS CANA_QUEMADA, (CASE WHEN (SELECT COUNT(1) FROM ENVIO E WHERE E.ID_ZAFRA = C.ID_ZAFRA AND E.ACCESLOTE = L.ACCESLOTE AND E.ID_TIPO_CANA IN(27,43)) = 0 THEN 'S' ELSE 'N' END) AS CANA_VERDE, (CASE WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_MADURANTE, (CASE WHEN (SELECT COUNT(1) FROM ANALISIS_PRECOSECHA A WHERE A.ID_ZAFRA = S.ID_ZAFRA AND A.ACCESLOTE = L.ACCESLOTE AND NOT A.POL IS NULL) &gt; 0 THEN 'S' ELSE 'N' END) AS ES_PRE_COSECHA, (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_TIPO) + '-' + (SELECT LEFT(TG.NOM_TIPO,3) FROM TIPOS_GENERALES TG WHERE TG.ID_TIPO = V.ID_SUB_TIPO) AS TIPO_CANA, L.EDAD_LOTE FROM LOTES L, CENSO_LOTES C, CENSO S, ZAFRA Z, VARIEDAD V WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND C.ID_ZAFRA = Z.ID_ZAFRA AND L.CODIVARIEDA = V.CODIVARIEDA AND S.ID_CENSO = @ID_CENSO ) C ON A.ACCESLOTE = C.ACCESLOTE AND A.CODIPROVEEDOR = C.CODIPROVEEDOR WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaFabricaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaFabricaPorFecha" GeneratorSourceName="FillPorPlanCosechaFabricaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaFabricaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaFabricaPorFecha" UserSourceName="FillPorPlanCosechaFabricaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))
	AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) 
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaFabricaPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaFabricaPorLote" GeneratorSourceName="FillPorPlanCosechaFabricaPorLote" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaFabricaPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaFabricaPorLote" UserSourceName="FillPorPlanCosechaFabricaPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO, A.CODICANTON
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO,
		(ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))	
    AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')		
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO, A.CODICANTON FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO, (ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODICANTON FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorCanton" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorCanton" GeneratorSourceName="FillPorPlanCosechaPorCanton" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorCanton" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorCanton" UserSourceName="FillPorPlanCosechaPorCanton">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, SUB_ZONA, NOMBRE_DEPTO, NOMBRE_MUNI, NOMBRE_CANTON, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorFecha" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorFecha" GeneratorSourceName="FillPorPlanCosechaPorFecha" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorFecha" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorFecha" UserSourceName="FillPorPlanCosechaPorFecha">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE 
	(EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) 
	     OR (@USUARIO_CREA = ''))
	AND (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) 
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA1" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA2" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (EXISTS(SELECT 1 FROM FILTRO_CANTON FC WHERE FC.CODI_DEPTO = A.CODI_DEPTO AND FC.CODI_MUNI = A.CODI_MUNI AND FC.CODI_CANTON = A.CODI_CANTON AND FC.USUARIO_CREA = @USUARIO_CREA AND FC.FECHA_CREA = @FECHA_CREA) OR (@USUARIO_CREA = '')) AND (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (C.FECHA_ROZA_SH &gt;= @FECHA1 AND C.FECHA_ROZA_SH &lt;= @FECHA2) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHA_CREA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorLote" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorLote" GeneratorSourceName="FillPorPlanCosechaPorLote" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorLote" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorLote" UserSourceName="FillPorPlanCosechaPorLote">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT *
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		C.SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, C.VARIEDAD, C.TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, C.SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANA' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIA' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorSubZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorSubZona" GeneratorSourceName="FillPorPlanCosechaPorSubZona" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorSubZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorSubZona" UserSourceName="FillPorPlanCosechaPorSubZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, SUB_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, SUB_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorPlanCosechaPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorPlanCosechaPorZona" GeneratorSourceName="FillPorPlanCosechaPorZona" GetMethodModifier="Public" GetMethodName="GetPorPlanCosechaPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorPlanCosechaPorZona" UserSourceName="FillPorPlanCosechaPorZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT DESCRIP_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO, 
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE WHEN SUM(MZ_ENTREGADA) = 0 THEN 0 ELSE SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA) END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE WHEN SUM(MZ_CENSO) = 0 THEN 0 ELSE SUM(TONEL_CENSO)/SUM(MZ_CENSO) END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO
FROM(
SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE,
		C.REND_CONTRATADO, 
		C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO,
		C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, 
		B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, 	
		C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA,
		A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO,
		CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR)
		ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA,
		ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA,
		CASE 
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1
		ELSE C.SEMANA
		END AS SEMANA,
		CASE 
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0
		WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1
		ELSE C.CATORCENA
		END AS CATORCENA,	 
		CASE 
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1
		WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3
		ELSE C.TERCIO 
		END AS TERCIO,
		ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, 
		CASE 
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO'
		WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO'
		ELSE C.SUB_TERCIO 
		END AS SUB_TERCIO
FROM 
	(
		SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, 
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
		NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
		ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO,
		ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO
		FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P		
		WHERE ML.ZONA = Z.ZONA 
		AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO
		AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI 
		AND ML.CODI_DEPTO = D.CODI_DEPTO
		AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR		
	) A LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		0 AS TONEL_ENTREGAR, 
		0 AS LBS_ENTREGAR, 
		0 AS VALOR_ENTREGAR,		
		LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA,	
		LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, 	
		LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, 	
		(L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO
		FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC
		WHERE L.ACCESLOTE = LC.ACCESLOTE					
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND L.ACCESLOTE = LC.ACCESLOTE 
		AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA	
	) B ON A.ID_MAESTRO = B.ID_MAESTRO 
	LEFT OUTER JOIN
	(
		SELECT L.ID_MAESTRO, L.CODIPROVEEDOR,  
		0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 	
		0 AS MZ_ENTREGAR, 
		0 AS TONEL_MZ_ENTREGAR, 
		C.TONEL_ENTREGAR, 
		C.LBS_ENTREGAR, 
		C.VALOR_ENTREGAR,
		C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,	
		C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, 	
		C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, 	
		(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
		(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR,
		0 AS TOTAL_VAR,
		(V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
		(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO,
		(DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH,
		(SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA,
		(SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA,
		(SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO,
		(SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO,
		(SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, 
		(SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO,		 
		(SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO,
		(SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN,
		V.CODIVARIEDA
		FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC 
		WHERE L.ACCESLOTE = C.ACCESLOTE		
		AND C.ID_CENSO = S.ID_CENSO		
		AND L.CODIVARIEDA = V.CODIVARIEDA	
		AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA
		AND S.ID_CENSO = @ID_CENSO
	) C ON A.ID_MAESTRO = C.ID_MAESTRO	
WHERE (A.ZONA = @ZONA OR @ZONA = '')
	AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
	AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
	AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
	AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '')
	AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1)	
	AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1)	
	AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')
) T
WHERE (SEMANA = @SEMANA OR @SEMANA = -1)
AND (CATORCENA = @CATORCENA OR @CATORCENA = -1)
AND (SUB_TERCIO = @SUB_TERCIO OR @SUB_TERCIO = '')
AND (TERCIO = @TERCIO OR @TERCIO = -1)

GROUP BY DESCRIP_ZONA, VARIEDAD, TIPO, TERCIO, SUB_TIPO_CANA, SUB_TERCIO </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="SEMANA" ColumnName="SEMANA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SEMANA" Precision="0" Scale="0" Size="1024" SourceColumn="SEMANA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CATORCENA" ColumnName="CATORCENA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@CATORCENA" Precision="0" Scale="0" Size="1024" SourceColumn="CATORCENA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUB_TERCIO" ColumnName="SUB_TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@SUB_TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="SUB_TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="TERCIO" ColumnName="TERCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="Object" Direction="Input" ParameterName="@TERCIO" Precision="0" Scale="0" Size="1024" SourceColumn="TERCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="varchar(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" Scale="0" Size="1024" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" Scale="0" Size="1024" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODIVARIEDA" ColumnName="" DataSourceName="" DataTypeServer="char(3)" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" Scale="0" Size="3" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_SUB_TIPO_CANA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SUB_TIPO_CANA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="NOMBRE_PROVEEDOR" DataSourceName="SELECT A.NOMBRE_ZAFRA, A.CODIPROVEEDOR, A.CODIPROVEE, A.CODISOCIO, A.NOMBRE_PROVEEDOR, A.CODICONTRATO, A.CODILOTE, A.NOMBLOTE, C.REND_CONTRATADO, C.MZ_CONTRATADO, C.TC_MZ_CONTRATADO, C.TC_CONTRATADO, C.LBS_CONTRATADO, C.VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, B.MZ_ENTREGADA, B.TONEL_MZ_ENTREGADA, B.TONEL_ENTREGADA, B.LBS_ENTREGADA, B.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, '' AS ACCESLOTE, C.FECHA_VERIFICACION, C.MZ_VAR, C.TC_MZ_VAR, C.TC_VAR, C.LBS_VAR, C.TOTAL_VAR, A.DESCRIP_ZONA, A.SUB_ZONA, A.NOMBRE_CANTON, A.NOMBRE_MUNI, A.NOMBRE_DEPTO, CASE WHEN A.CODIPROVEEDOR &lt;&gt; B.CODIPROVEEDOR THEN (SELECT RTRIM(ISNULL(R.NOMBRES,'')) + RTRIM(ISNULL(R.APELLIDOS,'')) FROM PROVEEDOR R WHERE R.CODIPROVEEDOR = B.CODIPROVEEDOR) ELSE '' END AS OBSERVACION, B.MZ_ENTREGADA AS MZ_ZAFRA_COMPA, B.TONEL_MZ_ENTREGADA AS TC_MZ_ZAFRA_COMPA, B.TONEL_ENTREGADA AS TC_ZAFRA_COMPA, ISNULL(C.VARIEDAD,B.VARIEDAD) AS VARIEDAD, ISNULL(C.TIPO,B.TIPO) AS TIPO, C.FECHA_ROZA AS FECHA_COSECHA, CASE WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.SEMANA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.SEMANA_FIN_CICLO + 1 ELSE C.SEMANA END AS SEMANA, CASE WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 0 WHEN C.CATORCENA IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN C.CATORCENA_FIN + 1 ELSE C.CATORCENA END AS CATORCENA, CASE WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 1 WHEN C.TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 3 ELSE C.TERCIO END AS TERCIO, ISNULL(C.SUB_TIPO_CANA,B.SUB_TIPO_CANA) AS SUB_TIPO_CANA, CASE WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &lt; C.FEC_INI_CICLO THEN 'TEMPRANO' WHEN C.SUB_TERCIO IS NULL AND C.FECHA_ROZA_SH &gt; C.FEC_FIN_CICLO THEN 'TARDIO' ELSE C.SUB_TERCIO END AS SUB_TERCIO FROM ( SELECT '' AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, ML.ID_MAESTRO, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, NULL AS CODICONTRATO, ML.CODILOTE_COMER AS CODILOTE, ML.NOMBRE_COMER AS NOMBLOTE, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, ML.ZONA, Z.DESCRIP_ZONA, ML.SUB_ZONA, C.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO, ML.CODI_CANTON, ML.CODI_MUNI, ML.CODI_DEPTO FROM MAESTRO_LOTES ML, ZONAS Z, DEPARTAMENTO D, MUNICIPIO M, CANTON C, PROVEEDOR P WHERE ML.ZONA = Z.ZONA AND ML.CODI_CANTON = C.CODI_CANTON AND ML.CODI_MUNI = C.CODI_MUNI AND ML.CODI_DEPTO = C.CODI_DEPTO AND ML.CODI_DEPTO = M.CODI_DEPTO AND ML.CODI_MUNI = M.CODI_MUNI AND ML.CODI_DEPTO = D.CODI_DEPTO AND ML.CODIPROVEEDOR = P.CODIPROVEEDOR ) A LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, 0 AS TONEL_ENTREGAR, 0 AS LBS_ENTREGAR, 0 AS VALOR_ENTREGAR, LC.MZ_ENTREGADA, LC.TONEL_MZ_ENTREGADA, LC.TONEL_ENTREGADA, LC.LBS_ENTREGADA, LC.VALOR_ENTREGADA, LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.LBS_CENSO, LC.VALOR_CENSO, LC.REND_COSECHA AS REND_HISTO, 0 AS CANT_LOTES, NULL AS FECHA_VERIFICACION, (L.AREA - LC.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - LC.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - LC.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO FROM LOTES L, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = LC.ACCESLOTE AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = @ID_ZAFRA_COMPA ) B ON A.ID_MAESTRO = B.ID_MAESTRO LEFT OUTER JOIN ( SELECT L.ID_MAESTRO, L.CODIPROVEEDOR, 0 AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 0 AS LBS_CONTRATADO, 0 AS VALOR_CONTRATADO, 0 AS MZ_ENTREGAR, 0 AS TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, 0 AS CANT_LOTES, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, 0 AS LBS_VAR, 0 AS TOTAL_VAR, (V.NOM_VARIEDAD) AS VARIEDAD, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, (SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_SUB_TIPO) AS SUB_TIPO_CANA, V.ID_TIPO, V.ID_SUB_TIPO, (DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS FECHA_ROZA, CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AS FECHA_ROZA_SH, (SELECT CP.SEMANA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SEMANA, (SELECT CP.CATORCENA FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA, (SELECT CP.TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS TERCIO, (SELECT CP.SUB_TERCIO FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.FECHA = CAST((DATEADD(HOUR,@HORAS_AJUSTE,C.FECHA_ROZA)) AS DATE) AND CP.ID_CICLO = @ID_CICLO) AS SUB_TERCIO, (SELECT MIN(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_INI_CICLO, (SELECT MAX(CP.FECHA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS FEC_FIN_CICLO, (SELECT MAX(CP.SEMANA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS SEMANA_FIN_CICLO, (SELECT MAX(CP.CATORCENA) FROM CICLO CI, CICLO_PERIODO CP WHERE CI.ID_ZAFRA = C.ID_ZAFRA AND CI.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = @ID_CICLO) AS CATORCENA_FIN, V.CODIVARIEDA FROM LOTES L, CENSO_LOTES C, CENSO S, VARIEDAD V, LOTES_COSECHA LC WHERE L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND L.CODIVARIEDA = V.CODIVARIEDA AND L.ACCESLOTE = LC.ACCESLOTE AND LC.ID_ZAFRA = S.ID_ZAFRA AND S.ID_CENSO = @ID_CENSO ) C ON A.ID_MAESTRO = C.ID_MAESTRO WHERE (A.ZONA = @ZONA OR @ZONA = '') AND (A.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((A.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (A.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (A.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = '')) AND (A.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '') AND (A.CODISOCIO = @CODISOCIO OR @CODISOCIO = '') AND (C.CODIVARIEDA = @CODIVARIEDA OR @CODIVARIEDA = '') AND (C.ID_TIPO = @ID_TIPO_CANA OR @ID_TIPO_CANA = -1) AND (C.ID_SUB_TIPO = @ID_SUB_TIPO_CANA OR @ID_SUB_TIPO_CANA = -1) AND (A.NOMBRE_PROVEEDOR LIKE '%'+ @NOMBRE_PROVEEDOR + '%')" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="NOMBRE_PROVEEDOR" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA_COMPA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA_COMPA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="HORAS_AJUSTE" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@HORAS_AJUSTE" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CICLO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CICLO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZona" GeneratorSourceName="FillPorZona" GetMethodModifier="Public" GetMethodName="GetPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZona" UserSourceName="FillPorZona">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA	
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY NOMBRE_ZAFRA, FECHA_VERIFICACION, DESCRIP_ZONA, CODICONTRATO, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaCierreZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCierreZafra" GeneratorSourceName="FillPorZonaCierreZafra" GetMethodModifier="Public" GetMethodName="GetPorZonaCierreZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCierreZafra" UserSourceName="FillPorZonaCierreZafra">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY NOMBRE_ZAFRA, FECHA_VERIFICACION, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZonaCierreZafraSdoEnt" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCierreZafraSdoEnt" GeneratorSourceName="FillPorZonaCierreZafraSdoEnt" GetMethodModifier="Public" GetMethodName="GetPorZonaCierreZafraSdoEnt" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCierreZafraSdoEnt" UserSourceName="FillPorZonaCierreZafraSdoEnt">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	NOMBRE_ZAFRA, '' AS CODIPROVEEDOR, '' AS CODIPROVEE, '' AS CODISOCIO,
	'' AS NOMBRE_PROVEEDOR, CODICONTRATO, '' AS CODILOTE, '' AS NOMBLOTE,
	SUM(REND_CONTRATADO * TC_CONTRATADO)/SUM(TC_CONTRATADO) AS REND_CONTRATADO, 
	SUM(MZ_CONTRATADO) AS MZ_CONTRATADO, 
	CASE 
	WHEN SUM(MZ_CONTRATADO) &gt; 0 THEN SUM(TC_CONTRATADO)/SUM(MZ_CONTRATADO)
	ELSE 0
	END AS TC_MZ_CONTRATADO,
	SUM(TC_CONTRATADO) AS TC_CONTRATADO, SUM(LBS_CONTRATADO) AS LBS_CONTRATADO,
	SUM(VALOR_CONTRATADO) AS VALOR_CONTRATADO, 
	SUM(MZ_ENTREGAR) AS MZ_ENTREGAR, 
	CASE 
	WHEN SUM(MZ_ENTREGAR) &gt; 0 THEN SUM(TONEL_ENTREGAR)/SUM(MZ_ENTREGAR)
	ELSE 0
	END AS TONEL_MZ_ENTREGAR, SUM(TONEL_ENTREGAR) AS TONEL_ENTREGAR, SUM(LBS_ENTREGAR) AS LBS_ENTREGAR,
	SUM(VALOR_ENTREGAR) AS VALOR_ENTREGAR,
	SUM(MZ_ENTREGADA) AS MZ_ENTREGADA, 
	CASE 
	WHEN SUM(MZ_ENTREGADA) &gt; 0 THEN SUM(TONEL_ENTREGADA)/SUM(MZ_ENTREGADA)
	ELSE 0
	END AS TONEL_MZ_ENTREGADA, SUM(TONEL_ENTREGADA) AS TONEL_ENTREGADA, SUM(LBS_ENTREGADA) AS LBS_ENTREGADA,
	SUM(VALOR_ENTREGADA) AS VALOR_ENTREGADA,
	SUM(MZ_CENSO) AS MZ_CENSO, 
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TONEL_CENSO)/SUM(MZ_CENSO)
	ELSE 0
	END AS TONEL_MZ_CENSO, SUM(TONEL_CENSO) AS TONEL_CENSO, SUM(LBS_CENSO) AS LBS_CENSO,
	SUM(VALOR_CENSO) AS VALOR_CENSO, 
	CASE
	WHEN SUM(TONEL_CENSO) &gt; 0 THEN SUM(REND_HISTO * TONEL_CENSO)/SUM(TONEL_CENSO)
	ELSE 0
	END AS REND_HISTO,
	COUNT(CODILOTE) AS CANT_LOTES, NULL AS ACCESLOTE, FECHA_VERIFICACION,
	SUM(MZ_VAR) AS MZ_VAR,
	CASE 
	WHEN SUM(MZ_CENSO) &gt; 0 THEN SUM(TC_VAR)/SUM(MZ_CENSO)
	ELSE 0
	END AS TC_MZ_VAR, 
	SUM(TC_VAR) AS TC_VAR, SUM(LBS_VAR) AS LBS_VAR, SUM(TOTAL_VAR) AS TOTAL_VAR, DESCRIP_ZONA, COUNT(DISTINCT CODICONTRATO) AS CANT_CONTRATOS,
	SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO 
FROM (
	SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO,
	L.CODILOTE, L.NOMBLOTE, 
	C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, 
	(C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, 	
	C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR,
	C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA,
	C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION,
	(L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR,
	(L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR,
	((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA,
	L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO 
	FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D
	WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR
	AND L.ACCESLOTE = C.ACCESLOTE
	AND C.ID_CENSO = S.ID_CENSO
	AND S.ID_ZAFRA = Z.ID_ZAFRA
	AND L.ZONA = N.ZONA 
		AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO
		AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI 
		AND M.CODI_DEPTO = D.CODI_DEPTO
	AND S.ID_CENSO = @ID_CENSO
	AND (L.ZONA = @ZONA OR @ZONA = '')
	AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '')
	AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))
) T
GROUP BY NOMBRE_ZAFRA, FECHA_VERIFICACION, CODICONTRATO, DESCRIP_ZONA, SUB_ZONA, NOMBRE_CANTON, NOMBRE_MUNI, NOMBRE_DEPTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CENSO" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="ZONA" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="SUB_ZONA" ColumnName="SUB_ZONA" DataSourceName="SELECT Z.NOMBRE_ZAFRA, L.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR, dbo.QuitarFormatoCODICONTRATO(L.CODICONTRATO) AS CODICONTRATO, L.CODILOTE, L.NOMBLOTE, C.REND_HISTO AS REND_CONTRATADO, L.AREA AS MZ_CONTRATADO, L.TONELADAS AS TC_MZ_CONTRATADO, L.TONEL_TC AS TC_CONTRATADO, (C.REND_HISTO * L.TONEL_TC) AS LBS_CONTRATADO, (C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) AS VALOR_CONTRATADO, C.MZ_ENTREGAR, C.TONEL_MZ_ENTREGAR, C.TONEL_ENTREGAR, C.LBS_ENTREGAR, C.VALOR_ENTREGAR, C.MZ_ENTREGADA, C.TONEL_MZ_ENTREGADA, C.TONEL_ENTREGADA, C.LBS_ENTREGADA, C.VALOR_ENTREGADA, C.MZ_CENSO, C.TONEL_MZ_CENSO, C.TONEL_CENSO, C.LBS_CENSO, C.VALOR_CENSO, C.REND_HISTO, C.FECHA_VERIFICACION, (L.AREA - C.MZ_CENSO) AS MZ_VAR, (L.TONELADAS - C.TONEL_MZ_CENSO) AS TC_MZ_VAR, (L.TONEL_TC - C.TONEL_CENSO) AS TC_VAR, ((C.REND_HISTO * L.TONEL_TC) - C.LBS_CENSO) AS LBS_VAR, ((C.REND_HISTO * L.TONEL_TC * Z.PRECIO_LIBRA_AZUCAR) - C.VALOR_CENSO) AS TOTAL_VAR, N.DESCRIP_ZONA, L.SUB_ZONA, T.NOMBRE_CANTON, M.NOMBRE_MUNI, D.NOMBRE_DEPTO FROM LOTES L, PROVEEDOR P, CENSO_LOTES C, CENSO S, ZAFRA Z, ZONAS N, MAESTRO_LOTES ML, CANTON T, MUNICIPIO M, DEPARTAMENTO D WHERE L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ACCESLOTE = C.ACCESLOTE AND C.ID_CENSO = S.ID_CENSO AND S.ID_ZAFRA = Z.ID_ZAFRA AND L.ZONA = N.ZONA AND L.ID_MAESTRO = ML.ID_MAESTRO AND ML.CODI_CANTON = T.CODI_CANTON AND ML.CODI_MUNI = T.CODI_MUNI AND ML.CODI_DEPTO = T.CODI_DEPTO AND T.CODI_DEPTO = M.CODI_DEPTO AND T.CODI_MUNI = M.CODI_MUNI AND M.CODI_DEPTO = D.CODI_DEPTO AND S.ID_CENSO = @ID_CENSO AND (L.ZONA = @ZONA OR @ZONA = '') AND (L.SUB_ZONA = @SUB_ZONA OR @SUB_ZONA = '') AND ((ML.CODI_DEPTO = @CODI_DEPTO OR @CODI_DEPTO = '') AND (ML.CODI_MUNI = @CODI_MUNI OR @CODI_MUNI = '') AND (ML.CODI_CANTON = @CODI_CANTON OR @CODI_CANTON = ''))" DataTypeServer="varchar(6)" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" Scale="0" Size="6" SourceColumn="SUB_ZONA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_DEPTO" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_MUNI" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODI_CANTON" ColumnName="" DataSourceName="" DataTypeServer="char(2)" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" Scale="0" Size="2" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ORDEN_ROZA_COSECHATableAdapter" GeneratorDataComponentClassName="ORDEN_ROZA_COSECHATableAdapter" Name="ORDEN_ROZA_COSECHA" UserDataComponentName="ORDEN_ROZA_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT T.*, (SELECT MIN(CP.FECHA) FROM CICLO_PERIODO CP WHERE CP.CATORCENA = T.CATORCENA AND CP.ID_CICLO = 2) AS FECHA_INI_CATORCENA, (SELECT MAX(CP.FECHA) FROM CICLO_PERIODO CP WHERE CP.CATORCENA = T.CATORCENA AND CP.ID_CICLO = 2) AS FECHA_FIN_CATORCENA FROM ( SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = PC.ID_ZAFRA) AS ZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR, (SELECT CP.CATORCENA FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_ZAFRA = PC.ID_ZAFRA AND C.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2 AND CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA, PC.FECHA_INI_COSECHA, PC.CUOTA_DIARIA, C.NO_CONTRATO, L.ZONA, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD, L.EDAD_LOTE, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, dbo.QuitarFormatoCODIAGRON(LC.CODIAGRON) AS CODIAGRON, (SELECT RTRIM(A.NOMBRE_AGRONOMO) + ' ' + RTRIM(A.NOMBRE_AGRONOMO) FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO, PC.FECHA_CREA, LC.FECHA_ROZA FROM PLAN_COSECHA PC, LOTES L, LOTES_COSECHA LC, CONTRATO C, PROVEEDOR P, MAESTRO_LOTES ML WHERE PC.ACCESLOTE = LC.ACCESLOTE AND PC.ID_ZAFRA = LC.ID_ZAFRA AND PC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ID_MAESTRO = ML.ID_MAESTRO AND PC.ID_PLAN_COSECHA = -1 ) T" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.*, 
CAST(DAY(FECHA_INI_CATORCENA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_INI_CATORCENA)) AS SFECHA_INI_CAT,
CAST(DAY(FECHA_FIN_CATORCENA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_FIN_CATORCENA)) AS SFECHA_FIN_CAT,
CAST(DAY(FECHA_CREA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_CREA)) AS SFECHA_CREA,
CAST(DAY(FECHA_INI_COSECHA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_INI_COSECHA)) AS SFECHA_INI_COSECHA
FROM (
	SELECT T.*,
		(SELECT MIN(CP.FECHA) FROM CICLO_PERIODO CP WHERE CP.CATORCENA = T.CATORCENA AND CP.ID_CICLO = 2) AS FECHA_INI_CATORCENA,
		(SELECT MAX(CP.FECHA) FROM CICLO_PERIODO CP WHERE CP.CATORCENA = T.CATORCENA AND CP.ID_CICLO = 2) AS FECHA_FIN_CATORCENA
	FROM (
		SELECT 
		(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = PC.ID_ZAFRA) AS ZAFRA,
					  P.CODIPROVEEDOR,
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, 
		dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR,		
		(SELECT CP.CATORCENA FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_ZAFRA = PC.ID_ZAFRA AND C.ID_CICLO = CP.ID_CICLO AND CP.ID_CICLO = 2 AND CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA,
		PC.FECHA_INI_COSECHA, PC.CUOTA_DIARIA, C.NO_CONTRATO, L.ZONA, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA,
		(SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
		L.EDAD_LOTE, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, dbo.QuitarFormatoCODIAGRON(LC.CODIAGRON) AS CODIAGRON, 
		(SELECT RTRIM(A.NOMBRE_AGRONOMO) + ' ' + RTRIM(A.NOMBRE_AGRONOMO) FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO,
		PC.FECHA_CREA, LC.FECHA_ROZA
		FROM PLAN_COSECHA PC, LOTES L, LOTES_COSECHA LC, CONTRATO C, PROVEEDOR P, MAESTRO_LOTES ML
		WHERE PC.ACCESLOTE = LC.ACCESLOTE
		AND PC.ID_ZAFRA = LC.ID_ZAFRA
		AND PC.ACCESLOTE = L.ACCESLOTE
		AND L.CODICONTRATO = C.CODICONTRATO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND PC.ID_PLAN_COSECHA = -1
	) T
) A
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="FECHA_INI_COSECHA" DataSetColumn="FECHA_INI_COSECHA" />
              <Mapping SourceColumn="CUOTA_DIARIA" DataSetColumn="CUOTA_DIARIA" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODIVARIEDA" DataSetColumn="CODIVARIEDA" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="PROCEDENCIA" DataSetColumn="PROCEDENCIA" />
              <Mapping SourceColumn="CODIAGRON" DataSetColumn="CODIAGRON" />
              <Mapping SourceColumn="AGRONOMO" DataSetColumn="AGRONOMO" />
              <Mapping SourceColumn="FECHA_CREA" DataSetColumn="FECHA_CREA" />
              <Mapping SourceColumn="FECHA_INI_CATORCENA" DataSetColumn="FECHA_INI_CATORCENA" />
              <Mapping SourceColumn="FECHA_FIN_CATORCENA" DataSetColumn="FECHA_FIN_CATORCENA" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="SFECHA_INI_CAT" DataSetColumn="SFECHA_INI_CAT" />
              <Mapping SourceColumn="SFECHA_FIN_CAT" DataSetColumn="SFECHA_FIN_CAT" />
              <Mapping SourceColumn="SFECHA_CREA" DataSetColumn="SFECHA_CREA" />
              <Mapping SourceColumn="SFECHA_INI_COSECHA" DataSetColumn="SFECHA_INI_COSECHA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="SELECT T.*, (SELECT MIN(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_INI_CATORCENA, (SELECT MAX(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_FIN_CATORCENA FROM ( SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = PC.ID_ZAFRA) AS ZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR, (SELECT CP.CATORCENA FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_ZAFRA = PC.ID_ZAFRA AND C.ID_CICLO = CP.ID_CICLO AND CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA, PC.FECHA_INI_COSECHA, PC.CUOTA_DIARIA, C.NO_CONTRATO, L.ZONA, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD, L.EDAD_LOTE, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, dbo.QuitarFormatoCODIAGRON(LC.CODIAGRON) AS CODIAGRON, (SELECT RTRIM(A.APELLIDO_AGRONOMO) FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO, PC.FECHA_CREA, LC.FECHA_ROZA FROM PLAN_COSECHA PC, LOTES L, LOTES_COSECHA LC, CONTRATO C, PROVEEDOR P, MAESTRO_LOTES ML WHERE PC.ACCESLOTE = LC.ACCESLOTE AND PC.ID_ZAFRA = LC.ID_ZAFRA AND PC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ID_MAESTRO = ML.ID_MAESTRO AND PC.ID_ZAFRA = @ID_ZAFRA AND EXISTS(SELECT 1 FROM FILTRO_ORDEN_ROZA F WHERE F.USUARIO_CREA = @USUARIO_CREA AND F.FECHA_CREA = @FECHA_CREA AND F.ID_PLAN_COSECHA = PC.ID_PLAN_COSECHA) ) T" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorZafraFiltro" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafraFiltro" GeneratorSourceName="FillPorZafraFiltro" GetMethodModifier="Public" GetMethodName="GetPorZafraFiltro" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafraFiltro" UserSourceName="FillPorZafraFiltro">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT A.*, 
CAST(DAY(FECHA_INI_CATORCENA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_INI_CATORCENA)) AS SFECHA_INI_CAT,
CAST(DAY(FECHA_FIN_CATORCENA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_FIN_CATORCENA)) AS SFECHA_FIN_CAT,
CAST(DAY(FECHA_CREA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_CREA)) AS SFECHA_CREA,
CAST(DAY(FECHA_INI_COSECHA) AS VARCHAR) + ' DE ' + dbo.NombreMes(MONTH(FECHA_INI_COSECHA)) AS SFECHA_INI_COSECHA
FROM (
	SELECT T.*,
		(SELECT MIN(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_INI_CATORCENA,
		(SELECT MAX(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_FIN_CATORCENA
	FROM (
		SELECT 
		(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = PC.ID_ZAFRA) AS ZAFRA,
					  P.CODIPROVEEDOR,
		dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, 
		dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, 
		ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR,		
		(SELECT CP.CATORCENA FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_ZAFRA = PC.ID_ZAFRA AND C.ID_CICLO = CP.ID_CICLO AND CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA,
		PC.FECHA_INI_COSECHA, PC.CUOTA_DIARIA, C.NO_CONTRATO, L.ZONA, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA,
		(SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
		L.EDAD_LOTE, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, dbo.QuitarFormatoCODIAGRON(LC.CODIAGRON) AS CODIAGRON, 
		(SELECT RTRIM(A.APELLIDO_AGRONOMO) FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO,
		PC.FECHA_CREA, LC.FECHA_ROZA
		FROM PLAN_COSECHA PC, LOTES L, LOTES_COSECHA LC, CONTRATO C, PROVEEDOR P, MAESTRO_LOTES ML
		WHERE PC.ACCESLOTE = LC.ACCESLOTE
		AND PC.ID_ZAFRA = LC.ID_ZAFRA
		AND PC.ACCESLOTE = L.ACCESLOTE
		AND L.CODICONTRATO = C.CODICONTRATO
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND L.ID_MAESTRO = ML.ID_MAESTRO
		AND PC.ID_ZAFRA = @ID_ZAFRA
		AND EXISTS(SELECT 1 FROM FILTRO_ORDEN_ROZA F WHERE F.USUARIO_CREA = @USUARIO_CREA AND F.FECHA_CREA = @FECHA_CREA AND F.ID_PLAN_COSECHA = PC.ID_PLAN_COSECHA)
	) T
) A</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="USUARIO_CREA" ColumnName="" DataSourceName="" DataTypeServer="varchar(100)" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" Scale="0" Size="100" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_CREA" ColumnName="FECHA_CREA" DataSourceName="SELECT T.*, (SELECT MIN(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_INI_CATORCENA, (SELECT MAX(CP.FECHA) FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_CICLO = CP.ID_CICLO AND CP.CATORCENA = T.CATORCENA AND C.ID_ZAFRA = @ID_ZAFRA) AS FECHA_FIN_CATORCENA FROM ( SELECT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = PC.ID_ZAFRA) AS ZAFRA, P.CODIPROVEEDOR, dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR, (SELECT CP.CATORCENA FROM CICLO C, CICLO_PERIODO CP WHERE C.ID_ZAFRA = PC.ID_ZAFRA AND C.ID_CICLO = CP.ID_CICLO AND CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA, PC.FECHA_INI_COSECHA, PC.CUOTA_DIARIA, C.NO_CONTRATO, L.ZONA, L.CODILOTE, L.NOMBLOTE, L.CODIVARIEDA, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD, L.EDAD_LOTE, (SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, dbo.QuitarFormatoCODIAGRON(LC.CODIAGRON) AS CODIAGRON, (SELECT RTRIM(A.APELLIDO_AGRONOMO) FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO, PC.FECHA_CREA, LC.FECHA_ROZA FROM PLAN_COSECHA PC, LOTES L, LOTES_COSECHA LC, CONTRATO C, PROVEEDOR P, MAESTRO_LOTES ML WHERE PC.ACCESLOTE = LC.ACCESLOTE AND PC.ID_ZAFRA = LC.ID_ZAFRA AND PC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = C.CODICONTRATO AND L.CODIPROVEEDOR = P.CODIPROVEEDOR AND L.ID_MAESTRO = ML.ID_MAESTRO AND PC.ID_ZAFRA = @ID_ZAFRA AND EXISTS(SELECT 1 FROM FILTRO_ORDEN_ROZA F WHERE F.USUARIO_CREA = @USUARIO_CREA AND F.FECHA_CREA = @FECHA_CREA AND F.ID_PLAN_COSECHA = PC.ID_PLAN_COSECHA) ) T" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="0" Scale="0" Size="8" SourceColumn="FECHA_CREA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PROFORMATableAdapter" GeneratorDataComponentClassName="PROFORMATableAdapter" Name="PROFORMA" UserDataComponentName="PROFORMATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
F.ID_PROFORMA, F.NOPROFORMA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = F.ID_ZAFRA) AS ZAFRA,
(SELECT C.NO_CONTRATO FROM CONTRATO C WHERE C.CODICONTRATO = L.CODICONTRATO) AS NO_CONTRATO,
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
L.CODILOTE, L.NOMBLOTE, F.CODTRANSPORT,
T.NOMBRES + ' ' + ISNULL(T.APELLIDOS,'') AS NOMBRE_TRANSPORTISTA,
CASE
WHEN F.TRANSPORTE_PROPIO = 1 THEN 'X'
ELSE NULL
END AS TRANSPORTE_PROPIO,
CASE
WHEN F.TRANSPORTE_PROPIO = 0 THEN 'X'
ELSE NULL
END AS TRANSPORTE_PARTICULAR,
F.PLACAVEHIC, F.NOMBRES_MOTORISTA, 
F.ID_CARGADORA, (SELECT C.NOMBRE FROM CARGADORA C WHERE C.ID_CARGADORA = F.ID_CARGADORA) AS CARGADORA,
F.ID_CARGADOR, (SELECT C.NOMBRE_CARGADOR FROM CARGADOR C WHERE C.ID_CARGADOR = F.ID_CARGADOR) AS CARGADOR,
(SELECT P.NOMBRE_PRODUCTO FROM PRODUCTO P WHERE P.ID_PRODUCTO = F.ID_PRODUCTO) AS NOMBRE_MADURANTE,
CASE 
WHEN F.QUEMAPROG = 1 THEN 'X'
ELSE NULL
END AS QUEMAPROG,
CASE 
WHEN F.QUEMANOPROG = 1 THEN 'X'
ELSE NULL
END AS QUEMANOPROG,
CASE 
WHEN F.CANA_VERDE = 1 THEN 'X'
ELSE NULL
END AS CANA_VERDE,
CASE 
WHEN F.FIN_LOTE = 1 THEN 'X'
ELSE NULL
END AS FIN_LOTE, F.ID_PROVEEDOR_ROZA, F.ID_SUPERVISOR, 
(SELECT S.NOMBRE_SUPERVISOR FROM SUPERVISOR S WHERE S.ID_SUPERVISOR = F.ID_SUPERVISOR) AS CHEQUERO,
(CASE 
WHEN F.ID_TIPO_CANA = 16 THEN 'X'
ELSE NULL
END) AS CANA_CORTA,
(CASE 
WHEN F.ID_TIPO_CANA = 17 THEN 'X'
ELSE NULL
END) AS CANA_PICADA,
(CASE 
WHEN F.ID_TIPO_CANA = 18 THEN 'X'
ELSE NULL
END) AS CANA_LARGA,
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 19) AS CAMION,  
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 20) AS RASTRA,
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 21) AS _3EJES,
CAST(F.FECHA_CREA AS DATE) AS FECHA_EMISION, F.FECHA_MADURANTE
FROM PROFORMA F, LOTES L, PROVEEDOR P, TRANSPORTISTA T
WHERE F.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND F.CODTRANSPORT = T.CODTRANSPORT
AND F.ID_PROFORMA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_PROFORMA" DataSetColumn="ID_PROFORMA" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODTRANSPORT" DataSetColumn="CODTRANSPORT" />
              <Mapping SourceColumn="NOMBRE_TRANSPORTISTA" DataSetColumn="NOMBRE_TRANSPORTISTA" />
              <Mapping SourceColumn="TRANSPORTE_PROPIO" DataSetColumn="TRANSPORTE_PROPIO" />
              <Mapping SourceColumn="TRANSPORTE_PARTICULAR" DataSetColumn="TRANSPORTE_PARTICULAR" />
              <Mapping SourceColumn="PLACAVEHIC" DataSetColumn="PLACAVEHIC" />
              <Mapping SourceColumn="NOMBRES_MOTORISTA" DataSetColumn="NOMBRES_MOTORISTA" />
              <Mapping SourceColumn="ID_CARGADORA" DataSetColumn="ID_CARGADORA" />
              <Mapping SourceColumn="CARGADORA" DataSetColumn="CARGADORA" />
              <Mapping SourceColumn="ID_CARGADOR" DataSetColumn="ID_CARGADOR" />
              <Mapping SourceColumn="CARGADOR" DataSetColumn="CARGADOR" />
              <Mapping SourceColumn="NOMBRE_MADURANTE" DataSetColumn="NOMBRE_MADURANTE" />
              <Mapping SourceColumn="QUEMAPROG" DataSetColumn="QUEMAPROG" />
              <Mapping SourceColumn="QUEMANOPROG" DataSetColumn="QUEMANOPROG" />
              <Mapping SourceColumn="FIN_LOTE" DataSetColumn="FIN_LOTE" />
              <Mapping SourceColumn="ID_PROVEEDOR_ROZA" DataSetColumn="ID_PROVEEDOR_ROZA" />
              <Mapping SourceColumn="ID_SUPERVISOR" DataSetColumn="ID_SUPERVISOR" />
              <Mapping SourceColumn="CHEQUERO" DataSetColumn="CHEQUERO" />
              <Mapping SourceColumn="CAMION" DataSetColumn="CAMION" />
              <Mapping SourceColumn="RASTRA" DataSetColumn="RASTRA" />
              <Mapping SourceColumn="_3EJES" DataSetColumn="_3EJES" />
              <Mapping SourceColumn="FECHA_EMISION" DataSetColumn="FECHA_EMISION" />
              <Mapping SourceColumn="CANA_CORTA" DataSetColumn="CANA_CORTA" />
              <Mapping SourceColumn="CANA_PICADA" DataSetColumn="CANA_PICADA" />
              <Mapping SourceColumn="CANA_LARGA" DataSetColumn="CANA_LARGA" />
              <Mapping SourceColumn="NOPROFORMA" DataSetColumn="NOPROFORMA" />
              <Mapping SourceColumn="CANA_VERDE" DataSetColumn="CANA_VERDE" />
              <Mapping SourceColumn="FECHA_MADURANTE" DataSetColumn="FECHA_MADURANTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorIdProforma" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorIdProforma" GeneratorSourceName="FillPorIdProforma" GetMethodModifier="Public" GetMethodName="GetPorIdProforma" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorIdProforma" UserSourceName="FillPorIdProforma">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
F.ID_PROFORMA, F.NOPROFORMA,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = F.ID_ZAFRA) AS ZAFRA,
(SELECT C.NO_CONTRATO FROM CONTRATO C WHERE C.CODICONTRATO = L.CODICONTRATO) AS NO_CONTRATO,
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
L.CODILOTE, L.NOMBLOTE, F.CODTRANSPORT,
T.NOMBRES + ' ' + ISNULL(T.APELLIDOS,'') AS NOMBRE_TRANSPORTISTA,
CASE
WHEN F.TRANSPORTE_PROPIO = 1 THEN 'X'
ELSE NULL
END AS TRANSPORTE_PROPIO,
CASE
WHEN F.TRANSPORTE_PROPIO = 0 THEN 'X'
ELSE NULL
END AS TRANSPORTE_PARTICULAR,
F.PLACAVEHIC, F.NOMBRES_MOTORISTA, 
F.ID_CARGADORA, (SELECT C.NOMBRE FROM CARGADORA C WHERE C.ID_CARGADORA = F.ID_CARGADORA) AS CARGADORA,
F.ID_CARGADOR, (SELECT C.NOMBRE_CARGADOR FROM CARGADOR C WHERE C.ID_CARGADOR = F.ID_CARGADOR) AS CARGADOR,
(SELECT P.NOMBRE_PRODUCTO FROM PRODUCTO P WHERE P.ID_PRODUCTO = F.ID_PRODUCTO) AS NOMBRE_MADURANTE,
CASE 
WHEN F.QUEMAPROG = 1 THEN 'X'
ELSE NULL
END AS QUEMAPROG,
CASE 
WHEN F.QUEMANOPROG = 1 THEN 'X'
ELSE NULL
END AS QUEMANOPROG,
CASE 
WHEN F.CANA_VERDE = 1 THEN 'X'
ELSE NULL
END AS CANA_VERDE,
CASE 
WHEN F.FIN_LOTE = 1 THEN 'X'
ELSE NULL
END AS FIN_LOTE, F.ID_PROVEEDOR_ROZA, F.ID_SUPERVISOR, 
(SELECT S.NOMBRE_SUPERVISOR FROM SUPERVISOR S WHERE S.ID_SUPERVISOR = F.ID_SUPERVISOR) AS CHEQUERO,
(CASE 
WHEN F.ID_TIPO_CANA = 16 THEN 'X'
ELSE NULL
END) AS CANA_CORTA,
(CASE 
WHEN F.ID_TIPO_CANA = 17 THEN 'X'
ELSE NULL
END) AS CANA_PICADA,
(CASE 
WHEN F.ID_TIPO_CANA = 18 THEN 'X'
ELSE NULL
END) AS CANA_LARGA,
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 19) AS CAMION,  
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 20) AS RASTRA,
(SELECT 'X' FROM TIPO_TRANSPORTE T WHERE T.ID_TIPOTRANS = F.ID_TIPOTRANS AND T.ID_TIPOTRANS = 21) AS _3EJES,
CAST(F.FECHA_CREA AS DATE) AS FECHA_EMISION,
F.FECHA_MADURANTE
FROM PROFORMA F, LOTES L, PROVEEDOR P, TRANSPORTISTA T
WHERE F.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND F.CODTRANSPORT = T.CODTRANSPORT
AND F.ID_PROFORMA = @ID_PROFORMA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="ID_PROFORMA" ColumnName="ID_PROFORMA" DataSourceName="INJIBOA.dbo.PROFORMA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_PROFORMA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_PROFORMA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ANALISIS_MUESTRAS_ENVIOTableAdapter" GeneratorDataComponentClassName="ANALISIS_MUESTRAS_ENVIOTableAdapter" Name="ANALISIS_MUESTRAS_ENVIO" UserDataComponentName="ANALISIS_MUESTRAS_ENVIOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = E.ID_ZAFRA) AS ZAFRA, E.DIAZAFRA,
A.FECHA_LEE_POL, E.ID_ENVIO, E.ACCESLOTE, E.NROBOLETA, E.NUMRECIBO_CANA, 
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO,
RTRIM(ISNULL(P.NOMBRES,'')) + ' ' + RTRIM(ISNULL(P.APELLIDOS,'')) AS PROVEEDOR,
L.CODILOTE, L.NOMBLOTE, (SELECT B.NETOTONEL FROM BASCULA B WHERE B.ID_ENVIO = E.ID_ENVIO) AS NETOTONEL,
CASE 
WHEN NOT(E.QUEMAPROG = 1) AND NOT(E.QUEMAPROG = 0 AND E.ID_TIPO_CANA IN (27,43)) THEN 'COSECHADORA'
WHEN E.ID_TIPO_CANA IN(19,27) THEN 'LARGA MANUAL'
WHEN E.ID_TIPO_CANA IN(35,43) THEN 'LARGA MANUAL'
END AS TIPO_CANA,
CASE
	WHEN E.QUEMAPROG = 1 THEN 'QUEMA PROGRAMADA' 
	WHEN E.QUEMAPROG = 0 AND E.ID_TIPO_CANA IN (27,43) THEN 'QUEMA NO PROGRAMADA' 
	ELSE 'CAÑA VERDE' 
END AS TIPO_QUEMA,
E.FECHA_QUEMA,
E.HORAS_QUEMA,
CASE 
WHEN (SELECT COUNT(1) FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = E.ID_ZAFRA AND S.ACCESLOTE = E.ACCESLOTE) &gt; 0 THEN 
CONVERT(VARCHAR(10), (SELECT TOP 1 S.FECHA_INI_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = E.ID_ZAFRA AND S.ACCESLOTE = E.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) ,103) + ' AL ' +
CONVERT(VARCHAR(10), (SELECT TOP 1 S.FECHA_FIN_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = E.ID_ZAFRA AND S.ACCESLOTE = E.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) ,103) 
ELSE
 CONVERT(VARCHAR(10),(SELECT LC.FECHA_ROZA FROM LOTES_COSECHA LC WHERE LC.ID_ZAFRA = E.ID_ZAFRA AND LC.ACCESLOTE = E.ACCESLOTE),103)
END AS VENTANA_COSECHA,
(SELECT MAX(AP.NO_MUESTRA) FROM ANALISIS_PRECOSECHA AP WHERE AP.ID_ZAFRA = E.ID_ZAFRA AND AP.ACCESLOTE = E.ACCESLOTE) AS NO_ANALISIS,
(SELECT TOP 1 AP.RENDIA_CALC2 FROM ANALISIS_PRECOSECHA AP WHERE AP.ID_ZAFRA = E.ID_ZAFRA AND AP.ACCESLOTE = E.ACCESLOTE ORDER BY AP.NO_MUESTRA DESC) AS PRECOSECHA85,
(SELECT AVG(AP.RENDIA_CALC2) FROM ANALISIS_PRECOSECHA AP WHERE AP.ID_ZAFRA = E.ID_ZAFRA AND AP.ACCESLOTE = E.ACCESLOTE) AS PRECOSECHA85_PROM,
A.RENDIA_CALC2 AS RECIBO85,
(SELECT TOP 1 S.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = E.ID_ZAFRA AND S.ACCESLOTE = E.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS MADURANTE
FROM ENVIO E, PROVEEDOR P, ANALISIS A, LOTES L
WHERE E.CODIPROVEEDOR = P.CODIPROVEEDOR
AND E.ID_ENVIO = A.ID_ENVIO
AND E.ACCESLOTE = L.ACCESLOTE 
AND E.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="FECHA_LEE_POL" DataSetColumn="FECHA_LEE_POL" />
              <Mapping SourceColumn="ID_ENVIO" DataSetColumn="ID_ENVIO" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="NROBOLETA" DataSetColumn="NROBOLETA" />
              <Mapping SourceColumn="NUMRECIBO_CANA" DataSetColumn="NUMRECIBO_CANA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="TIPO_CANA" DataSetColumn="TIPO_CANA" />
              <Mapping SourceColumn="TIPO_QUEMA" DataSetColumn="TIPO_QUEMA" />
              <Mapping SourceColumn="FECHA_QUEMA" DataSetColumn="FECHA_QUEMA" />
              <Mapping SourceColumn="HORAS_QUEMA" DataSetColumn="HORAS_QUEMA" />
              <Mapping SourceColumn="NO_ANALISIS" DataSetColumn="NO_ANALISIS" />
              <Mapping SourceColumn="PRECOSECHA85" DataSetColumn="PRECOSECHA85" />
              <Mapping SourceColumn="RECIBO85" DataSetColumn="RECIBO85" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="DIAZAFRA" DataSetColumn="DIAZAFRA" />
              <Mapping SourceColumn="VENTANA_COSECHA" DataSetColumn="VENTANA_COSECHA" />
              <Mapping SourceColumn="PRECOSECHA85_PROM" DataSetColumn="PRECOSECHA85_PROM" />
              <Mapping SourceColumn="MADURANTE" DataSetColumn="MADURANTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="CONSULTA_INJIBOA.dbo.RPT_SIGESTA_ANALISIS_MUESTRAS_ENVIOS" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_ANALISIS_MUESTRAS_ENVIOS</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@OPCION" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="date" DbType="Date" Direction="Input" ParameterName="@FECHA_CORTE" Precision="10" ProviderType="Date" Scale="0" Size="3" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="20" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="20" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="char" DbType="AnsiStringFixedLength" Direction="Input" ParameterName="@ACCESLOTE" Precision="0" ProviderType="Char" Scale="0" Size="21" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE" Precision="0" ProviderType="VarChar" Scale="0" Size="200" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_PROGRAMACION_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_PROGRAMACION_COSECHATableAdapter" Name="RPT_PROGRAMACION_COSECHA" UserDataComponentName="RPT_PROGRAMACION_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
Z.NOMBRE_ZAFRA, L.ZONA, 
(SELECT MAX(CP.CATORCENA) FROM CICLO_PERIODO CP WHERE CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA,
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, 
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, V.CODIVARIEDA, L.CODILOTE,
L.NOMBLOTE, PC.MZ_COSECHA, PC.TONEL_COSECHA, PC.CUOTA_DIARIA, V.NOM_VARIEDAD,
LC.CODIAGRON, (SELECT A.NOMBRE_AGRONOMO + ' ' + A.APELLIDO_AGRONOMO FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO,
PC.FECHA_INI_COSECHA, PC.FECHA_FIN_COSECHA, 
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO, 
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
CASE WHEN ML.RIESGO_PIEDRA = 1 THEN 'S' ELSE '' END AS RIESGO_PIEDRA
FROM PLAN_COSECHA PC, PROVEEDOR P, LOTES L, VARIEDAD V, ZAFRA Z, LOTES_COSECHA LC, MAESTRO_LOTES ML
WHERE 
PC.ID_ZAFRA = -1 AND
PC.ACCESLOTE = L.ACCESLOTE AND
L.CODIPROVEEDOR = P.CODIPROVEEDOR AND
L.CODIVARIEDA = V.CODIVARIEDA AND
PC.ID_ZAFRA = Z.ID_ZAFRA AND
PC.ID_ZAFRA = LC.ID_ZAFRA AND
PC.ACCESLOTE = LC.ACCESLOTE AND
L.ID_MAESTRO = ML.ID_MAESTRO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="MZ_COSECHA" DataSetColumn="MZ_COSECHA" />
              <Mapping SourceColumn="TONEL_COSECHA" DataSetColumn="TONEL_COSECHA" />
              <Mapping SourceColumn="CUOTA_DIARIA" DataSetColumn="CUOTA_DIARIA" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="CODIAGRON" DataSetColumn="CODIAGRON" />
              <Mapping SourceColumn="AGRONOMO" DataSetColumn="AGRONOMO" />
              <Mapping SourceColumn="FECHA_INI_COSECHA" DataSetColumn="FECHA_INI_COSECHA" />
              <Mapping SourceColumn="FECHA_FIN_COSECHA" DataSetColumn="FECHA_FIN_COSECHA" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODIVARIEDA" DataSetColumn="CODIVARIEDA" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="RIESGO_PIEDRA" DataSetColumn="RIESGO_PIEDRA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
Z.NOMBRE_ZAFRA, L.ZONA, 
(SELECT MAX(CP.CATORCENA) FROM CICLO_PERIODO CP WHERE CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA,
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, 
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, V.CODIVARIEDA, L.CODILOTE,
L.NOMBLOTE, PC.MZ_COSECHA, PC.TONEL_COSECHA, PC.CUOTA_DIARIA, V.NOM_VARIEDAD,
LC.CODIAGRON, (SELECT A.NOMBRE_AGRONOMO + ' ' + A.APELLIDO_AGRONOMO FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO,
PC.FECHA_INI_COSECHA, PC.FECHA_FIN_COSECHA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO, 
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
CASE WHEN ML.RIESGO_PIEDRA = 1 THEN 'S' ELSE '' END AS RIESGO_PIEDRA
FROM PLAN_COSECHA PC, PROVEEDOR P, LOTES L, VARIEDAD V, ZAFRA Z, LOTES_COSECHA LC, MAESTRO_LOTES ML
WHERE 
PC.ID_ZAFRA = @ID_ZAFRA AND
PC.ACCESLOTE = L.ACCESLOTE AND
L.CODIPROVEEDOR = P.CODIPROVEEDOR AND
L.CODIVARIEDA = V.CODIVARIEDA AND
PC.ID_ZAFRA = Z.ID_ZAFRA AND
PC.ID_ZAFRA = LC.ID_ZAFRA AND
PC.ACCESLOTE = LC.ACCESLOTE AND
L.ID_MAESTRO = ML.ID_MAESTRO AND
(PC.FECHA_INI_COSECHA BETWEEN @FECHA_INI_COSECHA AND @FECHA_FIN_COSECHA OR PC.FECHA_FIN_COSECHA BETWEEN @FECHA_INI_COSECHA AND @FECHA_FIN_COSECHA) AND
(LC.CODIAGRON = @CODIAGRON OR @CODIAGRON = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_INI_COSECHA" ColumnName="FECHA_INI_COSECHA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_INI_COSECHA" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_INI_COSECHA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_FIN_COSECHA" ColumnName="FECHA_INI_COSECHA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_FIN_COSECHA" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_INI_COSECHA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIAGRON" ColumnName="CODIAGRON" DataSourceName="DESAINJIBOA.dbo.LOTES_COSECHA" DataTypeServer="char(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODIAGRON" Precision="0" ProviderType="Char" Scale="0" Size="8" SourceColumn="CODIAGRON" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriteriosConCuota" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriteriosConCuota" GeneratorSourceName="FillPorCriteriosConCuota" GetMethodModifier="Public" GetMethodName="GetPorCriteriosConCuota" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriteriosConCuota" UserSourceName="FillPorCriteriosConCuota">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
Z.NOMBRE_ZAFRA, L.ZONA, 
(SELECT MAX(CP.CATORCENA) FROM CICLO_PERIODO CP WHERE CP.FECHA = PC.FECHA_INI_COSECHA) AS CATORCENA,
dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE, 
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS NOMBRE_PROVEEDOR, V.CODIVARIEDA, L.CODILOTE,
L.NOMBLOTE, PC.MZ_COSECHA, PC.TONEL_COSECHA, PC.CUOTA_DIARIA, V.NOM_VARIEDAD,
LC.CODIAGRON, (SELECT A.NOMBRE_AGRONOMO + ' ' + A.APELLIDO_AGRONOMO FROM AGRONOMO A WHERE A.CODIAGRON = LC.CODIAGRON) AS AGRONOMO,
PC.FECHA_INI_COSECHA, PC.FECHA_FIN_COSECHA,
(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS DEPARTAMENTO, 
(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS MUNICIPIO, 
(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS CANTON,
CASE WHEN ML.RIESGO_PIEDRA = 1 THEN 'S' ELSE '' END AS RIESGO_PIEDRA
FROM PLAN_COSECHA PC, PROVEEDOR P, LOTES L, VARIEDAD V, ZAFRA Z, LOTES_COSECHA LC, MAESTRO_LOTES ML
WHERE 
PC.ID_ZAFRA = @ID_ZAFRA AND
PC.ACCESLOTE = L.ACCESLOTE AND
L.CODIPROVEEDOR = P.CODIPROVEEDOR AND
L.CODIVARIEDA = V.CODIVARIEDA AND
PC.ID_ZAFRA = Z.ID_ZAFRA AND
PC.ID_ZAFRA = LC.ID_ZAFRA AND
PC.ACCESLOTE = LC.ACCESLOTE AND
L.ID_MAESTRO = ML.ID_MAESTRO AND
PC.CUOTA_DIARIA &gt; 0 AND
(PC.FECHA_INI_COSECHA BETWEEN @FECHA_INI_COSECHA AND @FECHA_FIN_COSECHA OR PC.FECHA_FIN_COSECHA BETWEEN @FECHA_INI_COSECHA AND @FECHA_FIN_COSECHA) AND
(LC.CODIAGRON = @CODIAGRON OR @CODIAGRON = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_INI_COSECHA" ColumnName="FECHA_INI_COSECHA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_INI_COSECHA" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_INI_COSECHA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_FIN_COSECHA" ColumnName="FECHA_INI_COSECHA" DataSourceName="DESAINJIBOA.dbo.PLAN_COSECHA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_FIN_COSECHA" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHA_INI_COSECHA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIAGRON" ColumnName="CODIAGRON" DataSourceName="DESAINJIBOA.dbo.LOTES_COSECHA" DataTypeServer="char(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODIAGRON" Precision="0" ProviderType="Char" Scale="0" Size="8" SourceColumn="CODIAGRON" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLICITUD_APLICACIONESTableAdapter" GeneratorDataComponentClassName="SOLICITUD_APLICACIONESTableAdapter" Name="SOLICITUD_APLICACIONES" UserDataComponentName="SOLICITUD_APLICACIONESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	DISTINCT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = S.ID_ZAFRA) AS NOMBRE_ZAFRA,
	dbo.QuitarFormatoCODIPROVEE(P2.CODIPROVEE) AS CODIPROVEE, 
	dbo.QuitarFormatoCODISOCIO(P2.CODISOCIO) AS CODISOCIO, 
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR1,
	CASE 
	WHEN P.CODIPROVEEDOR &lt;&gt; P2.CODIPROVEEDOR THEN ISNULL(RTRIM(P2.NOMBRES),'') + ' ' + ISNULL(RTRIM(P2.APELLIDOS),'') 
	ELSE ''
	END AS PROVEEDOR2,
	S.FECHA_SOLIC, L.CODILOTE,  L.NOMBLOTE, S.NUM_SOLICITUD, A.NOMBRE_PRODUCTO, A.MZ, A.FECHA_APLICA, A.FECHA_INI_VENTANA, A.FECHA_FIN_VENTANA, A.FECHA_ROZA_MADURANTE
FROM SOLIC_AGRICOLA S, SOLIC_APLICA_LOTE A, PROVEEDOR P, LOTES L, CONTRATO C, PROVEEDOR P2
WHERE S.ID_SOLICITUD = A.ID_SOLICITUD
AND C.CODICONTRATO = L.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND A.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P2.CODIPROVEEDOR
AND S.ID_SOLICITUD = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR1" DataSetColumn="PROVEEDOR1" />
              <Mapping SourceColumn="PROVEEDOR2" DataSetColumn="PROVEEDOR2" />
              <Mapping SourceColumn="FECHA_SOLIC" DataSetColumn="FECHA_SOLIC" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NUM_SOLICITUD" DataSetColumn="NUM_SOLICITUD" />
              <Mapping SourceColumn="NOMBRE_PRODUCTO" DataSetColumn="NOMBRE_PRODUCTO" />
              <Mapping SourceColumn="MZ" DataSetColumn="MZ" />
              <Mapping SourceColumn="FECHA_APLICA" DataSetColumn="FECHA_APLICA" />
              <Mapping SourceColumn="FECHA_INI_VENTANA" DataSetColumn="FECHA_INI_VENTANA" />
              <Mapping SourceColumn="FECHA_FIN_VENTANA" DataSetColumn="FECHA_FIN_VENTANA" />
              <Mapping SourceColumn="FECHA_ROZA_MADURANTE" DataSetColumn="FECHA_ROZA_MADURANTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorSolicitud" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorSolicitud" GeneratorSourceName="FillPorSolicitud" GetMethodModifier="Public" GetMethodName="GetPorSolicitud" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorSolicitud" UserSourceName="FillPorSolicitud">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	DISTINCT (SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = S.ID_ZAFRA) AS NOMBRE_ZAFRA,
	dbo.QuitarFormatoCODIPROVEE(P2.CODIPROVEE) AS CODIPROVEE, 
	dbo.QuitarFormatoCODISOCIO(P2.CODISOCIO) AS CODISOCIO, 
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS PROVEEDOR1,
	CASE 
	WHEN P.CODIPROVEEDOR &lt;&gt; P2.CODIPROVEEDOR THEN ISNULL(RTRIM(P2.NOMBRES),'') + ' ' + ISNULL(RTRIM(P2.APELLIDOS),'') 
	ELSE ''
	END AS PROVEEDOR2,
	S.FECHA_SOLIC, L.CODILOTE,  L.NOMBLOTE, S.NUM_SOLICITUD, A.NOMBRE_PRODUCTO, A.MZ, A.FECHA_APLICA, A.FECHA_INI_VENTANA, A.FECHA_FIN_VENTANA, A.FECHA_ROZA_MADURANTE
FROM SOLIC_AGRICOLA S, SOLIC_APLICA_LOTE A, PROVEEDOR P, LOTES L, CONTRATO C, PROVEEDOR P2
WHERE S.ID_SOLICITUD = A.ID_SOLICITUD
AND C.CODICONTRATO = L.CODICONTRATO
AND C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND A.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P2.CODIPROVEEDOR
AND S.ID_SOLICITUD = @ID_SOLICITUD</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_SOLICITUD" ColumnName="ID_SOLICITUD" DataSourceName="CONSULTA_INJIBOA.dbo.SOLIC_AGRICOLA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SOLICITUD" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_SOLICITUD" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ANALISIS_MUESTRAS_TODOTableAdapter" GeneratorDataComponentClassName="ANALISIS_MUESTRAS_TODOTableAdapter" Name="ANALISIS_MUESTRAS_TODO" UserDataComponentName="ANALISIS_MUESTRAS_TODOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, L.ACCESLOTE,
CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS PROVEEDOR,
L.ZONA, L.CODILOTE, L.NOMBLOTE, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
(SELECT LC.EDAD_LOTE FROM LOTES_COSECHA LC WHERE LC.ID_ZAFRA = A.ID_ZAFRA AND LC.ACCESLOTE = A.ACCESLOTE) AS EDAD_LOTE,
A.NO_ANALISIS, A.FECHA_MUESTRA, A.NO_MUESTRA, A.FECHA_LEE_POL, A.RENDIA_CALC2 AS REND_PRECO, 
(SELECT ROUND(SUM(I.AZUCAR_CALC2)/SUM(B.NETOTONEL),2) FROM ENVIO E, ANALISIS I, BASCULA B WHERE E.ID_ENVIO = I.ID_ENVIO AND E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = A.ID_ZAFRA AND E.ACCESLOTE = A.ACCESLOTE) AS REND_RECIBO,
(SELECT ROUND(SUM(I.AZUCAR_CATORCENA_REAL)/SUM(B.NETOTONEL),2) FROM ENVIO E, ANALISIS I, BASCULA B WHERE E.ID_ENVIO = I.ID_ENVIO AND E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = A.ID_ZAFRA AND E.ACCESLOTE = A.ACCESLOTE) AS REND_REAL,
(SELECT TOP 1 S.FECHA_APLICA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_APLICA_MADURANTE,
(SELECT TOP 1 S.FECHA_INI_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_INI_VENTANA,
(SELECT TOP 1 S.FECHA_FIN_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_FIN_VENTANA,
A.BAGAZO_NETO AS PBH, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO, A.PH, A.AZUCAR_REDUCTORES,
(SELECT TOP 1 S.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS MADURANTE
FROM ANALISIS_PRECOSECHA A, LOTES L, PROVEEDOR P
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND NOT A.FECHA_LEE_POL IS NULL
AND P.CODIPROVEEDOR = ''</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="NO_ANALISIS" DataSetColumn="NO_ANALISIS" />
              <Mapping SourceColumn="FECHA_MUESTRA" DataSetColumn="FECHA_MUESTRA" />
              <Mapping SourceColumn="NO_MUESTRA" DataSetColumn="NO_MUESTRA" />
              <Mapping SourceColumn="FECHA_LEE_POL" DataSetColumn="FECHA_LEE_POL" />
              <Mapping SourceColumn="REND_PRECO" DataSetColumn="REND_PRECO" />
              <Mapping SourceColumn="REND_RECIBO" DataSetColumn="REND_RECIBO" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="FECHA_APLICA_MADURANTE" DataSetColumn="FECHA_APLICA_MADURANTE" />
              <Mapping SourceColumn="FECHA_INI_VENTANA" DataSetColumn="FECHA_INI_VENTANA" />
              <Mapping SourceColumn="FECHA_FIN_VENTANA" DataSetColumn="FECHA_FIN_VENTANA" />
              <Mapping SourceColumn="PBH" DataSetColumn="PBH" />
              <Mapping SourceColumn="BRIX" DataSetColumn="BRIX" />
              <Mapping SourceColumn="POL" DataSetColumn="POL" />
              <Mapping SourceColumn="PUREZA_JUGO" DataSetColumn="PUREZA_JUGO" />
              <Mapping SourceColumn="FIBRA_CANA" DataSetColumn="FIBRA_CANA" />
              <Mapping SourceColumn="DEXTRANA" DataSetColumn="DEXTRANA" />
              <Mapping SourceColumn="HUMEDAD" DataSetColumn="HUMEDAD" />
              <Mapping SourceColumn="ALMIDON_JUGO" DataSetColumn="ALMIDON_JUGO" />
              <Mapping SourceColumn="PH" DataSetColumn="PH" />
              <Mapping SourceColumn="AZUCAR_REDUCTORES" DataSetColumn="AZUCAR_REDUCTORES" />
              <Mapping SourceColumn="MADURANTE" DataSetColumn="MADURANTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = A.ID_ZAFRA) AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, L.ACCESLOTE,
CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS PROVEEDOR,
L.ZONA, L.CODILOTE, L.NOMBLOTE, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
(SELECT LC.EDAD_LOTE FROM LOTES_COSECHA LC WHERE LC.ID_ZAFRA = A.ID_ZAFRA AND LC.ACCESLOTE = A.ACCESLOTE) AS EDAD_LOTE,
A.NO_ANALISIS, A.FECHA_MUESTRA, A.NO_MUESTRA, A.FECHA_LEE_POL, A.RENDIA_CALC2 AS REND_PRECO, 
(SELECT ROUND(SUM(I.AZUCAR_CALC2)/SUM(B.NETOTONEL),2) FROM ENVIO E, ANALISIS I, BASCULA B WHERE E.ID_ENVIO = I.ID_ENVIO AND E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = A.ID_ZAFRA AND E.ACCESLOTE = A.ACCESLOTE) AS REND_RECIBO,
(SELECT ROUND(SUM(I.AZUCAR_CATORCENA_REAL)/SUM(B.NETOTONEL),2) FROM ENVIO E, ANALISIS I, BASCULA B WHERE E.ID_ENVIO = I.ID_ENVIO AND E.ID_ENVIO = B.ID_ENVIO AND E.ID_ZAFRA = A.ID_ZAFRA AND E.ACCESLOTE = A.ACCESLOTE) AS REND_REAL,
(SELECT TOP 1 S.FECHA_APLICA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_APLICA_MADURANTE,
(SELECT TOP 1 S.FECHA_INI_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_INI_VENTANA,
(SELECT TOP 1 S.FECHA_FIN_VENTANA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_FIN_VENTANA,
A.BAGAZO_NETO AS PBH, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, A.DEXTRANA, A.HUMEDAD, A.ALMIDON_JUGO, A.PH, A.AZUCAR_REDUCTORES,
(SELECT TOP 1 S.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = A.ID_ZAFRA AND S.ACCESLOTE = A.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS MADURANTE
FROM ANALISIS_PRECOSECHA A, LOTES L, PROVEEDOR P
WHERE A.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND NOT A.FECHA_LEE_POL IS NULL
AND A.ID_ZAFRA = @ID_ZAFRA
AND (P.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
AND (P.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
AND (RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) LIKE '%' + @NOMBRE_PROVEEDOR + '%' OR @NOMBRE_PROVEEDOR = '')
AND (L.NOMBLOTE LIKE '%' + @NOMBLOTE + '%' OR @NOMBLOTE = '')
AND (CAST(A.FECHA_LEE_POL AS DATE) BETWEEN CONVERT(DATETIME,@FECHA_INI,103) AND CONVERT(DATETIME,@FECHA_FIN,103) OR @FECHA_INI = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="DESAINJIBOA.dbo.ANALISIS_PRECOSECHA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="DESAINJIBOA.dbo.PROVEEDOR" DataTypeServer="char(6)" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="Char" Scale="0" Size="6" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="DESAINJIBOA.dbo.PROVEEDOR" DataTypeServer="char(4)" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="Char" Scale="0" Size="4" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="NOMBLOTE" ColumnName="NOMBLOTE" DataSourceName="DESAINJIBOA.dbo.LOTES" DataTypeServer="char(60)" DbType="AnsiString" Direction="Input" ParameterName="@NOMBLOTE" Precision="0" ProviderType="Char" Scale="0" Size="60" SourceColumn="NOMBLOTE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_INI" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_INI" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_FIN" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_FIN" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_REND_DIARIO_ACUMULADOTableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_REND_DIARIO_ACUMULADOTableAdapter" Name="RPT_SIGESTA_REND_DIARIO_ACUMULADO" UserDataComponentName="RPT_SIGESTA_REND_DIARIO_ACUMULADOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT GETDATE() AS FECHA_ZAFRA,
1 AS DIA_ZAFRA,
14287767 AS CODIPROVEE,
'9999'AS CODISOCIO,
'JUAN GABRIEL DIAZ VASQUEZ' AS NOMBRE_PROVEEDOR,
'0020' AS CODILOTE,
'EL ASILO ( EL CAUCA )                                        ' AS NOMBLOTE,
16.74 AS NETOTONEL_DIA,
191.23 AS RENDIA_CALC2_DIA,
49 AS HORAS_QUEMA_DIA,
34 AS HORAS_CORTA_DIA,
18.49 AS BRIX_DIA,
15.42 AS POL_DIA,
83.3964 AS PUREZA_JUGO_DIA,
68.9204 AS HUMEDAD_DIA,
12.5896 AS FIBRA_CANA_DIA,
153407 AS NROBOLETA,
220724 AS NUMRECIBO_CANA,
GETDATE() AS FECHA_LEE_TARA,
16.74 AS NETOTONEL_RECIBO, 
191.229988 AS RENDIACALC2_RECIBO, 	
191.229988 AS HORAS_QUEMA_RECIBO, 	
191.229988 AS HORAS_CORTA_RECIBO, 	
191.229988 AS NETOTONEL_ACUM, 	
189.937369 AS RENDIACALC2_ACUM, 	
42.096033 AS HORAS_QUEMA_ACUM, 	
25.123471 AS HORAS_CORTA_ACUM, 	
18.097175 AS BRIX_ACUM, 	
15.10514 AS POL_ACUM, 	
83.467759 AS PUREZA_JUGO_ACUM, 	
70.077605 AS HUMEDAD_ACUM, 	
11.825218 AS FIBRA_CANA_ACUM
WHERE 1 = -1
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="FECHA_ZAFRA" DataSetColumn="FECHA_ZAFRA" />
              <Mapping SourceColumn="DIA_ZAFRA" DataSetColumn="DIA_ZAFRA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NETOTONEL_DIA" DataSetColumn="NETOTONEL_DIA" />
              <Mapping SourceColumn="RENDIA_CALC2_DIA" DataSetColumn="RENDIA_CALC2_DIA" />
              <Mapping SourceColumn="HORAS_QUEMA_DIA" DataSetColumn="HORAS_QUEMA_DIA" />
              <Mapping SourceColumn="HORAS_CORTA_DIA" DataSetColumn="HORAS_CORTA_DIA" />
              <Mapping SourceColumn="BRIX_DIA" DataSetColumn="BRIX_DIA" />
              <Mapping SourceColumn="POL_DIA" DataSetColumn="POL_DIA" />
              <Mapping SourceColumn="PUREZA_JUGO_DIA" DataSetColumn="PUREZA_JUGO_DIA" />
              <Mapping SourceColumn="HUMEDAD_DIA" DataSetColumn="HUMEDAD_DIA" />
              <Mapping SourceColumn="FIBRA_CANA_DIA" DataSetColumn="FIBRA_CANA_DIA" />
              <Mapping SourceColumn="NROBOLETA" DataSetColumn="NROBOLETA" />
              <Mapping SourceColumn="NUMRECIBO_CANA" DataSetColumn="NUMRECIBO_CANA" />
              <Mapping SourceColumn="FECHA_LEE_TARA" DataSetColumn="FECHA_LEE_TARA" />
              <Mapping SourceColumn="NETOTONEL_RECIBO" DataSetColumn="NETOTONEL_RECIBO" />
              <Mapping SourceColumn="RENDIACALC2_RECIBO" DataSetColumn="RENDIACALC2_RECIBO" />
              <Mapping SourceColumn="HORAS_QUEMA_RECIBO" DataSetColumn="HORAS_QUEMA_RECIBO" />
              <Mapping SourceColumn="HORAS_CORTA_RECIBO" DataSetColumn="HORAS_CORTA_RECIBO" />
              <Mapping SourceColumn="NETOTONEL_ACUM" DataSetColumn="NETOTONEL_ACUM" />
              <Mapping SourceColumn="RENDIACALC2_ACUM" DataSetColumn="RENDIACALC2_ACUM" />
              <Mapping SourceColumn="HORAS_QUEMA_ACUM" DataSetColumn="HORAS_QUEMA_ACUM" />
              <Mapping SourceColumn="HORAS_CORTA_ACUM" DataSetColumn="HORAS_CORTA_ACUM" />
              <Mapping SourceColumn="BRIX_ACUM" DataSetColumn="BRIX_ACUM" />
              <Mapping SourceColumn="POL_ACUM" DataSetColumn="POL_ACUM" />
              <Mapping SourceColumn="PUREZA_JUGO_ACUM" DataSetColumn="PUREZA_JUGO_ACUM" />
              <Mapping SourceColumn="HUMEDAD_ACUM" DataSetColumn="HUMEDAD_ACUM" />
              <Mapping SourceColumn="FIBRA_CANA_ACUM" DataSetColumn="FIBRA_CANA_ACUM" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="CONSULTA_INJIBOA.dbo.RPT_SIGESTA_REND_DIARIO_ACUMULADO" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_REND_DIARIO_ACUMULADO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@OPCION" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_INICIAL" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_FINAL" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="200" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PLAN_COSECHA_EJECUCIONTableAdapter" GeneratorDataComponentClassName="PLAN_COSECHA_EJECUCIONTableAdapter" Name="PLAN_COSECHA_EJECUCION" UserDataComponentName="PLAN_COSECHA_EJECUCIONTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT  L.ACCESLOTE,
	(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = 2) AS ZAFRA,
	L.ZONA AS ZONA,
	L.SUB_ZONA,
	(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO,
	(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI,
	(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON,
	dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
	dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR,
	ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
	L.CODILOTE, L.NOMBLOTE, C.CODICONTRATO, C.NO_CONTRATO, L.AREA AS MZ_CONTRA, L.TONELADAS AS TC_MZ_CONTRA, L.TONEL_TC AS TONEL_CONTRA, 
	LC.MZ_CENSO, LC.TONEL_MZ_CENSO, LC.TONEL_CENSO, LC.TONEL_SEMILLA, LC.TONEL_ENTREGADA, LC.TONEL_SALDO_VAR, 
	LC.MZ_ENTREGAR, LC.TONEL_MZ_ENTREGAR, LC.TONEL_ENTREGAR, CASE LC.FIN_LOTE WHEN 1 THEN 'CERRADO' ELSE '' END AS FIN_LOTE,
	L.CODIVARIEDA,
	(V.NOM_VARIEDAD) AS VARIEDAD, 
	(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = LC.ID_TIPO_CANA) AS TIPO_CANA, 
	(SELECT T.NOM_TIPO FROM TIPOS_GENERALES T WHERE T.ID_TIPO = V.ID_TIPO) AS TIPO, 
	V.ID_TIPO, LC.REND_COSECHA,  LC.FECHA_ROZA,
	LC.FAB_SEMANA AS SEMANA, LC.FAB_CATORCENA AS CATORCENA, 
	ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON, ML.ID_TIPO_CANA,
	(SELECT TOP 1 S.NOMBRE_PRODUCTO FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = LC.ID_ZAFRA AND S.ACCESLOTE = LC.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS MADURANTE,
	(SELECT TOP 1 S.FECHA_APLICA FROM SOLIC_APLICA_LOTE S WHERE S.ID_ZAFRA = LC.ID_ZAFRA AND S.ACCESLOTE = LC.ACCESLOTE ORDER BY S.FECHA_APLICA DESC) AS FECHA_APLICA,
	L.EDAD_LOTE
FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V
WHERE L.ACCESLOTE = LC.ACCESLOTE 
AND L.ID_MAESTRO = ML.ID_MAESTRO 
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND L.CODICONTRATO = C.CODICONTRATO
AND L.CODIVARIEDA = V.CODIVARIEDA
AND LC.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="MZ_CONTRA" DataSetColumn="MZ_CONTRA" />
              <Mapping SourceColumn="TC_MZ_CONTRA" DataSetColumn="TC_MZ_CONTRA" />
              <Mapping SourceColumn="TONEL_CONTRA" DataSetColumn="TONEL_CONTRA" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_MZ_CENSO" DataSetColumn="TONEL_MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="TONEL_SALDO_VAR" DataSetColumn="TONEL_SALDO_VAR" />
              <Mapping SourceColumn="MZ_ENTREGAR" DataSetColumn="MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_MZ_ENTREGAR" DataSetColumn="TONEL_MZ_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="FIN_LOTE" DataSetColumn="FIN_LOTE" />
              <Mapping SourceColumn="CODIVARIEDA" DataSetColumn="CODIVARIEDA" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="TIPO_CANA" DataSetColumn="TIPO_CANA" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="ID_TIPO" DataSetColumn="ID_TIPO" />
              <Mapping SourceColumn="REND_COSECHA" DataSetColumn="REND_COSECHA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="ID_TIPO_CANA" DataSetColumn="ID_TIPO_CANA" />
              <Mapping SourceColumn="MADURANTE" DataSetColumn="MADURANTE" />
              <Mapping SourceColumn="FECHA_APLICA" DataSetColumn="FECHA_APLICA" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="TONEL_SEMILLA" DataSetColumn="TONEL_SEMILLA" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJECUCION_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJECUCION_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TIPO" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CENSO" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_ZAFRA" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ESTADO_LOTE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIAGRON" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@EDAD_LOTE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC010TableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC010TableAdapter" Name="RPT_SIGESTA_EJEC010" UserDataComponentName="RPT_SIGESTA_EJEC010TableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>		SELECT 
			LC.ACCESLOTE,			
			L.ZONA AS ZONA,
			LEFT(LTRIM(L.ZONA),1) + 'X' AS CZONA,'TTTTTTTTTTTTTTTTTTTTT' AS CZONA_DESCRIP,
			L.SUB_ZONA,
			(SELECT D.NOMBRE_DEPTO FROM DEPARTAMENTO D WHERE D.CODI_DEPTO = ML.CODI_DEPTO) AS NOMBRE_DEPTO,
			(SELECT M.NOMBRE_MUNI FROM MUNICIPIO M WHERE M.CODI_DEPTO = ML.CODI_DEPTO AND M.CODI_MUNI = ML.CODI_MUNI) AS NOMBRE_MUNI,
			(SELECT C.NOMBRE_CANTON FROM CANTON C WHERE C.CODI_DEPTO = ML.CODI_DEPTO AND C.CODI_MUNI = ML.CODI_MUNI AND C.CODI_CANTON = ML.CODI_CANTON) AS NOMBRE_CANTON,
			dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS CODIPROVEE,
			dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, P.CODIPROVEEDOR,
			ISNULL(RTRIM(P.NOMBRES),'') + ' ' + ISNULL(RTRIM(P.APELLIDOS),'') AS NOMBRE_PROVEEDOR,
			L.CODILOTE, L.NOMBLOTE, C.CODICONTRATO, C.NO_CONTRATO, 
			LC.TONEL_CENSO, LC.TONEL_ENTREGADA, 		
			LC.TONEL_SEMILLA,
			LC.TONEL_SALDO_VAR,
			LC.TONEL_ENTREGAR,
			ML.CODI_DEPTO, ML.CODI_MUNI, ML.CODI_CANTON,
			99999999.9999 AS PH_TONEL_ENTREGADA,
			99999999.9999 AS PH_TONEL_ENTREGAR,
			99999999.9999 AS PV_TONEL_CENSO,
			99999999.9999 AS PV_TONEL_ENTREGADA,
			99999999.9999 AS PV_TONEL_ENTREGAR
		FROM LOTES L, LOTES_COSECHA LC, MAESTRO_LOTES ML, PROVEEDOR P,CONTRATO C, VARIEDAD V
		WHERE L.ACCESLOTE = LC.ACCESLOTE 
		AND L.ID_MAESTRO = ML.ID_MAESTRO 
		AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
		AND L.CODICONTRATO = C.CODICONTRATO
		AND L.CODIVARIEDA = V.CODIVARIEDA
		AND LC.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CZONA" DataSetColumn="CZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="TONEL_SEMILLA" DataSetColumn="TONEL_SEMILLA" />
              <Mapping SourceColumn="TONEL_SALDO_VAR" DataSetColumn="TONEL_SALDO_VAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="PH_TONEL_ENTREGADA" DataSetColumn="PH_TONEL_ENTREGADA" />
              <Mapping SourceColumn="PH_TONEL_ENTREGAR" DataSetColumn="PH_TONEL_ENTREGAR" />
              <Mapping SourceColumn="PV_TONEL_CENSO" DataSetColumn="PV_TONEL_CENSO" />
              <Mapping SourceColumn="PV_TONEL_ENTREGADA" DataSetColumn="PV_TONEL_ENTREGADA" />
              <Mapping SourceColumn="PV_TONEL_ENTREGAR" DataSetColumn="PV_TONEL_ENTREGAR" />
              <Mapping SourceColumn="CZONA_DESCRIP" DataSetColumn="CZONA_DESCRIP" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC010_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZonaCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCriterios" GeneratorSourceName="FillPorZonaCriterios" GetMethodModifier="Public" GetMethodName="GetPorZonaCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCriterios" UserSourceName="FillPorZonaCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC010_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_FABRICA" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC003TableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC003TableAdapter" Name="RPT_SIGESTA_EJEC003" UserDataComponentName="RPT_SIGESTA_EJEC003TableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS ACCESLOTE,
100 AS CORTE_CERRADO, 100 AS CATORCENA,
GETDATE() AS FECHA_INICIO,
GETDATE() AS FECHA_FIN,
9999999.99999 AS NETOTONEL,
9999999.99999 AS REND_85,
9999999.99999 AS REND_REAL,
12.9996666 AS EFICIENCIA,
9999999.99999 AS AZUCAR_CALC2,
9999999.99999 AS AZUCAR_CATORCENA_REAL,
9999999.99999 AS TONEL_CENSO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS PORC_NETOTONEL,
122533.0000 AS PORC_AZUCAR_REAL
WHERE 1 = -1


</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CORTE_CERRADO" DataSetColumn="CORTE_CERRADO" />
              <Mapping SourceColumn="CATORCENA" DataSetColumn="CATORCENA" />
              <Mapping SourceColumn="FECHA_INICIO" DataSetColumn="FECHA_INICIO" />
              <Mapping SourceColumn="FECHA_FIN" DataSetColumn="FECHA_FIN" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="EFICIENCIA" DataSetColumn="EFICIENCIA" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="PORC_NETOTONEL" DataSetColumn="PORC_NETOTONEL" />
              <Mapping SourceColumn="PORC_AZUCAR_REAL" DataSetColumn="PORC_AZUCAR_REAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC003_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC003_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC011_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC011_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC011_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC011_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS ACCESLOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS ZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CZONA_DESCRIP,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS SUB_ZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_DEPTO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_MUNI,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_CANTON,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODIPROVEE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODISOCIO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODIPROVEEDOR,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_PROVEEDOR,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODILOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBLOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODICONTRATO,
10000000 AS NO_CONTRATO,
10000000000.55555 AS TONEL_ENTREGAR,
10000000000.55555 AS TONEL_ENTREGAR_CORTA,
10000000000.55555 AS TONEL_ENTREGAR_LARGA,
10000000000.55555 AS TONEL_ENTREGAR_MECANIZADA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_DEPTO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_MUNI,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_CANTON,
10000000000.55555 AS PV_TONEL_ENTREGAR,
10000000000.55555 AS PV_TONEL_ENTREGAR_CORTA,
10000000000.55555 AS PV_TONEL_ENTREGAR_LARGA,
10000000000.55555 AS PV_TONEL_ENTREGAR_MECANIZADA,
10000000000.55555 AS PH_TONEL_ENTREGAR,
10000000000.55555 AS PH_TONEL_ENTREGAR_CORTA,
10000000000.55555 AS PH_TONEL_ENTREGAR_LARGA,
10000000000.55555 AS PH_TONEL_ENTREGAR_MECANIZADA,
10000000000.55555 AS PH_CZONA_TONEL_ENTREGAR_CORTA,
10000000000.55555 AS PH_CZONA_TONEL_ENTREGAR_LARGA,
10000000000.55555 AS PH_CZONA_TONEL_ENTREGAR_MECANIZADA,
10000000000.55555 AS PH_TOTAL_TONEL_ENTREGAR_CORTA,
10000000000.55555 AS PH_TOTAL_TONEL_ENTREGAR_LARGA,
10000000000.55555 AS PH_TOTAL_TONEL_ENTREGAR_MECANIZADA
FROM LOTES_COSECHA
WHERE 1 = -1
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CZONA" DataSetColumn="CZONA" />
              <Mapping SourceColumn="CZONA_DESCRIP" DataSetColumn="CZONA_DESCRIP" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR_CORTA" DataSetColumn="TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="TONEL_ENTREGAR_LARGA" DataSetColumn="TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="TONEL_ENTREGAR_MECANIZADA" DataSetColumn="TONEL_ENTREGAR_MECANIZADA" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="PV_TONEL_ENTREGAR" DataSetColumn="PV_TONEL_ENTREGAR" />
              <Mapping SourceColumn="PV_TONEL_ENTREGAR_CORTA" DataSetColumn="PV_TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="PV_TONEL_ENTREGAR_LARGA" DataSetColumn="PV_TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="PV_TONEL_ENTREGAR_MECANIZADA" DataSetColumn="PV_TONEL_ENTREGAR_MECANIZADA" />
              <Mapping SourceColumn="PH_TONEL_ENTREGAR" DataSetColumn="PH_TONEL_ENTREGAR" />
              <Mapping SourceColumn="PH_TONEL_ENTREGAR_CORTA" DataSetColumn="PH_TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="PH_TONEL_ENTREGAR_LARGA" DataSetColumn="PH_TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="PH_TONEL_ENTREGAR_MECANIZADA" DataSetColumn="PH_TONEL_ENTREGAR_MECANIZADA" />
              <Mapping SourceColumn="PH_CZONA_TONEL_ENTREGAR_CORTA" DataSetColumn="PH_CZONA_TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="PH_CZONA_TONEL_ENTREGAR_LARGA" DataSetColumn="PH_CZONA_TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="PH_CZONA_TONEL_ENTREGAR_MECANIZADA" DataSetColumn="PH_CZONA_TONEL_ENTREGAR_MECANIZADA" />
              <Mapping SourceColumn="PH_TOTAL_TONEL_ENTREGAR_CORTA" DataSetColumn="PH_TOTAL_TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="PH_TOTAL_TONEL_ENTREGAR_LARGA" DataSetColumn="PH_TOTAL_TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="PH_TOTAL_TONEL_ENTREGAR_MECANIZADA" DataSetColumn="PH_TOTAL_TONEL_ENTREGAR_MECANIZADA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC011_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZona" GeneratorSourceName="FillPorZona" GetMethodModifier="Public" GetMethodName="GetPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZona" UserSourceName="FillPorZona">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC011_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC006_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC006_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC006_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC006_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
10000000000 AS CANT_PROVEEDORES,
10000000000 AS RANGO_REND_REAL_DESDE,
10000000000 AS RANGO_REND_REAL_HASTA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEEDOR,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS ACCESLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS REND_REAL_PROMEDIO,
122533.0000 AS TONEL_ENTREGADA,
122533.0000 AS LBS_ENTREGADA,
122533.0000 AS PORC_TONEL_ENTREGADA,
122533.0000 AS PORC_LBS_ENTREGADA,
122533.0000 AS REND_REAL_PROMEDIO_TOTAL
FROM LOTES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CANT_PROVEEDORES" DataSetColumn="CANT_PROVEEDORES" />
              <Mapping SourceColumn="RANGO_REND_REAL_DESDE" DataSetColumn="RANGO_REND_REAL_DESDE" />
              <Mapping SourceColumn="RANGO_REND_REAL_HASTA" DataSetColumn="RANGO_REND_REAL_HASTA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="REND_REAL_PROMEDIO" DataSetColumn="REND_REAL_PROMEDIO" />
              <Mapping SourceColumn="LBS_ENTREGADA" DataSetColumn="LBS_ENTREGADA" />
              <Mapping SourceColumn="PORC_LBS_ENTREGADA" DataSetColumn="PORC_LBS_ENTREGADA" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="PORC_TONEL_ENTREGADA" DataSetColumn="PORC_TONEL_ENTREGADA" />
              <Mapping SourceColumn="REND_REAL_PROMEDIO_TOTAL" DataSetColumn="REND_REAL_PROMEDIO_TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC006_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC006_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC004_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC004_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC004_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC004_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
10000000000 AS CANT_PROVEEDORES,
122533.0000 AS RANGO_MZ_DESDE,
122533.0000 AS RANGO_MZ_HASTA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEEDOR,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS ACCESLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS AREA,
122533.0000 AS TONEL_TC,
122533.0000 AS MZ_CENSO,
122533.0000 AS TONEL_CENSO,
122533.0000 AS PORC_AREA,
122533.0000 AS PORC_TONEL_TC,
122533.0000 AS PORC_MZ_CENSO,
122533.0000 AS PORC_TONEL_CENSO
FROM LOTES WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CANT_PROVEEDORES" DataSetColumn="CANT_PROVEEDORES" />
              <Mapping SourceColumn="RANGO_MZ_DESDE" DataSetColumn="RANGO_MZ_DESDE" />
              <Mapping SourceColumn="RANGO_MZ_HASTA" DataSetColumn="RANGO_MZ_HASTA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="AREA" DataSetColumn="AREA" />
              <Mapping SourceColumn="TONEL_TC" DataSetColumn="TONEL_TC" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="PORC_AREA" DataSetColumn="PORC_AREA" />
              <Mapping SourceColumn="PORC_TONEL_TC" DataSetColumn="PORC_TONEL_TC" />
              <Mapping SourceColumn="PORC_MZ_CENSO" DataSetColumn="PORC_MZ_CENSO" />
              <Mapping SourceColumn="PORC_TONEL_CENSO" DataSetColumn="PORC_TONEL_CENSO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC004_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC004_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC005_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC005_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC005_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC005_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
10000000000 AS CANT_PROVEEDORES,
122533.0000 AS RANGO_TC_MZ_DESDE,
122533.0000 AS RANGO_TC_MZ_HASTA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEEDOR,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS ACCESLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS AREA,
122533.0000 AS TONEL_TC,
122533.0000 AS MZ_CENSO,
122533.0000 AS TONEL_CENSO,
122533.0000 AS PORC_AREA,
122533.0000 AS PORC_TONEL_TC,
122533.0000 AS PORC_MZ_CENSO,
122533.0000 AS PORC_TONEL_CENSO
FROM LOTES WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CANT_PROVEEDORES" DataSetColumn="CANT_PROVEEDORES" />
              <Mapping SourceColumn="RANGO_TC_MZ_DESDE" DataSetColumn="RANGO_TC_MZ_DESDE" />
              <Mapping SourceColumn="RANGO_TC_MZ_HASTA" DataSetColumn="RANGO_TC_MZ_HASTA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="AREA" DataSetColumn="AREA" />
              <Mapping SourceColumn="TONEL_TC" DataSetColumn="TONEL_TC" />
              <Mapping SourceColumn="MZ_CENSO" DataSetColumn="MZ_CENSO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="PORC_AREA" DataSetColumn="PORC_AREA" />
              <Mapping SourceColumn="PORC_TONEL_TC" DataSetColumn="PORC_TONEL_TC" />
              <Mapping SourceColumn="PORC_MZ_CENSO" DataSetColumn="PORC_MZ_CENSO" />
              <Mapping SourceColumn="PORC_TONEL_CENSO" DataSetColumn="PORC_TONEL_CENSO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC005_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC005_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC014_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC014_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC014_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC014_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS ACCESLOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS ZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CZONA_DESCRIP,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS SUB_ZONA,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_DEPTO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_MUNI,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_CANTON,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODIPROVEE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODISOCIO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODIPROVEEDOR,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBRE_PROVEEDOR,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODILOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS NOMBLOTE,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODICONTRATO,
10000000 AS NO_CONTRATO,
10000000000.23322 AS TONEL_ENTREGAR, 
10000000000.23322 AS TONEL_ENTREGAR_CORTA, 
10000000000.23322 AS TONEL_ENTREGAR_LARGA, 
10000000000.23322 AS TONEL_ENTREGAR_MECANIZADA,
10000000000 AS CORTA_CAMION,
10000000000 AS CORTA_3EJES,
10000000000 AS CORTA_RASTRA,
10000000000 AS LARGA_CAMION,
10000000000 AS LARGA_3EJES,
10000000000 AS LARGA_RASTRA,
10000000000 AS MECANIZADA_CAMION,
10000000000 AS MECANIZADA_3EJES,
10000000000 AS MECANIZADA_RASTRA,
10000000000 AS TOTAL_CAMION,
10000000000 AS TOTAL_3EJES,
10000000000 AS TOTAL_RASTRA,
10000000000 AS CORTA_CAMION_CAP, 
10000000000 AS LARGA_CAMION_CAP, 
10000000000 AS LARGA_3EJES_CAP, 
10000000000 AS LARGA_RASTRA_CAP, 
10000000000 AS MECANIZA_CAMION_CAP, 
10000000000 AS MECANIZA_3EJES_CAP,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_DEPTO,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_MUNI,
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' AS CODI_CANTON
FROM LOTES_COSECHA
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CORTA_CAMION" DataSetColumn="CORTA_CAMION" />
              <Mapping SourceColumn="CORTA_3EJES" DataSetColumn="CORTA_3EJES" />
              <Mapping SourceColumn="CORTA_RASTRA" DataSetColumn="CORTA_RASTRA" />
              <Mapping SourceColumn="LARGA_CAMION" DataSetColumn="LARGA_CAMION" />
              <Mapping SourceColumn="LARGA_3EJES" DataSetColumn="LARGA_3EJES" />
              <Mapping SourceColumn="LARGA_RASTRA" DataSetColumn="LARGA_RASTRA" />
              <Mapping SourceColumn="MECANIZADA_CAMION" DataSetColumn="MECANIZADA_CAMION" />
              <Mapping SourceColumn="MECANIZADA_3EJES" DataSetColumn="MECANIZADA_3EJES" />
              <Mapping SourceColumn="MECANIZADA_RASTRA" DataSetColumn="MECANIZADA_RASTRA" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="CORTA_CAMION_CAP" DataSetColumn="CORTA_CAMION_CAP" />
              <Mapping SourceColumn="LARGA_CAMION_CAP" DataSetColumn="LARGA_CAMION_CAP" />
              <Mapping SourceColumn="LARGA_3EJES_CAP" DataSetColumn="LARGA_3EJES_CAP" />
              <Mapping SourceColumn="LARGA_RASTRA_CAP" DataSetColumn="LARGA_RASTRA_CAP" />
              <Mapping SourceColumn="MECANIZA_CAMION_CAP" DataSetColumn="MECANIZA_CAMION_CAP" />
              <Mapping SourceColumn="MECANIZA_3EJES_CAP" DataSetColumn="MECANIZA_3EJES_CAP" />
              <Mapping SourceColumn="TOTAL_CAMION" DataSetColumn="TOTAL_CAMION" />
              <Mapping SourceColumn="TOTAL_3EJES" DataSetColumn="TOTAL_3EJES" />
              <Mapping SourceColumn="TOTAL_RASTRA" DataSetColumn="TOTAL_RASTRA" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR_CORTA" DataSetColumn="TONEL_ENTREGAR_CORTA" />
              <Mapping SourceColumn="TONEL_ENTREGAR_LARGA" DataSetColumn="TONEL_ENTREGAR_LARGA" />
              <Mapping SourceColumn="TONEL_ENTREGAR_MECANIZADA" DataSetColumn="TONEL_ENTREGAR_MECANIZADA" />
              <Mapping SourceColumn="CZONA" DataSetColumn="CZONA" />
              <Mapping SourceColumn="CZONA_DESCRIP" DataSetColumn="CZONA_DESCRIP" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC014_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZona" GeneratorSourceName="FillPorZona" GetMethodModifier="Public" GetMethodName="GetPorZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZona" UserSourceName="FillPorZona">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC014_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC014_PLAN_CATORCENAL" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZonaCatorcenal" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZonaCatorcenal" GeneratorSourceName="FillPorZonaCatorcenal" GetMethodModifier="Public" GetMethodName="GetPorZonaCatorcenal" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZonaCatorcenal" UserSourceName="FillPorZonaCatorcenal">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC014_PLAN_CATORCENAL</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_INI_COSECHA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_FIN_COSECHA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIAGRON" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC012_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC012_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC012_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC012_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
1000 AS GRUPO,
1000 AS CORRELATIVO,
'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AS DESCRIP_CORTE,
100000.2322 AS REND_GRAL,
100000.2322 AS REND_NORTE,
100000.2322 AS REND_SUR,
100000.2322 AS REND_N1,
100000.2322 AS REND_N2,
100000.2322 AS REND_N3,
100000.2322 AS REND_S1,
100000.2322 AS REND_S2,
100000.2322 AS REND_S3,
100000.2322 AS REND_S4,
'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AS ENCA1,
'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AS ENCA2
FROM LOTES
WHERE 1 = -1
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="GRUPO" DataSetColumn="GRUPO" />
              <Mapping SourceColumn="CORRELATIVO" DataSetColumn="CORRELATIVO" />
              <Mapping SourceColumn="DESCRIP_CORTE" DataSetColumn="DESCRIP_CORTE" />
              <Mapping SourceColumn="REND_GRAL" DataSetColumn="REND_GRAL" />
              <Mapping SourceColumn="REND_NORTE" DataSetColumn="REND_NORTE" />
              <Mapping SourceColumn="REND_SUR" DataSetColumn="REND_SUR" />
              <Mapping SourceColumn="REND_N1" DataSetColumn="REND_N1" />
              <Mapping SourceColumn="REND_N2" DataSetColumn="REND_N2" />
              <Mapping SourceColumn="REND_N3" DataSetColumn="REND_N3" />
              <Mapping SourceColumn="REND_S1" DataSetColumn="REND_S1" />
              <Mapping SourceColumn="REND_S2" DataSetColumn="REND_S2" />
              <Mapping SourceColumn="REND_S3" DataSetColumn="REND_S3" />
              <Mapping SourceColumn="REND_S4" DataSetColumn="REND_S4" />
              <Mapping SourceColumn="ENCA1" DataSetColumn="ENCA1" />
              <Mapping SourceColumn="ENCA2" DataSetColumn="ENCA2" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC012_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC012_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC001_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC001_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC001_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC001_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS TIPO_QUEMA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS TIPO_CANA,
9999999.99999 AS NETOTONEL,
9999999.99999 AS AZUCAR_CALC2,
9999999.99999 AS AZUCAR_CATORCENA_REAL,
9999999.99999 AS TONEL_CENSO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS PORC_NETOTONEL,
122533.0000 AS PORC_TIPO_QUEMA,
122533.0000 AS PORC_TIPO_CANA,
122533.0000 AS REND_85,
122533.0000 AS REND_REAL,
122533.0000 AS REND_85_TIPO_QUEMA,
122533.0000 AS REND_85_TIPO_CANA,
122533.0000 AS REND_REAL_TIPO_QUEMA,
122533.0000 AS REND_REAL_TIPO_CANA,
122533.0000 AS REND_85_TOTAL,
122533.0000 AS REND_REAL_TOTAL
FROM LOTES 
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TIPO_QUEMA" DataSetColumn="TIPO_QUEMA" />
              <Mapping SourceColumn="TIPO_CANA" DataSetColumn="TIPO_CANA" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="PORC_NETOTONEL" DataSetColumn="PORC_NETOTONEL" />
              <Mapping SourceColumn="PORC_TIPO_QUEMA" DataSetColumn="PORC_TIPO_QUEMA" />
              <Mapping SourceColumn="PORC_TIPO_CANA" DataSetColumn="PORC_TIPO_CANA" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="REND_85_TIPO_QUEMA" DataSetColumn="REND_85_TIPO_QUEMA" />
              <Mapping SourceColumn="REND_85_TIPO_CANA" DataSetColumn="REND_85_TIPO_CANA" />
              <Mapping SourceColumn="REND_REAL_TIPO_QUEMA" DataSetColumn="REND_REAL_TIPO_QUEMA" />
              <Mapping SourceColumn="REND_REAL_TIPO_CANA" DataSetColumn="REND_REAL_TIPO_CANA" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC001_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC001_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC007_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC007_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC007_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC007_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS TIPO_COSECHADORA,
45855455 AS ID_CARGADORA,
9999999.99999 AS NETOTONEL,
9999999.99999 AS AZUCAR_CALC2,
9999999.99999 AS AZUCAR_CATORCENA_REAL,
9999999.99999 AS TONEL_CENSO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS PORC_NETOTONEL,
122533.0000 AS PORC_LBS_AZUCAR,
122533.0000 AS REND_85,
122533.0000 AS REND_REAL,
122533.0000 AS EFICIENCIA,
122533.0000 AS REND_85_COSECHADORA,
122533.0000 AS REND_REAL_COSECHADORA,
122533.0000 AS EFICIENCIA_COSECHADORA,
122533.0000 AS REND_85_TOTAL,
122533.0000 AS REND_REAL_TOTAL,
122533.0000 AS EFICIENCIA_TOTAL
FROM LOTES 
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TIPO_COSECHADORA" DataSetColumn="TIPO_COSECHADORA" />
              <Mapping SourceColumn="ID_CARGADORA" DataSetColumn="ID_CARGADORA" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="PORC_NETOTONEL" DataSetColumn="PORC_NETOTONEL" />
              <Mapping SourceColumn="PORC_LBS_AZUCAR" DataSetColumn="PORC_LBS_AZUCAR" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="EFICIENCIA" DataSetColumn="EFICIENCIA" />
              <Mapping SourceColumn="REND_85_COSECHADORA" DataSetColumn="REND_85_COSECHADORA" />
              <Mapping SourceColumn="REND_REAL_COSECHADORA" DataSetColumn="REND_REAL_COSECHADORA" />
              <Mapping SourceColumn="EFICIENCIA_COSECHADORA" DataSetColumn="EFICIENCIA_COSECHADORA" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
              <Mapping SourceColumn="EFICIENCIA_TOTAL" DataSetColumn="EFICIENCIA_TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC007_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC007_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC008_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC008_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC008_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC008_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS TIPO_CARGADORA,
45855455 AS ID_CARGADORA,
9999999.99999 AS NETOTONEL,
9999999.99999 AS AZUCAR_CALC2,
9999999.99999 AS AZUCAR_CATORCENA_REAL,
9999999.99999 AS TONEL_CENSO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS PORC_NETOTONEL,
122533.0000 AS PORC_LBS_AZUCAR,
122533.0000 AS REND_85,
122533.0000 AS REND_REAL,
122533.0000 AS EFICIENCIA,
122533.0000 AS REND_85_CARGADORA,
122533.0000 AS REND_REAL_CARGADORA,
122533.0000 AS EFICIENCIA_CARGADORA,
122533.0000 AS REND_85_TOTAL,
122533.0000 AS REND_REAL_TOTAL,
122533.0000 AS EFICIENCIA_TOTAL
FROM LOTES 
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TIPO_CARGADORA" DataSetColumn="TIPO_CARGADORA" />
              <Mapping SourceColumn="ID_CARGADORA" DataSetColumn="ID_CARGADORA" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="PORC_NETOTONEL" DataSetColumn="PORC_NETOTONEL" />
              <Mapping SourceColumn="PORC_LBS_AZUCAR" DataSetColumn="PORC_LBS_AZUCAR" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="EFICIENCIA" DataSetColumn="EFICIENCIA" />
              <Mapping SourceColumn="REND_85_CARGADORA" DataSetColumn="REND_85_CARGADORA" />
              <Mapping SourceColumn="REND_REAL_CARGADORA" DataSetColumn="REND_REAL_CARGADORA" />
              <Mapping SourceColumn="EFICIENCIA_CARGADORA" DataSetColumn="EFICIENCIA_CARGADORA" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
              <Mapping SourceColumn="EFICIENCIA_TOTAL" DataSetColumn="EFICIENCIA_TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC008_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC008_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC009_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC009_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC009_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC009_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CLASE_TRANSPORTE,
'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AS TIPO_TRANSPORTE,
9999999.99999 AS NETOTONEL,
9999999.99999 AS AZUCAR_CALC2,
9999999.99999 AS AZUCAR_CATORCENA_REAL,
9999999.99999 AS TONEL_CENSO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYYUUUUUUUUUUYYYYY' AS CODIPROVEE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYYY' AS CODISOCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBRE_PROVEEDOR,
10000 AS NO_CONTRATO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CODILOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOMBLOTE,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS NOM_VARIEDAD,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS ZONA,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS SUB_ZONA,
GETDATE() AS FECHA_ROZA,
100000 AS SEMANA,
100000 AS TERCIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS DEPARTAMENTO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS MUNICIPIO,
'DFDFDFFFDFDFYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUYYYYYYYY' AS CANTON,
122533.0000 AS PORC_NETOTONEL,
122533.0000 AS PORC_LBS_AZUCAR,
122533.0000 AS REND_85,
122533.0000 AS REND_REAL,
122533.0000 AS EFICIENCIA,
122533.0000 AS REND_85_CLASE_TRANSPORTE,
122533.0000 AS REND_REAL_CLASE_TRANSPORTE,
122533.0000 AS EFICIENCIA_CLASE_TRANSPORTE,
122533.0000 AS REND_85_TOTAL,
122533.0000 AS REND_REAL_TOTAL,
122533.0000 AS EFICIENCIA_TOTAL
FROM LOTES 
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CLASE_TRANSPORTE" DataSetColumn="CLASE_TRANSPORTE" />
              <Mapping SourceColumn="TIPO_TRANSPORTE" DataSetColumn="TIPO_TRANSPORTE" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="FECHA_ROZA" DataSetColumn="FECHA_ROZA" />
              <Mapping SourceColumn="SEMANA" DataSetColumn="SEMANA" />
              <Mapping SourceColumn="TERCIO" DataSetColumn="TERCIO" />
              <Mapping SourceColumn="DEPARTAMENTO" DataSetColumn="DEPARTAMENTO" />
              <Mapping SourceColumn="MUNICIPIO" DataSetColumn="MUNICIPIO" />
              <Mapping SourceColumn="CANTON" DataSetColumn="CANTON" />
              <Mapping SourceColumn="PORC_NETOTONEL" DataSetColumn="PORC_NETOTONEL" />
              <Mapping SourceColumn="PORC_LBS_AZUCAR" DataSetColumn="PORC_LBS_AZUCAR" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="REND_REAL" DataSetColumn="REND_REAL" />
              <Mapping SourceColumn="EFICIENCIA" DataSetColumn="EFICIENCIA" />
              <Mapping SourceColumn="REND_85_CLASE_TRANSPORTE" DataSetColumn="REND_85_CLASE_TRANSPORTE" />
              <Mapping SourceColumn="REND_REAL_CLASE_TRANSPORTE" DataSetColumn="REND_REAL_CLASE_TRANSPORTE" />
              <Mapping SourceColumn="EFICIENCIA_CLASE_TRANSPORTE" DataSetColumn="EFICIENCIA_CLASE_TRANSPORTE" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
              <Mapping SourceColumn="EFICIENCIA_TOTAL" DataSetColumn="EFICIENCIA_TOTAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC009_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC009_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIVARIEDA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_TIPO_CANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA1" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA2" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@SEMANA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTETableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTETableAdapter" Name="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" UserDataComponentName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTETableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
'XXXXX' AS ZONA,
'XXXXX' AS DESCRIP_ZONA,
'XXXXX' AS ACCESLOTE,
'XXXXX' AS CODIPROVEE,
'XXXXX' AS CODISOCIO,
'XXXXX' AS PRODUCTOR,
'XXXXX' AS CODILOTE,
'XXXXX' AS NOMBLOTE,
'XXXXX' AS COD_CARGA1,
'XXXXX' AS COD_CARGA2,
'XXXXX' AS COD_CARGA3,
10000000000 AS CORRELATIVO
FROM LOTES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PRODUCTOR" DataSetColumn="PRODUCTOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="COD_CARGA1" DataSetColumn="COD_CARGA1" />
              <Mapping SourceColumn="COD_CARGA2" DataSetColumn="COD_CARGA2" />
              <Mapping SourceColumn="COD_CARGA3" DataSetColumn="COD_CARGA3" />
              <Mapping SourceColumn="CORRELATIVO" DataSetColumn="CORRELATIVO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIAZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PLAN_COSECHA_DIARIOTableAdapter" GeneratorDataComponentClassName="PLAN_COSECHA_DIARIOTableAdapter" Name="PLAN_COSECHA_DIARIO" UserDataComponentName="PLAN_COSECHA_DIARIOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	'XXX' AS ZAFRA,
	'XXX' AS ZONA,
	'XXX' AS CODIPROVEE,
	'XXX' AS CCODISOCIO,
	'XXX' AS PROVEEDOR,
	'XXX' AS CODILOTE,
	'XXX' AS NOMBLOTE,
	'XXX' AS ACCESLOTE,
	0.008 AS ROZA_ANTERIOR,
	0.008 AS ROZA_DIA,
	0.008 AS ROZA_PROYECTADA,
	0.008 AS TONEL_CENSO,
	0.008 AS TONEL_ENTREGADA,
	0.008 AS TONEL_ENTREGAR,
	0.008 AS SALDO_QUEMA_PROG,
	0.008 AS SALDO_QUEMA_NOPROG,
	0.008 AS SALDO_ROZA,
	0.008 AS INV_CANA,
	0.008 AS INV_PROYECTADO,
	0.008 AS MOLIENDA,
	GETDATE() AS FECHA_PRECOSECHA,
	0.008 AS REND_85,
	0 AS AUTORIZADO
FROM LOTES
WHERE -1 = 1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CCODISOCIO" DataSetColumn="CCODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ROZA_ANTERIOR" DataSetColumn="ROZA_ANTERIOR" />
              <Mapping SourceColumn="ROZA_DIA" DataSetColumn="ROZA_DIA" />
              <Mapping SourceColumn="ROZA_PROYECTADA" DataSetColumn="ROZA_PROYECTADA" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="SALDO_ROZA" DataSetColumn="SALDO_ROZA" />
              <Mapping SourceColumn="INV_CANA" DataSetColumn="INV_CANA" />
              <Mapping SourceColumn="INV_PROYECTADO" DataSetColumn="INV_PROYECTADO" />
              <Mapping SourceColumn="SALDO_QUEMA_PROG" DataSetColumn="SALDO_QUEMA_PROG" />
              <Mapping SourceColumn="SALDO_QUEMA_NOPROG" DataSetColumn="SALDO_QUEMA_NOPROG" />
              <Mapping SourceColumn="MOLIENDA" DataSetColumn="MOLIENDA" />
              <Mapping SourceColumn="FECHA_PRECOSECHA" DataSetColumn="FECHA_PRECOSECHA" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="AUTORIZADO" DataSetColumn="AUTORIZADO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC001_PLAN_COSECHA_DIARIO" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC001_PLAN_COSECHA_DIARIO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_HORA_FINAL" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@TIPO" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASTableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASTableAdapter" Name="RPT_SIGESTA_EJEC014_COMPA_ZAFRAS" UserDataComponentName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
1 AS DIAZAFRA,
'X' AS ZAFRA1,
'X' AS ZAFR21,
GETDATE() AS FECHA1,
GETDATE() AS FECHA2,
0.001 AS TC1,
0.001 AS TC1_A,
0.001 AS TC2,
0.001 AS TC2_A,
0.001 AS REND851,
0.001 AS REND851_A,
0.001 AS REND852,
0.001 AS REND852_A,
0.001 AS REND_REAL1,
0.001 AS REND_REAL1_A,
0.001 AS REND_REAL2,
0.001 AS REND_REAL2_A,
0.001 AS EFICIENCIA1,
0.001 AS EFICIENCIA2,
0.001 AS LBS_REAL1,
0.001 AS LBS_REAL1_A,
0.001 AS LBS_REAL2,
0.001 AS LBS_REAL2_A,
0.001 AS REND851_A_PROM,
0.001 AS REND852_A_PROM,
0.001 AS REND_REAL1_A_PROM,
0.001 AS REND_REAL2_A_PROM,
0.001 AS EFICIENCIA1_PROM,
0.001 AS EFICIENCIA2_PROM,

0.001 AS DIF_TC_PROM,
0.001 AS DIF_TC_TOTAL,
0.001 AS DIF_LBS_REAL_A_PROM,
0.001 AS DIF_REND85_A_PROM,
0.001 AS DIF_REND_REAL_A_PROM,
0.001 AS DIF_EFICIENCIA_PROM,
0.001 AS REND851_PROM,
0.001 AS REND852_PROM,
0.001 AS REND_REAL1_PROM,
0.001 AS REND_REAL2_PROM,
0.001 AS LBS_REAL1_PROM,
0.001 AS LBS_REAL2_PROM,
0.001 AS DIF_LBS_REAL_PROM,
0.001 AS DIF_REND85_PROM,
0.001 AS DIF_REND_REAL_PROM
FROM LOTES
WHERE -1 = 1</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="AnsiString" Direction="Input" ParameterName="Parameter1" Precision="0" Scale="0" Size="0" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="DIAZAFRA" DataSetColumn="DIAZAFRA" />
              <Mapping SourceColumn="ZAFRA1" DataSetColumn="ZAFRA1" />
              <Mapping SourceColumn="FECHA1" DataSetColumn="FECHA1" />
              <Mapping SourceColumn="FECHA2" DataSetColumn="FECHA2" />
              <Mapping SourceColumn="TC1" DataSetColumn="TC1" />
              <Mapping SourceColumn="TC1_A" DataSetColumn="TC1_A" />
              <Mapping SourceColumn="TC2" DataSetColumn="TC2" />
              <Mapping SourceColumn="TC2_A" DataSetColumn="TC2_A" />
              <Mapping SourceColumn="REND851" DataSetColumn="REND851" />
              <Mapping SourceColumn="REND851_A" DataSetColumn="REND851_A" />
              <Mapping SourceColumn="REND852" DataSetColumn="REND852" />
              <Mapping SourceColumn="REND852_A" DataSetColumn="REND852_A" />
              <Mapping SourceColumn="REND_REAL1" DataSetColumn="REND_REAL1" />
              <Mapping SourceColumn="REND_REAL1_A" DataSetColumn="REND_REAL1_A" />
              <Mapping SourceColumn="REND_REAL2" DataSetColumn="REND_REAL2" />
              <Mapping SourceColumn="REND_REAL2_A" DataSetColumn="REND_REAL2_A" />
              <Mapping SourceColumn="EFICIENCIA1" DataSetColumn="EFICIENCIA1" />
              <Mapping SourceColumn="EFICIENCIA2" DataSetColumn="EFICIENCIA2" />
              <Mapping SourceColumn="LBS_REAL1" DataSetColumn="LBS_REAL1" />
              <Mapping SourceColumn="LBS_REAL1_A" DataSetColumn="LBS_REAL1_A" />
              <Mapping SourceColumn="LBS_REAL2" DataSetColumn="LBS_REAL2" />
              <Mapping SourceColumn="LBS_REAL2_A" DataSetColumn="LBS_REAL2_A" />
              <Mapping SourceColumn="DIF_TC_PROM" DataSetColumn="DIF_TC_PROM" />
              <Mapping SourceColumn="DIF_TC_TOTAL" DataSetColumn="DIF_TC_TOTAL" />
              <Mapping SourceColumn="ZAFR21" DataSetColumn="ZAFR21" />
              <Mapping SourceColumn="DIF_REND85_A_PROM" DataSetColumn="DIF_REND85_A_PROM" />
              <Mapping SourceColumn="DIF_REND_REAL_A_PROM" DataSetColumn="DIF_REND_REAL_A_PROM" />
              <Mapping SourceColumn="DIF_EFICIENCIA_PROM" DataSetColumn="DIF_EFICIENCIA_PROM" />
              <Mapping SourceColumn="REND851_PROM" DataSetColumn="REND851_PROM" />
              <Mapping SourceColumn="REND852_PROM" DataSetColumn="REND852_PROM" />
              <Mapping SourceColumn="REND_REAL1_PROM" DataSetColumn="REND_REAL1_PROM" />
              <Mapping SourceColumn="REND_REAL2_PROM" DataSetColumn="REND_REAL2_PROM" />
              <Mapping SourceColumn="LBS_REAL1_PROM" DataSetColumn="LBS_REAL1_PROM" />
              <Mapping SourceColumn="LBS_REAL2_PROM" DataSetColumn="LBS_REAL2_PROM" />
              <Mapping SourceColumn="DIF_LBS_REAL_PROM" DataSetColumn="DIF_LBS_REAL_PROM" />
              <Mapping SourceColumn="DIF_REND85_PROM" DataSetColumn="DIF_REND85_PROM" />
              <Mapping SourceColumn="DIF_REND_REAL_PROM" DataSetColumn="DIF_REND_REAL_PROM" />
              <Mapping SourceColumn="REND851_A_PROM" DataSetColumn="REND851_A_PROM" />
              <Mapping SourceColumn="REND852_A_PROM" DataSetColumn="REND852_A_PROM" />
              <Mapping SourceColumn="REND_REAL1_A_PROM" DataSetColumn="REND_REAL1_A_PROM" />
              <Mapping SourceColumn="REND_REAL2_A_PROM" DataSetColumn="REND_REAL2_A_PROM" />
              <Mapping SourceColumn="EFICIENCIA1_PROM" DataSetColumn="EFICIENCIA1_PROM" />
              <Mapping SourceColumn="EFICIENCIA2_PROM" DataSetColumn="EFICIENCIA2_PROM" />
              <Mapping SourceColumn="DIF_LBS_REAL_A_PROM" DataSetColumn="DIF_LBS_REAL_A_PROM" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC014_COMPA_ZAFRAS" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC014_COMPA_ZAFRAS</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA1" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA2" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC015_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC015_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC015_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC015_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
1 AS ORDEN_EDAD,
'X' AS DESCRIP_EDAD,
'X' AS ZONA,
'X' AS NOMBRE_DEPTO,
'X' AS NOMBRE_MUNI,
'X' AS NOMBRE_CANTON,
'X' AS CODIPROVEE,
'X' AS CODISOCIO,
'X' AS CODIPROVEEDOR,
'X' AS NOMBRE_PROVEEDOR,
'X' AS CODILOTE,
'X' AS NOMBLOTE,
'X' AS CODICONTRATO,
1122 AS NO_CONTRATO,
4412.363 AS TONEL_CENSO,
4412.363 AS ZONA_NORTE,
4412.363 AS ZONA_SUR,
4412.363 AS TONEL_ENTREGADA,
4412.363 AS AZUCAR_CALC2,
4412.363 AS AZUCAR_CATORCENA_REAL,
4412.363 AS TONEL_SEMILLA,
4412.363 AS TONEL_SALDO_VAR,
4412.363 AS TONEL_ENTREGAR,
'X' AS CODI_DEPTO,
'X' AS CODI_MUNI,
'X' AS CODI_CANTON,
440.02333 AS PORC_TONEL_CENSO_V,
440.02333 AS PORC_NETOTONEL_V,
440.02333 AS PORC_NETOTONEL_H,
440.02333 AS REND_85_ORDEN_EDAD,
440.02333 AS REND_REAL_ORDEN_EDAD,
440.02333 AS PORC_NETOTONEL_TOTAL_H,
440.02333 AS REND_85_TOTAL,
440.02333 AS REND_REAL_TOTAL,
440.02333 AS PORC_ZONA_NORTE_V,
440.02333 AS PORC_ZONA_NORTE_H,
440.02333 AS PORC_ZONA_SUR_V,
440.02333 AS PORC_ZONA_SUR_H,
440.02333 AS PORC_ZONA_NORTE_TOTAL_H,
440.02333 AS PORC_ZONA_SUR_TOTAL_H
FROM LOTES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ORDEN_EDAD" DataSetColumn="ORDEN_EDAD" />
              <Mapping SourceColumn="DESCRIP_EDAD" DataSetColumn="DESCRIP_EDAD" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="ZONA_NORTE" DataSetColumn="ZONA_NORTE" />
              <Mapping SourceColumn="ZONA_SUR" DataSetColumn="ZONA_SUR" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_SEMILLA" DataSetColumn="TONEL_SEMILLA" />
              <Mapping SourceColumn="TONEL_SALDO_VAR" DataSetColumn="TONEL_SALDO_VAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="PORC_TONEL_CENSO_V" DataSetColumn="PORC_TONEL_CENSO_V" />
              <Mapping SourceColumn="PORC_NETOTONEL_V" DataSetColumn="PORC_NETOTONEL_V" />
              <Mapping SourceColumn="PORC_NETOTONEL_H" DataSetColumn="PORC_NETOTONEL_H" />
              <Mapping SourceColumn="REND_85_ORDEN_EDAD" DataSetColumn="REND_85_ORDEN_EDAD" />
              <Mapping SourceColumn="REND_REAL_ORDEN_EDAD" DataSetColumn="REND_REAL_ORDEN_EDAD" />
              <Mapping SourceColumn="PORC_NETOTONEL_TOTAL_H" DataSetColumn="PORC_NETOTONEL_TOTAL_H" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_V" DataSetColumn="PORC_ZONA_NORTE_V" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_H" DataSetColumn="PORC_ZONA_NORTE_H" />
              <Mapping SourceColumn="PORC_ZONA_SUR_V" DataSetColumn="PORC_ZONA_SUR_V" />
              <Mapping SourceColumn="PORC_ZONA_SUR_H" DataSetColumn="PORC_ZONA_SUR_H" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_TOTAL_H" DataSetColumn="PORC_ZONA_NORTE_TOTAL_H" />
              <Mapping SourceColumn="PORC_ZONA_SUR_TOTAL_H" DataSetColumn="PORC_ZONA_SUR_TOTAL_H" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC015_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC015_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC017_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC017_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC017_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC017_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
'X' AS NOM_VARIEDAD,
'X' AS TIPO,
'X' AS SUB_TIPO,
'X' AS ZONA,
'X' AS NOMBRE_DEPTO,
'X' AS NOMBRE_MUNI,
'X' AS NOMBRE_CANTON,
'X' AS CODIPROVEE,
'X' AS CODISOCIO,
'X' AS CODIPROVEEDOR,
'X' AS NOMBRE_PROVEEDOR,
'X' AS CODILOTE,
'X' AS NOMBLOTE,
'X' AS CODICONTRATO,
1122 AS NO_CONTRATO,
4412.363 AS TONEL_CENSO,
4412.363 AS ZONA_NORTE,
4412.363 AS ZONA_SUR,
4412.363 AS TONEL_ENTREGADA,
4412.363 AS AZUCAR_CALC2,
4412.363 AS AZUCAR_CATORCENA_REAL,
4412.363 AS TONEL_SEMILLA,
4412.363 AS TONEL_SALDO_VAR,
4412.363 AS TONEL_ENTREGAR,
'X' AS CODI_DEPTO,
'X' AS CODI_MUNI,
'X' AS CODI_CANTON,
440.02333 AS PORC_TONEL_CENSO_V,
440.02333 AS PORC_NETOTONEL_V,
440.02333 AS PORC_NETOTONEL_H,
440.02333 AS REND_85_ORDEN_EDAD,
440.02333 AS REND_REAL_ORDEN_EDAD,
440.02333 AS PORC_NETOTONEL_TOTAL_H,
440.02333 AS REND_85_TOTAL,
440.02333 AS REND_REAL_TOTAL,
440.02333 AS PORC_ZONA_NORTE_V,
440.02333 AS PORC_ZONA_NORTE_H,
440.02333 AS PORC_ZONA_SUR_V,
440.02333 AS PORC_ZONA_SUR_H,
440.02333 AS PORC_ZONA_NORTE_TOTAL_H,
440.02333 AS PORC_ZONA_SUR_TOTAL_H
FROM LOTES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="SUB_TIPO" DataSetColumn="SUB_TIPO" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="ZONA_NORTE" DataSetColumn="ZONA_NORTE" />
              <Mapping SourceColumn="ZONA_SUR" DataSetColumn="ZONA_SUR" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="AZUCAR_CALC2" DataSetColumn="AZUCAR_CALC2" />
              <Mapping SourceColumn="AZUCAR_CATORCENA_REAL" DataSetColumn="AZUCAR_CATORCENA_REAL" />
              <Mapping SourceColumn="TONEL_SEMILLA" DataSetColumn="TONEL_SEMILLA" />
              <Mapping SourceColumn="TONEL_SALDO_VAR" DataSetColumn="TONEL_SALDO_VAR" />
              <Mapping SourceColumn="TONEL_ENTREGAR" DataSetColumn="TONEL_ENTREGAR" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="PORC_TONEL_CENSO_V" DataSetColumn="PORC_TONEL_CENSO_V" />
              <Mapping SourceColumn="PORC_NETOTONEL_V" DataSetColumn="PORC_NETOTONEL_V" />
              <Mapping SourceColumn="PORC_NETOTONEL_H" DataSetColumn="PORC_NETOTONEL_H" />
              <Mapping SourceColumn="REND_85_ORDEN_EDAD" DataSetColumn="REND_85_ORDEN_EDAD" />
              <Mapping SourceColumn="REND_REAL_ORDEN_EDAD" DataSetColumn="REND_REAL_ORDEN_EDAD" />
              <Mapping SourceColumn="PORC_NETOTONEL_TOTAL_H" DataSetColumn="PORC_NETOTONEL_TOTAL_H" />
              <Mapping SourceColumn="REND_85_TOTAL" DataSetColumn="REND_85_TOTAL" />
              <Mapping SourceColumn="REND_REAL_TOTAL" DataSetColumn="REND_REAL_TOTAL" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_V" DataSetColumn="PORC_ZONA_NORTE_V" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_H" DataSetColumn="PORC_ZONA_NORTE_H" />
              <Mapping SourceColumn="PORC_ZONA_SUR_V" DataSetColumn="PORC_ZONA_SUR_V" />
              <Mapping SourceColumn="PORC_ZONA_SUR_H" DataSetColumn="PORC_ZONA_SUR_H" />
              <Mapping SourceColumn="PORC_ZONA_NORTE_TOTAL_H" DataSetColumn="PORC_ZONA_NORTE_TOTAL_H" />
              <Mapping SourceColumn="PORC_ZONA_SUR_TOTAL_H" DataSetColumn="PORC_ZONA_SUR_TOTAL_H" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC017_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC017_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_SIGESTA_EJEC019_PLAN_COSECHATableAdapter" GeneratorDataComponentClassName="RPT_SIGESTA_EJEC019_PLAN_COSECHATableAdapter" Name="RPT_SIGESTA_EJEC019_PLAN_COSECHA" UserDataComponentName="RPT_SIGESTA_EJEC019_PLAN_COSECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
'X' AS ZONA,
'X' AS SUB_ZONA,
'X' AS NOMBRE_DEPTO,
'X' AS NOMBRE_MUNI,
'X' AS NOMBRE_CANTON,
1000 AS CODIPROVEE,
'X' AS CODISOCIO,
'X' AS CODIPROVEEDOR,
'X' AS NOMBRE_PROVEEDOR,
'X' AS CODILOTE,
'X' AS NOMBLOTE,
4412.363 AS TONEL_ENTREGADA,
4412.363 AS REND_COSECHA,
4412.363 AS LBS_ENTREGADA,
'X' AS CODI_DEPTO,
'X' AS CODI_MUNI,
'X' AS CODI_CANTON,
1000.23 AS RENDXPROVEEDOR,
1000.23 AS REND_GENERAL,
'' AS CODIPRINCIPAL,
'' AS AGRUPADOR,
1000 AS ORDEN
FROM LOTES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="SUB_ZONA" DataSetColumn="SUB_ZONA" />
              <Mapping SourceColumn="NOMBRE_DEPTO" DataSetColumn="NOMBRE_DEPTO" />
              <Mapping SourceColumn="NOMBRE_MUNI" DataSetColumn="NOMBRE_MUNI" />
              <Mapping SourceColumn="NOMBRE_CANTON" DataSetColumn="NOMBRE_CANTON" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="TONEL_ENTREGADA" DataSetColumn="TONEL_ENTREGADA" />
              <Mapping SourceColumn="REND_COSECHA" DataSetColumn="REND_COSECHA" />
              <Mapping SourceColumn="LBS_ENTREGADA" DataSetColumn="LBS_ENTREGADA" />
              <Mapping SourceColumn="CODI_DEPTO" DataSetColumn="CODI_DEPTO" />
              <Mapping SourceColumn="CODI_MUNI" DataSetColumn="CODI_MUNI" />
              <Mapping SourceColumn="CODI_CANTON" DataSetColumn="CODI_CANTON" />
              <Mapping SourceColumn="RENDXPROVEEDOR" DataSetColumn="RENDXPROVEEDOR" />
              <Mapping SourceColumn="REND_GENERAL" DataSetColumn="REND_GENERAL" />
              <Mapping SourceColumn="AGRUPADOR" DataSetColumn="AGRUPADOR" />
              <Mapping SourceColumn="ORDEN" DataSetColumn="ORDEN" />
              <Mapping SourceColumn="CODIPRINCIPAL" DataSetColumn="CODIPRINCIPAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_SIGESTA_EJEC019_PLAN_COSECHA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_SIGESTA_EJEC019_PLAN_COSECHA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@TIPO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@USUARIO_CREA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHA_CREA" Precision="23" ProviderType="DateTime" Scale="3" Size="8" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@CODIGOS_RELACIONADOS" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEEDOR" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLICITUD_REQUISICIONTableAdapter" GeneratorDataComponentClassName="SOLICITUD_REQUISICIONTableAdapter" Name="SOLICITUD_REQUISICION" UserDataComponentName="SOLICITUD_REQUISICIONTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT E.NO_REQ, E.CODI_REQ, P.DESCRIP_PERIODO, E.FECHA_EMISION, A.NOMBRE_SECCION, S.NOMBRE_SOLICITANTE,
E.USO, D.CODIGO, D.CANTIDAD, D.UNIDAD, D.DESCRIPCION, D.OBSERVACION, D.ID_REQDETA,
E.SECCION, E.EQUIPO, 
CASE E.PROPOSITO WHEN 1 THEN 'REPARACION' WHEN 2 THEN 'INVERSION' WHEN 3 THEN 'PROVISION' END AS PROPOSITO, 
CASE E.COMPRA_LOCAL WHEN 1 THEN 'LOCAL' ELSE 'EXTERIOR' END AS COMPRA,
E.FECHA_MAX_SUMIN  
FROM REQENCA E, REQDETA D, PERIODOREQ P, SECCION A, SOLICITANTE S
WHERE E.ID_REQENCA = D.ID_REQENCA
AND E.ID_PERIODOREQ = P.ID_PERIODOREQ
AND E.ID_SECCION = A.ID_SECCION
AND E.ID_SOLICITANTE = S.ID_SOLICITANTE
AND E.ID_REQENCA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NO_REQ" DataSetColumn="NO_REQ" />
              <Mapping SourceColumn="DESCRIP_PERIODO" DataSetColumn="DESCRIP_PERIODO" />
              <Mapping SourceColumn="FECHA_EMISION" DataSetColumn="FECHA_EMISION" />
              <Mapping SourceColumn="NOMBRE_SECCION" DataSetColumn="NOMBRE_SECCION" />
              <Mapping SourceColumn="NOMBRE_SOLICITANTE" DataSetColumn="NOMBRE_SOLICITANTE" />
              <Mapping SourceColumn="USO" DataSetColumn="USO" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="CANTIDAD" DataSetColumn="CANTIDAD" />
              <Mapping SourceColumn="UNIDAD" DataSetColumn="UNIDAD" />
              <Mapping SourceColumn="DESCRIPCION" DataSetColumn="DESCRIPCION" />
              <Mapping SourceColumn="OBSERVACION" DataSetColumn="OBSERVACION" />
              <Mapping SourceColumn="ID_REQDETA" DataSetColumn="ID_REQDETA" />
              <Mapping SourceColumn="CODI_REQ" DataSetColumn="CODI_REQ" />
              <Mapping SourceColumn="SECCION" DataSetColumn="SECCION" />
              <Mapping SourceColumn="EQUIPO" DataSetColumn="EQUIPO" />
              <Mapping SourceColumn="PROPOSITO" DataSetColumn="PROPOSITO" />
              <Mapping SourceColumn="COMPRA" DataSetColumn="COMPRA" />
              <Mapping SourceColumn="FECHA_MAX_SUMIN" DataSetColumn="FECHA_MAX_SUMIN" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorId" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorId" GeneratorSourceName="FillPorId" GetMethodModifier="Public" GetMethodName="GetPorId" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorId" UserSourceName="FillPorId">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT E.NO_REQ, E.CODI_REQ, P.DESCRIP_PERIODO, E.FECHA_EMISION, A.NOMBRE_SECCION, S.NOMBRE_SOLICITANTE,
E.USO, D.CODIGO, D.CANTIDAD, D.UNIDAD, D.DESCRIPCION, D.OBSERVACION, D.ID_REQDETA,
E.SECCION, E.EQUIPO, 
CASE E.PROPOSITO WHEN 1 THEN 'REPARACION' WHEN 2 THEN 'INVERSION' WHEN 3 THEN 'PROVISION' END AS PROPOSITO, 
CASE E.COMPRA_LOCAL WHEN 1 THEN 'LOCAL' ELSE 'EXTERIOR' END AS COMPRA,
E.FECHA_MAX_SUMIN  
FROM REQENCA E, REQDETA D, PERIODOREQ P, SECCION A, SOLICITANTE S
WHERE E.ID_REQENCA = D.ID_REQENCA
AND E.ID_PERIODOREQ = P.ID_PERIODOREQ
AND E.ID_SECCION = A.ID_SECCION
AND E.ID_SOLICITANTE = S.ID_SOLICITANTE
AND E.ID_REQENCA = @ID_REQENCA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_REQENCA" ColumnName="ID_REQENCA" DataSourceName="INJIBOA.dbo.REQENCA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_REQENCA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_REQENCA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_REQUISICIONESTableAdapter" GeneratorDataComponentClassName="RPT_REQUISICIONESTableAdapter" Name="RPT_REQUISICIONES" UserDataComponentName="RPT_REQUISICIONESTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT E.*, N.CODIGO AS COD_SECCION, N.NOMBRE_SECCION, S.CODIGO AS COD_SOLICITANTE, S.NOMBRE_SOLICITANTE, P.DESCRIP_PERIODO 	
	FROM REQENCA E, SECCION N, SOLICITANTE S, PERIODOREQ P		
	WHERE E.ID_SECCION		= N.ID_SECCION
	AND E.ID_SOLICITANTE	= S.ID_SOLICITANTE
	AND E.ID_PERIODOREQ		= P.ID_PERIODOREQ
	AND E.ID_REQENCA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_REQENCA" DataSetColumn="ID_REQENCA" />
              <Mapping SourceColumn="ID_PERIODOREQ" DataSetColumn="ID_PERIODOREQ" />
              <Mapping SourceColumn="ID_SECCION" DataSetColumn="ID_SECCION" />
              <Mapping SourceColumn="ID_SOLICITANTE" DataSetColumn="ID_SOLICITANTE" />
              <Mapping SourceColumn="NO_REQ" DataSetColumn="NO_REQ" />
              <Mapping SourceColumn="FECHA_EMISION" DataSetColumn="FECHA_EMISION" />
              <Mapping SourceColumn="NO_REQ_PH" DataSetColumn="NO_REQ_PH" />
              <Mapping SourceColumn="FECHA_REQ_PH" DataSetColumn="FECHA_REQ_PH" />
              <Mapping SourceColumn="NO_ORDEN_PH" DataSetColumn="NO_ORDEN_PH" />
              <Mapping SourceColumn="FECHA_ORDEN_PH" DataSetColumn="FECHA_ORDEN_PH" />
              <Mapping SourceColumn="TOTAL_ORDEN_PH" DataSetColumn="TOTAL_ORDEN_PH" />
              <Mapping SourceColumn="AFECTO_ORDEN_PH" DataSetColumn="AFECTO_ORDEN_PH" />
              <Mapping SourceColumn="IVA_ORDEN_PH" DataSetColumn="IVA_ORDEN_PH" />
              <Mapping SourceColumn="NO_INGRESO_ALM" DataSetColumn="NO_INGRESO_ALM" />
              <Mapping SourceColumn="FECHA_INGRESO_ALM" DataSetColumn="FECHA_INGRESO_ALM" />
              <Mapping SourceColumn="NO_QUEDAN" DataSetColumn="NO_QUEDAN" />
              <Mapping SourceColumn="FECHA_QUEDAN" DataSetColumn="FECHA_QUEDAN" />
              <Mapping SourceColumn="ESTADO" DataSetColumn="ESTADO" />
              <Mapping SourceColumn="USO" DataSetColumn="USO" />
              <Mapping SourceColumn="USUARIO_APROB" DataSetColumn="USUARIO_APROB" />
              <Mapping SourceColumn="FECHA_APROB" DataSetColumn="FECHA_APROB" />
              <Mapping SourceColumn="USUARIO_NOAPROB" DataSetColumn="USUARIO_NOAPROB" />
              <Mapping SourceColumn="FECHA_NOAPROB" DataSetColumn="FECHA_NOAPROB" />
              <Mapping SourceColumn="USUARIO_ANUL" DataSetColumn="USUARIO_ANUL" />
              <Mapping SourceColumn="FECHA_ANUL" DataSetColumn="FECHA_ANUL" />
              <Mapping SourceColumn="USUARIO_CREA" DataSetColumn="USUARIO_CREA" />
              <Mapping SourceColumn="FECHA_CREA" DataSetColumn="FECHA_CREA" />
              <Mapping SourceColumn="USUARIO_ACT" DataSetColumn="USUARIO_ACT" />
              <Mapping SourceColumn="FECHA_ACT" DataSetColumn="FECHA_ACT" />
              <Mapping SourceColumn="CODI_REQ" DataSetColumn="CODI_REQ" />
              <Mapping SourceColumn="ORDEN_LOCAL" DataSetColumn="ORDEN_LOCAL" />
              <Mapping SourceColumn="FECHA_INGRESO_EST" DataSetColumn="FECHA_INGRESO_EST" />
              <Mapping SourceColumn="COMENTARIO_EST" DataSetColumn="COMENTARIO_EST" />
              <Mapping SourceColumn="TOTAL_INGRESO_ALM" DataSetColumn="TOTAL_INGRESO_ALM" />
              <Mapping SourceColumn="AFECTO_INGRESO_ALM" DataSetColumn="AFECTO_INGRESO_ALM" />
              <Mapping SourceColumn="IVA_INGRESO_ALM" DataSetColumn="IVA_INGRESO_ALM" />
              <Mapping SourceColumn="TOTAL_QUEDAN" DataSetColumn="TOTAL_QUEDAN" />
              <Mapping SourceColumn="AFECTO_QUEDAN" DataSetColumn="AFECTO_QUEDAN" />
              <Mapping SourceColumn="IVA_QUEDAN" DataSetColumn="IVA_QUEDAN" />
              <Mapping SourceColumn="COD_SECCION" DataSetColumn="COD_SECCION" />
              <Mapping SourceColumn="NOMBRE_SECCION" DataSetColumn="NOMBRE_SECCION" />
              <Mapping SourceColumn="COD_SOLICITANTE" DataSetColumn="COD_SOLICITANTE" />
              <Mapping SourceColumn="NOMBRE_SOLICITANTE" DataSetColumn="NOMBRE_SOLICITANTE" />
              <Mapping SourceColumn="DESCRIP_PERIODO" DataSetColumn="DESCRIP_PERIODO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_CONTROL_REQUISICIONES" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_CONTROL_REQUISICIONES</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_REQ" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_PERIODOREQ" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SECCION" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_SOLICITANTE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_EMISION_INI" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_EMISION_FIN" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ETAPA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_ZAFRATableAdapter" GeneratorDataComponentClassName="CONTRATO_ZAFRATableAdapter" Name="CONTRATO_ZAFRA" UserDataComponentName="CONTRATO_ZAFRATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
10000 AS CORRELATIVO,
C.CODICONTRATO, L.ACCESLOTE,
RTRIM(RTRIM(C.NOMBRES) + ' ' + RTRIM(C.APELLIDOS)) AS NOMBRE_PROVEEDOR,
C.APODERADO, dbo.QuitarFormatoCODIPROVEEDOR(C.CODIPROVEEDOR) AS CODIPROVEE,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = C.ID_ZAFRA) AS ZAFRA, C.NO_CONTRATO, C.DIRECCION, C.NIT_APODERADO, C.NIT,  C.DUI_APODERADO, C.CREDITFISCAL,
C.TELEFONO, C.FINANCOADO, C.FINAN_NUMERO, C.TOTALMZ_CONTRATOCB, C.TONELADAS_CONTRATOCB,
L.NOMBLOTE, L.AREA, L.AREA_CANA, L.TONELADAS, L.TONEL_TC, L.EDAD_LOTE, V.NOM_VARIEDAD,
(SELECT N.NOMBRE_CANTON FROM CANTON N WHERE N.CODI_DEPTO = ML.CODI_DEPTO AND N.CODI_MUNI = ML.CODI_MUNI AND N.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, 
(ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODPROCEDENCIA, 
CASE L.TIPO_DERECHO
WHEN 1 THEN 'PROPIETARIO'
WHEN 2 THEN 'ARRENDATARIO'
WHEN 3 THEN 'ASIGNATARIO'
ELSE NULL
END AS TENENCIA_TIERRA, L.ZONA, C.DUI, C.CELULAR, P.PROFESION, P.EDAD, C.FECHA_CONTRATOCB, C.OBSERVACIONES_CONTRATOCB,
ISNULL((SELECT SUM(LC.TONEL_ENTREGADA) FROM LOTES_COSECHA LC, LOTES L, CONTRATO T WHERE LC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA)),0) AS TC_ZAFRA_ANT, 
ISNULL((SELECT dbo.fDividir(SUM(LC.LBS_ENTREGADA),SUM(LC.TONEL_ENTREGADA))  FROM LOTES_COSECHA LC, LOTES L, CONTRATO T WHERE LC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA)),0) AS REND_ZAFRA_ANT, 
ISNULL((SELECT SUM(LC.LBS_ENTREGADA) FROM LOTES_COSECHA LC, LOTES L, CONTRATO T WHERE LC.ACCESLOTE = L.ACCESLOTE AND L.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA)),0) AS LBS_ZAFRA_ANT
FROM CONTRATO C, PROVEEDOR P, LOTES L, VARIEDAD V, MAESTRO_LOTES ML
WHERE C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND C.CODICONTRATO = L.CODICONTRATO
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND C.CODICONTRATO = '-'</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CORRELATIVO" DataSetColumn="CORRELATIVO" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="NOMBRE_PROVEEDOR" DataSetColumn="NOMBRE_PROVEEDOR" />
              <Mapping SourceColumn="APODERADO" DataSetColumn="APODERADO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="NO_CONTRATO" DataSetColumn="NO_CONTRATO" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="NIT_APODERADO" DataSetColumn="NIT_APODERADO" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
              <Mapping SourceColumn="DUI_APODERADO" DataSetColumn="DUI_APODERADO" />
              <Mapping SourceColumn="CREDITFISCAL" DataSetColumn="CREDITFISCAL" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="FINANCOADO" DataSetColumn="FINANCOADO" />
              <Mapping SourceColumn="FINAN_NUMERO" DataSetColumn="FINAN_NUMERO" />
              <Mapping SourceColumn="TOTALMZ_CONTRATOCB" DataSetColumn="TOTALMZ_CONTRATOCB" />
              <Mapping SourceColumn="TONELADAS_CONTRATOCB" DataSetColumn="TONELADAS_CONTRATOCB" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="AREA" DataSetColumn="AREA" />
              <Mapping SourceColumn="AREA_CANA" DataSetColumn="AREA_CANA" />
              <Mapping SourceColumn="TONELADAS" DataSetColumn="TONELADAS" />
              <Mapping SourceColumn="TONEL_TC" DataSetColumn="TONEL_TC" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="NOM_VARIEDAD" DataSetColumn="NOM_VARIEDAD" />
              <Mapping SourceColumn="PROCEDENCIA" DataSetColumn="PROCEDENCIA" />
              <Mapping SourceColumn="CODPROCEDENCIA" DataSetColumn="CODPROCEDENCIA" />
              <Mapping SourceColumn="TENENCIA_TIERRA" DataSetColumn="TENENCIA_TIERRA" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="DUI" DataSetColumn="DUI" />
              <Mapping SourceColumn="CELULAR" DataSetColumn="CELULAR" />
              <Mapping SourceColumn="PROFESION" DataSetColumn="PROFESION" />
              <Mapping SourceColumn="EDAD" DataSetColumn="EDAD" />
              <Mapping SourceColumn="FECHA_CONTRATOCB" DataSetColumn="FECHA_CONTRATOCB" />
              <Mapping SourceColumn="OBSERVACIONES_CONTRATOCB" DataSetColumn="OBSERVACIONES_CONTRATOCB" />
              <Mapping SourceColumn="TC_ZAFRA_ANT" DataSetColumn="TC_ZAFRA_ANT" />
              <Mapping SourceColumn="REND_ZAFRA_ANT" DataSetColumn="REND_ZAFRA_ANT" />
              <Mapping SourceColumn="LBS_ZAFRA_ANT" DataSetColumn="LBS_ZAFRA_ANT" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContrato" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContrato" GeneratorSourceName="FillPorContrato" GetMethodModifier="Public" GetMethodName="GetPorContrato" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContrato" UserSourceName="FillPorContrato">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT T.*, 
	SUM(TC_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO) AS TC_ZAFRA_ANT,
	dbo.fDividir(SUM(LBS_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO),SUM(TC_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO)) AS REND_ZAFRA_ANT,
	SUM(LBS_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO) AS LBS_ZAFRA_ANT
FROM (
SELECT 
ROW_NUMBER() OVER(ORDER BY L.FECHA_CREA) AS CORRELATIVO,
C.CODICONTRATO, L.ACCESLOTE,
RTRIM(ISNULL(C.NOMBRES,'')) + ' ' + RTRIM(ISNULL(C.APELLIDOS,'')) AS NOMBRE_PROVEEDOR,
C.APODERADO, dbo.QuitarFormatoCODIPROVEEDOR(C.CODIPROVEEDOR) AS CODIPROVEE,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = C.ID_ZAFRA) AS ZAFRA, C.NO_CONTRATO, C.DIRECCION, C.NIT_APODERADO, C.NIT,  C.DUI_APODERADO, C.CREDITFISCAL,
C.TELEFONO, C.FINANCOADO, C.FINAN_NUMERO, C.TOTALMZ_CONTRATOCB, C.TONELADAS_CONTRATOCB,
L.NOMBLOTE, L.AREA, L.AREA_CANA, L.TONELADAS, L.TONEL_TC, L.EDAD_LOTE, V.NOM_VARIEDAD,
(SELECT N.NOMBRE_CANTON FROM CANTON N WHERE N.CODI_DEPTO = ML.CODI_DEPTO AND N.CODI_MUNI = ML.CODI_MUNI AND N.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, 
(ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODPROCEDENCIA, 
CASE  L.TIPO_DERECHO
WHEN 1 THEN 'PROPIETARIO'
WHEN 2 THEN 'ARRENDATARIO'
WHEN 3 THEN 'ASIGNATARIO'
ELSE NULL
END AS TENENCIA_TIERRA, L.ZONA, C.DUI, C.CELULAR, P.PROFESION, C.EDAD, C.FECHA_CONTRATOCB, C.OBSERVACIONES_CONTRATOCB,
ISNULL((SELECT SUM(LC.TONEL_ENTREGADA) FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS TC_ZAFRA_ANT_LOTE, 
--ISNULL((SELECT dbo.fDividir(SUM(LC.LBS_ENTREGADA),SUM(LC.TONEL_ENTREGADA))  FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS REND_ZAFRA_ANT, 
ISNULL((SELECT SUM(LC.LBS_ENTREGADA) FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS LBS_ZAFRA_ANT_LOTE
FROM CONTRATO C, PROVEEDOR P, LOTES L, VARIEDAD V, MAESTRO_LOTES ML
WHERE C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND C.CODICONTRATO = L.CODICONTRATO
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND C.CODICONTRATO = @CODICONTRATO
) AS T</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="CODICONTRATO" ColumnName="CODICONTRATO" DataSourceName="" DataTypeServer="char(13)" DbType="AnsiString" Direction="Input" ParameterName="@CODICONTRATO" Precision="0" ProviderType="Char" Scale="0" Size="13" SourceColumn="CODICONTRATO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorContratoLegal" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoLegal" GeneratorSourceName="FillPorContratoLegal" GetMethodModifier="Public" GetMethodName="GetPorContratoLegal" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoLegal" UserSourceName="FillPorContratoLegal">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT T.*, 
	SUM(TC_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO) AS TC_ZAFRA_ANT,
	dbo.fDividir(SUM(LBS_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO),SUM(TC_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO)) AS REND_ZAFRA_ANT,
	SUM(LBS_ZAFRA_ANT_LOTE) OVER(PARTITION BY CODICONTRATO) AS LBS_ZAFRA_ANT
FROM (
SELECT 
ROW_NUMBER() OVER(ORDER BY L.FECHA_CREA) AS CORRELATIVO,
C.CODICONTRATO, L.ACCESLOTE,
RTRIM(RTRIM(isnull(C.NOMBRES,'')) + ' ' + RTRIM(isnull(C.APELLIDOS,''))) AS NOMBRE_PROVEEDOR,
C.APODERADO, dbo.QuitarFormatoCODIPROVEEDOR(C.CODIPROVEEDOR) AS CODIPROVEE,
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = C.ID_ZAFRA) AS ZAFRA, C.NO_CONTRATO, 
RTRIM(RTRIM(C.DIRECCION) + ' ' + ISNULL((SELECT X.NOMBRE_MUNI FROM MUNICIPIO X WHERE X.CODI_DEPTO = P.CODI_DEPTO AND X.CODI_MUNI = P.CODI_MUNI),'') + ' ' +
 ISNULL((SELECT X.NOMBRE_DEPTO FROM DEPARTAMENTO X WHERE X.CODI_DEPTO = P.CODI_DEPTO),''))
AS DIRECCION,
C.NIT_APODERADO, C.NIT,  C.DUI_APODERADO, C.CREDITFISCAL,
C.TELEFONO, C.FINANCOADO, C.FINAN_NUMERO, C.TOTALMZ_CONTRATOCB, C.TONELADAS_CONTRATOCB,
L.NOMBLOTE, L.AREA, L.AREA_CANA, L.TONELADAS, L.TONEL_TC, L.EDAD_LOTE, V.NOM_VARIEDAD,
(SELECT N.NOMBRE_CANTON FROM CANTON N WHERE N.CODI_DEPTO = ML.CODI_DEPTO AND N.CODI_MUNI = ML.CODI_MUNI AND N.CODI_CANTON = ML.CODI_CANTON) AS PROCEDENCIA, 
(ML.CODI_DEPTO + ML.CODI_MUNI + ML.CODI_CANTON) AS CODPROCEDENCIA, 
CASE  L.TIPO_DERECHO
WHEN 1 THEN 'PROPIETARIO'
WHEN 2 THEN 'ARRENDATARIO'
WHEN 3 THEN 'ASIGNATARIO'
ELSE NULL
END AS TENENCIA_TIERRA, L.ZONA, C.DUI, C.CELULAR, P.PROFESION, C.EDAD, C.FECHA_CONTRATOCB, C.OBSERVACIONES_CONTRATOCB,
ISNULL((SELECT SUM(LC.TONEL_ENTREGADA) FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS TC_ZAFRA_ANT_LOTE, 
--ISNULL((SELECT dbo.fDividir(SUM(LC.LBS_ENTREGADA),SUM(LC.TONEL_ENTREGADA))  FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS REND_ZAFRA_ANT, 
ISNULL((SELECT SUM(LC.LBS_ENTREGADA) FROM LOTES_COSECHA LC, LOTES S, CONTRATO T WHERE LC.ACCESLOTE = S.ACCESLOTE AND S.CODICONTRATO = T.CODICONTRATO AND T.CODIPROVEEDOR = P.CODIPROVEEDOR AND LC.ID_ZAFRA = dbo.fIdZafraAnterior(C.ID_ZAFRA) AND S.ID_MAESTRO = L.ID_MAESTRO ),0) AS LBS_ZAFRA_ANT_LOTE
FROM CONTRATO_LG C, PROVEEDOR P, LOTES_LG L, VARIEDAD V, MAESTRO_LOTES ML
WHERE C.CODIPROVEEDOR = P.CODIPROVEEDOR
AND C.CODICONTRATO = L.CODICONTRATO
AND L.CODIVARIEDA = V.CODIVARIEDA
AND L.ID_MAESTRO = ML.ID_MAESTRO
AND C.CODICONTRATO = @CODICONTRATO
) AS T</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="" ColumnName="CODICONTRATO" DataSourceName="" DbType="AnsiString" Direction="Input" ParameterName="@CODICONTRATO" Precision="0" Scale="0" Size="20" SourceColumn="CODICONTRATO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_CTASTableAdapter" GeneratorDataComponentClassName="CONTRATO_CTASTableAdapter" Name="CONTRATO_CTAS" UserDataComponentName="CONTRATO_CTASTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CC.*, CF.NOMBRE_CUENTA FROM CONTRATO_CTAS CC, CUENTA_FINAN CF WHERE CC.ID_CONTRATO_FINAN = -1 AND CC.ID_CUENTA_FINAN = CF.ID_CUENTA_FINAN</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_CONTRATO_CTAS" DataSetColumn="ID_CONTRATO_CTAS" />
              <Mapping SourceColumn="ID_CONTRATO_FINAN" DataSetColumn="ID_CONTRATO_FINAN" />
              <Mapping SourceColumn="CODICONTRATO" DataSetColumn="CODICONTRATO" />
              <Mapping SourceColumn="ID_ZAFRA" DataSetColumn="ID_ZAFRA" />
              <Mapping SourceColumn="ID_CUENTA_FINAN" DataSetColumn="ID_CUENTA_FINAN" />
              <Mapping SourceColumn="NO_DOCTO_REFERENCIA" DataSetColumn="NO_DOCTO_REFERENCIA" />
              <Mapping SourceColumn="UID_REFERENCIA" DataSetColumn="UID_REFERENCIA" />
              <Mapping SourceColumn="CARGO" DataSetColumn="CARGO" />
              <Mapping SourceColumn="ABONO" DataSetColumn="ABONO" />
              <Mapping SourceColumn="SALDO" DataSetColumn="SALDO" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="USUARIO_CREA" DataSetColumn="USUARIO_CREA" />
              <Mapping SourceColumn="FECHA_CREA" DataSetColumn="FECHA_CREA" />
              <Mapping SourceColumn="USUARIO_ACT" DataSetColumn="USUARIO_ACT" />
              <Mapping SourceColumn="FECHA_ACT" DataSetColumn="FECHA_ACT" />
              <Mapping SourceColumn="NOMBRE_CUENTA" DataSetColumn="NOMBRE_CUENTA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.CUENTA_FINAN" DbObjectType="Table" FillMethodModifier="Public" FillMethodName="FillPorContratoFinan" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorContratoFinan" GeneratorSourceName="FillPorContratoFinan" GetMethodModifier="Public" GetMethodName="GetPorContratoFinan" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorContratoFinan" UserSourceName="FillPorContratoFinan">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT CC.ID_CONTRATO_FINAN, CC.CODICONTRATO, CC.ID_ZAFRA, CC.ID_CUENTA_FINAN, 
SUM(CC.CARGO) AS CARGO,
SUM(CC.ABONO) AS ABONO,
SUM(CC.SALDO) AS SALDO,
CC.ZAFRA,
CF.NOMBRE_CUENTA 
FROM CONTRATO_CTAS CC, CUENTA_FINAN CF 
WHERE CC.ID_CONTRATO_FINAN = @ID_CONTRATO_FINAN AND CC.ID_CUENTA_FINAN = CF.ID_CUENTA_FINAN
GROUP BY  CC.ID_CONTRATO_FINAN, CC.CODICONTRATO, CC.ID_ZAFRA, CC.ID_CUENTA_FINAN, CC.ZAFRA, CF.NOMBRE_CUENTA </CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_CONTRATO_FINAN" ColumnName="ID_CONTRATO_FINAN" DataSourceName="INJIBOA.dbo.CONTRATO_CTAS" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CONTRATO_FINAN" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_CONTRATO_FINAN" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="INVENTARIO_CANATableAdapter" GeneratorDataComponentClassName="INVENTARIO_CANATableAdapter" Name="INVENTARIO_CANA" UserDataComponentName="INVENTARIO_CANATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 1000 AS ORDEN, 1000 AS ES_ENCA, 'GHJHGJHGJHGJHGJGJG' AS DESCRIP, 
0.25 AS MONTO, 0 AS UNI_CAMION7, 0.25 AS TC_CAMION7, 0 AS UNI_CAMION, 0.25 AS TC_CAMION, 0 AS UNI_3EJES, 0.25 AS TC_3EJES, 0 AS UNI_RASTRA, 0.25 AS TC_RASTRA,
0.25 AS N1, 0.25 AS N2, 0.25 AS N3, 0.25 AS S1, 0.25 AS S2, 0.25 AS S3, 0.25 AS S4,
0 AS UNI_4EJES, 0.25 AS TC_4EJES
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ORDEN" DataSetColumn="ORDEN" />
              <Mapping SourceColumn="ES_ENCA" DataSetColumn="ES_ENCA" />
              <Mapping SourceColumn="DESCRIP" DataSetColumn="DESCRIP" />
              <Mapping SourceColumn="MONTO" DataSetColumn="MONTO" />
              <Mapping SourceColumn="UNI_CAMION7" DataSetColumn="UNI_CAMION7" />
              <Mapping SourceColumn="TC_CAMION7" DataSetColumn="TC_CAMION7" />
              <Mapping SourceColumn="UNI_CAMION" DataSetColumn="UNI_CAMION" />
              <Mapping SourceColumn="TC_CAMION" DataSetColumn="TC_CAMION" />
              <Mapping SourceColumn="UNI_3EJES" DataSetColumn="UNI_3EJES" />
              <Mapping SourceColumn="TC_3EJES" DataSetColumn="TC_3EJES" />
              <Mapping SourceColumn="UNI_RASTRA" DataSetColumn="UNI_RASTRA" />
              <Mapping SourceColumn="TC_RASTRA" DataSetColumn="TC_RASTRA" />
              <Mapping SourceColumn="N1" DataSetColumn="N1" />
              <Mapping SourceColumn="N2" DataSetColumn="N2" />
              <Mapping SourceColumn="N3" DataSetColumn="N3" />
              <Mapping SourceColumn="S1" DataSetColumn="S1" />
              <Mapping SourceColumn="S2" DataSetColumn="S2" />
              <Mapping SourceColumn="S3" DataSetColumn="S3" />
              <Mapping SourceColumn="S4" DataSetColumn="S4" />
              <Mapping SourceColumn="UNI_4EJES" DataSetColumn="UNI_4EJES" />
              <Mapping SourceColumn="TC_4EJES" DataSetColumn="TC_4EJES" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.INVENTARIO_CANA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.INVENTARIO_CANA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_TRANSPORTE" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="INVENTARIO_ROZA_DIARIATableAdapter" GeneratorDataComponentClassName="INVENTARIO_ROZA_DIARIATableAdapter" Name="INVENTARIO_ROZA_DIARIA" UserDataComponentName="INVENTARIO_ROZA_DIARIATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
'N1' AS ZONA, 	'12459' AS CODIPROVEE, 	'XXXX' AS CODISOCIO, 	'JIMMY GARCIA BARAHONA' AS PROVEEDOR, 	'03' AS CODILOTE, 	'EL CERRITO 1' AS NOMBLOTE, 
75.15 AS TONEL_CENSO, 	75.15 AS ROZA_ACUM, 	75.15 AS ROZA_DIA, 	75.15 AS ROZA_TOTAL, 	75.15 AS SALDO_ROZA, 	75.15 AS QP_CORTA, 	75.15 AS QP_LARGA, 	
75.15 AS QP_MECA, 	75.15 AS QNP_CORTA, 	75.15 AS QNP_LARGA, 	75.15 AS QNP_MECA, 	75.15 AS VERDE_CORTA, 	75.15 AS VERDE_LARGA, 	75.15 AS VERDE_MECA,
75.15 AS CUOTA_DIARIA, 75.15 AS TC_MOLIDA
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="ROZA_ACUM" DataSetColumn="ROZA_ACUM" />
              <Mapping SourceColumn="ROZA_DIA" DataSetColumn="ROZA_DIA" />
              <Mapping SourceColumn="ROZA_TOTAL" DataSetColumn="ROZA_TOTAL" />
              <Mapping SourceColumn="SALDO_ROZA" DataSetColumn="SALDO_ROZA" />
              <Mapping SourceColumn="QP_CORTA" DataSetColumn="QP_CORTA" />
              <Mapping SourceColumn="QP_LARGA" DataSetColumn="QP_LARGA" />
              <Mapping SourceColumn="QP_MECA" DataSetColumn="QP_MECA" />
              <Mapping SourceColumn="QNP_CORTA" DataSetColumn="QNP_CORTA" />
              <Mapping SourceColumn="QNP_LARGA" DataSetColumn="QNP_LARGA" />
              <Mapping SourceColumn="QNP_MECA" DataSetColumn="QNP_MECA" />
              <Mapping SourceColumn="VERDE_CORTA" DataSetColumn="VERDE_CORTA" />
              <Mapping SourceColumn="VERDE_LARGA" DataSetColumn="VERDE_LARGA" />
              <Mapping SourceColumn="VERDE_MECA" DataSetColumn="VERDE_MECA" />
              <Mapping SourceColumn="CUOTA_DIARIA" DataSetColumn="CUOTA_DIARIA" />
              <Mapping SourceColumn="TC_MOLIDA" DataSetColumn="TC_MOLIDA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.INVENTARIO_ROZA_DIARIA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.INVENTARIO_ROZA_DIARIA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIAZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@OPCION" Precision="0" ProviderType="VarChar" Scale="0" Size="20" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="INVENTARIO_ROZA_DIARIA_PROVEEDORTableAdapter" GeneratorDataComponentClassName="INVENTARIO_ROZA_DIARIA_PROVEEDORTableAdapter" Name="INVENTARIO_ROZA_DIARIA_PROVEEDOR" UserDataComponentName="INVENTARIO_ROZA_DIARIA_PROVEEDORTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT '2014/2015S1081402002'  AS ACCESLOTE, 'S1' AS ZONA, 	'14156' AS CODIPROVEE, 'XXX' AS CODISOCIO, 	'OSCAR EZEQUIEL JULE TOBAR' AS PROVEEDOR, 	'01' AS CODILOTE, 	
'EL COCO ' AS NOMBLOTE, 'MECANIZADA' AS CODI_PROVEEDOR_ROZA, 'RZ99- BLOQUE DE ROZA PROPIO' AS PROVEEDOR_ROZA, 400.26 AS TC 
WHERE -1 = 1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CODI_PROVEEDOR_ROZA" DataSetColumn="CODI_PROVEEDOR_ROZA" />
              <Mapping SourceColumn="PROVEEDOR_ROZA" DataSetColumn="PROVEEDOR_ROZA" />
              <Mapping SourceColumn="TC" DataSetColumn="TC" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.INVENTARIO_ROZA_DIARIA_PROVEEDOR" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.INVENTARIO_ROZA_DIARIA_PROVEEDOR</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@OPCION" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="INVENTARIO_ROZA_SALDOSTableAdapter" GeneratorDataComponentClassName="INVENTARIO_ROZA_SALDOSTableAdapter" Name="INVENTARIO_ROZA_SALDOS" UserDataComponentName="INVENTARIO_ROZA_SALDOSTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
'N1' AS ZONA,
'2459' AS CODIPROVEE,
'' AS CODISOCIO,
'JIMMY GARCIA BARAHONA' AS PROVEEDOR,
'3' AS CODILOTE,
'EL CERRITO 1' AS NOMBLOTE,
75.21 AS CUOTA_DIARIA, 	75.21 AS TC_MOLIDA, 	
439 AS HORAS_QUEMA, 	
417 AS HORAS_ROZA, 	75.21 AS TONEL_CENSO, 	
75.21 AS ROZA_ACUM, 	75.21 AS SALDO_ROZA, 	75.21 AS INVEN_TOTAL,
75.21 AS TOTAL_QUEMA, 	75.21 AS QUEMA_PROG, 	75.21 AS QUEMA_NOPROG,
75.21 AS TOTAL_ROZA, 	75.21 AS Q_CORTA, 	75.21 AS Q_LARGA, 	75.21 AS Q_MECA, 	
75.21 AS VERDE_CORTA, 	75.21 AS VERDE_LARGA, 	75.21 AS VERDE_MECA
WHERE -1 = 1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="CUOTA_DIARIA" DataSetColumn="CUOTA_DIARIA" />
              <Mapping SourceColumn="TC_MOLIDA" DataSetColumn="TC_MOLIDA" />
              <Mapping SourceColumn="HORAS_QUEMA" DataSetColumn="HORAS_QUEMA" />
              <Mapping SourceColumn="HORAS_ROZA" DataSetColumn="HORAS_ROZA" />
              <Mapping SourceColumn="TONEL_CENSO" DataSetColumn="TONEL_CENSO" />
              <Mapping SourceColumn="ROZA_ACUM" DataSetColumn="ROZA_ACUM" />
              <Mapping SourceColumn="SALDO_ROZA" DataSetColumn="SALDO_ROZA" />
              <Mapping SourceColumn="INVEN_TOTAL" DataSetColumn="INVEN_TOTAL" />
              <Mapping SourceColumn="TOTAL_QUEMA" DataSetColumn="TOTAL_QUEMA" />
              <Mapping SourceColumn="QUEMA_PROG" DataSetColumn="QUEMA_PROG" />
              <Mapping SourceColumn="QUEMA_NOPROG" DataSetColumn="QUEMA_NOPROG" />
              <Mapping SourceColumn="TOTAL_ROZA" DataSetColumn="TOTAL_ROZA" />
              <Mapping SourceColumn="Q_CORTA" DataSetColumn="Q_CORTA" />
              <Mapping SourceColumn="Q_LARGA" DataSetColumn="Q_LARGA" />
              <Mapping SourceColumn="Q_MECA" DataSetColumn="Q_MECA" />
              <Mapping SourceColumn="VERDE_CORTA" DataSetColumn="VERDE_CORTA" />
              <Mapping SourceColumn="VERDE_LARGA" DataSetColumn="VERDE_LARGA" />
              <Mapping SourceColumn="VERDE_MECA" DataSetColumn="VERDE_MECA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.INVENTARIO_ROZA_SALDOS" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.INVENTARIO_ROZA_SALDOS</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@OPCION" Precision="0" ProviderType="VarChar" Scale="0" Size="20" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ANALISIS_VMTTableAdapter" GeneratorDataComponentClassName="ANALISIS_VMTTableAdapter" Name="ANALISIS_VMT" UserDataComponentName="ANALISIS_VMTTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText> SELECT
 'VEHICULOS REGULADOS VMT' AS REGULADO, 	
 'CAMIONES 3 EJES' AS VEHICULO, 	'C3' AS TIPO, 	
 'CAÑA LARGA' AS DESCRIP, 	
 'QUEMADA' AS TIPO_QUEMA, 	
 24.72 AS VMT_RESO, 	
 25129.86 AS TC_BRUTO, 	
 15915.99 AS TC_NETO, 	
 998 AS NO_VIAJES, 	
 25.18 AS PROM_TC_BRUTO, 	
 15.95 AS PROM_TC_NETO, 	
 0.46 AS TC_SOBREPESO, 	
 0.0186 AS SOBRE_PESO_PORC, 	
 530 AS RANGO1_2, 	
 0 AS RANGO3_4, 	
 0 AS RANGO5_6, 	
 0 AS RANGO7_8, 	
 0 AS RANGO9_10, 	
 25.18 AS TIPO_DESCRIP_PROM_BRUTO, 	
 0.46 AS TIPO_DESCRIP_TC_SOBREPESO, 	
 0.0186 AS TIPO_DESCRIP_SOBREPESO_PORC, 	
 15.95 AS TIPO_DESCRIP_PROM_NETO, 	
 25.41 AS TIPO_PROM_BRUTO, 	
 0.69 AS TIPO_TC_SOBREPESO, 	
 0.0279 AS TIPO_SOBREPESO_PORC, 	
 16.16 AS TIPO_PROM_NETO, 	
 28.63 AS REGULADO_PROM_BRUTO, 	
 3.906364 AS REGULADO_TC_SOBREPESO, 	
 0.158 AS REGULADO_SOBREPESO_PORC, 	
 18.37 AS REGULADO_PROM_NETO, 	
 28.63 AS GRANTOTAL_PROM_BRUTO, 	
 18.37 AS GRANTOTAL_PROM_NETO
 WHERE -1 = 1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="REGULADO" DataSetColumn="REGULADO" />
              <Mapping SourceColumn="VEHICULO" DataSetColumn="VEHICULO" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="DESCRIP" DataSetColumn="DESCRIP" />
              <Mapping SourceColumn="TIPO_QUEMA" DataSetColumn="TIPO_QUEMA" />
              <Mapping SourceColumn="VMT_RESO" DataSetColumn="VMT_RESO" />
              <Mapping SourceColumn="TC_BRUTO" DataSetColumn="TC_BRUTO" />
              <Mapping SourceColumn="TC_NETO" DataSetColumn="TC_NETO" />
              <Mapping SourceColumn="NO_VIAJES" DataSetColumn="NO_VIAJES" />
              <Mapping SourceColumn="PROM_TC_BRUTO" DataSetColumn="PROM_TC_BRUTO" />
              <Mapping SourceColumn="PROM_TC_NETO" DataSetColumn="PROM_TC_NETO" />
              <Mapping SourceColumn="TC_SOBREPESO" DataSetColumn="TC_SOBREPESO" />
              <Mapping SourceColumn="SOBRE_PESO_PORC" DataSetColumn="SOBRE_PESO_PORC" />
              <Mapping SourceColumn="RANGO1_2" DataSetColumn="RANGO1_2" />
              <Mapping SourceColumn="RANGO3_4" DataSetColumn="RANGO3_4" />
              <Mapping SourceColumn="RANGO5_6" DataSetColumn="RANGO5_6" />
              <Mapping SourceColumn="RANGO7_8" DataSetColumn="RANGO7_8" />
              <Mapping SourceColumn="RANGO9_10" DataSetColumn="RANGO9_10" />
              <Mapping SourceColumn="TIPO_DESCRIP_PROM_BRUTO" DataSetColumn="TIPO_DESCRIP_PROM_BRUTO" />
              <Mapping SourceColumn="TIPO_DESCRIP_TC_SOBREPESO" DataSetColumn="TIPO_DESCRIP_TC_SOBREPESO" />
              <Mapping SourceColumn="TIPO_DESCRIP_SOBREPESO_PORC" DataSetColumn="TIPO_DESCRIP_SOBREPESO_PORC" />
              <Mapping SourceColumn="TIPO_DESCRIP_PROM_NETO" DataSetColumn="TIPO_DESCRIP_PROM_NETO" />
              <Mapping SourceColumn="TIPO_PROM_BRUTO" DataSetColumn="TIPO_PROM_BRUTO" />
              <Mapping SourceColumn="TIPO_TC_SOBREPESO" DataSetColumn="TIPO_TC_SOBREPESO" />
              <Mapping SourceColumn="TIPO_SOBREPESO_PORC" DataSetColumn="TIPO_SOBREPESO_PORC" />
              <Mapping SourceColumn="TIPO_PROM_NETO" DataSetColumn="TIPO_PROM_NETO" />
              <Mapping SourceColumn="REGULADO_PROM_BRUTO" DataSetColumn="REGULADO_PROM_BRUTO" />
              <Mapping SourceColumn="REGULADO_TC_SOBREPESO" DataSetColumn="REGULADO_TC_SOBREPESO" />
              <Mapping SourceColumn="REGULADO_SOBREPESO_PORC" DataSetColumn="REGULADO_SOBREPESO_PORC" />
              <Mapping SourceColumn="REGULADO_PROM_NETO" DataSetColumn="REGULADO_PROM_NETO" />
              <Mapping SourceColumn="GRANTOTAL_PROM_BRUTO" DataSetColumn="GRANTOTAL_PROM_BRUTO" />
              <Mapping SourceColumn="GRANTOTAL_PROM_NETO" DataSetColumn="GRANTOTAL_PROM_NETO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.ANALISIS_VMT" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.ANALISIS_VMT</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ES_TM" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@VER_TIPO_QUEMA" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@ACUMULADO" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_INI" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_FIN" Precision="0" ProviderType="VarChar" Scale="0" Size="10" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="INVENTARIO_CANA_SEGUINTEGRALTableAdapter" GeneratorDataComponentClassName="INVENTARIO_CANA_SEGUINTEGRALTableAdapter" Name="INVENTARIO_CANA_SEGUINTEGRAL" UserDataComponentName="INVENTARIO_CANA_SEGUINTEGRALTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 'N1' AS ZONA, 	159 AS CODIPROVEE, 	'9' AS CODISOCIO, 	'SANTOS RAFAEL ALVAREZ' AS PROVEEDOR, 	'01' AS CODILOTE, 	
'LA INFANCIA' AS NOMBLOTE, 	'ABIERTO' AS ESTADO, 	8.36 AS TC_ESTICANA, 	
8.36 AS TC_MOLIDA_ACUM, 	8.36 AS SALDO_X_MOLER, 	8.36 AS ROZA_ACUM, 	
8.36 AS SALDO_X_ROZAR, 	8.36 AS SDO_1_2, 	8.36 AS SALDO_AJUSTADO, 	
8.36 AS INVE_TOTAL, 	8.36 AS CANA_PIE_ROZA_TOTAL, 	8.36 AS QUEMA_SALDO, 	
8.36 AS CANA_VERDE_SALDO, 	8.36 AS ROZA_SALDO, 	8.36 AS CANA_TRANSPO_TOTAL, 	
8.36 AS CANA_TRANSITO, 	8.36 AS CANA_RUEDA, 	8.36 AS CANA_PATIO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="ESTADO" DataSetColumn="ESTADO" />
              <Mapping SourceColumn="TC_ESTICANA" DataSetColumn="TC_ESTICANA" />
              <Mapping SourceColumn="TC_MOLIDA_ACUM" DataSetColumn="TC_MOLIDA_ACUM" />
              <Mapping SourceColumn="SALDO_X_MOLER" DataSetColumn="SALDO_X_MOLER" />
              <Mapping SourceColumn="ROZA_ACUM" DataSetColumn="ROZA_ACUM" />
              <Mapping SourceColumn="SALDO_X_ROZAR" DataSetColumn="SALDO_X_ROZAR" />
              <Mapping SourceColumn="SDO_1_2" DataSetColumn="SDO_1_2" />
              <Mapping SourceColumn="SALDO_AJUSTADO" DataSetColumn="SALDO_AJUSTADO" />
              <Mapping SourceColumn="INVE_TOTAL" DataSetColumn="INVE_TOTAL" />
              <Mapping SourceColumn="CANA_PIE_ROZA_TOTAL" DataSetColumn="CANA_PIE_ROZA_TOTAL" />
              <Mapping SourceColumn="QUEMA_SALDO" DataSetColumn="QUEMA_SALDO" />
              <Mapping SourceColumn="CANA_VERDE_SALDO" DataSetColumn="CANA_VERDE_SALDO" />
              <Mapping SourceColumn="ROZA_SALDO" DataSetColumn="ROZA_SALDO" />
              <Mapping SourceColumn="CANA_TRANSPO_TOTAL" DataSetColumn="CANA_TRANSPO_TOTAL" />
              <Mapping SourceColumn="CANA_TRANSITO" DataSetColumn="CANA_TRANSITO" />
              <Mapping SourceColumn="CANA_RUEDA" DataSetColumn="CANA_RUEDA" />
              <Mapping SourceColumn="CANA_PATIO" DataSetColumn="CANA_PATIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.INVENTARIO_CANA_SEGUINTEGRAL" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafraZona" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafraZona" GeneratorSourceName="FillPorZafraZona" GetMethodModifier="Public" GetMethodName="GetPorZafraZona" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafraZona" UserSourceName="FillPorZafraZona">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.INVENTARIO_CANA_SEGUINTEGRAL</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@OPCION" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ANALISIS_LAB_PROVEEDORTableAdapter" GeneratorDataComponentClassName="ANALISIS_LAB_PROVEEDORTableAdapter" Name="ANALISIS_LAB_PROVEEDOR" UserDataComponentName="ANALISIS_LAB_PROVEEDORTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = E.ID_ZAFRA) AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, L.ACCESLOTE,
CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS PROVEEDOR,
L.ZONA, L.CODILOTE, L.NOMBLOTE, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
(SELECT LC.EDAD_LOTE FROM LOTES_COSECHA LC WHERE LC.ID_ZAFRA = E.ID_ZAFRA AND LC.ACCESLOTE = E.ACCESLOTE) AS EDAD_LOTE,
B.FECHA_LEE_TARA, E.COMPTENVIO, E.NROBOLETA, E.NUMRECIBO_CANA, B.NETOTONEL,
A.RENDIA_CALC2 AS REND_85, 
A.BAGAZO_NETO AS PBH, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, 
(SELECT D.DEXTRANA FROM DATOS_LABORATORIO D WHERE D.ID_ANALISIS = A.ID_ANALISIS) AS DEXTRANA, 
A.HUMEDAD, A.PH, A.AZUCAR_REDUCTORES
FROM ENVIO E, ANALISIS A, BASCULA B, LOTES L, PROVEEDOR P
WHERE E.ID_ENVIO = A.ID_ENVIO
AND E.ID_ENVIO = B.ID_ENVIO
AND  E.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND NOT A.FECHA_LEE_POL IS NULL AND NOT B.FECHA_LEE_TARA IS NULL
AND E.ID_ZAFRA = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
              <Mapping SourceColumn="ACCESLOTE" DataSetColumn="ACCESLOTE" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="VARIEDAD" DataSetColumn="VARIEDAD" />
              <Mapping SourceColumn="EDAD_LOTE" DataSetColumn="EDAD_LOTE" />
              <Mapping SourceColumn="FECHA_LEE_TARA" DataSetColumn="FECHA_LEE_TARA" />
              <Mapping SourceColumn="COMPTENVIO" DataSetColumn="COMPTENVIO" />
              <Mapping SourceColumn="NROBOLETA" DataSetColumn="NROBOLETA" />
              <Mapping SourceColumn="NUMRECIBO_CANA" DataSetColumn="NUMRECIBO_CANA" />
              <Mapping SourceColumn="NETOTONEL" DataSetColumn="NETOTONEL" />
              <Mapping SourceColumn="REND_85" DataSetColumn="REND_85" />
              <Mapping SourceColumn="PBH" DataSetColumn="PBH" />
              <Mapping SourceColumn="BRIX" DataSetColumn="BRIX" />
              <Mapping SourceColumn="POL" DataSetColumn="POL" />
              <Mapping SourceColumn="PUREZA_JUGO" DataSetColumn="PUREZA_JUGO" />
              <Mapping SourceColumn="FIBRA_CANA" DataSetColumn="FIBRA_CANA" />
              <Mapping SourceColumn="DEXTRANA" DataSetColumn="DEXTRANA" />
              <Mapping SourceColumn="HUMEDAD" DataSetColumn="HUMEDAD" />
              <Mapping SourceColumn="PH" DataSetColumn="PH" />
              <Mapping SourceColumn="AZUCAR_REDUCTORES" DataSetColumn="AZUCAR_REDUCTORES" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
(SELECT Z.NOMBRE_ZAFRA FROM ZAFRA Z WHERE Z.ID_ZAFRA = E.ID_ZAFRA) AS NOMBRE_ZAFRA, P.CODIPROVEEDOR, L.ACCESLOTE,
CAST(dbo.QuitarFormatoCODIPROVEE(P.CODIPROVEE) AS INT) AS CODIPROVEE,
dbo.QuitarFormatoCODISOCIO(P.CODISOCIO) AS CODISOCIO, RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) AS PROVEEDOR,
L.ZONA, L.CODILOTE, L.NOMBLOTE, (SELECT V.NOM_VARIEDAD FROM VARIEDAD V WHERE V.CODIVARIEDA = L.CODIVARIEDA) AS VARIEDAD,
(SELECT LC.EDAD_LOTE FROM LOTES_COSECHA LC WHERE LC.ID_ZAFRA = E.ID_ZAFRA AND LC.ACCESLOTE = E.ACCESLOTE) AS EDAD_LOTE,
B.FECHA_LEE_TARA, E.COMPTENVIO, E.NROBOLETA, E.NUMRECIBO_CANA, B.NETOTONEL,
A.RENDIA_CALC2 AS REND_85, 
A.BAGAZO_NETO AS PBH, A.BRIX, A.POL, A.PUREZA_JUGO, A.FIBRA_CANA, 
(SELECT D.DEXTRANA FROM DATOS_LABORATORIO D WHERE D.ID_ANALISIS = A.ID_ANALISIS) AS DEXTRANA, 
A.HUMEDAD, A.PH, A.AZUCAR_REDUCTORES
FROM ENVIO E, ANALISIS A, BASCULA B, LOTES L, PROVEEDOR P
WHERE E.ID_ENVIO = A.ID_ENVIO
AND E.ID_ENVIO = B.ID_ENVIO
AND  E.ACCESLOTE = L.ACCESLOTE
AND L.CODIPROVEEDOR = P.CODIPROVEEDOR
AND NOT A.FECHA_LEE_POL IS NULL AND NOT B.FECHA_LEE_TARA IS NULL
AND E.ID_ZAFRA = @ID_ZAFRA
AND (P.CODIPROVEE = @CODIPROVEE OR @CODIPROVEE = '')
AND (P.CODISOCIO = @CODISOCIO OR @CODISOCIO = '')
AND (RTRIM(P.NOMBRES) + ' ' + RTRIM(P.APELLIDOS) LIKE '%' + @NOMBRE_PROVEEDOR + '%' OR @NOMBRE_PROVEEDOR = '')
AND (CAST(B.FECHA_LEE_TARA AS DATE) BETWEEN CONVERT(DATETIME,@FECHA_INI,103) AND CONVERT(DATETIME,@FECHA_FIN,103) OR @FECHA_INI = '')
AND (E.DIAZAFRA = @DIA_ZAFRA OR @DIA_ZAFRA = -1)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ZAFRA" ColumnName="ID_ZAFRA" DataSourceName="INJIBOA2.dbo.ENVIO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODIPROVEE" ColumnName="CODIPROVEE" DataSourceName="INJIBOA2.dbo.PROVEEDOR" DataTypeServer="char(6)" DbType="AnsiString" Direction="Input" ParameterName="@CODIPROVEE" Precision="0" ProviderType="Char" Scale="0" Size="6" SourceColumn="CODIPROVEE" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODISOCIO" ColumnName="CODISOCIO" DataSourceName="INJIBOA2.dbo.PROVEEDOR" DataTypeServer="char(4)" DbType="AnsiString" Direction="Input" ParameterName="@CODISOCIO" Precision="0" ProviderType="Char" Scale="0" Size="4" SourceColumn="CODISOCIO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="NOMBRE_PROVEEDOR" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@NOMBRE_PROVEEDOR" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_INI" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_INI" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FECHA_FIN" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@FECHA_FIN" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="DIA_ZAFRA" ColumnName="DIAZAFRA" DataSourceName="INJIBOA2.dbo.ENVIO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA_ZAFRA" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="DIAZAFRA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CONTRATO_CANA_ZONATableAdapter" GeneratorDataComponentClassName="CONTRATO_CANA_ZONATableAdapter" Name="CONTRATO_CANA_ZONA" UserDataComponentName="CONTRATO_CANA_ZONATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 'XXXXX' AS ANIOZAFRA, 'XXX DDD' AS DESCRIP_ZONA, 545454 AS CANT_PROVEEDORES, 5454 AS CANT_CONTRATOS, 54545 AS CANT_LOTES, 54545454.2233 AS LBS_CONTRATADO,
4545.0221 AS REND_CONTRATADO, 54554.0511 AS MZ_CONTRATADO, 54554.0511 AS TC_MZ_CONTRATADO, 545454.5454 AS TC_CONTRATADO,
454545 AS TOTAL_CANT_PROVEEDORES, 545454 AS TOTAL_CANT_CONTRATOS, 454545.22312 AS TOTAL_REND_CONTRATADO, 5454.5454 AS TOTAL_TC_MZ_CONTRATADO
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ANIOZAFRA" DataSetColumn="ANIOZAFRA" />
              <Mapping SourceColumn="DESCRIP_ZONA" DataSetColumn="DESCRIP_ZONA" />
              <Mapping SourceColumn="CANT_PROVEEDORES" DataSetColumn="CANT_PROVEEDORES" />
              <Mapping SourceColumn="CANT_CONTRATOS" DataSetColumn="CANT_CONTRATOS" />
              <Mapping SourceColumn="CANT_LOTES" DataSetColumn="CANT_LOTES" />
              <Mapping SourceColumn="LBS_CONTRATADO" DataSetColumn="LBS_CONTRATADO" />
              <Mapping SourceColumn="REND_CONTRATADO" DataSetColumn="REND_CONTRATADO" />
              <Mapping SourceColumn="MZ_CONTRATADO" DataSetColumn="MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_MZ_CONTRATADO" DataSetColumn="TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TC_CONTRATADO" DataSetColumn="TC_CONTRATADO" />
              <Mapping SourceColumn="TOTAL_REND_CONTRATADO" DataSetColumn="TOTAL_REND_CONTRATADO" />
              <Mapping SourceColumn="TOTAL_TC_MZ_CONTRATADO" DataSetColumn="TOTAL_TC_MZ_CONTRATADO" />
              <Mapping SourceColumn="TOTAL_CANT_PROVEEDORES" DataSetColumn="TOTAL_CANT_PROVEEDORES" />
              <Mapping SourceColumn="TOTAL_CANT_CONTRATOS" DataSetColumn="TOTAL_CANT_CONTRATOS" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.RPT_CONTRATO_CANA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_CONTRATO_CANA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA.dbo.RPT_CONTRATO_ESTICANA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriteriosEsticana" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriteriosEsticana" GeneratorSourceName="FillPorCriteriosEsticana" GetMethodModifier="Public" GetMethodName="GetPorCriteriosEsticana" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriteriosEsticana" UserSourceName="FillPorCriteriosEsticana">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_CONTRATO_ESTICANA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@SUB_ZONA" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_DEPTO" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_MUNI" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="varchar" DbType="AnsiString" Direction="Input" ParameterName="@CODI_CANTON" Precision="0" ProviderType="VarChar" Scale="0" Size="100" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="TERCIO_ENTREGA_CANATableAdapter" GeneratorDataComponentClassName="TERCIO_ENTREGA_CANATableAdapter" Name="TERCIO_ENTREGA_CANA" UserDataComponentName="TERCIO_ENTREGA_CANATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>select 1000 as grupo, 1000 as orden, 'fggfgfgf' as zona, 100.23 as tc_esticana, 'yyyyyyyy' as tipo,
	123.26 as tc_1, 4523.36 as cuota_1, 
	123.26 as tc_2, 4523.36 as cuota_2, 
	123.26 as tc_3, 4523.36 as cuota_3, 
	123.26 as tc_4, 4523.36 as cuota_4, 
	123.26 as tc_5, 4523.36 as cuota_5, 
	123.26 as tc_6, 4523.36 as cuota_6, 
	123.26 as tc_7, 4523.36 as cuota_7, 
	123.26 as tc_8, 4523.36 as cuota_8, 
	123.26 as tc_9, 4523.36 as cuota_9, 
	123.26 as tc_10, 4523.36 as cuota_10, 
	123.26 as tc_11, 4523.36 as cuota_11
	where 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="grupo" DataSetColumn="grupo" />
              <Mapping SourceColumn="orden" DataSetColumn="orden" />
              <Mapping SourceColumn="zona" DataSetColumn="zona" />
              <Mapping SourceColumn="tc_esticana" DataSetColumn="tc_esticana" />
              <Mapping SourceColumn="tipo" DataSetColumn="tipo" />
              <Mapping SourceColumn="tc_1" DataSetColumn="tc_1" />
              <Mapping SourceColumn="cuota_1" DataSetColumn="cuota_1" />
              <Mapping SourceColumn="tc_2" DataSetColumn="tc_2" />
              <Mapping SourceColumn="cuota_2" DataSetColumn="cuota_2" />
              <Mapping SourceColumn="tc_3" DataSetColumn="tc_3" />
              <Mapping SourceColumn="cuota_3" DataSetColumn="cuota_3" />
              <Mapping SourceColumn="tc_4" DataSetColumn="tc_4" />
              <Mapping SourceColumn="cuota_4" DataSetColumn="cuota_4" />
              <Mapping SourceColumn="tc_5" DataSetColumn="tc_5" />
              <Mapping SourceColumn="cuota_5" DataSetColumn="cuota_5" />
              <Mapping SourceColumn="tc_6" DataSetColumn="tc_6" />
              <Mapping SourceColumn="cuota_6" DataSetColumn="cuota_6" />
              <Mapping SourceColumn="tc_7" DataSetColumn="tc_7" />
              <Mapping SourceColumn="cuota_7" DataSetColumn="cuota_7" />
              <Mapping SourceColumn="tc_8" DataSetColumn="tc_8" />
              <Mapping SourceColumn="cuota_8" DataSetColumn="cuota_8" />
              <Mapping SourceColumn="tc_9" DataSetColumn="tc_9" />
              <Mapping SourceColumn="cuota_9" DataSetColumn="cuota_9" />
              <Mapping SourceColumn="tc_10" DataSetColumn="tc_10" />
              <Mapping SourceColumn="cuota_10" DataSetColumn="cuota_10" />
              <Mapping SourceColumn="tc_11" DataSetColumn="tc_11" />
              <Mapping SourceColumn="cuota_11" DataSetColumn="cuota_11" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.REPORTE_TERCIOS_ENTREGA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorZafra" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorZafra" GeneratorSourceName="FillPorZafra" GetMethodModifier="Public" GetMethodName="GetPorZafra" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorZafra" UserSourceName="FillPorZafra">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.REPORTE_TERCIOS_ENTREGA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@id_zafra" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@grupo" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="SOLIC_ANTICIPOTableAdapter" GeneratorDataComponentClassName="SOLIC_ANTICIPOTableAdapter" Name="SOLIC_ANTICIPO" UserDataComponentName="SOLIC_ANTICIPOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 1223 AS ID_ANTICIPO, 'XXXXXXX' AS ZAFRA, GETDATE() AS FECHA, 'XXXXXXXXX' AS NOMBRE_EMPRESA, 'XXXXXXXXXXXX' AS REPRESENTANTE,
'XXXX' AS CODIGO, 'XXXX' AS ZONA, 54854.23 AS AREA, 2112.12 AS TONELADAS, 1212.12 AS TOTAL,
'XXXX' AS DUI, 'XXXX' AS NIT, 'DFDFDF' AS CREDITFISCAL, 'XXXXXXX' AS CONCEPTO,
'XXXX' AS TECNICO, 5454 AS NUM_ANTICIPO
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_ANTICIPO" DataSetColumn="ID_ANTICIPO" />
              <Mapping SourceColumn="ZAFRA" DataSetColumn="ZAFRA" />
              <Mapping SourceColumn="FECHA" DataSetColumn="FECHA" />
              <Mapping SourceColumn="NOMBRE_EMPRESA" DataSetColumn="NOMBRE_EMPRESA" />
              <Mapping SourceColumn="REPRESENTANTE" DataSetColumn="REPRESENTANTE" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="ZONA" DataSetColumn="ZONA" />
              <Mapping SourceColumn="AREA" DataSetColumn="AREA" />
              <Mapping SourceColumn="TONELADAS" DataSetColumn="TONELADAS" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
              <Mapping SourceColumn="DUI" DataSetColumn="DUI" />
              <Mapping SourceColumn="CREDITFISCAL" DataSetColumn="CREDITFISCAL" />
              <Mapping SourceColumn="CONCEPTO" DataSetColumn="CONCEPTO" />
              <Mapping SourceColumn="TECNICO" DataSetColumn="TECNICO" />
              <Mapping SourceColumn="NUM_ANTICIPO" DataSetColumn="NUM_ANTICIPO" />
              <Mapping SourceColumn="NIT" DataSetColumn="NIT" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillPorIdAnticipo" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorIdAnticipo" GeneratorSourceName="FillPorIdAnticipo" GetMethodModifier="Public" GetMethodName="GetPorIdAnticipo" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorIdAnticipo" UserSourceName="FillPorIdAnticipo">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>select 
		s.ID_ANTICIPO, s.ZAFRA, s.FECHA as fecha, 
			rtrim(p.NOMBRES) + ' ' + rtrim(p.APELLIDOS) as nombre_empresa,
		case 
			when isnull(rtrim(p.APODERADO),'') = '' then  rtrim(p.NOMBRES) + ' ' + rtrim(p.APELLIDOS)
			else isnull(rtrim(p.APODERADO),'')
		end representante,
		dbo.QuitarFormatoCODIPROVEE(p.CODIPROVEE) as codigo, 
		ISNULL((select max(l.ZONA) from SOLIC_ANTICIPO_LOTE n, LOTES l where n.ACCESLOTE = l.ACCESLOTE AND n.ID_ANTICIPO = s.ID_ANTICIPO),0) as zona, 
		ISNULL((SELECT SUM(SC.MZ) FROM SOLIC_ANTICIPO_LOTE SC WHERE SC.ID_ANTICIPO = S.ID_ANTICIPO),0) as area,
		ISNULL((SELECT SUM(SC.TONEL_ESTI) FROM SOLIC_ANTICIPO_LOTE SC WHERE SC.ID_ANTICIPO = S.ID_ANTICIPO),0) as toneladas,
		s.MONTO as total,		
		case 
			when isnull(rtrim(p.APODERADO),'') = '' then dbo.FormatearDUI(p.DUI)
			else dbo.FormatearDUI(p.DUI_APODERADO)
		end dui,
		case 
			when isnull(rtrim(p.APODERADO),'') = '' then dbo.FormatearNIT(p.NIT)
			else dbo.FormatearNIT(p.NIT_APODERADO)
		end nit,
		p.CREDITFISCAL,
		s.CONCEPTO,
		(select max(rtrim(a.NOMBRE_AGRONOMO) + ' ' + rtrim(a.APELLIDO_AGRONOMO)) 
		from SOLIC_ANTICIPO_LOTE n, LOTES l, MAESTRO_LOTES m, AGRONOMO a where n.ACCESLOTE = l.ACCESLOTE AND n.ID_ANTICIPO = s.ID_ANTICIPO and l.ID_MAESTRO = m.ID_MAESTRO and m.CODIAGRON = a.CODIAGRON
		) as tecnico,
			s.NUM_ANTICIPO
	from SOLIC_ANTICIPO s, PROVEEDOR p
	where s.CODIPROVEEDOR = p.CODIPROVEEDOR and s.ID_ANTICIPO = @ID_ANTICIPO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="ID_ANTICIPO" ColumnName="ID_ANTICIPO" DataSourceName="INJIBOA.dbo.SOLIC_ANTICIPO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ANTICIPO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="ID_ANTICIPO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="REPORTE_ENTREGA_ANOMALOTableAdapter" GeneratorDataComponentClassName="REPORTE_ENTREGA_ANOMALOTableAdapter" Name="REPORTE_ENTREGA_ANOMALO" UserDataComponentName="REPORTE_ENTREGA_ANOMALOTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	1000 AS DIAZAFRA, 545454 AS NO_RECIBO, 545454 AS TACO, 'XXXXX' AS CODIPROVEE,
	'XXXX' AS CODISOCIO, 'XXXXXX' AS PROVEEDOR, 'XX' AS CODIGO, 'XXXXXX' AS LOTE, 54545.23 AS REND85,
	45545.23 AS TONELADAS, 1 AS ES_ANOMALO, 212121.23 AS RENDIA85_ANOMALO
WHERE 1 = -1
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="DIAZAFRA" DataSetColumn="DIAZAFRA" />
              <Mapping SourceColumn="NO_RECIBO" DataSetColumn="NO_RECIBO" />
              <Mapping SourceColumn="TACO" DataSetColumn="TACO" />
              <Mapping SourceColumn="CODIPROVEE" DataSetColumn="CODIPROVEE" />
              <Mapping SourceColumn="CODISOCIO" DataSetColumn="CODISOCIO" />
              <Mapping SourceColumn="PROVEEDOR" DataSetColumn="PROVEEDOR" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="LOTE" DataSetColumn="LOTE" />
              <Mapping SourceColumn="REND85" DataSetColumn="REND85" />
              <Mapping SourceColumn="TONELADAS" DataSetColumn="TONELADAS" />
              <Mapping SourceColumn="ES_ANOMALO" DataSetColumn="ES_ANOMALO" />
              <Mapping SourceColumn="RENDIA85_ANOMALO" DataSetColumn="RENDIA85_ANOMALO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="INJIBOA2.dbo.REPORTE_ENTREGA_ANOMALA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCriterios" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCriterios" GeneratorSourceName="FillPorCriterios" GetMethodModifier="Public" GetMethodName="GetPorCriterios" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCriterios" UserSourceName="FillPorCriterios">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.REPORTE_ENTREGA_ANOMALA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA_ZAFRA1" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA_ZAFRA2" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="bit" DbType="Boolean" Direction="Input" ParameterName="@VER_SOLO_ANOMALOS" Precision="1" ProviderType="Bit" Scale="0" Size="1" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RPT_AUTOVOLTEO_TRACTORISTATableAdapter" GeneratorDataComponentClassName="RPT_AUTOVOLTEO_TRACTORISTATableAdapter" Name="RPT_AUTOVOLTEO_TRACTORISTA" UserDataComponentName="RPT_AUTOVOLTEO_TRACTORISTATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 'XXXX' AS NOMBRE_ZAFRA,
5454 AS ID_CARGADOR, 'XXXXXX' AS TRACTORISTA, 0.000 AS TARIFA_TRACTORISTA, 454554 AS CODIPROVEEDOR, 'XXXXXX' AS PRODUCTOR,
'XXXX' AS CODILOTE, 'XXXXX' AS NOMBLOTE, 'XXXXXX' AS COSECHADORA, 545454.12 AS TC, 54545.12 AS PAGO
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="ID_CARGADOR" DataSetColumn="ID_CARGADOR" />
              <Mapping SourceColumn="TRACTORISTA" DataSetColumn="TRACTORISTA" />
              <Mapping SourceColumn="TARIFA_TRACTORISTA" DataSetColumn="TARIFA_TRACTORISTA" />
              <Mapping SourceColumn="PRODUCTOR" DataSetColumn="PRODUCTOR" />
              <Mapping SourceColumn="CODILOTE" DataSetColumn="CODILOTE" />
              <Mapping SourceColumn="NOMBLOTE" DataSetColumn="NOMBLOTE" />
              <Mapping SourceColumn="COSECHADORA" DataSetColumn="COSECHADORA" />
              <Mapping SourceColumn="TC" DataSetColumn="TC" />
              <Mapping SourceColumn="PAGO" DataSetColumn="PAGO" />
              <Mapping SourceColumn="CODIPROVEEDOR" DataSetColumn="CODIPROVEEDOR" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="DESAINJIBOA.dbo.RPT_AUTOVOLTEO_TRACTORISTA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillPorCatorcena" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetPorCatorcena" GeneratorSourceName="FillPorCatorcena" GetMethodModifier="Public" GetMethodName="GetPorCatorcena" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetPorCatorcena" UserSourceName="FillPorCatorcena">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_AUTOVOLTEO_TRACTORISTA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_CATORCENA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="TIPOCANA_POR_DIAZAFRATableAdapter" GeneratorDataComponentClassName="TIPOCANA_POR_DIAZAFRATableAdapter" Name="TIPOCANA_POR_DIAZAFRA" UserDataComponentName="TIPOCANA_POR_DIAZAFRATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
1000 AS ID_ZAFRA, 'XXXX' AS NOMBRE_ZAFRA, 777 AS DIAZAFRA, 1000.23 AS LARGA,
1000.23 AS CORTA, 1000.23 AS PICADA_MECANIZADA, 1000.23 AS TOTAL,
1000.23 AS PLARGA, 1000.23 AS PCORTA, 1000.23 AS PPICADA_MECANIZADA
WHERE 1 = -1</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID_ZAFRA" DataSetColumn="ID_ZAFRA" />
              <Mapping SourceColumn="NOMBRE_ZAFRA" DataSetColumn="NOMBRE_ZAFRA" />
              <Mapping SourceColumn="DIAZAFRA" DataSetColumn="DIAZAFRA" />
              <Mapping SourceColumn="LARGA" DataSetColumn="LARGA" />
              <Mapping SourceColumn="CORTA" DataSetColumn="CORTA" />
              <Mapping SourceColumn="PICADA_MECANIZADA" DataSetColumn="PICADA_MECANIZADA" />
              <Mapping SourceColumn="TOTAL" DataSetColumn="TOTAL" />
              <Mapping SourceColumn="PLARGA" DataSetColumn="PLARGA" />
              <Mapping SourceColumn="PCORTA" DataSetColumn="PCORTA" />
              <Mapping SourceColumn="PPICADA_MECANIZADA" DataSetColumn="PPICADA_MECANIZADA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="cn (MySettings)" DbObjectName="DESAINJIBOA.dbo.RPT_TIPO_CANA_DIAZAFRA" DbObjectType="StoredProcedure" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="StoredProcedure" ModifiedByUser="false">
                    <CommandText>dbo.RPT_TIPO_CANA_DIAZAFRA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="ReturnValue" ParameterName="@RETURN_VALUE" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@ID_ZAFRA" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA1" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@DIA2" Precision="10" ProviderType="Int" Scale="0" Size="4" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DS_SIGESTA" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="DS_SIGESTA" msprop:Generator_UserDSName="DS_SIGESTA">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="CONTRATO_REND_ESTIMADO" msprop:Generator_TableClassName="CONTRATO_REND_ESTIMADODataTable" msprop:Generator_TableVarName="tableCONTRATO_REND_ESTIMADO" msprop:Generator_RowChangedName="CONTRATO_REND_ESTIMADORowChanged" msprop:Generator_TablePropName="CONTRATO_REND_ESTIMADO" msprop:Generator_RowDeletingName="CONTRATO_REND_ESTIMADORowDeleting" msprop:Generator_RowChangingName="CONTRATO_REND_ESTIMADORowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_REND_ESTIMADORowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_REND_ESTIMADORowDeleted" msprop:Generator_RowClassName="CONTRATO_REND_ESTIMADORow" msprop:Generator_UserTableName="CONTRATO_REND_ESTIMADO" msprop:Generator_RowEvArgName="CONTRATO_REND_ESTIMADORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="REND_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnREND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="REND_CONTRATADOColumn" msprop:Generator_UserColumnName="REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnLBS_CONTRATADO" msprop:Generator_ColumnPropNameInRow="LBS_CONTRATADO" msprop:Generator_ColumnPropNameInTable="LBS_CONTRATADOColumn" msprop:Generator_UserColumnName="LBS_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnVALOR_CONTRATADO" msprop:Generator_ColumnPropNameInRow="VALOR_CONTRATADO" msprop:Generator_ColumnPropNameInTable="VALOR_CONTRATADOColumn" msprop:Generator_UserColumnName="VALOR_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="ANIOZAFRA" msprop:Generator_ColumnVarNameInTable="columnANIOZAFRA" msprop:Generator_ColumnPropNameInRow="ANIOZAFRA" msprop:Generator_ColumnPropNameInTable="ANIOZAFRAColumn" msprop:Generator_UserColumnName="ANIOZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="CANT_LOTES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_LOTES" msprop:Generator_ColumnPropNameInRow="CANT_LOTES" msprop:Generator_ColumnPropNameInTable="CANT_LOTESColumn" msprop:Generator_UserColumnName="CANT_LOTES" type="xs:int" minOccurs="0" />
              <xs:element name="DESCRIP_ZONA" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="CANT_CONTRATOS" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="VIGENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVIGENCIA" msprop:Generator_ColumnPropNameInRow="VIGENCIA" msprop:Generator_ColumnPropNameInTable="VIGENCIAColumn" msprop:Generator_UserColumnName="VIGENCIA" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CENSO_X" msprop:Generator_TableClassName="CENSO_XDataTable" msprop:Generator_TableVarName="tableCENSO_X" msprop:Generator_RowChangedName="CENSO_XRowChanged" msprop:Generator_TablePropName="CENSO_X" msprop:Generator_RowDeletingName="CENSO_XRowDeleting" msprop:Generator_RowChangingName="CENSO_XRowChanging" msprop:Generator_RowEvHandlerName="CENSO_XRowChangeEventHandler" msprop:Generator_RowDeletedName="CENSO_XRowDeleted" msprop:Generator_RowClassName="CENSO_XRow" msprop:Generator_UserTableName="CENSO_X" msprop:Generator_RowEvArgName="CENSO_XRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="REND_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnREND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="REND_CONTRATADOColumn" msprop:Generator_UserColumnName="REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnLBS_CONTRATADO" msprop:Generator_ColumnPropNameInRow="LBS_CONTRATADO" msprop:Generator_ColumnPropNameInTable="LBS_CONTRATADOColumn" msprop:Generator_UserColumnName="LBS_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnVALOR_CONTRATADO" msprop:Generator_ColumnPropNameInRow="VALOR_CONTRATADO" msprop:Generator_ColumnPropNameInTable="VALOR_CONTRATADOColumn" msprop:Generator_UserColumnName="VALOR_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGARColumn" msprop:Generator_UserColumnName="MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGAR" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGAR" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGARColumn" msprop:Generator_UserColumnName="LBS_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGAR" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGAR" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGARColumn" msprop:Generator_UserColumnName="VALOR_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGADA" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGADA" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGADAColumn" msprop:Generator_UserColumnName="VALOR_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CENSO" msprop:Generator_ColumnVarNameInTable="columnLBS_CENSO" msprop:Generator_ColumnPropNameInRow="LBS_CENSO" msprop:Generator_ColumnPropNameInTable="LBS_CENSOColumn" msprop:Generator_UserColumnName="LBS_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CENSO" msprop:Generator_ColumnVarNameInTable="columnVALOR_CENSO" msprop:Generator_ColumnPropNameInRow="VALOR_CENSO" msprop:Generator_ColumnPropNameInTable="VALOR_CENSOColumn" msprop:Generator_UserColumnName="VALOR_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_HISTO" msprop:Generator_ColumnVarNameInTable="columnREND_HISTO" msprop:Generator_ColumnPropNameInRow="REND_HISTO" msprop:Generator_ColumnPropNameInTable="REND_HISTOColumn" msprop:Generator_UserColumnName="REND_HISTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_ZAFRA" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANT_LOTES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_LOTES" msprop:Generator_ColumnPropNameInRow="CANT_LOTES" msprop:Generator_ColumnPropNameInTable="CANT_LOTESColumn" msprop:Generator_UserColumnName="CANT_LOTES" type="xs:int" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_VERIFICACION" msprop:Generator_ColumnVarNameInTable="columnFECHA_VERIFICACION" msprop:Generator_ColumnPropNameInRow="FECHA_VERIFICACION" msprop:Generator_ColumnPropNameInTable="FECHA_VERIFICACIONColumn" msprop:Generator_UserColumnName="FECHA_VERIFICACION" type="xs:dateTime" minOccurs="0" />
              <xs:element name="MZ_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_VAR" msprop:Generator_ColumnPropNameInRow="MZ_VAR" msprop:Generator_ColumnPropNameInTable="MZ_VARColumn" msprop:Generator_UserColumnName="MZ_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_VAR" msprop:Generator_ColumnPropNameInRow="TC_MZ_VAR" msprop:Generator_ColumnPropNameInTable="TC_MZ_VARColumn" msprop:Generator_UserColumnName="TC_MZ_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_VAR" msprop:Generator_ColumnPropNameInRow="TC_VAR" msprop:Generator_ColumnPropNameInTable="TC_VARColumn" msprop:Generator_UserColumnName="TC_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_VAR" msprop:Generator_ColumnPropNameInRow="LBS_VAR" msprop:Generator_ColumnPropNameInTable="LBS_VARColumn" msprop:Generator_UserColumnName="LBS_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_VAR" msprop:Generator_ColumnPropNameInRow="TOTAL_VAR" msprop:Generator_ColumnPropNameInTable="TOTAL_VARColumn" msprop:Generator_UserColumnName="TOTAL_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESCRIP_ZONA" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="CANT_CONTRATOS" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="OBSERVACION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnOBSERVACION" msprop:Generator_ColumnPropNameInRow="OBSERVACION" msprop:Generator_ColumnPropNameInTable="OBSERVACIONColumn" msprop:Generator_UserColumnName="OBSERVACION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MZ_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="MZ_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="MZ_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="TC_MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="TC_MZ_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="TC_MZ_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="TC_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="TC_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="TC_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ZAFRA_COMPA1" msdata:ReadOnly="true" msdata:Caption="MZ_ZAFRA_COMPA" msprop:Generator_ColumnVarNameInTable="columnMZ_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInRow="MZ_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInTable="MZ_ZAFRA_COMPA1Column" msprop:Generator_UserColumnName="MZ_ZAFRA_COMPA1" type="xs:int" minOccurs="0" />
              <xs:element name="TC_MZ_ZAFRA_COMPA1" msdata:ReadOnly="true" msdata:Caption="TC_MZ_ZAFRA_COMPA" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInRow="TC_MZ_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInTable="TC_MZ_ZAFRA_COMPA1Column" msprop:Generator_UserColumnName="TC_MZ_ZAFRA_COMPA1" type="xs:int" minOccurs="0" />
              <xs:element name="TC_ZAFRA_COMPA1" msdata:ReadOnly="true" msdata:Caption="TC_ZAFRA_COMPA" msprop:Generator_ColumnVarNameInTable="columnTC_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInRow="TC_ZAFRA_COMPA1" msprop:Generator_ColumnPropNameInTable="TC_ZAFRA_COMPA1Column" msprop:Generator_UserColumnName="TC_ZAFRA_COMPA1" type="xs:int" minOccurs="0" />
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_COSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_COSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_COSECHAColumn" msprop:Generator_UserColumnName="FECHA_COSECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="SUB_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="SUB_TIPO_CANAColumn" msprop:Generator_UserColumnName="SUB_TIPO_CANA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TERCIO" msprop:Generator_ColumnPropNameInRow="SUB_TERCIO" msprop:Generator_ColumnPropNameInTable="SUB_TERCIOColumn" msprop:Generator_UserColumnName="SUB_TERCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CENSO_RESUMEN" msprop:Generator_TableClassName="CENSO_RESUMENDataTable" msprop:Generator_TableVarName="tableCENSO_RESUMEN" msprop:Generator_RowChangedName="CENSO_RESUMENRowChanged" msprop:Generator_TablePropName="CENSO_RESUMEN" msprop:Generator_RowDeletingName="CENSO_RESUMENRowDeleting" msprop:Generator_RowChangingName="CENSO_RESUMENRowChanging" msprop:Generator_RowEvHandlerName="CENSO_RESUMENRowChangeEventHandler" msprop:Generator_RowDeletedName="CENSO_RESUMENRowDeleted" msprop:Generator_RowClassName="CENSO_RESUMENRow" msprop:Generator_UserTableName="CENSO_RESUMEN" msprop:Generator_RowEvArgName="CENSO_RESUMENRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_CENSO" msprop:Generator_ColumnPropNameInRow="LBS_CENSO" msprop:Generator_ColumnPropNameInTable="LBS_CENSOColumn" msprop:Generator_UserColumnName="LBS_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR_CENSO" msprop:Generator_ColumnPropNameInRow="VALOR_CENSO" msprop:Generator_ColumnPropNameInTable="VALOR_CENSOColumn" msprop:Generator_UserColumnName="VALOR_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGARColumn" msprop:Generator_UserColumnName="MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGAR" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGAR" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGARColumn" msprop:Generator_UserColumnName="LBS_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGAR" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGAR" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGARColumn" msprop:Generator_UserColumnName="VALOR_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGADA" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGADA" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGADAColumn" msprop:Generator_UserColumnName="VALOR_ENTREGADA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CONTRATO_RESUMEN" msprop:Generator_TableClassName="CONTRATO_RESUMENDataTable" msprop:Generator_TableVarName="tableCONTRATO_RESUMEN" msprop:Generator_RowChangedName="CONTRATO_RESUMENRowChanged" msprop:Generator_TablePropName="CONTRATO_RESUMEN" msprop:Generator_RowDeletingName="CONTRATO_RESUMENRowDeleting" msprop:Generator_RowChangingName="CONTRATO_RESUMENRowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_RESUMENRowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_RESUMENRowDeleted" msprop:Generator_RowClassName="CONTRATO_RESUMENRow" msprop:Generator_UserTableName="CONTRATO_RESUMEN" msprop:Generator_RowEvArgName="CONTRATO_RESUMENRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ANIOZAFRA" msprop:Generator_ColumnVarNameInTable="columnANIOZAFRA" msprop:Generator_ColumnPropNameInRow="ANIOZAFRA" msprop:Generator_ColumnPropNameInTable="ANIOZAFRAColumn" msprop:Generator_UserColumnName="ANIOZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="REND_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="REND_CONTRATADOColumn" msprop:Generator_UserColumnName="REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_CONTRATADO" msprop:Generator_ColumnPropNameInRow="LBS_CONTRATADO" msprop:Generator_ColumnPropNameInTable="LBS_CONTRATADOColumn" msprop:Generator_UserColumnName="LBS_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR_CONTRATADO" msprop:Generator_ColumnPropNameInRow="VALOR_CONTRATADO" msprop:Generator_ColumnPropNameInTable="VALOR_CONTRATADOColumn" msprop:Generator_UserColumnName="VALOR_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANT_LOTES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_LOTES" msprop:Generator_ColumnPropNameInRow="CANT_LOTES" msprop:Generator_ColumnPropNameInTable="CANT_LOTESColumn" msprop:Generator_UserColumnName="CANT_LOTES" type="xs:int" minOccurs="0" />
              <xs:element name="CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="CANT_CONTRATOS" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="MAESTRO_LOTES" msprop:Generator_TableClassName="MAESTRO_LOTESDataTable" msprop:Generator_TableVarName="tableMAESTRO_LOTES" msprop:Generator_RowChangedName="MAESTRO_LOTESRowChanged" msprop:Generator_TablePropName="MAESTRO_LOTES" msprop:Generator_RowDeletingName="MAESTRO_LOTESRowDeleting" msprop:Generator_RowChangingName="MAESTRO_LOTESRowChanging" msprop:Generator_RowEvHandlerName="MAESTRO_LOTESRowChangeEventHandler" msprop:Generator_RowDeletedName="MAESTRO_LOTESRowDeleted" msprop:Generator_RowClassName="MAESTRO_LOTESRow" msprop:Generator_UserTableName="MAESTRO_LOTES" msprop:Generator_RowEvArgName="MAESTRO_LOTESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_COMER" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_COMER" msprop:Generator_ColumnPropNameInRow="NOMBRE_COMER" msprop:Generator_ColumnPropNameInTable="NOMBRE_COMERColumn" msprop:Generator_UserColumnName="NOMBRE_COMER">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE_COMER" msprop:Generator_ColumnVarNameInTable="columnCODILOTE_COMER" msprop:Generator_ColumnPropNameInRow="CODILOTE_COMER" msprop:Generator_ColumnPropNameInTable="CODILOTE_COMERColumn" msprop:Generator_UserColumnName="CODILOTE_COMER">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CUI" msprop:Generator_ColumnVarNameInTable="columnCUI" msprop:Generator_ColumnPropNameInRow="CUI" msprop:Generator_ColumnPropNameInTable="CUIColumn" msprop:Generator_UserColumnName="CUI">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="21" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ORDEN_ANALISIS_PRECOSECHA" msprop:Generator_TableClassName="ORDEN_ANALISIS_PRECOSECHADataTable" msprop:Generator_TableVarName="tableORDEN_ANALISIS_PRECOSECHA" msprop:Generator_RowChangedName="ORDEN_ANALISIS_PRECOSECHARowChanged" msprop:Generator_TablePropName="ORDEN_ANALISIS_PRECOSECHA" msprop:Generator_RowDeletingName="ORDEN_ANALISIS_PRECOSECHARowDeleting" msprop:Generator_RowChangingName="ORDEN_ANALISIS_PRECOSECHARowChanging" msprop:Generator_RowEvHandlerName="ORDEN_ANALISIS_PRECOSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="ORDEN_ANALISIS_PRECOSECHARowDeleted" msprop:Generator_RowClassName="ORDEN_ANALISIS_PRECOSECHARow" msprop:Generator_UserTableName="ORDEN_ANALISIS_PRECOSECHA" msprop:Generator_RowEvArgName="ORDEN_ANALISIS_PRECOSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_ANALISIS_PRE" msprop:Generator_ColumnVarNameInTable="columnID_ANALISIS_PRE" msprop:Generator_ColumnPropNameInRow="ID_ANALISIS_PRE" msprop:Generator_ColumnPropNameInTable="ID_ANALISIS_PREColumn" msprop:Generator_UserColumnName="ID_ANALISIS_PRE" type="xs:int" minOccurs="0" />
              <xs:element name="NO_ANALISIS" msprop:Generator_ColumnVarNameInTable="columnNO_ANALISIS" msprop:Generator_ColumnPropNameInRow="NO_ANALISIS" msprop:Generator_ColumnPropNameInTable="NO_ANALISISColumn" msprop:Generator_UserColumnName="NO_ANALISIS" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnFECHA_MUESTRA" msprop:Generator_ColumnPropNameInRow="FECHA_MUESTRA" msprop:Generator_ColumnPropNameInTable="FECHA_MUESTRAColumn" msprop:Generator_UserColumnName="FECHA_MUESTRA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NO_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnNO_MUESTRA" msprop:Generator_ColumnPropNameInRow="NO_MUESTRA" msprop:Generator_ColumnPropNameInTable="NO_MUESTRAColumn" msprop:Generator_UserColumnName="NO_MUESTRA" type="xs:int" minOccurs="0" />
              <xs:element name="AREA_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnAREA_MUESTRA" msprop:Generator_ColumnPropNameInRow="AREA_MUESTRA" msprop:Generator_ColumnPropNameInTable="AREA_MUESTRAColumn" msprop:Generator_UserColumnName="AREA_MUESTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBRE_USUARIO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_USUARIO" msprop:Generator_ColumnPropNameInRow="NOMBRE_USUARIO" msprop:Generator_ColumnPropNameInTable="NOMBRE_USUARIOColumn" msprop:Generator_UserColumnName="NOMBRE_USUARIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE_CONTRATO" msprop:Generator_ColumnPropNameInRow="CODIPROVEE_CONTRATO" msprop:Generator_ColumnPropNameInTable="CODIPROVEE_CONTRATOColumn" msprop:Generator_UserColumnName="CODIPROVEE_CONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE_LOTE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE_LOTE" msprop:Generator_ColumnPropNameInTable="CODIPROVEE_LOTEColumn" msprop:Generator_UserColumnName="CODIPROVEE_LOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO_LOTE" msprop:Generator_ColumnPropNameInRow="CODISOCIO_LOTE" msprop:Generator_ColumnPropNameInTable="CODISOCIO_LOTEColumn" msprop:Generator_UserColumnName="CODISOCIO_LOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR_CONTRATO" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR_CONTRATO" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDOR_CONTRATOColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR_CONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR_LOTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR_LOTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDOR_LOTEColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR_LOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="REQUERIMIENTO_FABRICA" msprop:Generator_TableClassName="REQUERIMIENTO_FABRICADataTable" msprop:Generator_TableVarName="tableREQUERIMIENTO_FABRICA" msprop:Generator_RowChangedName="REQUERIMIENTO_FABRICARowChanged" msprop:Generator_TablePropName="REQUERIMIENTO_FABRICA" msprop:Generator_RowDeletingName="REQUERIMIENTO_FABRICARowDeleting" msprop:Generator_RowChangingName="REQUERIMIENTO_FABRICARowChanging" msprop:Generator_RowEvHandlerName="REQUERIMIENTO_FABRICARowChangeEventHandler" msprop:Generator_RowDeletedName="REQUERIMIENTO_FABRICARowDeleted" msprop:Generator_RowClassName="REQUERIMIENTO_FABRICARow" msprop:Generator_UserTableName="REQUERIMIENTO_FABRICA" msprop:Generator_RowEvArgName="REQUERIMIENTO_FABRICARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TC_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_DIA" msprop:Generator_ColumnPropNameInRow="TC_DIA" msprop:Generator_ColumnPropNameInTable="TC_DIAColumn" msprop:Generator_UserColumnName="TC_DIA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="PLAN_CAT" msprop:Generator_TableClassName="PLAN_CATDataTable" msprop:Generator_TableVarName="tablePLAN_CAT" msprop:Generator_RowChangedName="PLAN_CATRowChanged" msprop:Generator_TablePropName="PLAN_CAT" msprop:Generator_RowDeletingName="PLAN_CATRowDeleting" msprop:Generator_RowChangingName="PLAN_CATRowChanging" msprop:Generator_RowEvHandlerName="PLAN_CATRowChangeEventHandler" msprop:Generator_RowDeletedName="PLAN_CATRowDeleted" msprop:Generator_RowClassName="PLAN_CATRow" msprop:Generator_UserTableName="PLAN_CAT" msprop:Generator_RowEvArgName="PLAN_CATRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_ROZA_SH" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA_SH" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA_SH" msprop:Generator_ColumnPropNameInTable="FECHA_ROZA_SHColumn" msprop:Generator_UserColumnName="FECHA_ROZA_SH" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="21" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_TIPO_CANA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_CANAColumn" msprop:Generator_UserColumnName="ID_TIPO_CANA" type="xs:int" minOccurs="0" />
              <xs:element name="ID_TIPO_ROZA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_ROZA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_ROZA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_ROZAColumn" msprop:Generator_UserColumnName="ID_TIPO_ROZA" type="xs:int" minOccurs="0" />
              <xs:element name="ID_TIPO_ALZA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_ALZA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_ALZA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_ALZAColumn" msprop:Generator_UserColumnName="ID_TIPO_ALZA" type="xs:int" minOccurs="0" />
              <xs:element name="ID_TIPO_TRANS" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_TRANS" msprop:Generator_ColumnPropNameInRow="ID_TIPO_TRANS" msprop:Generator_ColumnPropNameInTable="ID_TIPO_TRANSColumn" msprop:Generator_UserColumnName="ID_TIPO_TRANS" type="xs:int" minOccurs="0" />
              <xs:element name="TIPO_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_ROZA" msprop:Generator_ColumnPropNameInRow="TIPO_ROZA" msprop:Generator_ColumnPropNameInTable="TIPO_ROZAColumn" msprop:Generator_UserColumnName="TIPO_ROZA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO_ALZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_ALZA" msprop:Generator_ColumnPropNameInRow="TIPO_ALZA" msprop:Generator_ColumnPropNameInTable="TIPO_ALZAColumn" msprop:Generator_UserColumnName="TIPO_ALZA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="TIPO_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="TIPO_TRANSPORTEColumn" msprop:Generator_UserColumnName="TIPO_TRANSPORTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TERCIO" msprop:Generator_ColumnPropNameInRow="SUB_TERCIO" msprop:Generator_ColumnPropNameInTable="SUB_TERCIOColumn" msprop:Generator_UserColumnName="SUB_TERCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_DEPTO" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CANA" msprop:Generator_ColumnPropNameInRow="TIPO_CANA" msprop:Generator_ColumnPropNameInTable="TIPO_CANAColumn" msprop:Generator_UserColumnName="TIPO_CANA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RESULTADOS_ANALISIS_PRECOSECHA" msprop:Generator_TableClassName="RESULTADOS_ANALISIS_PRECOSECHADataTable" msprop:Generator_TableVarName="tableRESULTADOS_ANALISIS_PRECOSECHA" msprop:Generator_RowChangedName="RESULTADOS_ANALISIS_PRECOSECHARowChanged" msprop:Generator_TablePropName="RESULTADOS_ANALISIS_PRECOSECHA" msprop:Generator_RowDeletingName="RESULTADOS_ANALISIS_PRECOSECHARowDeleting" msprop:Generator_RowChangingName="RESULTADOS_ANALISIS_PRECOSECHARowChanging" msprop:Generator_RowEvHandlerName="RESULTADOS_ANALISIS_PRECOSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RESULTADOS_ANALISIS_PRECOSECHARowDeleted" msprop:Generator_RowClassName="RESULTADOS_ANALISIS_PRECOSECHARow" msprop:Generator_UserTableName="RESULTADOS_ANALISIS_PRECOSECHA" msprop:Generator_RowEvArgName="RESULTADOS_ANALISIS_PRECOSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="FECHA_LEE_BAGAZO_BRUTO" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_BAGAZO_BRUTO" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_BAGAZO_BRUTO" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_BAGAZO_BRUTOColumn" msprop:Generator_UserColumnName="FECHA_LEE_BAGAZO_BRUTO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NO_ANALISIS" msprop:Generator_ColumnVarNameInTable="columnNO_ANALISIS" msprop:Generator_ColumnPropNameInRow="NO_ANALISIS" msprop:Generator_ColumnPropNameInTable="NO_ANALISISColumn" msprop:Generator_UserColumnName="NO_ANALISIS" type="xs:int" />
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" type="xs:string" minOccurs="0" />
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" type="xs:string" minOccurs="0" />
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" />
              <xs:element name="AZUCAR_REDUCTORES" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInRow="AZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInTable="AZUCAR_REDUCTORESColumn" msprop:Generator_UserColumnName="AZUCAR_REDUCTORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL_JUGO" msprop:Generator_ColumnVarNameInTable="columnPOL_JUGO" msprop:Generator_ColumnPropNameInRow="POL_JUGO" msprop:Generator_ColumnPropNameInTable="POL_JUGOColumn" msprop:Generator_UserColumnName="POL_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="BRIX" msprop:Generator_ColumnVarNameInTable="columnBRIX" msprop:Generator_ColumnPropNameInRow="BRIX" msprop:Generator_ColumnPropNameInTable="BRIXColumn" msprop:Generator_UserColumnName="BRIX" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEXTRANA" msprop:Generator_ColumnVarNameInTable="columnDEXTRANA" msprop:Generator_ColumnPropNameInRow="DEXTRANA" msprop:Generator_ColumnPropNameInTable="DEXTRANAColumn" msprop:Generator_UserColumnName="DEXTRANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEXTRA_BRIZ" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEXTRA_BRIZ" msprop:Generator_ColumnPropNameInRow="DEXTRA_BRIZ" msprop:Generator_ColumnPropNameInTable="DEXTRA_BRIZColumn" msprop:Generator_UserColumnName="DEXTRA_BRIZ" type="xs:decimal" minOccurs="0" />
              <xs:element name="ALMIDON_JUGO" msprop:Generator_ColumnVarNameInTable="columnALMIDON_JUGO" msprop:Generator_ColumnPropNameInRow="ALMIDON_JUGO" msprop:Generator_ColumnPropNameInTable="ALMIDON_JUGOColumn" msprop:Generator_UserColumnName="ALMIDON_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA_LEE_POL" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_POL" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_POL" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_POLColumn" msprop:Generator_UserColumnName="FECHA_LEE_POL" type="xs:dateTime" minOccurs="0" />
              <xs:element name="POL" msprop:Generator_ColumnVarNameInTable="columnPOL" msprop:Generator_ColumnPropNameInRow="POL" msprop:Generator_ColumnPropNameInTable="POLColumn" msprop:Generator_UserColumnName="POL" type="xs:decimal" minOccurs="0" />
              <xs:element name="BAGAZO_NETO" msprop:Generator_ColumnVarNameInTable="columnBAGAZO_NETO" msprop:Generator_ColumnPropNameInRow="BAGAZO_NETO" msprop:Generator_ColumnPropNameInTable="BAGAZO_NETOColumn" msprop:Generator_UserColumnName="BAGAZO_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA" msprop:Generator_ColumnPropNameInTable="FIBRA_CANAColumn" msprop:Generator_UserColumnName="FIBRA_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="JUGO_CANA" msprop:Generator_ColumnVarNameInTable="columnJUGO_CANA" msprop:Generator_ColumnPropNameInRow="JUGO_CANA" msprop:Generator_ColumnPropNameInTable="JUGO_CANAColumn" msprop:Generator_UserColumnName="JUGO_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL_CANA" msprop:Generator_ColumnVarNameInTable="columnPOL_CANA" msprop:Generator_ColumnPropNameInRow="POL_CANA" msprop:Generator_ColumnPropNameInTable="POL_CANAColumn" msprop:Generator_UserColumnName="POL_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGOColumn" msprop:Generator_UserColumnName="PUREZA_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_AZUCAR" msprop:Generator_ColumnVarNameInTable="columnPUREZA_AZUCAR" msprop:Generator_ColumnPropNameInRow="PUREZA_AZUCAR" msprop:Generator_ColumnPropNameInTable="PUREZA_AZUCARColumn" msprop:Generator_UserColumnName="PUREZA_AZUCAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="SJM" msprop:Generator_ColumnVarNameInTable="columnSJM" msprop:Generator_ColumnPropNameInRow="SJM" msprop:Generator_ColumnPropNameInTable="SJMColumn" msprop:Generator_UserColumnName="SJM" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH" msprop:Generator_ColumnVarNameInTable="columnPH" msprop:Generator_ColumnPropNameInRow="PH" msprop:Generator_ColumnPropNameInTable="PHColumn" msprop:Generator_UserColumnName="PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="RENDIA_CALC2" msprop:Generator_ColumnVarNameInTable="columnRENDIA_CALC2" msprop:Generator_ColumnPropNameInRow="RENDIA_CALC2" msprop:Generator_ColumnPropNameInTable="RENDIA_CALC2Column" msprop:Generator_UserColumnName="RENDIA_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLIC_AGRICOLA_MADURANTE" msprop:Generator_TableClassName="SOLIC_AGRICOLA_MADURANTEDataTable" msprop:Generator_TableVarName="tableSOLIC_AGRICOLA_MADURANTE" msprop:Generator_RowChangedName="SOLIC_AGRICOLA_MADURANTERowChanged" msprop:Generator_TablePropName="SOLIC_AGRICOLA_MADURANTE" msprop:Generator_RowDeletingName="SOLIC_AGRICOLA_MADURANTERowDeleting" msprop:Generator_RowChangingName="SOLIC_AGRICOLA_MADURANTERowChanging" msprop:Generator_RowEvHandlerName="SOLIC_AGRICOLA_MADURANTERowChangeEventHandler" msprop:Generator_RowDeletedName="SOLIC_AGRICOLA_MADURANTERowDeleted" msprop:Generator_RowClassName="SOLIC_AGRICOLA_MADURANTERow" msprop:Generator_UserTableName="SOLIC_AGRICOLA_MADURANTE" msprop:Generator_RowEvArgName="SOLIC_AGRICOLA_MADURANTERowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_PROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="NRC" msprop:Generator_ColumnVarNameInTable="columnNRC" msprop:Generator_ColumnPropNameInRow="NRC" msprop:Generator_ColumnPropNameInTable="NRCColumn" msprop:Generator_UserColumnName="NRC" type="xs:string" minOccurs="0" />
              <xs:element name="ACTIVIDAD" msprop:Generator_ColumnVarNameInTable="columnACTIVIDAD" msprop:Generator_ColumnPropNameInRow="ACTIVIDAD" msprop:Generator_ColumnPropNameInTable="ACTIVIDADColumn" msprop:Generator_UserColumnName="ACTIVIDAD" type="xs:string" />
              <xs:element name="PROVEEDOR_VUELO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR_VUELO" msprop:Generator_ColumnPropNameInRow="PROVEEDOR_VUELO" msprop:Generator_ColumnPropNameInTable="PROVEEDOR_VUELOColumn" msprop:Generator_UserColumnName="PROVEEDOR_VUELO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PILOTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PILOTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_PILOTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_PILOTOColumn" msprop:Generator_UserColumnName="NOMBRE_PILOTO" type="xs:string" minOccurs="0" />
              <xs:element name="MEDIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMEDIO" msprop:Generator_ColumnPropNameInRow="MEDIO" msprop:Generator_ColumnPropNameInTable="MEDIOColumn" msprop:Generator_UserColumnName="MEDIO" type="xs:string" minOccurs="0" />
              <xs:element name="DESCRIP_AERONAVE" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_AERONAVE" msprop:Generator_ColumnPropNameInRow="DESCRIP_AERONAVE" msprop:Generator_ColumnPropNameInTable="DESCRIP_AERONAVEColumn" msprop:Generator_UserColumnName="DESCRIP_AERONAVE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_AGRONOMO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_AGRONOMO" msprop:Generator_ColumnPropNameInRow="NOMBRE_AGRONOMO" msprop:Generator_ColumnPropNameInTable="NOMBRE_AGRONOMOColumn" msprop:Generator_UserColumnName="NOMBRE_AGRONOMO" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_APLICA" msprop:Generator_ColumnVarNameInTable="columnFECHA_APLICA" msprop:Generator_ColumnPropNameInRow="FECHA_APLICA" msprop:Generator_ColumnPropNameInTable="FECHA_APLICAColumn" msprop:Generator_UserColumnName="FECHA_APLICA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_SOLIC" msprop:Generator_ColumnVarNameInTable="columnFECHA_SOLIC" msprop:Generator_ColumnPropNameInRow="FECHA_SOLIC" msprop:Generator_ColumnPropNameInTable="FECHA_SOLICColumn" msprop:Generator_UserColumnName="FECHA_SOLIC" type="xs:dateTime" />
              <xs:element name="ZAFRA" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLIC_AGRICOLA_LOTES" msprop:Generator_TableClassName="SOLIC_AGRICOLA_LOTESDataTable" msprop:Generator_TableVarName="tableSOLIC_AGRICOLA_LOTES" msprop:Generator_RowChangedName="SOLIC_AGRICOLA_LOTESRowChanged" msprop:Generator_TablePropName="SOLIC_AGRICOLA_LOTES" msprop:Generator_RowDeletingName="SOLIC_AGRICOLA_LOTESRowDeleting" msprop:Generator_RowChangingName="SOLIC_AGRICOLA_LOTESRowChanging" msprop:Generator_RowEvHandlerName="SOLIC_AGRICOLA_LOTESRowChangeEventHandler" msprop:Generator_RowDeletedName="SOLIC_AGRICOLA_LOTESRowDeleted" msprop:Generator_RowClassName="SOLIC_AGRICOLA_LOTESRow" msprop:Generator_UserTableName="SOLIC_AGRICOLA_LOTES" msprop:Generator_RowEvArgName="SOLIC_AGRICOLA_LOTESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MZ" msprop:Generator_ColumnVarNameInTable="columnMZ" msprop:Generator_ColumnPropNameInRow="MZ" msprop:Generator_ColumnPropNameInTable="MZColumn" msprop:Generator_UserColumnName="MZ" type="xs:decimal" />
              <xs:element name="TONEL_ESTI" msprop:Generator_ColumnVarNameInTable="columnTONEL_ESTI" msprop:Generator_ColumnPropNameInRow="TONEL_ESTI" msprop:Generator_ColumnPropNameInTable="TONEL_ESTIColumn" msprop:Generator_UserColumnName="TONEL_ESTI" type="xs:decimal" />
              <xs:element name="NOM_VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_SOLICITUD" msprop:Generator_ColumnVarNameInTable="columnID_SOLICITUD" msprop:Generator_ColumnPropNameInRow="ID_SOLICITUD" msprop:Generator_ColumnPropNameInTable="ID_SOLICITUDColumn" msprop:Generator_UserColumnName="ID_SOLICITUD" type="xs:int" />
              <xs:element name="CORRELATIVO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORRELATIVO" msprop:Generator_ColumnPropNameInRow="CORRELATIVO" msprop:Generator_ColumnPropNameInTable="CORRELATIVOColumn" msprop:Generator_UserColumnName="CORRELATIVO" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CONTRATO_FINAN" msprop:Generator_TableClassName="CONTRATO_FINANDataTable" msprop:Generator_TableVarName="tableCONTRATO_FINAN" msprop:Generator_RowChangedName="CONTRATO_FINANRowChanged" msprop:Generator_TablePropName="CONTRATO_FINAN" msprop:Generator_RowDeletingName="CONTRATO_FINANRowDeleting" msprop:Generator_RowChangingName="CONTRATO_FINANRowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_FINANRowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_FINANRowDeleted" msprop:Generator_RowClassName="CONTRATO_FINANRow" msprop:Generator_UserTableName="CONTRATO_FINAN" msprop:Generator_RowEvArgName="CONTRATO_FINANRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_CONTRATO_FINAN" msprop:Generator_ColumnVarNameInTable="columnID_CONTRATO_FINAN" msprop:Generator_ColumnPropNameInRow="ID_CONTRATO_FINAN" msprop:Generator_ColumnPropNameInTable="ID_CONTRATO_FINANColumn" msprop:Generator_UserColumnName="ID_CONTRATO_FINAN" type="xs:int" minOccurs="0" />
              <xs:element name="ID_ZAFRA" msprop:Generator_ColumnVarNameInTable="columnID_ZAFRA" msprop:Generator_ColumnPropNameInRow="ID_ZAFRA" msprop:Generator_ColumnPropNameInTable="ID_ZAFRAColumn" msprop:Generator_UserColumnName="ID_ZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="MZ" msprop:Generator_ColumnVarNameInTable="columnMZ" msprop:Generator_ColumnPropNameInRow="MZ" msprop:Generator_ColumnPropNameInTable="MZColumn" msprop:Generator_UserColumnName="MZ" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ" msprop:Generator_ColumnPropNameInRow="TONEL_MZ" msprop:Generator_ColumnPropNameInTable="TONEL_MZColumn" msprop:Generator_UserColumnName="TONEL_MZ" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL" msprop:Generator_ColumnVarNameInTable="columnTONEL" msprop:Generator_ColumnPropNameInRow="TONEL" msprop:Generator_ColumnPropNameInTable="TONELColumn" msprop:Generator_UserColumnName="TONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_COSECHA" msprop:Generator_ColumnVarNameInTable="columnREND_COSECHA" msprop:Generator_ColumnPropNameInRow="REND_COSECHA" msprop:Generator_ColumnPropNameInTable="REND_COSECHAColumn" msprop:Generator_UserColumnName="REND_COSECHA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LIBRAS" msprop:Generator_ColumnVarNameInTable="columnLIBRAS" msprop:Generator_ColumnPropNameInRow="LIBRAS" msprop:Generator_ColumnPropNameInTable="LIBRASColumn" msprop:Generator_UserColumnName="LIBRAS" type="xs:decimal" minOccurs="0" />
              <xs:element name="VIP" msprop:Generator_ColumnVarNameInTable="columnVIP" msprop:Generator_ColumnPropNameInRow="VIP" msprop:Generator_ColumnPropNameInTable="VIPColumn" msprop:Generator_UserColumnName="VIP" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CONTRA" msprop:Generator_ColumnVarNameInTable="columnVALOR_CONTRA" msprop:Generator_ColumnPropNameInRow="VALOR_CONTRA" msprop:Generator_ColumnPropNameInTable="VALOR_CONTRAColumn" msprop:Generator_UserColumnName="VALOR_CONTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROVI_ROZA" msprop:Generator_ColumnVarNameInTable="columnPROVI_ROZA" msprop:Generator_ColumnPropNameInRow="PROVI_ROZA" msprop:Generator_ColumnPropNameInTable="PROVI_ROZAColumn" msprop:Generator_UserColumnName="PROVI_ROZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROVI_ALZA" msprop:Generator_ColumnVarNameInTable="columnPROVI_ALZA" msprop:Generator_ColumnPropNameInRow="PROVI_ALZA" msprop:Generator_ColumnPropNameInTable="PROVI_ALZAColumn" msprop:Generator_UserColumnName="PROVI_ALZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROVI_TRANS" msprop:Generator_ColumnVarNameInTable="columnPROVI_TRANS" msprop:Generator_ColumnPropNameInRow="PROVI_TRANS" msprop:Generator_ColumnPropNameInTable="PROVI_TRANSColumn" msprop:Generator_UserColumnName="PROVI_TRANS" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROVISION" msprop:Generator_ColumnVarNameInTable="columnPROVISION" msprop:Generator_ColumnPropNameInRow="PROVISION" msprop:Generator_ColumnPropNameInTable="PROVISIONColumn" msprop:Generator_UserColumnName="PROVISION" type="xs:decimal" minOccurs="0" />
              <xs:element name="MONTO_FINAN" msprop:Generator_ColumnVarNameInTable="columnMONTO_FINAN" msprop:Generator_ColumnPropNameInRow="MONTO_FINAN" msprop:Generator_ColumnPropNameInTable="MONTO_FINANColumn" msprop:Generator_UserColumnName="MONTO_FINAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="ABONO_FINAN" msprop:Generator_ColumnVarNameInTable="columnABONO_FINAN" msprop:Generator_ColumnPropNameInRow="ABONO_FINAN" msprop:Generator_ColumnPropNameInTable="ABONO_FINANColumn" msprop:Generator_UserColumnName="ABONO_FINAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_FINAN" msprop:Generator_ColumnVarNameInTable="columnSALDO_FINAN" msprop:Generator_ColumnPropNameInRow="SALDO_FINAN" msprop:Generator_ColumnPropNameInTable="SALDO_FINANColumn" msprop:Generator_UserColumnName="SALDO_FINAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_DISPO" msprop:Generator_ColumnVarNameInTable="columnSALDO_DISPO" msprop:Generator_ColumnPropNameInRow="SALDO_DISPO" msprop:Generator_ColumnPropNameInTable="SALDO_DISPOColumn" msprop:Generator_UserColumnName="SALDO_DISPO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZAFRA" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="USUARIO_CREA" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_CREA" msprop:Generator_ColumnPropNameInRow="USUARIO_CREA" msprop:Generator_ColumnPropNameInTable="USUARIO_CREAColumn" msprop:Generator_UserColumnName="USUARIO_CREA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_CREA" msprop:Generator_ColumnVarNameInTable="columnFECHA_CREA" msprop:Generator_ColumnPropNameInRow="FECHA_CREA" msprop:Generator_ColumnPropNameInTable="FECHA_CREAColumn" msprop:Generator_UserColumnName="FECHA_CREA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="USUARIO_ACT" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_ACT" msprop:Generator_ColumnPropNameInRow="USUARIO_ACT" msprop:Generator_ColumnPropNameInTable="USUARIO_ACTColumn" msprop:Generator_UserColumnName="USUARIO_ACT" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ACT" msprop:Generator_ColumnVarNameInTable="columnFECHA_ACT" msprop:Generator_ColumnPropNameInRow="FECHA_ACT" msprop:Generator_ColumnPropNameInTable="FECHA_ACTColumn" msprop:Generator_UserColumnName="FECHA_ACT" type="xs:dateTime" />
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="HOJA_ANALISIS_LOTE" msprop:Generator_TableClassName="HOJA_ANALISIS_LOTEDataTable" msprop:Generator_TableVarName="tableHOJA_ANALISIS_LOTE" msprop:Generator_RowChangedName="HOJA_ANALISIS_LOTERowChanged" msprop:Generator_TablePropName="HOJA_ANALISIS_LOTE" msprop:Generator_RowDeletingName="HOJA_ANALISIS_LOTERowDeleting" msprop:Generator_RowChangingName="HOJA_ANALISIS_LOTERowChanging" msprop:Generator_RowEvHandlerName="HOJA_ANALISIS_LOTERowChangeEventHandler" msprop:Generator_RowDeletedName="HOJA_ANALISIS_LOTERowDeleted" msprop:Generator_RowClassName="HOJA_ANALISIS_LOTERow" msprop:Generator_UserTableName="HOJA_ANALISIS_LOTE" msprop:Generator_RowEvArgName="HOJA_ANALISIS_LOTERowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NO_ANALISIS" msprop:Generator_ColumnVarNameInTable="columnNO_ANALISIS" msprop:Generator_ColumnPropNameInRow="NO_ANALISIS" msprop:Generator_ColumnPropNameInTable="NO_ANALISISColumn" msprop:Generator_UserColumnName="NO_ANALISIS" type="xs:int" minOccurs="0" />
              <xs:element name="NO_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnNO_MUESTRA" msprop:Generator_ColumnPropNameInRow="NO_MUESTRA" msprop:Generator_ColumnPropNameInTable="NO_MUESTRAColumn" msprop:Generator_UserColumnName="NO_MUESTRA" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnFECHA_MUESTRA" msprop:Generator_ColumnPropNameInRow="FECHA_MUESTRA" msprop:Generator_ColumnPropNameInTable="FECHA_MUESTRAColumn" msprop:Generator_UserColumnName="FECHA_MUESTRA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_LEE_POL" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_POL" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_POL" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_POLColumn" msprop:Generator_UserColumnName="FECHA_LEE_POL" type="xs:dateTime" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:int" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="NOM_VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="BAGAZO_NETO" msprop:Generator_ColumnVarNameInTable="columnBAGAZO_NETO" msprop:Generator_ColumnPropNameInRow="BAGAZO_NETO" msprop:Generator_ColumnPropNameInTable="BAGAZO_NETOColumn" msprop:Generator_UserColumnName="BAGAZO_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="BRIX" msprop:Generator_ColumnVarNameInTable="columnBRIX" msprop:Generator_ColumnPropNameInRow="BRIX" msprop:Generator_ColumnPropNameInTable="BRIXColumn" msprop:Generator_UserColumnName="BRIX" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL" msprop:Generator_ColumnVarNameInTable="columnPOL" msprop:Generator_ColumnPropNameInRow="POL" msprop:Generator_ColumnPropNameInTable="POLColumn" msprop:Generator_UserColumnName="POL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGOColumn" msprop:Generator_UserColumnName="PUREZA_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA" msprop:Generator_ColumnPropNameInTable="FIBRA_CANAColumn" msprop:Generator_UserColumnName="FIBRA_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEXTRANA" msprop:Generator_ColumnVarNameInTable="columnDEXTRANA" msprop:Generator_ColumnPropNameInRow="DEXTRANA" msprop:Generator_ColumnPropNameInTable="DEXTRANAColumn" msprop:Generator_UserColumnName="DEXTRANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HUMEDAD" msprop:Generator_ColumnVarNameInTable="columnHUMEDAD" msprop:Generator_ColumnPropNameInRow="HUMEDAD" msprop:Generator_ColumnPropNameInTable="HUMEDADColumn" msprop:Generator_UserColumnName="HUMEDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="ALMIDON_JUGO" msprop:Generator_ColumnVarNameInTable="columnALMIDON_JUGO" msprop:Generator_ColumnPropNameInRow="ALMIDON_JUGO" msprop:Generator_ColumnPropNameInTable="ALMIDON_JUGOColumn" msprop:Generator_UserColumnName="ALMIDON_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_REDUCTORES" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInRow="AZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInTable="AZUCAR_REDUCTORESColumn" msprop:Generator_UserColumnName="AZUCAR_REDUCTORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH" msprop:Generator_ColumnVarNameInTable="columnPH" msprop:Generator_ColumnPropNameInRow="PH" msprop:Generator_ColumnPropNameInTable="PHColumn" msprop:Generator_UserColumnName="PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANALISTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANALISTA" msprop:Generator_ColumnPropNameInRow="ANALISTA" msprop:Generator_ColumnPropNameInTable="ANALISTAColumn" msprop:Generator_UserColumnName="ANALISTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMADURANTE" msprop:Generator_ColumnPropNameInRow="MADURANTE" msprop:Generator_ColumnPropNameInTable="MADURANTEColumn" msprop:Generator_UserColumnName="MADURANTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_APLICA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_APLICA" msprop:Generator_ColumnPropNameInRow="FECHA_APLICA" msprop:Generator_ColumnPropNameInTable="FECHA_APLICAColumn" msprop:Generator_UserColumnName="FECHA_APLICA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="VENTANA_FECHA_INI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVENTANA_FECHA_INI" msprop:Generator_ColumnPropNameInRow="VENTANA_FECHA_INI" msprop:Generator_ColumnPropNameInTable="VENTANA_FECHA_INIColumn" msprop:Generator_UserColumnName="VENTANA_FECHA_INI" type="xs:dateTime" minOccurs="0" />
              <xs:element name="VENTANA_FECHA_FIN" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVENTANA_FECHA_FIN" msprop:Generator_ColumnPropNameInRow="VENTANA_FECHA_FIN" msprop:Generator_ColumnPropNameInTable="VENTANA_FECHA_FINColumn" msprop:Generator_UserColumnName="VENTANA_FECHA_FIN" type="xs:dateTime" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="PLAN_COSECHA_ACTUAL" msprop:Generator_TableClassName="PLAN_COSECHA_ACTUALDataTable" msprop:Generator_TableVarName="tablePLAN_COSECHA_ACTUAL" msprop:Generator_RowChangedName="PLAN_COSECHA_ACTUALRowChanged" msprop:Generator_TablePropName="PLAN_COSECHA_ACTUAL" msprop:Generator_RowDeletingName="PLAN_COSECHA_ACTUALRowDeleting" msprop:Generator_RowChangingName="PLAN_COSECHA_ACTUALRowChanging" msprop:Generator_RowEvHandlerName="PLAN_COSECHA_ACTUALRowChangeEventHandler" msprop:Generator_RowDeletedName="PLAN_COSECHA_ACTUALRowDeleted" msprop:Generator_RowClassName="PLAN_COSECHA_ACTUALRow" msprop:Generator_UserTableName="PLAN_COSECHA_ACTUAL" msprop:Generator_RowEvArgName="PLAN_COSECHA_ACTUALRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="DESCRIP_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="30" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="13" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIVARIEDA" msprop:Generator_ColumnVarNameInTable="columnCODIVARIEDA" msprop:Generator_ColumnPropNameInRow="CODIVARIEDA" msprop:Generator_ColumnPropNameInTable="CODIVARIEDAColumn" msprop:Generator_UserColumnName="CODIVARIEDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="3" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="SUB_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="SUB_TIPO_CANAColumn" msprop:Generator_UserColumnName="SUB_TIPO_CANA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_TIPO" msprop:Generator_ColumnVarNameInTable="columnID_TIPO" msprop:Generator_ColumnPropNameInRow="ID_TIPO" msprop:Generator_ColumnPropNameInTable="ID_TIPOColumn" msprop:Generator_UserColumnName="ID_TIPO" type="xs:int" minOccurs="0" />
              <xs:element name="ID_SUB_TIPO" msprop:Generator_ColumnVarNameInTable="columnID_SUB_TIPO" msprop:Generator_ColumnPropNameInRow="ID_SUB_TIPO" msprop:Generator_ColumnPropNameInTable="ID_SUB_TIPOColumn" msprop:Generator_UserColumnName="ID_SUB_TIPO" type="xs:int" minOccurs="0" />
              <xs:element name="REND_COSECHA" msprop:Generator_ColumnVarNameInTable="columnREND_COSECHA" msprop:Generator_ColumnPropNameInRow="REND_COSECHA" msprop:Generator_ColumnPropNameInTable="REND_COSECHAColumn" msprop:Generator_UserColumnName="REND_COSECHA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA_ROZA" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_TERCIO" msprop:Generator_ColumnVarNameInTable="columnSUB_TERCIO" msprop:Generator_ColumnPropNameInRow="SUB_TERCIO" msprop:Generator_ColumnPropNameInTable="SUB_TERCIOColumn" msprop:Generator_UserColumnName="SUB_TERCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TERCIO" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_TIPO_CANA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_CANAColumn" msprop:Generator_UserColumnName="ID_TIPO_CANA" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CENSO" msprop:Generator_TableClassName="CENSODataTable" msprop:Generator_TableVarName="tableCENSO" msprop:Generator_RowChangedName="CENSORowChanged" msprop:Generator_TablePropName="CENSO" msprop:Generator_RowDeletingName="CENSORowDeleting" msprop:Generator_RowChangingName="CENSORowChanging" msprop:Generator_RowEvHandlerName="CENSORowChangeEventHandler" msprop:Generator_RowDeletedName="CENSORowDeleted" msprop:Generator_RowClassName="CENSORow" msprop:Generator_UserTableName="CENSO" msprop:Generator_RowEvArgName="CENSORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="REND_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnREND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="REND_CONTRATADOColumn" msprop:Generator_UserColumnName="REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_CONTRATADO" msprop:Generator_ColumnVarNameInTable="columnTC_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_CONTRATADO" msprop:Generator_ColumnPropNameInRow="LBS_CONTRATADO" msprop:Generator_ColumnPropNameInTable="LBS_CONTRATADOColumn" msprop:Generator_UserColumnName="LBS_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVALOR_CONTRATADO" msprop:Generator_ColumnPropNameInRow="VALOR_CONTRATADO" msprop:Generator_ColumnPropNameInTable="VALOR_CONTRATADOColumn" msprop:Generator_UserColumnName="VALOR_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGARColumn" msprop:Generator_UserColumnName="MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGAR" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGAR" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGARColumn" msprop:Generator_UserColumnName="LBS_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGAR" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGAR" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGARColumn" msprop:Generator_UserColumnName="VALOR_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnVALOR_ENTREGADA" msprop:Generator_ColumnPropNameInRow="VALOR_ENTREGADA" msprop:Generator_ColumnPropNameInTable="VALOR_ENTREGADAColumn" msprop:Generator_UserColumnName="VALOR_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_CENSO" msprop:Generator_ColumnVarNameInTable="columnLBS_CENSO" msprop:Generator_ColumnPropNameInRow="LBS_CENSO" msprop:Generator_ColumnPropNameInTable="LBS_CENSOColumn" msprop:Generator_UserColumnName="LBS_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VALOR_CENSO" msprop:Generator_ColumnVarNameInTable="columnVALOR_CENSO" msprop:Generator_ColumnPropNameInRow="VALOR_CENSO" msprop:Generator_ColumnPropNameInTable="VALOR_CENSOColumn" msprop:Generator_UserColumnName="VALOR_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_HISTO" msprop:Generator_ColumnVarNameInTable="columnREND_HISTO" msprop:Generator_ColumnPropNameInRow="REND_HISTO" msprop:Generator_ColumnPropNameInTable="REND_HISTOColumn" msprop:Generator_UserColumnName="REND_HISTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANT_LOTES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_LOTES" msprop:Generator_ColumnPropNameInRow="CANT_LOTES" msprop:Generator_ColumnPropNameInTable="CANT_LOTESColumn" msprop:Generator_UserColumnName="CANT_LOTES" type="xs:int" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_VERIFICACION" msprop:Generator_ColumnVarNameInTable="columnFECHA_VERIFICACION" msprop:Generator_ColumnPropNameInRow="FECHA_VERIFICACION" msprop:Generator_ColumnPropNameInTable="FECHA_VERIFICACIONColumn" msprop:Generator_UserColumnName="FECHA_VERIFICACION" type="xs:dateTime" minOccurs="0" />
              <xs:element name="MZ_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_VAR" msprop:Generator_ColumnPropNameInRow="MZ_VAR" msprop:Generator_ColumnPropNameInTable="MZ_VARColumn" msprop:Generator_UserColumnName="MZ_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_VAR" msprop:Generator_ColumnPropNameInRow="TC_MZ_VAR" msprop:Generator_ColumnPropNameInTable="TC_MZ_VARColumn" msprop:Generator_UserColumnName="TC_MZ_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_VAR" msprop:Generator_ColumnPropNameInRow="TC_VAR" msprop:Generator_ColumnPropNameInTable="TC_VARColumn" msprop:Generator_UserColumnName="TC_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_VAR" msprop:Generator_ColumnPropNameInRow="LBS_VAR" msprop:Generator_ColumnPropNameInTable="LBS_VARColumn" msprop:Generator_UserColumnName="LBS_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_VAR" msprop:Generator_ColumnPropNameInRow="TOTAL_VAR" msprop:Generator_ColumnPropNameInTable="TOTAL_VARColumn" msprop:Generator_UserColumnName="TOTAL_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESCRIP_ZONA" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="CANT_CONTRATOS" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_CANTON" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MUNI" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_DEPTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="OBSERVACION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnOBSERVACION" msprop:Generator_ColumnPropNameInRow="OBSERVACION" msprop:Generator_ColumnPropNameInTable="OBSERVACIONColumn" msprop:Generator_UserColumnName="OBSERVACION" type="xs:string" minOccurs="0" />
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_COSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_COSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_COSECHAColumn" msprop:Generator_UserColumnName="FECHA_COSECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="SUB_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="SUB_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="SUB_TIPO_CANAColumn" msprop:Generator_UserColumnName="SUB_TIPO_CANA" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TERCIO" msprop:Generator_ColumnPropNameInRow="SUB_TERCIO" msprop:Generator_ColumnPropNameInTable="SUB_TERCIOColumn" msprop:Generator_UserColumnName="SUB_TERCIO" type="xs:string" minOccurs="0" />
              <xs:element name="MZ_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="MZ_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="MZ_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="TC_MZ_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="TC_MZ_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="TC_MZ_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_ZAFRA_COMPA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInRow="TC_ZAFRA_COMPA" msprop:Generator_ColumnPropNameInTable="TC_ZAFRA_COMPAColumn" msprop:Generator_UserColumnName="TC_ZAFRA_COMPA" type="xs:decimal" minOccurs="0" />
              <xs:element name="INICIO_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnINICIO_COSECHA" msprop:Generator_ColumnPropNameInRow="INICIO_COSECHA" msprop:Generator_ColumnPropNameInTable="INICIO_COSECHAColumn" msprop:Generator_UserColumnName="INICIO_COSECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FIN_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFIN_COSECHA" msprop:Generator_ColumnPropNameInRow="FIN_COSECHA" msprop:Generator_ColumnPropNameInTable="FIN_COSECHAColumn" msprop:Generator_UserColumnName="FIN_COSECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="CANA_QUEMADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_QUEMADA" msprop:Generator_ColumnPropNameInRow="CANA_QUEMADA" msprop:Generator_ColumnPropNameInTable="CANA_QUEMADAColumn" msprop:Generator_UserColumnName="CANA_QUEMADA" type="xs:string" minOccurs="0" />
              <xs:element name="CANA_VERDE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_VERDE" msprop:Generator_ColumnPropNameInRow="CANA_VERDE" msprop:Generator_ColumnPropNameInTable="CANA_VERDEColumn" msprop:Generator_UserColumnName="CANA_VERDE" type="xs:string" minOccurs="0" />
              <xs:element name="ES_MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnES_MADURANTE" msprop:Generator_ColumnPropNameInRow="ES_MADURANTE" msprop:Generator_ColumnPropNameInTable="ES_MADURANTEColumn" msprop:Generator_UserColumnName="ES_MADURANTE" type="xs:string" minOccurs="0" />
              <xs:element name="ES_PRE_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnES_PRE_COSECHA" msprop:Generator_ColumnPropNameInRow="ES_PRE_COSECHA" msprop:Generator_ColumnPropNameInTable="ES_PRE_COSECHAColumn" msprop:Generator_UserColumnName="ES_PRE_COSECHA" type="xs:string" minOccurs="0" />
              <xs:element name="REND_COSECHA_ANT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_COSECHA_ANT" msprop:Generator_ColumnPropNameInRow="REND_COSECHA_ANT" msprop:Generator_ColumnPropNameInTable="REND_COSECHA_ANTColumn" msprop:Generator_UserColumnName="REND_COSECHA_ANT" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CANA" msprop:Generator_ColumnPropNameInRow="TIPO_CANA" msprop:Generator_ColumnPropNameInTable="TIPO_CANAColumn" msprop:Generator_UserColumnName="TIPO_CANA" type="xs:string" minOccurs="0" />
              <xs:element name="EDAD_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:int" minOccurs="0" />
              <xs:element name="EDAD_LOTE_ANT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE_ANT" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE_ANT" msprop:Generator_ColumnPropNameInTable="EDAD_LOTE_ANTColumn" msprop:Generator_UserColumnName="EDAD_LOTE_ANT" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ORDEN_ROZA_COSECHA" msprop:Generator_TableClassName="ORDEN_ROZA_COSECHADataTable" msprop:Generator_TableVarName="tableORDEN_ROZA_COSECHA" msprop:Generator_RowChangedName="ORDEN_ROZA_COSECHARowChanged" msprop:Generator_TablePropName="ORDEN_ROZA_COSECHA" msprop:Generator_RowDeletingName="ORDEN_ROZA_COSECHARowDeleting" msprop:Generator_RowChangingName="ORDEN_ROZA_COSECHARowChanging" msprop:Generator_RowEvHandlerName="ORDEN_ROZA_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="ORDEN_ROZA_COSECHARowDeleted" msprop:Generator_RowClassName="ORDEN_ROZA_COSECHARow" msprop:Generator_UserTableName="ORDEN_ROZA_COSECHA" msprop:Generator_RowEvArgName="ORDEN_ROZA_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_INI_COSECHA" msprop:Generator_ColumnVarNameInTable="columnFECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_INI_COSECHAColumn" msprop:Generator_UserColumnName="FECHA_INI_COSECHA" type="xs:dateTime" />
              <xs:element name="CUOTA_DIARIA" msprop:Generator_ColumnVarNameInTable="columnCUOTA_DIARIA" msprop:Generator_ColumnPropNameInRow="CUOTA_DIARIA" msprop:Generator_ColumnPropNameInTable="CUOTA_DIARIAColumn" msprop:Generator_UserColumnName="CUOTA_DIARIA" type="xs:decimal" />
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIVARIEDA" msprop:Generator_ColumnVarNameInTable="columnCODIVARIEDA" msprop:Generator_ColumnPropNameInRow="CODIVARIEDA" msprop:Generator_ColumnPropNameInTable="CODIVARIEDAColumn" msprop:Generator_UserColumnName="CODIVARIEDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="3" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROCEDENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROCEDENCIA" msprop:Generator_ColumnPropNameInRow="PROCEDENCIA" msprop:Generator_ColumnPropNameInTable="PROCEDENCIAColumn" msprop:Generator_UserColumnName="PROCEDENCIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIAGRON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIAGRON" msprop:Generator_ColumnPropNameInRow="CODIAGRON" msprop:Generator_ColumnPropNameInTable="CODIAGRONColumn" msprop:Generator_UserColumnName="CODIAGRON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="AGRONOMO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAGRONOMO" msprop:Generator_ColumnPropNameInRow="AGRONOMO" msprop:Generator_ColumnPropNameInTable="AGRONOMOColumn" msprop:Generator_UserColumnName="AGRONOMO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="65" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_CREA" msprop:Generator_ColumnVarNameInTable="columnFECHA_CREA" msprop:Generator_ColumnPropNameInRow="FECHA_CREA" msprop:Generator_ColumnPropNameInTable="FECHA_CREAColumn" msprop:Generator_UserColumnName="FECHA_CREA" type="xs:dateTime" />
              <xs:element name="FECHA_INI_CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_INI_CATORCENA" msprop:Generator_ColumnPropNameInRow="FECHA_INI_CATORCENA" msprop:Generator_ColumnPropNameInTable="FECHA_INI_CATORCENAColumn" msprop:Generator_UserColumnName="FECHA_INI_CATORCENA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_FIN_CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_FIN_CATORCENA" msprop:Generator_ColumnPropNameInRow="FECHA_FIN_CATORCENA" msprop:Generator_ColumnPropNameInTable="FECHA_FIN_CATORCENAColumn" msprop:Generator_UserColumnName="FECHA_FIN_CATORCENA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SFECHA_INI_CAT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSFECHA_INI_CAT" msprop:Generator_ColumnPropNameInRow="SFECHA_INI_CAT" msprop:Generator_ColumnPropNameInTable="SFECHA_INI_CATColumn" msprop:Generator_UserColumnName="SFECHA_INI_CAT" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SFECHA_FIN_CAT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSFECHA_FIN_CAT" msprop:Generator_ColumnPropNameInRow="SFECHA_FIN_CAT" msprop:Generator_ColumnPropNameInTable="SFECHA_FIN_CATColumn" msprop:Generator_UserColumnName="SFECHA_FIN_CAT" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SFECHA_CREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSFECHA_CREA" msprop:Generator_ColumnPropNameInRow="SFECHA_CREA" msprop:Generator_ColumnPropNameInTable="SFECHA_CREAColumn" msprop:Generator_UserColumnName="SFECHA_CREA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SFECHA_INI_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSFECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInRow="SFECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInTable="SFECHA_INI_COSECHAColumn" msprop:Generator_UserColumnName="SFECHA_INI_COSECHA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="54" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="PROFORMA" msprop:Generator_TableClassName="PROFORMADataTable" msprop:Generator_TableVarName="tablePROFORMA" msprop:Generator_RowChangedName="PROFORMARowChanged" msprop:Generator_TablePropName="PROFORMA" msprop:Generator_RowDeletingName="PROFORMARowDeleting" msprop:Generator_RowChangingName="PROFORMARowChanging" msprop:Generator_RowEvHandlerName="PROFORMARowChangeEventHandler" msprop:Generator_RowDeletedName="PROFORMARowDeleted" msprop:Generator_RowClassName="PROFORMARow" msprop:Generator_UserTableName="PROFORMA" msprop:Generator_RowEvArgName="PROFORMARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_PROFORMA" msprop:Generator_ColumnVarNameInTable="columnID_PROFORMA" msprop:Generator_ColumnPropNameInRow="ID_PROFORMA" msprop:Generator_ColumnPropNameInTable="ID_PROFORMAColumn" msprop:Generator_UserColumnName="ID_PROFORMA" type="xs:int" minOccurs="0" />
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODTRANSPORT" msprop:Generator_ColumnVarNameInTable="columnCODTRANSPORT" msprop:Generator_ColumnPropNameInRow="CODTRANSPORT" msprop:Generator_ColumnPropNameInTable="CODTRANSPORTColumn" msprop:Generator_UserColumnName="CODTRANSPORT" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_TRANSPORTISTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_TRANSPORTISTA" msprop:Generator_ColumnPropNameInRow="NOMBRE_TRANSPORTISTA" msprop:Generator_ColumnPropNameInTable="NOMBRE_TRANSPORTISTAColumn" msprop:Generator_UserColumnName="NOMBRE_TRANSPORTISTA" type="xs:string" minOccurs="0" />
              <xs:element name="TRANSPORTE_PROPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSPORTE_PROPIO" msprop:Generator_ColumnPropNameInRow="TRANSPORTE_PROPIO" msprop:Generator_ColumnPropNameInTable="TRANSPORTE_PROPIOColumn" msprop:Generator_UserColumnName="TRANSPORTE_PROPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TRANSPORTE_PARTICULAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSPORTE_PARTICULAR" msprop:Generator_ColumnPropNameInRow="TRANSPORTE_PARTICULAR" msprop:Generator_ColumnPropNameInTable="TRANSPORTE_PARTICULARColumn" msprop:Generator_UserColumnName="TRANSPORTE_PARTICULAR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PLACAVEHIC" msprop:Generator_ColumnVarNameInTable="columnPLACAVEHIC" msprop:Generator_ColumnPropNameInRow="PLACAVEHIC" msprop:Generator_ColumnPropNameInTable="PLACAVEHICColumn" msprop:Generator_UserColumnName="PLACAVEHIC" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRES_MOTORISTA" msprop:Generator_ColumnVarNameInTable="columnNOMBRES_MOTORISTA" msprop:Generator_ColumnPropNameInRow="NOMBRES_MOTORISTA" msprop:Generator_ColumnPropNameInTable="NOMBRES_MOTORISTAColumn" msprop:Generator_UserColumnName="NOMBRES_MOTORISTA" type="xs:string" minOccurs="0" />
              <xs:element name="ID_CARGADORA" msprop:Generator_ColumnVarNameInTable="columnID_CARGADORA" msprop:Generator_ColumnPropNameInRow="ID_CARGADORA" msprop:Generator_ColumnPropNameInTable="ID_CARGADORAColumn" msprop:Generator_UserColumnName="ID_CARGADORA" type="xs:int" minOccurs="0" />
              <xs:element name="CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCARGADORA" msprop:Generator_ColumnPropNameInRow="CARGADORA" msprop:Generator_ColumnPropNameInTable="CARGADORAColumn" msprop:Generator_UserColumnName="CARGADORA" type="xs:string" minOccurs="0" />
              <xs:element name="ID_CARGADOR" msprop:Generator_ColumnVarNameInTable="columnID_CARGADOR" msprop:Generator_ColumnPropNameInRow="ID_CARGADOR" msprop:Generator_ColumnPropNameInTable="ID_CARGADORColumn" msprop:Generator_UserColumnName="ID_CARGADOR" type="xs:int" minOccurs="0" />
              <xs:element name="CARGADOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCARGADOR" msprop:Generator_ColumnPropNameInRow="CARGADOR" msprop:Generator_ColumnPropNameInTable="CARGADORColumn" msprop:Generator_UserColumnName="CARGADOR" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MADURANTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_MADURANTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_MADURANTEColumn" msprop:Generator_UserColumnName="NOMBRE_MADURANTE" type="xs:string" minOccurs="0" />
              <xs:element name="QUEMAPROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQUEMAPROG" msprop:Generator_ColumnPropNameInRow="QUEMAPROG" msprop:Generator_ColumnPropNameInTable="QUEMAPROGColumn" msprop:Generator_UserColumnName="QUEMAPROG" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="QUEMANOPROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQUEMANOPROG" msprop:Generator_ColumnPropNameInRow="QUEMANOPROG" msprop:Generator_ColumnPropNameInTable="QUEMANOPROGColumn" msprop:Generator_UserColumnName="QUEMANOPROG" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FIN_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFIN_LOTE" msprop:Generator_ColumnPropNameInRow="FIN_LOTE" msprop:Generator_ColumnPropNameInTable="FIN_LOTEColumn" msprop:Generator_UserColumnName="FIN_LOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_PROVEEDOR_ROZA" msprop:Generator_ColumnVarNameInTable="columnID_PROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInRow="ID_PROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInTable="ID_PROVEEDOR_ROZAColumn" msprop:Generator_UserColumnName="ID_PROVEEDOR_ROZA" type="xs:int" minOccurs="0" />
              <xs:element name="ID_SUPERVISOR" msprop:Generator_ColumnVarNameInTable="columnID_SUPERVISOR" msprop:Generator_ColumnPropNameInRow="ID_SUPERVISOR" msprop:Generator_ColumnPropNameInTable="ID_SUPERVISORColumn" msprop:Generator_UserColumnName="ID_SUPERVISOR" type="xs:int" minOccurs="0" />
              <xs:element name="CHEQUERO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCHEQUERO" msprop:Generator_ColumnPropNameInRow="CHEQUERO" msprop:Generator_ColumnPropNameInTable="CHEQUEROColumn" msprop:Generator_UserColumnName="CHEQUERO" type="xs:string" minOccurs="0" />
              <xs:element name="CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCAMION" msprop:Generator_ColumnPropNameInRow="CAMION" msprop:Generator_ColumnPropNameInTable="CAMIONColumn" msprop:Generator_UserColumnName="CAMION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRASTRA" msprop:Generator_ColumnPropNameInRow="RASTRA" msprop:Generator_ColumnPropNameInTable="RASTRAColumn" msprop:Generator_UserColumnName="RASTRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="column_3EJES" msprop:Generator_ColumnPropNameInRow="_3EJES" msprop:Generator_ColumnPropNameInTable="_3EJESColumn" msprop:Generator_UserColumnName="_3EJES" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_EMISION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_EMISION" msprop:Generator_ColumnPropNameInRow="FECHA_EMISION" msprop:Generator_ColumnPropNameInTable="FECHA_EMISIONColumn" msprop:Generator_UserColumnName="FECHA_EMISION" type="xs:dateTime" minOccurs="0" />
              <xs:element name="CANA_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_CORTA" msprop:Generator_ColumnPropNameInRow="CANA_CORTA" msprop:Generator_ColumnPropNameInTable="CANA_CORTAColumn" msprop:Generator_UserColumnName="CANA_CORTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANA_PICADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_PICADA" msprop:Generator_ColumnPropNameInRow="CANA_PICADA" msprop:Generator_ColumnPropNameInTable="CANA_PICADAColumn" msprop:Generator_UserColumnName="CANA_PICADA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANA_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_LARGA" msprop:Generator_ColumnPropNameInRow="CANA_LARGA" msprop:Generator_ColumnPropNameInTable="CANA_LARGAColumn" msprop:Generator_UserColumnName="CANA_LARGA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOPROFORMA" msprop:Generator_ColumnVarNameInTable="columnNOPROFORMA" msprop:Generator_ColumnPropNameInRow="NOPROFORMA" msprop:Generator_ColumnPropNameInTable="NOPROFORMAColumn" msprop:Generator_UserColumnName="NOPROFORMA" type="xs:int" minOccurs="0" />
              <xs:element name="CANA_VERDE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_VERDE" msprop:Generator_ColumnPropNameInRow="CANA_VERDE" msprop:Generator_ColumnPropNameInTable="CANA_VERDEColumn" msprop:Generator_UserColumnName="CANA_VERDE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_MADURANTE" msprop:Generator_ColumnVarNameInTable="columnFECHA_MADURANTE" msprop:Generator_ColumnPropNameInRow="FECHA_MADURANTE" msprop:Generator_ColumnPropNameInTable="FECHA_MADURANTEColumn" msprop:Generator_UserColumnName="FECHA_MADURANTE" type="xs:dateTime" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ANALISIS_MUESTRAS_ENVIO" msprop:Generator_TableClassName="ANALISIS_MUESTRAS_ENVIODataTable" msprop:Generator_TableVarName="tableANALISIS_MUESTRAS_ENVIO" msprop:Generator_RowChangedName="ANALISIS_MUESTRAS_ENVIORowChanged" msprop:Generator_TablePropName="ANALISIS_MUESTRAS_ENVIO" msprop:Generator_RowDeletingName="ANALISIS_MUESTRAS_ENVIORowDeleting" msprop:Generator_RowChangingName="ANALISIS_MUESTRAS_ENVIORowChanging" msprop:Generator_RowEvHandlerName="ANALISIS_MUESTRAS_ENVIORowChangeEventHandler" msprop:Generator_RowDeletedName="ANALISIS_MUESTRAS_ENVIORowDeleted" msprop:Generator_RowClassName="ANALISIS_MUESTRAS_ENVIORow" msprop:Generator_UserTableName="ANALISIS_MUESTRAS_ENVIO" msprop:Generator_RowEvArgName="ANALISIS_MUESTRAS_ENVIORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="FECHA_LEE_POL" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_POL" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_POL" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_POLColumn" msprop:Generator_UserColumnName="FECHA_LEE_POL" type="xs:dateTime" minOccurs="0" />
              <xs:element name="ID_ENVIO" msprop:Generator_ColumnVarNameInTable="columnID_ENVIO" msprop:Generator_ColumnPropNameInRow="ID_ENVIO" msprop:Generator_ColumnPropNameInTable="ID_ENVIOColumn" msprop:Generator_UserColumnName="ID_ENVIO" type="xs:int" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NROBOLETA" msprop:Generator_ColumnVarNameInTable="columnNROBOLETA" msprop:Generator_ColumnPropNameInRow="NROBOLETA" msprop:Generator_ColumnPropNameInTable="NROBOLETAColumn" msprop:Generator_UserColumnName="NROBOLETA" type="xs:int" />
              <xs:element name="NUMRECIBO_CANA" msprop:Generator_ColumnVarNameInTable="columnNUMRECIBO_CANA" msprop:Generator_ColumnPropNameInRow="NUMRECIBO_CANA" msprop:Generator_ColumnPropNameInTable="NUMRECIBO_CANAColumn" msprop:Generator_UserColumnName="NUMRECIBO_CANA" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CANA" msprop:Generator_ColumnPropNameInRow="TIPO_CANA" msprop:Generator_ColumnPropNameInTable="TIPO_CANAColumn" msprop:Generator_UserColumnName="TIPO_CANA" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="TIPO_QUEMAColumn" msprop:Generator_UserColumnName="TIPO_QUEMA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_QUEMA" msprop:Generator_ColumnVarNameInTable="columnFECHA_QUEMA" msprop:Generator_ColumnPropNameInRow="FECHA_QUEMA" msprop:Generator_ColumnPropNameInTable="FECHA_QUEMAColumn" msprop:Generator_UserColumnName="FECHA_QUEMA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="HORAS_QUEMA" msprop:Generator_ColumnVarNameInTable="columnHORAS_QUEMA" msprop:Generator_ColumnPropNameInRow="HORAS_QUEMA" msprop:Generator_ColumnPropNameInTable="HORAS_QUEMAColumn" msprop:Generator_UserColumnName="HORAS_QUEMA" type="xs:decimal" minOccurs="0" />
              <xs:element name="NO_ANALISIS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_ANALISIS" msprop:Generator_ColumnPropNameInRow="NO_ANALISIS" msprop:Generator_ColumnPropNameInTable="NO_ANALISISColumn" msprop:Generator_UserColumnName="NO_ANALISIS" type="xs:int" minOccurs="0" />
              <xs:element name="PRECOSECHA85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRECOSECHA85" msprop:Generator_ColumnPropNameInRow="PRECOSECHA85" msprop:Generator_ColumnPropNameInTable="PRECOSECHA85Column" msprop:Generator_UserColumnName="PRECOSECHA85" type="xs:decimal" minOccurs="0" />
              <xs:element name="RECIBO85" msprop:Generator_ColumnVarNameInTable="columnRECIBO85" msprop:Generator_ColumnPropNameInRow="RECIBO85" msprop:Generator_ColumnPropNameInTable="RECIBO85Column" msprop:Generator_UserColumnName="RECIBO85" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="DIAZAFRA" msprop:Generator_ColumnVarNameInTable="columnDIAZAFRA" msprop:Generator_ColumnPropNameInRow="DIAZAFRA" msprop:Generator_ColumnPropNameInTable="DIAZAFRAColumn" msprop:Generator_UserColumnName="DIAZAFRA" type="xs:int" />
              <xs:element name="VENTANA_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVENTANA_COSECHA" msprop:Generator_ColumnPropNameInRow="VENTANA_COSECHA" msprop:Generator_ColumnPropNameInTable="VENTANA_COSECHAColumn" msprop:Generator_UserColumnName="VENTANA_COSECHA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="24" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRECOSECHA85_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRECOSECHA85_PROM" msprop:Generator_ColumnPropNameInRow="PRECOSECHA85_PROM" msprop:Generator_ColumnPropNameInTable="PRECOSECHA85_PROMColumn" msprop:Generator_UserColumnName="PRECOSECHA85_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMADURANTE" msprop:Generator_ColumnPropNameInRow="MADURANTE" msprop:Generator_ColumnPropNameInTable="MADURANTEColumn" msprop:Generator_UserColumnName="MADURANTE" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_PROGRAMACION_COSECHA" msprop:Generator_TableClassName="RPT_PROGRAMACION_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_PROGRAMACION_COSECHA" msprop:Generator_RowChangedName="RPT_PROGRAMACION_COSECHARowChanged" msprop:Generator_TablePropName="RPT_PROGRAMACION_COSECHA" msprop:Generator_RowDeletingName="RPT_PROGRAMACION_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_PROGRAMACION_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_PROGRAMACION_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_PROGRAMACION_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_PROGRAMACION_COSECHARow" msprop:Generator_UserTableName="RPT_PROGRAMACION_COSECHA" msprop:Generator_RowEvArgName="RPT_PROGRAMACION_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPROVEE" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MZ_COSECHA" msprop:Generator_ColumnVarNameInTable="columnMZ_COSECHA" msprop:Generator_ColumnPropNameInRow="MZ_COSECHA" msprop:Generator_ColumnPropNameInTable="MZ_COSECHAColumn" msprop:Generator_UserColumnName="MZ_COSECHA" type="xs:decimal" />
              <xs:element name="TONEL_COSECHA" msprop:Generator_ColumnVarNameInTable="columnTONEL_COSECHA" msprop:Generator_ColumnPropNameInRow="TONEL_COSECHA" msprop:Generator_ColumnPropNameInTable="TONEL_COSECHAColumn" msprop:Generator_UserColumnName="TONEL_COSECHA" type="xs:decimal" />
              <xs:element name="CUOTA_DIARIA" msprop:Generator_ColumnVarNameInTable="columnCUOTA_DIARIA" msprop:Generator_ColumnPropNameInRow="CUOTA_DIARIA" msprop:Generator_ColumnPropNameInTable="CUOTA_DIARIAColumn" msprop:Generator_UserColumnName="CUOTA_DIARIA" type="xs:decimal" />
              <xs:element name="NOM_VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIAGRON" msprop:Generator_ColumnVarNameInTable="columnCODIAGRON" msprop:Generator_ColumnPropNameInRow="CODIAGRON" msprop:Generator_ColumnPropNameInTable="CODIAGRONColumn" msprop:Generator_UserColumnName="CODIAGRON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="AGRONOMO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAGRONOMO" msprop:Generator_ColumnPropNameInRow="AGRONOMO" msprop:Generator_ColumnPropNameInTable="AGRONOMOColumn" msprop:Generator_UserColumnName="AGRONOMO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="65" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_INI_COSECHA" msprop:Generator_ColumnVarNameInTable="columnFECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_INI_COSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_INI_COSECHAColumn" msprop:Generator_UserColumnName="FECHA_INI_COSECHA" type="xs:dateTime" />
              <xs:element name="FECHA_FIN_COSECHA" msprop:Generator_ColumnVarNameInTable="columnFECHA_FIN_COSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_FIN_COSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_FIN_COSECHAColumn" msprop:Generator_UserColumnName="FECHA_FIN_COSECHA" type="xs:dateTime" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIVARIEDA" msprop:Generator_ColumnVarNameInTable="columnCODIVARIEDA" msprop:Generator_ColumnPropNameInRow="CODIVARIEDA" msprop:Generator_ColumnPropNameInTable="CODIVARIEDAColumn" msprop:Generator_UserColumnName="CODIVARIEDA">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="3" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="RIESGO_PIEDRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRIESGO_PIEDRA" msprop:Generator_ColumnPropNameInRow="RIESGO_PIEDRA" msprop:Generator_ColumnPropNameInTable="RIESGO_PIEDRAColumn" msprop:Generator_UserColumnName="RIESGO_PIEDRA" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLICITUD_APLICACIONES" msprop:Generator_TableClassName="SOLICITUD_APLICACIONESDataTable" msprop:Generator_TableVarName="tableSOLICITUD_APLICACIONES" msprop:Generator_RowChangedName="SOLICITUD_APLICACIONESRowChanged" msprop:Generator_TablePropName="SOLICITUD_APLICACIONES" msprop:Generator_RowDeletingName="SOLICITUD_APLICACIONESRowDeleting" msprop:Generator_RowChangingName="SOLICITUD_APLICACIONESRowChanging" msprop:Generator_RowEvHandlerName="SOLICITUD_APLICACIONESRowChangeEventHandler" msprop:Generator_RowDeletedName="SOLICITUD_APLICACIONESRowDeleted" msprop:Generator_RowClassName="SOLICITUD_APLICACIONESRow" msprop:Generator_UserTableName="SOLICITUD_APLICACIONES" msprop:Generator_RowEvArgName="SOLICITUD_APLICACIONESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PROVEEDOR1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR1" msprop:Generator_ColumnPropNameInRow="PROVEEDOR1" msprop:Generator_ColumnPropNameInTable="PROVEEDOR1Column" msprop:Generator_UserColumnName="PROVEEDOR1" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PROVEEDOR2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR2" msprop:Generator_ColumnPropNameInRow="PROVEEDOR2" msprop:Generator_ColumnPropNameInTable="PROVEEDOR2Column" msprop:Generator_UserColumnName="PROVEEDOR2" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_SOLIC" msprop:Generator_ColumnVarNameInTable="columnFECHA_SOLIC" msprop:Generator_ColumnPropNameInRow="FECHA_SOLIC" msprop:Generator_ColumnPropNameInTable="FECHA_SOLICColumn" msprop:Generator_UserColumnName="FECHA_SOLIC" type="xs:dateTime" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUM_SOLICITUD" msprop:Generator_ColumnVarNameInTable="columnNUM_SOLICITUD" msprop:Generator_ColumnPropNameInRow="NUM_SOLICITUD" msprop:Generator_ColumnPropNameInTable="NUM_SOLICITUDColumn" msprop:Generator_UserColumnName="NUM_SOLICITUD" type="xs:int" />
              <xs:element name="NOMBRE_PRODUCTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PRODUCTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_PRODUCTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_PRODUCTOColumn" msprop:Generator_UserColumnName="NOMBRE_PRODUCTO">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MZ" msprop:Generator_ColumnVarNameInTable="columnMZ" msprop:Generator_ColumnPropNameInRow="MZ" msprop:Generator_ColumnPropNameInTable="MZColumn" msprop:Generator_UserColumnName="MZ" type="xs:decimal" />
              <xs:element name="FECHA_APLICA" msprop:Generator_ColumnVarNameInTable="columnFECHA_APLICA" msprop:Generator_ColumnPropNameInRow="FECHA_APLICA" msprop:Generator_ColumnPropNameInTable="FECHA_APLICAColumn" msprop:Generator_UserColumnName="FECHA_APLICA" type="xs:dateTime" />
              <xs:element name="FECHA_INI_VENTANA" msprop:Generator_ColumnVarNameInTable="columnFECHA_INI_VENTANA" msprop:Generator_ColumnPropNameInRow="FECHA_INI_VENTANA" msprop:Generator_ColumnPropNameInTable="FECHA_INI_VENTANAColumn" msprop:Generator_UserColumnName="FECHA_INI_VENTANA" type="xs:dateTime" />
              <xs:element name="FECHA_FIN_VENTANA" msprop:Generator_ColumnVarNameInTable="columnFECHA_FIN_VENTANA" msprop:Generator_ColumnPropNameInRow="FECHA_FIN_VENTANA" msprop:Generator_ColumnPropNameInTable="FECHA_FIN_VENTANAColumn" msprop:Generator_UserColumnName="FECHA_FIN_VENTANA" type="xs:dateTime" />
              <xs:element name="FECHA_ROZA_MADURANTE" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA_MADURANTE" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA_MADURANTE" msprop:Generator_ColumnPropNameInTable="FECHA_ROZA_MADURANTEColumn" msprop:Generator_UserColumnName="FECHA_ROZA_MADURANTE" type="xs:dateTime" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ANALISIS_MUESTRAS_TODO" msprop:Generator_TableClassName="ANALISIS_MUESTRAS_TODODataTable" msprop:Generator_TableVarName="tableANALISIS_MUESTRAS_TODO" msprop:Generator_RowChangedName="ANALISIS_MUESTRAS_TODORowChanged" msprop:Generator_TablePropName="ANALISIS_MUESTRAS_TODO" msprop:Generator_RowDeletingName="ANALISIS_MUESTRAS_TODORowDeleting" msprop:Generator_RowChangingName="ANALISIS_MUESTRAS_TODORowChanging" msprop:Generator_RowEvHandlerName="ANALISIS_MUESTRAS_TODORowChangeEventHandler" msprop:Generator_RowDeletedName="ANALISIS_MUESTRAS_TODORowDeleted" msprop:Generator_RowClassName="ANALISIS_MUESTRAS_TODORow" msprop:Generator_UserTableName="ANALISIS_MUESTRAS_TODO" msprop:Generator_RowEvArgName="ANALISIS_MUESTRAS_TODORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="21" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EDAD_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:int" minOccurs="0" />
              <xs:element name="NO_ANALISIS" msprop:Generator_ColumnVarNameInTable="columnNO_ANALISIS" msprop:Generator_ColumnPropNameInRow="NO_ANALISIS" msprop:Generator_ColumnPropNameInTable="NO_ANALISISColumn" msprop:Generator_UserColumnName="NO_ANALISIS" type="xs:int" />
              <xs:element name="FECHA_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnFECHA_MUESTRA" msprop:Generator_ColumnPropNameInRow="FECHA_MUESTRA" msprop:Generator_ColumnPropNameInTable="FECHA_MUESTRAColumn" msprop:Generator_UserColumnName="FECHA_MUESTRA" type="xs:dateTime" />
              <xs:element name="NO_MUESTRA" msprop:Generator_ColumnVarNameInTable="columnNO_MUESTRA" msprop:Generator_ColumnPropNameInRow="NO_MUESTRA" msprop:Generator_ColumnPropNameInTable="NO_MUESTRAColumn" msprop:Generator_UserColumnName="NO_MUESTRA" type="xs:int" />
              <xs:element name="FECHA_LEE_POL" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_POL" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_POL" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_POLColumn" msprop:Generator_UserColumnName="FECHA_LEE_POL" type="xs:dateTime" minOccurs="0" />
              <xs:element name="REND_PRECO" msprop:Generator_ColumnVarNameInTable="columnREND_PRECO" msprop:Generator_ColumnPropNameInRow="REND_PRECO" msprop:Generator_ColumnPropNameInTable="REND_PRECOColumn" msprop:Generator_UserColumnName="REND_PRECO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_RECIBO" msprop:Generator_ColumnPropNameInRow="REND_RECIBO" msprop:Generator_ColumnPropNameInTable="REND_RECIBOColumn" msprop:Generator_UserColumnName="REND_RECIBO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA_APLICA_MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_APLICA_MADURANTE" msprop:Generator_ColumnPropNameInRow="FECHA_APLICA_MADURANTE" msprop:Generator_ColumnPropNameInTable="FECHA_APLICA_MADURANTEColumn" msprop:Generator_UserColumnName="FECHA_APLICA_MADURANTE" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_INI_VENTANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_INI_VENTANA" msprop:Generator_ColumnPropNameInRow="FECHA_INI_VENTANA" msprop:Generator_ColumnPropNameInTable="FECHA_INI_VENTANAColumn" msprop:Generator_UserColumnName="FECHA_INI_VENTANA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_FIN_VENTANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_FIN_VENTANA" msprop:Generator_ColumnPropNameInRow="FECHA_FIN_VENTANA" msprop:Generator_ColumnPropNameInTable="FECHA_FIN_VENTANAColumn" msprop:Generator_UserColumnName="FECHA_FIN_VENTANA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="PBH" msprop:Generator_ColumnVarNameInTable="columnPBH" msprop:Generator_ColumnPropNameInRow="PBH" msprop:Generator_ColumnPropNameInTable="PBHColumn" msprop:Generator_UserColumnName="PBH" type="xs:decimal" minOccurs="0" />
              <xs:element name="BRIX" msprop:Generator_ColumnVarNameInTable="columnBRIX" msprop:Generator_ColumnPropNameInRow="BRIX" msprop:Generator_ColumnPropNameInTable="BRIXColumn" msprop:Generator_UserColumnName="BRIX" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL" msprop:Generator_ColumnVarNameInTable="columnPOL" msprop:Generator_ColumnPropNameInRow="POL" msprop:Generator_ColumnPropNameInTable="POLColumn" msprop:Generator_UserColumnName="POL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGOColumn" msprop:Generator_UserColumnName="PUREZA_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA" msprop:Generator_ColumnPropNameInTable="FIBRA_CANAColumn" msprop:Generator_UserColumnName="FIBRA_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEXTRANA" msprop:Generator_ColumnVarNameInTable="columnDEXTRANA" msprop:Generator_ColumnPropNameInRow="DEXTRANA" msprop:Generator_ColumnPropNameInTable="DEXTRANAColumn" msprop:Generator_UserColumnName="DEXTRANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HUMEDAD" msprop:Generator_ColumnVarNameInTable="columnHUMEDAD" msprop:Generator_ColumnPropNameInRow="HUMEDAD" msprop:Generator_ColumnPropNameInTable="HUMEDADColumn" msprop:Generator_UserColumnName="HUMEDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="ALMIDON_JUGO" msprop:Generator_ColumnVarNameInTable="columnALMIDON_JUGO" msprop:Generator_ColumnPropNameInRow="ALMIDON_JUGO" msprop:Generator_ColumnPropNameInTable="ALMIDON_JUGOColumn" msprop:Generator_UserColumnName="ALMIDON_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH" msprop:Generator_ColumnVarNameInTable="columnPH" msprop:Generator_ColumnPropNameInRow="PH" msprop:Generator_ColumnPropNameInTable="PHColumn" msprop:Generator_UserColumnName="PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_REDUCTORES" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInRow="AZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInTable="AZUCAR_REDUCTORESColumn" msprop:Generator_UserColumnName="AZUCAR_REDUCTORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMADURANTE" msprop:Generator_ColumnPropNameInRow="MADURANTE" msprop:Generator_ColumnPropNameInTable="MADURANTEColumn" msprop:Generator_UserColumnName="MADURANTE" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_REND_DIARIO_ACUMULADO" msprop:Generator_TableClassName="RPT_SIGESTA_REND_DIARIO_ACUMULADODataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_REND_DIARIO_ACUMULADO" msprop:Generator_RowChangedName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_REND_DIARIO_ACUMULADO" msprop:Generator_RowDeletingName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_REND_DIARIO_ACUMULADORow" msprop:Generator_UserTableName="RPT_SIGESTA_REND_DIARIO_ACUMULADO" msprop:Generator_RowEvArgName="RPT_SIGESTA_REND_DIARIO_ACUMULADORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="FECHA_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ZAFRA" msprop:Generator_ColumnPropNameInRow="FECHA_ZAFRA" msprop:Generator_ColumnPropNameInTable="FECHA_ZAFRAColumn" msprop:Generator_UserColumnName="FECHA_ZAFRA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="DIA_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIA_ZAFRA" msprop:Generator_ColumnPropNameInRow="DIA_ZAFRA" msprop:Generator_ColumnPropNameInTable="DIA_ZAFRAColumn" msprop:Generator_UserColumnName="DIA_ZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NETOTONEL_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL_DIA" msprop:Generator_ColumnPropNameInRow="NETOTONEL_DIA" msprop:Generator_ColumnPropNameInTable="NETOTONEL_DIAColumn" msprop:Generator_UserColumnName="NETOTONEL_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="RENDIA_CALC2_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENDIA_CALC2_DIA" msprop:Generator_ColumnPropNameInRow="RENDIA_CALC2_DIA" msprop:Generator_ColumnPropNameInTable="RENDIA_CALC2_DIAColumn" msprop:Generator_UserColumnName="RENDIA_CALC2_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_QUEMA_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_QUEMA_DIA" msprop:Generator_ColumnPropNameInRow="HORAS_QUEMA_DIA" msprop:Generator_ColumnPropNameInTable="HORAS_QUEMA_DIAColumn" msprop:Generator_UserColumnName="HORAS_QUEMA_DIA" type="xs:int" minOccurs="0" />
              <xs:element name="HORAS_CORTA_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_CORTA_DIA" msprop:Generator_ColumnPropNameInRow="HORAS_CORTA_DIA" msprop:Generator_ColumnPropNameInTable="HORAS_CORTA_DIAColumn" msprop:Generator_UserColumnName="HORAS_CORTA_DIA" type="xs:int" minOccurs="0" />
              <xs:element name="BRIX_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnBRIX_DIA" msprop:Generator_ColumnPropNameInRow="BRIX_DIA" msprop:Generator_ColumnPropNameInTable="BRIX_DIAColumn" msprop:Generator_UserColumnName="BRIX_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPOL_DIA" msprop:Generator_ColumnPropNameInRow="POL_DIA" msprop:Generator_ColumnPropNameInTable="POL_DIAColumn" msprop:Generator_UserColumnName="POL_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO_DIA" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO_DIA" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGO_DIAColumn" msprop:Generator_UserColumnName="PUREZA_JUGO_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HUMEDAD_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHUMEDAD_DIA" msprop:Generator_ColumnPropNameInRow="HUMEDAD_DIA" msprop:Generator_ColumnPropNameInTable="HUMEDAD_DIAColumn" msprop:Generator_UserColumnName="HUMEDAD_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA_DIA" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA_DIA" msprop:Generator_ColumnPropNameInTable="FIBRA_CANA_DIAColumn" msprop:Generator_UserColumnName="FIBRA_CANA_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="NROBOLETA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNROBOLETA" msprop:Generator_ColumnPropNameInRow="NROBOLETA" msprop:Generator_ColumnPropNameInTable="NROBOLETAColumn" msprop:Generator_UserColumnName="NROBOLETA" type="xs:int" minOccurs="0" />
              <xs:element name="NUMRECIBO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMRECIBO_CANA" msprop:Generator_ColumnPropNameInRow="NUMRECIBO_CANA" msprop:Generator_ColumnPropNameInTable="NUMRECIBO_CANAColumn" msprop:Generator_UserColumnName="NUMRECIBO_CANA" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_LEE_TARA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_TARA" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_TARA" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_TARAColumn" msprop:Generator_UserColumnName="FECHA_LEE_TARA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NETOTONEL_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL_RECIBO" msprop:Generator_ColumnPropNameInRow="NETOTONEL_RECIBO" msprop:Generator_ColumnPropNameInTable="NETOTONEL_RECIBOColumn" msprop:Generator_UserColumnName="NETOTONEL_RECIBO" type="xs:decimal" minOccurs="0" />
              <xs:element name="RENDIACALC2_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENDIACALC2_RECIBO" msprop:Generator_ColumnPropNameInRow="RENDIACALC2_RECIBO" msprop:Generator_ColumnPropNameInTable="RENDIACALC2_RECIBOColumn" msprop:Generator_UserColumnName="RENDIACALC2_RECIBO" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_QUEMA_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_QUEMA_RECIBO" msprop:Generator_ColumnPropNameInRow="HORAS_QUEMA_RECIBO" msprop:Generator_ColumnPropNameInTable="HORAS_QUEMA_RECIBOColumn" msprop:Generator_UserColumnName="HORAS_QUEMA_RECIBO" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_CORTA_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_CORTA_RECIBO" msprop:Generator_ColumnPropNameInRow="HORAS_CORTA_RECIBO" msprop:Generator_ColumnPropNameInTable="HORAS_CORTA_RECIBOColumn" msprop:Generator_UserColumnName="HORAS_CORTA_RECIBO" type="xs:decimal" minOccurs="0" />
              <xs:element name="NETOTONEL_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL_ACUM" msprop:Generator_ColumnPropNameInRow="NETOTONEL_ACUM" msprop:Generator_ColumnPropNameInTable="NETOTONEL_ACUMColumn" msprop:Generator_UserColumnName="NETOTONEL_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="RENDIACALC2_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENDIACALC2_ACUM" msprop:Generator_ColumnPropNameInRow="RENDIACALC2_ACUM" msprop:Generator_ColumnPropNameInTable="RENDIACALC2_ACUMColumn" msprop:Generator_UserColumnName="RENDIACALC2_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_QUEMA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_QUEMA_ACUM" msprop:Generator_ColumnPropNameInRow="HORAS_QUEMA_ACUM" msprop:Generator_ColumnPropNameInTable="HORAS_QUEMA_ACUMColumn" msprop:Generator_UserColumnName="HORAS_QUEMA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_CORTA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_CORTA_ACUM" msprop:Generator_ColumnPropNameInRow="HORAS_CORTA_ACUM" msprop:Generator_ColumnPropNameInTable="HORAS_CORTA_ACUMColumn" msprop:Generator_UserColumnName="HORAS_CORTA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="BRIX_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnBRIX_ACUM" msprop:Generator_ColumnPropNameInRow="BRIX_ACUM" msprop:Generator_ColumnPropNameInTable="BRIX_ACUMColumn" msprop:Generator_UserColumnName="BRIX_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPOL_ACUM" msprop:Generator_ColumnPropNameInRow="POL_ACUM" msprop:Generator_ColumnPropNameInTable="POL_ACUMColumn" msprop:Generator_UserColumnName="POL_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO_ACUM" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO_ACUM" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGO_ACUMColumn" msprop:Generator_UserColumnName="PUREZA_JUGO_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="HUMEDAD_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHUMEDAD_ACUM" msprop:Generator_ColumnPropNameInRow="HUMEDAD_ACUM" msprop:Generator_ColumnPropNameInTable="HUMEDAD_ACUMColumn" msprop:Generator_UserColumnName="HUMEDAD_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA_ACUM" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA_ACUM" msprop:Generator_ColumnPropNameInTable="FIBRA_CANA_ACUMColumn" msprop:Generator_UserColumnName="FIBRA_CANA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="PLAN_COSECHA_EJECUCION" msprop:Generator_TableClassName="PLAN_COSECHA_EJECUCIONDataTable" msprop:Generator_TableVarName="tablePLAN_COSECHA_EJECUCION" msprop:Generator_RowChangedName="PLAN_COSECHA_EJECUCIONRowChanged" msprop:Generator_TablePropName="PLAN_COSECHA_EJECUCION" msprop:Generator_RowDeletingName="PLAN_COSECHA_EJECUCIONRowDeleting" msprop:Generator_RowChangingName="PLAN_COSECHA_EJECUCIONRowChanging" msprop:Generator_RowEvHandlerName="PLAN_COSECHA_EJECUCIONRowChangeEventHandler" msprop:Generator_RowDeletedName="PLAN_COSECHA_EJECUCIONRowDeleted" msprop:Generator_RowClassName="PLAN_COSECHA_EJECUCIONRow" msprop:Generator_UserTableName="PLAN_COSECHA_EJECUCION" msprop:Generator_RowEvArgName="PLAN_COSECHA_EJECUCIONRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="13" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="MZ_CONTRA" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRA" msprop:Generator_ColumnPropNameInRow="MZ_CONTRA" msprop:Generator_ColumnPropNameInTable="MZ_CONTRAColumn" msprop:Generator_UserColumnName="MZ_CONTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRA" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRA" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRA" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRAColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CONTRA" msprop:Generator_ColumnVarNameInTable="columnTONEL_CONTRA" msprop:Generator_ColumnPropNameInRow="TONEL_CONTRA" msprop:Generator_ColumnPropNameInTable="TONEL_CONTRAColumn" msprop:Generator_UserColumnName="TONEL_CONTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_CENSOColumn" msprop:Generator_UserColumnName="TONEL_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SALDO_VAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInRow="TONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInTable="TONEL_SALDO_VARColumn" msprop:Generator_UserColumnName="TONEL_SALDO_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnMZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="MZ_ENTREGARColumn" msprop:Generator_UserColumnName="MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_MZ_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_MZ_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_MZ_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIN_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFIN_LOTE" msprop:Generator_ColumnPropNameInRow="FIN_LOTE" msprop:Generator_ColumnPropNameInTable="FIN_LOTEColumn" msprop:Generator_UserColumnName="FIN_LOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="7" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIVARIEDA" msprop:Generator_ColumnVarNameInTable="columnCODIVARIEDA" msprop:Generator_ColumnPropNameInRow="CODIVARIEDA" msprop:Generator_ColumnPropNameInTable="CODIVARIEDAColumn" msprop:Generator_UserColumnName="CODIVARIEDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="3" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CANA" msprop:Generator_ColumnPropNameInRow="TIPO_CANA" msprop:Generator_ColumnPropNameInTable="TIPO_CANAColumn" msprop:Generator_UserColumnName="TIPO_CANA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_TIPO" msprop:Generator_ColumnVarNameInTable="columnID_TIPO" msprop:Generator_ColumnPropNameInRow="ID_TIPO" msprop:Generator_ColumnPropNameInTable="ID_TIPOColumn" msprop:Generator_UserColumnName="ID_TIPO" type="xs:int" minOccurs="0" />
              <xs:element name="REND_COSECHA" msprop:Generator_ColumnVarNameInTable="columnREND_COSECHA" msprop:Generator_ColumnPropNameInRow="REND_COSECHA" msprop:Generator_ColumnPropNameInTable="REND_COSECHAColumn" msprop:Generator_UserColumnName="REND_COSECHA" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA_ROZA" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_TIPO_CANA" msprop:Generator_ColumnVarNameInTable="columnID_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="ID_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="ID_TIPO_CANAColumn" msprop:Generator_UserColumnName="ID_TIPO_CANA" type="xs:int" minOccurs="0" />
              <xs:element name="MADURANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMADURANTE" msprop:Generator_ColumnPropNameInRow="MADURANTE" msprop:Generator_ColumnPropNameInTable="MADURANTEColumn" msprop:Generator_UserColumnName="MADURANTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_APLICA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_APLICA" msprop:Generator_ColumnPropNameInRow="FECHA_APLICA" msprop:Generator_ColumnPropNameInTable="FECHA_APLICAColumn" msprop:Generator_UserColumnName="FECHA_APLICA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="21" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TONEL_SEMILLA" msprop:Generator_ColumnVarNameInTable="columnTONEL_SEMILLA" msprop:Generator_ColumnPropNameInRow="TONEL_SEMILLA" msprop:Generator_ColumnPropNameInTable="TONEL_SEMILLAColumn" msprop:Generator_UserColumnName="TONEL_SEMILLA" type="xs:decimal" minOccurs="0" />
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC010" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC010DataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC010" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC010RowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC010" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC010RowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC010RowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC010RowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC010RowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC010Row" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC010" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC010RowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="21" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA" msprop:Generator_ColumnPropNameInRow="CZONA" msprop:Generator_ColumnPropNameInTable="CZONAColumn" msprop:Generator_UserColumnName="CZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="6" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="4" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="73" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="5" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="13" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SEMILLA" msprop:Generator_ColumnVarNameInTable="columnTONEL_SEMILLA" msprop:Generator_ColumnPropNameInRow="TONEL_SEMILLA" msprop:Generator_ColumnPropNameInTable="TONEL_SEMILLAColumn" msprop:Generator_UserColumnName="TONEL_SEMILLA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SALDO_VAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInRow="TONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInTable="TONEL_SALDO_VARColumn" msprop:Generator_UserColumnName="TONEL_SALDO_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PH_TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_CENSO" msprop:Generator_ColumnPropNameInRow="PV_TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="PV_TONEL_CENSOColumn" msprop:Generator_UserColumnName="PV_TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="CZONA_DESCRIP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA_DESCRIP" msprop:Generator_ColumnPropNameInRow="CZONA_DESCRIP" msprop:Generator_ColumnPropNameInTable="CZONA_DESCRIPColumn" msprop:Generator_UserColumnName="CZONA_DESCRIP" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC003" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC003DataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC003" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC003RowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC003" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC003RowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC003RowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC003RowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC003RowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC003Row" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC003" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC003RowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CORTE_CERRADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTE_CERRADO" msprop:Generator_ColumnPropNameInRow="CORTE_CERRADO" msprop:Generator_ColumnPropNameInTable="CORTE_CERRADOColumn" msprop:Generator_UserColumnName="CORTE_CERRADO" type="xs:int" minOccurs="0" />
              <xs:element name="CATORCENA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATORCENA" msprop:Generator_ColumnPropNameInRow="CATORCENA" msprop:Generator_ColumnPropNameInTable="CATORCENAColumn" msprop:Generator_UserColumnName="CATORCENA" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_INICIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_INICIO" msprop:Generator_ColumnPropNameInRow="FECHA_INICIO" msprop:Generator_ColumnPropNameInTable="FECHA_INICIOColumn" msprop:Generator_UserColumnName="FECHA_INICIO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA_FIN" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_FIN" msprop:Generator_ColumnPropNameInRow="FECHA_FIN" msprop:Generator_ColumnPropNameInTable="FECHA_FINColumn" msprop:Generator_UserColumnName="FECHA_FIN" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA" msprop:Generator_ColumnPropNameInTable="EFICIENCIAColumn" msprop:Generator_UserColumnName="EFICIENCIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PORC_NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONELColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_AZUCAR_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_AZUCAR_REAL" msprop:Generator_ColumnPropNameInRow="PORC_AZUCAR_REAL" msprop:Generator_ColumnPropNameInTable="PORC_AZUCAR_REALColumn" msprop:Generator_UserColumnName="PORC_AZUCAR_REAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC011_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC011_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC011_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC011_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC011_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC011_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC011_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA" msprop:Generator_ColumnPropNameInRow="CZONA" msprop:Generator_ColumnPropNameInTable="CZONAColumn" msprop:Generator_UserColumnName="CZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CZONA_DESCRIP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA_DESCRIP" msprop:Generator_ColumnPropNameInRow="CZONA_DESCRIP" msprop:Generator_ColumnPropNameInTable="CZONA_DESCRIPColumn" msprop:Generator_UserColumnName="CZONA_DESCRIP" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PV_TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PV_TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPV_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PV_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PV_TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="PV_TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PH_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PH_TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="PH_TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_CZONA_TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_CZONA_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="PH_CZONA_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="PH_CZONA_TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="PH_CZONA_TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_CZONA_TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_CZONA_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="PH_CZONA_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="PH_CZONA_TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="PH_CZONA_TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_CZONA_TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_CZONA_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PH_CZONA_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PH_CZONA_TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="PH_CZONA_TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TOTAL_TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TOTAL_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="PH_TOTAL_TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="PH_TOTAL_TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="PH_TOTAL_TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TOTAL_TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TOTAL_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="PH_TOTAL_TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="PH_TOTAL_TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="PH_TOTAL_TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH_TOTAL_TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPH_TOTAL_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PH_TOTAL_TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PH_TOTAL_TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="PH_TOTAL_TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC006_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC006_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC006_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC006_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC006_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC006_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC006_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CANT_PROVEEDORES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_PROVEEDORES" msprop:Generator_ColumnPropNameInRow="CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInTable="CANT_PROVEEDORESColumn" msprop:Generator_UserColumnName="CANT_PROVEEDORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_REND_REAL_DESDE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_REND_REAL_DESDE" msprop:Generator_ColumnPropNameInRow="RANGO_REND_REAL_DESDE" msprop:Generator_ColumnPropNameInTable="RANGO_REND_REAL_DESDEColumn" msprop:Generator_UserColumnName="RANGO_REND_REAL_DESDE" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_REND_REAL_HASTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_REND_REAL_HASTA" msprop:Generator_ColumnPropNameInRow="RANGO_REND_REAL_HASTA" msprop:Generator_ColumnPropNameInTable="RANGO_REND_REAL_HASTAColumn" msprop:Generator_UserColumnName="RANGO_REND_REAL_HASTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="REND_REAL_PROMEDIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_PROMEDIO" msprop:Generator_ColumnPropNameInRow="REND_REAL_PROMEDIO" msprop:Generator_ColumnPropNameInTable="REND_REAL_PROMEDIOColumn" msprop:Generator_UserColumnName="REND_REAL_PROMEDIO" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_LBS_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_LBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="PORC_LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="PORC_LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="PORC_LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="PORC_TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_PROMEDIO_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_PROMEDIO_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_PROMEDIO_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_PROMEDIO_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_PROMEDIO_TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC004_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC004_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC004_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC004_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC004_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC004_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC004_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CANT_PROVEEDORES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_PROVEEDORES" msprop:Generator_ColumnPropNameInRow="CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInTable="CANT_PROVEEDORESColumn" msprop:Generator_UserColumnName="CANT_PROVEEDORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_MZ_DESDE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_MZ_DESDE" msprop:Generator_ColumnPropNameInRow="RANGO_MZ_DESDE" msprop:Generator_ColumnPropNameInTable="RANGO_MZ_DESDEColumn" msprop:Generator_UserColumnName="RANGO_MZ_DESDE" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_MZ_HASTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_MZ_HASTA" msprop:Generator_ColumnPropNameInRow="RANGO_MZ_HASTA" msprop:Generator_ColumnPropNameInTable="RANGO_MZ_HASTAColumn" msprop:Generator_UserColumnName="RANGO_MZ_HASTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="AREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAREA" msprop:Generator_ColumnPropNameInRow="AREA" msprop:Generator_ColumnPropNameInTable="AREAColumn" msprop:Generator_UserColumnName="AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_TC" msprop:Generator_ColumnPropNameInRow="TONEL_TC" msprop:Generator_ColumnPropNameInTable="TONEL_TCColumn" msprop:Generator_UserColumnName="TONEL_TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_AREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_AREA" msprop:Generator_ColumnPropNameInRow="PORC_AREA" msprop:Generator_ColumnPropNameInTable="PORC_AREAColumn" msprop:Generator_UserColumnName="PORC_AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TONEL_TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_TC" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_TC" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_TCColumn" msprop:Generator_UserColumnName="PORC_TONEL_TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="PORC_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="PORC_MZ_CENSOColumn" msprop:Generator_UserColumnName="PORC_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_CENSO" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_CENSOColumn" msprop:Generator_UserColumnName="PORC_TONEL_CENSO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC005_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC005_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC005_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC005_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC005_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC005_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC005_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CANT_PROVEEDORES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_PROVEEDORES" msprop:Generator_ColumnPropNameInRow="CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInTable="CANT_PROVEEDORESColumn" msprop:Generator_UserColumnName="CANT_PROVEEDORES" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_TC_MZ_DESDE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_TC_MZ_DESDE" msprop:Generator_ColumnPropNameInRow="RANGO_TC_MZ_DESDE" msprop:Generator_ColumnPropNameInTable="RANGO_TC_MZ_DESDEColumn" msprop:Generator_UserColumnName="RANGO_TC_MZ_DESDE" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO_TC_MZ_HASTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO_TC_MZ_HASTA" msprop:Generator_ColumnPropNameInRow="RANGO_TC_MZ_HASTA" msprop:Generator_ColumnPropNameInTable="RANGO_TC_MZ_HASTAColumn" msprop:Generator_UserColumnName="RANGO_TC_MZ_HASTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="AREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAREA" msprop:Generator_ColumnPropNameInRow="AREA" msprop:Generator_ColumnPropNameInTable="AREAColumn" msprop:Generator_UserColumnName="AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_TC" msprop:Generator_ColumnPropNameInRow="TONEL_TC" msprop:Generator_ColumnPropNameInTable="TONEL_TCColumn" msprop:Generator_UserColumnName="TONEL_TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_CENSO" msprop:Generator_ColumnPropNameInRow="MZ_CENSO" msprop:Generator_ColumnPropNameInTable="MZ_CENSOColumn" msprop:Generator_UserColumnName="MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_AREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_AREA" msprop:Generator_ColumnPropNameInRow="PORC_AREA" msprop:Generator_ColumnPropNameInTable="PORC_AREAColumn" msprop:Generator_UserColumnName="PORC_AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TONEL_TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_TC" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_TC" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_TCColumn" msprop:Generator_UserColumnName="PORC_TONEL_TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_MZ_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_MZ_CENSO" msprop:Generator_ColumnPropNameInRow="PORC_MZ_CENSO" msprop:Generator_ColumnPropNameInTable="PORC_MZ_CENSOColumn" msprop:Generator_UserColumnName="PORC_MZ_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_CENSO" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_CENSOColumn" msprop:Generator_UserColumnName="PORC_TONEL_CENSO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC014_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC014_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC014_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC014_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC014_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC014_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC014_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CORTA_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTA_CAMION" msprop:Generator_ColumnPropNameInRow="CORTA_CAMION" msprop:Generator_ColumnPropNameInTable="CORTA_CAMIONColumn" msprop:Generator_UserColumnName="CORTA_CAMION" type="xs:decimal" minOccurs="0" />
              <xs:element name="CORTA_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTA_3EJES" msprop:Generator_ColumnPropNameInRow="CORTA_3EJES" msprop:Generator_ColumnPropNameInTable="CORTA_3EJESColumn" msprop:Generator_UserColumnName="CORTA_3EJES" type="xs:decimal" minOccurs="0" />
              <xs:element name="CORTA_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTA_RASTRA" msprop:Generator_ColumnPropNameInRow="CORTA_RASTRA" msprop:Generator_ColumnPropNameInTable="CORTA_RASTRAColumn" msprop:Generator_UserColumnName="CORTA_RASTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_CAMION" msprop:Generator_ColumnPropNameInRow="LARGA_CAMION" msprop:Generator_ColumnPropNameInTable="LARGA_CAMIONColumn" msprop:Generator_UserColumnName="LARGA_CAMION" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_3EJES" msprop:Generator_ColumnPropNameInRow="LARGA_3EJES" msprop:Generator_ColumnPropNameInTable="LARGA_3EJESColumn" msprop:Generator_UserColumnName="LARGA_3EJES" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_RASTRA" msprop:Generator_ColumnPropNameInRow="LARGA_RASTRA" msprop:Generator_ColumnPropNameInTable="LARGA_RASTRAColumn" msprop:Generator_UserColumnName="LARGA_RASTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MECANIZADA_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMECANIZADA_CAMION" msprop:Generator_ColumnPropNameInRow="MECANIZADA_CAMION" msprop:Generator_ColumnPropNameInTable="MECANIZADA_CAMIONColumn" msprop:Generator_UserColumnName="MECANIZADA_CAMION" type="xs:decimal" minOccurs="0" />
              <xs:element name="MECANIZADA_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMECANIZADA_3EJES" msprop:Generator_ColumnPropNameInRow="MECANIZADA_3EJES" msprop:Generator_ColumnPropNameInTable="MECANIZADA_3EJESColumn" msprop:Generator_UserColumnName="MECANIZADA_3EJES" type="xs:decimal" minOccurs="0" />
              <xs:element name="MECANIZADA_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMECANIZADA_RASTRA" msprop:Generator_ColumnPropNameInRow="MECANIZADA_RASTRA" msprop:Generator_ColumnPropNameInTable="MECANIZADA_RASTRAColumn" msprop:Generator_UserColumnName="MECANIZADA_RASTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODI_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CORTA_CAMION_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTA_CAMION_CAP" msprop:Generator_ColumnPropNameInRow="CORTA_CAMION_CAP" msprop:Generator_ColumnPropNameInTable="CORTA_CAMION_CAPColumn" msprop:Generator_UserColumnName="CORTA_CAMION_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_CAMION_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_CAMION_CAP" msprop:Generator_ColumnPropNameInRow="LARGA_CAMION_CAP" msprop:Generator_ColumnPropNameInTable="LARGA_CAMION_CAPColumn" msprop:Generator_UserColumnName="LARGA_CAMION_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_3EJES_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_3EJES_CAP" msprop:Generator_ColumnPropNameInRow="LARGA_3EJES_CAP" msprop:Generator_ColumnPropNameInTable="LARGA_3EJES_CAPColumn" msprop:Generator_UserColumnName="LARGA_3EJES_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="LARGA_RASTRA_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA_RASTRA_CAP" msprop:Generator_ColumnPropNameInRow="LARGA_RASTRA_CAP" msprop:Generator_ColumnPropNameInTable="LARGA_RASTRA_CAPColumn" msprop:Generator_UserColumnName="LARGA_RASTRA_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="MECANIZA_CAMION_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMECANIZA_CAMION_CAP" msprop:Generator_ColumnPropNameInRow="MECANIZA_CAMION_CAP" msprop:Generator_ColumnPropNameInTable="MECANIZA_CAMION_CAPColumn" msprop:Generator_UserColumnName="MECANIZA_CAMION_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="MECANIZA_3EJES_CAP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMECANIZA_3EJES_CAP" msprop:Generator_ColumnPropNameInRow="MECANIZA_3EJES_CAP" msprop:Generator_ColumnPropNameInTable="MECANIZA_3EJES_CAPColumn" msprop:Generator_UserColumnName="MECANIZA_3EJES_CAP" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_CAMION" msprop:Generator_ColumnPropNameInRow="TOTAL_CAMION" msprop:Generator_ColumnPropNameInTable="TOTAL_CAMIONColumn" msprop:Generator_UserColumnName="TOTAL_CAMION" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_3EJES" msprop:Generator_ColumnPropNameInRow="TOTAL_3EJES" msprop:Generator_ColumnPropNameInTable="TOTAL_3EJESColumn" msprop:Generator_UserColumnName="TOTAL_3EJES" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_RASTRA" msprop:Generator_ColumnPropNameInRow="TOTAL_RASTRA" msprop:Generator_ColumnPropNameInTable="TOTAL_RASTRAColumn" msprop:Generator_UserColumnName="TOTAL_RASTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_CORTA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_CORTAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_LARGA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_LARGAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR_MECANIZADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGAR_MECANIZADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA" msprop:Generator_ColumnPropNameInRow="CZONA" msprop:Generator_ColumnPropNameInTable="CZONAColumn" msprop:Generator_UserColumnName="CZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CZONA_DESCRIP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCZONA_DESCRIP" msprop:Generator_ColumnPropNameInRow="CZONA_DESCRIP" msprop:Generator_ColumnPropNameInTable="CZONA_DESCRIPColumn" msprop:Generator_UserColumnName="CZONA_DESCRIP" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="67" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC012_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC012_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC012_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC012_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC012_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC012_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC012_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="GRUPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnGRUPO" msprop:Generator_ColumnPropNameInRow="GRUPO" msprop:Generator_ColumnPropNameInTable="GRUPOColumn" msprop:Generator_UserColumnName="GRUPO" type="xs:int" minOccurs="0" />
              <xs:element name="CORRELATIVO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORRELATIVO" msprop:Generator_ColumnPropNameInRow="CORRELATIVO" msprop:Generator_ColumnPropNameInTable="CORRELATIVOColumn" msprop:Generator_UserColumnName="CORRELATIVO" type="xs:int" minOccurs="0" />
              <xs:element name="DESCRIP_CORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_CORTE" msprop:Generator_ColumnPropNameInRow="DESCRIP_CORTE" msprop:Generator_ColumnPropNameInTable="DESCRIP_CORTEColumn" msprop:Generator_UserColumnName="DESCRIP_CORTE" type="xs:string" minOccurs="0" />
              <xs:element name="REND_GRAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_GRAL" msprop:Generator_ColumnPropNameInRow="REND_GRAL" msprop:Generator_ColumnPropNameInTable="REND_GRALColumn" msprop:Generator_UserColumnName="REND_GRAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_NORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_NORTE" msprop:Generator_ColumnPropNameInRow="REND_NORTE" msprop:Generator_ColumnPropNameInTable="REND_NORTEColumn" msprop:Generator_UserColumnName="REND_NORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_SUR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_SUR" msprop:Generator_ColumnPropNameInRow="REND_SUR" msprop:Generator_ColumnPropNameInTable="REND_SURColumn" msprop:Generator_UserColumnName="REND_SUR" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_N1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_N1" msprop:Generator_ColumnPropNameInRow="REND_N1" msprop:Generator_ColumnPropNameInTable="REND_N1Column" msprop:Generator_UserColumnName="REND_N1" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_N2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_N2" msprop:Generator_ColumnPropNameInRow="REND_N2" msprop:Generator_ColumnPropNameInTable="REND_N2Column" msprop:Generator_UserColumnName="REND_N2" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_N3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_N3" msprop:Generator_ColumnPropNameInRow="REND_N3" msprop:Generator_ColumnPropNameInTable="REND_N3Column" msprop:Generator_UserColumnName="REND_N3" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_S1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_S1" msprop:Generator_ColumnPropNameInRow="REND_S1" msprop:Generator_ColumnPropNameInTable="REND_S1Column" msprop:Generator_UserColumnName="REND_S1" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_S2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_S2" msprop:Generator_ColumnPropNameInRow="REND_S2" msprop:Generator_ColumnPropNameInTable="REND_S2Column" msprop:Generator_UserColumnName="REND_S2" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_S3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_S3" msprop:Generator_ColumnPropNameInRow="REND_S3" msprop:Generator_ColumnPropNameInTable="REND_S3Column" msprop:Generator_UserColumnName="REND_S3" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_S4" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_S4" msprop:Generator_ColumnPropNameInRow="REND_S4" msprop:Generator_ColumnPropNameInTable="REND_S4Column" msprop:Generator_UserColumnName="REND_S4" type="xs:decimal" minOccurs="0" />
              <xs:element name="ENCA1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnENCA1" msprop:Generator_ColumnPropNameInRow="ENCA1" msprop:Generator_ColumnPropNameInTable="ENCA1Column" msprop:Generator_UserColumnName="ENCA1" type="xs:string" minOccurs="0" />
              <xs:element name="ENCA2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnENCA2" msprop:Generator_ColumnPropNameInRow="ENCA2" msprop:Generator_ColumnPropNameInTable="ENCA2Column" msprop:Generator_UserColumnName="ENCA2" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC001_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC001_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC001_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC001_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC001_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC001_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC001_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="TIPO_QUEMAColumn" msprop:Generator_UserColumnName="TIPO_QUEMA" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CANA" msprop:Generator_ColumnPropNameInRow="TIPO_CANA" msprop:Generator_ColumnPropNameInTable="TIPO_CANAColumn" msprop:Generator_UserColumnName="TIPO_CANA" type="xs:string" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" type="xs:string" minOccurs="0" />
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" type="xs:string" minOccurs="0" />
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONELColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="PORC_TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="PORC_TIPO_QUEMAColumn" msprop:Generator_UserColumnName="PORC_TIPO_QUEMA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="PORC_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="PORC_TIPO_CANAColumn" msprop:Generator_UserColumnName="PORC_TIPO_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="REND_85_TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="REND_85_TIPO_QUEMAColumn" msprop:Generator_UserColumnName="REND_85_TIPO_QUEMA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="REND_85_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="REND_85_TIPO_CANAColumn" msprop:Generator_UserColumnName="REND_85_TIPO_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="REND_REAL_TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="REND_REAL_TIPO_QUEMAColumn" msprop:Generator_UserColumnName="REND_REAL_TIPO_QUEMA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TIPO_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TIPO_CANA" msprop:Generator_ColumnPropNameInRow="REND_REAL_TIPO_CANA" msprop:Generator_ColumnPropNameInTable="REND_REAL_TIPO_CANAColumn" msprop:Generator_UserColumnName="REND_REAL_TIPO_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC007_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC007_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC007_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC007_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC007_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC007_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC007_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TIPO_COSECHADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_COSECHADORA" msprop:Generator_ColumnPropNameInRow="TIPO_COSECHADORA" msprop:Generator_ColumnPropNameInTable="TIPO_COSECHADORAColumn" msprop:Generator_UserColumnName="TIPO_COSECHADORA" type="xs:string" minOccurs="0" />
              <xs:element name="ID_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_CARGADORA" msprop:Generator_ColumnPropNameInRow="ID_CARGADORA" msprop:Generator_ColumnPropNameInTable="ID_CARGADORAColumn" msprop:Generator_UserColumnName="ID_CARGADORA" type="xs:int" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PORC_NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONELColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_LBS_AZUCAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInRow="PORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInTable="PORC_LBS_AZUCARColumn" msprop:Generator_UserColumnName="PORC_LBS_AZUCAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA" msprop:Generator_ColumnPropNameInTable="EFICIENCIAColumn" msprop:Generator_UserColumnName="EFICIENCIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_COSECHADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_COSECHADORA" msprop:Generator_ColumnPropNameInRow="REND_85_COSECHADORA" msprop:Generator_ColumnPropNameInTable="REND_85_COSECHADORAColumn" msprop:Generator_UserColumnName="REND_85_COSECHADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_COSECHADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_COSECHADORA" msprop:Generator_ColumnPropNameInRow="REND_REAL_COSECHADORA" msprop:Generator_ColumnPropNameInTable="REND_REAL_COSECHADORAColumn" msprop:Generator_UserColumnName="REND_REAL_COSECHADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_COSECHADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_COSECHADORA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_COSECHADORA" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_COSECHADORAColumn" msprop:Generator_UserColumnName="EFICIENCIA_COSECHADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_TOTALColumn" msprop:Generator_UserColumnName="EFICIENCIA_TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC008_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC008_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC008_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC008_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC008_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC008_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC008_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TIPO_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_CARGADORA" msprop:Generator_ColumnPropNameInRow="TIPO_CARGADORA" msprop:Generator_ColumnPropNameInTable="TIPO_CARGADORAColumn" msprop:Generator_UserColumnName="TIPO_CARGADORA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ID_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_CARGADORA" msprop:Generator_ColumnPropNameInRow="ID_CARGADORA" msprop:Generator_ColumnPropNameInTable="ID_CARGADORAColumn" msprop:Generator_UserColumnName="ID_CARGADORA" type="xs:int" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="167" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PORC_NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONELColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_LBS_AZUCAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInRow="PORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInTable="PORC_LBS_AZUCARColumn" msprop:Generator_UserColumnName="PORC_LBS_AZUCAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA" msprop:Generator_ColumnPropNameInTable="EFICIENCIAColumn" msprop:Generator_UserColumnName="EFICIENCIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_CARGADORA" msprop:Generator_ColumnPropNameInRow="REND_85_CARGADORA" msprop:Generator_ColumnPropNameInTable="REND_85_CARGADORAColumn" msprop:Generator_UserColumnName="REND_85_CARGADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_CARGADORA" msprop:Generator_ColumnPropNameInRow="REND_REAL_CARGADORA" msprop:Generator_ColumnPropNameInTable="REND_REAL_CARGADORAColumn" msprop:Generator_UserColumnName="REND_REAL_CARGADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_CARGADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_CARGADORA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_CARGADORA" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_CARGADORAColumn" msprop:Generator_UserColumnName="EFICIENCIA_CARGADORA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_TOTALColumn" msprop:Generator_UserColumnName="EFICIENCIA_TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC009_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC009_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC009_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC009_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC009_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC009_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC009_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CLASE_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="CLASE_TRANSPORTEColumn" msprop:Generator_UserColumnName="CLASE_TRANSPORTE" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="TIPO_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="TIPO_TRANSPORTEColumn" msprop:Generator_UserColumnName="TIPO_TRANSPORTE" type="xs:string" minOccurs="0" />
              <xs:element name="NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_ROZA" msprop:Generator_ColumnPropNameInRow="FECHA_ROZA" msprop:Generator_ColumnPropNameInTable="FECHA_ROZAColumn" msprop:Generator_UserColumnName="FECHA_ROZA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="SEMANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSEMANA" msprop:Generator_ColumnPropNameInRow="SEMANA" msprop:Generator_ColumnPropNameInTable="SEMANAColumn" msprop:Generator_UserColumnName="SEMANA" type="xs:int" minOccurs="0" />
              <xs:element name="TERCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTERCIO" msprop:Generator_ColumnPropNameInRow="TERCIO" msprop:Generator_ColumnPropNameInTable="TERCIOColumn" msprop:Generator_UserColumnName="TERCIO" type="xs:int" minOccurs="0" />
              <xs:element name="DEPARTAMENTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEPARTAMENTO" msprop:Generator_ColumnPropNameInRow="DEPARTAMENTO" msprop:Generator_ColumnPropNameInTable="DEPARTAMENTOColumn" msprop:Generator_UserColumnName="DEPARTAMENTO" type="xs:string" minOccurs="0" />
              <xs:element name="MUNICIPIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMUNICIPIO" msprop:Generator_ColumnPropNameInRow="MUNICIPIO" msprop:Generator_ColumnPropNameInTable="MUNICIPIOColumn" msprop:Generator_UserColumnName="MUNICIPIO" type="xs:string" minOccurs="0" />
              <xs:element name="CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANTON" msprop:Generator_ColumnPropNameInRow="CANTON" msprop:Generator_ColumnPropNameInTable="CANTONColumn" msprop:Generator_UserColumnName="CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONELColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_LBS_AZUCAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInRow="PORC_LBS_AZUCAR" msprop:Generator_ColumnPropNameInTable="PORC_LBS_AZUCARColumn" msprop:Generator_UserColumnName="PORC_LBS_AZUCAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL" msprop:Generator_ColumnPropNameInRow="REND_REAL" msprop:Generator_ColumnPropNameInTable="REND_REALColumn" msprop:Generator_UserColumnName="REND_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA" msprop:Generator_ColumnPropNameInRow="EFICIENCIA" msprop:Generator_ColumnPropNameInTable="EFICIENCIAColumn" msprop:Generator_UserColumnName="EFICIENCIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_CLASE_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="REND_85_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="REND_85_CLASE_TRANSPORTEColumn" msprop:Generator_UserColumnName="REND_85_CLASE_TRANSPORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_CLASE_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="REND_REAL_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="REND_REAL_CLASE_TRANSPORTEColumn" msprop:Generator_UserColumnName="REND_REAL_CLASE_TRANSPORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_CLASE_TRANSPORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_CLASE_TRANSPORTE" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_CLASE_TRANSPORTEColumn" msprop:Generator_UserColumnName="EFICIENCIA_CLASE_TRANSPORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInRow="EFICIENCIA_TOTAL" msprop:Generator_ColumnPropNameInTable="EFICIENCIA_TOTALColumn" msprop:Generator_UserColumnName="EFICIENCIA_TOTAL" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" msprop:Generator_TableClassName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTEDataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" msprop:Generator_RowChangedName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" msprop:Generator_RowDeletingName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERow" msprop:Generator_UserTableName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTE" msprop:Generator_RowEvArgName="RPT_SIGESTA_SEGUIMIENTO_TRANSPORTERowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="DESCRIP_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PRODUCTOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTOR" msprop:Generator_ColumnPropNameInRow="PRODUCTOR" msprop:Generator_ColumnPropNameInTable="PRODUCTORColumn" msprop:Generator_UserColumnName="PRODUCTOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="COD_CARGA1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOD_CARGA1" msprop:Generator_ColumnPropNameInRow="COD_CARGA1" msprop:Generator_ColumnPropNameInTable="COD_CARGA1Column" msprop:Generator_UserColumnName="COD_CARGA1" type="xs:string" minOccurs="0" />
              <xs:element name="COD_CARGA2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOD_CARGA2" msprop:Generator_ColumnPropNameInRow="COD_CARGA2" msprop:Generator_ColumnPropNameInTable="COD_CARGA2Column" msprop:Generator_UserColumnName="COD_CARGA2" type="xs:string" minOccurs="0" />
              <xs:element name="COD_CARGA3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOD_CARGA3" msprop:Generator_ColumnPropNameInRow="COD_CARGA3" msprop:Generator_ColumnPropNameInTable="COD_CARGA3Column" msprop:Generator_UserColumnName="COD_CARGA3" type="xs:string" minOccurs="0" />
              <xs:element name="CORRELATIVO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORRELATIVO" msprop:Generator_ColumnPropNameInRow="CORRELATIVO" msprop:Generator_ColumnPropNameInTable="CORRELATIVOColumn" msprop:Generator_UserColumnName="CORRELATIVO" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="PLAN_COSECHA_DIARIO" msprop:Generator_TableClassName="PLAN_COSECHA_DIARIODataTable" msprop:Generator_TableVarName="tablePLAN_COSECHA_DIARIO" msprop:Generator_RowChangedName="PLAN_COSECHA_DIARIORowChanged" msprop:Generator_TablePropName="PLAN_COSECHA_DIARIO" msprop:Generator_RowDeletingName="PLAN_COSECHA_DIARIORowDeleting" msprop:Generator_RowChangingName="PLAN_COSECHA_DIARIORowChanging" msprop:Generator_RowEvHandlerName="PLAN_COSECHA_DIARIORowChangeEventHandler" msprop:Generator_RowDeletedName="PLAN_COSECHA_DIARIORowDeleted" msprop:Generator_RowClassName="PLAN_COSECHA_DIARIORow" msprop:Generator_UserTableName="PLAN_COSECHA_DIARIO" msprop:Generator_RowEvArgName="PLAN_COSECHA_DIARIORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CCODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCCODISOCIO" msprop:Generator_ColumnPropNameInRow="CCODISOCIO" msprop:Generator_ColumnPropNameInTable="CCODISOCIOColumn" msprop:Generator_UserColumnName="CCODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="ROZA_ANTERIOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_ANTERIOR" msprop:Generator_ColumnPropNameInRow="ROZA_ANTERIOR" msprop:Generator_ColumnPropNameInTable="ROZA_ANTERIORColumn" msprop:Generator_UserColumnName="ROZA_ANTERIOR" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_DIA" msprop:Generator_ColumnPropNameInRow="ROZA_DIA" msprop:Generator_ColumnPropNameInTable="ROZA_DIAColumn" msprop:Generator_UserColumnName="ROZA_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_PROYECTADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_PROYECTADA" msprop:Generator_ColumnPropNameInRow="ROZA_PROYECTADA" msprop:Generator_ColumnPropNameInTable="ROZA_PROYECTADAColumn" msprop:Generator_UserColumnName="ROZA_PROYECTADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_ROZA" msprop:Generator_ColumnPropNameInRow="SALDO_ROZA" msprop:Generator_ColumnPropNameInTable="SALDO_ROZAColumn" msprop:Generator_UserColumnName="SALDO_ROZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="INV_CANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnINV_CANA" msprop:Generator_ColumnPropNameInRow="INV_CANA" msprop:Generator_ColumnPropNameInTable="INV_CANAColumn" msprop:Generator_UserColumnName="INV_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="INV_PROYECTADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnINV_PROYECTADO" msprop:Generator_ColumnPropNameInRow="INV_PROYECTADO" msprop:Generator_ColumnPropNameInTable="INV_PROYECTADOColumn" msprop:Generator_UserColumnName="INV_PROYECTADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_QUEMA_PROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_QUEMA_PROG" msprop:Generator_ColumnPropNameInRow="SALDO_QUEMA_PROG" msprop:Generator_ColumnPropNameInTable="SALDO_QUEMA_PROGColumn" msprop:Generator_UserColumnName="SALDO_QUEMA_PROG" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_QUEMA_NOPROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_QUEMA_NOPROG" msprop:Generator_ColumnPropNameInRow="SALDO_QUEMA_NOPROG" msprop:Generator_ColumnPropNameInTable="SALDO_QUEMA_NOPROGColumn" msprop:Generator_UserColumnName="SALDO_QUEMA_NOPROG" type="xs:decimal" minOccurs="0" />
              <xs:element name="MOLIENDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMOLIENDA" msprop:Generator_ColumnPropNameInRow="MOLIENDA" msprop:Generator_ColumnPropNameInTable="MOLIENDAColumn" msprop:Generator_UserColumnName="MOLIENDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA_PRECOSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA_PRECOSECHA" msprop:Generator_ColumnPropNameInRow="FECHA_PRECOSECHA" msprop:Generator_ColumnPropNameInTable="FECHA_PRECOSECHAColumn" msprop:Generator_UserColumnName="FECHA_PRECOSECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="REND_85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="AUTORIZADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAUTORIZADO" msprop:Generator_ColumnPropNameInRow="AUTORIZADO" msprop:Generator_ColumnPropNameInTable="AUTORIZADOColumn" msprop:Generator_UserColumnName="AUTORIZADO" type="xs:boolean" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC014_COMPA_ZAFRAS" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASDataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC014_COMPA_ZAFRAS" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC014_COMPA_ZAFRAS" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC014_COMPA_ZAFRAS" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC014_COMPA_ZAFRASRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="DIAZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIAZAFRA" msprop:Generator_ColumnPropNameInRow="DIAZAFRA" msprop:Generator_ColumnPropNameInTable="DIAZAFRAColumn" msprop:Generator_UserColumnName="DIAZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="ZAFRA1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA1" msprop:Generator_ColumnPropNameInRow="ZAFRA1" msprop:Generator_ColumnPropNameInTable="ZAFRA1Column" msprop:Generator_UserColumnName="ZAFRA1" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA1" msprop:Generator_ColumnPropNameInRow="FECHA1" msprop:Generator_ColumnPropNameInTable="FECHA1Column" msprop:Generator_UserColumnName="FECHA1" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHA2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA2" msprop:Generator_ColumnPropNameInRow="FECHA2" msprop:Generator_ColumnPropNameInTable="FECHA2Column" msprop:Generator_UserColumnName="FECHA2" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TC1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC1" msprop:Generator_ColumnPropNameInRow="TC1" msprop:Generator_ColumnPropNameInTable="TC1Column" msprop:Generator_UserColumnName="TC1" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC1_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC1_A" msprop:Generator_ColumnPropNameInRow="TC1_A" msprop:Generator_ColumnPropNameInTable="TC1_AColumn" msprop:Generator_UserColumnName="TC1_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC2" msprop:Generator_ColumnPropNameInRow="TC2" msprop:Generator_ColumnPropNameInTable="TC2Column" msprop:Generator_UserColumnName="TC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC2_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC2_A" msprop:Generator_ColumnPropNameInRow="TC2_A" msprop:Generator_ColumnPropNameInTable="TC2_AColumn" msprop:Generator_UserColumnName="TC2_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND851" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND851" msprop:Generator_ColumnPropNameInRow="REND851" msprop:Generator_ColumnPropNameInTable="REND851Column" msprop:Generator_UserColumnName="REND851" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND851_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND851_A" msprop:Generator_ColumnPropNameInRow="REND851_A" msprop:Generator_ColumnPropNameInTable="REND851_AColumn" msprop:Generator_UserColumnName="REND851_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND852" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND852" msprop:Generator_ColumnPropNameInRow="REND852" msprop:Generator_ColumnPropNameInTable="REND852Column" msprop:Generator_UserColumnName="REND852" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND852_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND852_A" msprop:Generator_ColumnPropNameInRow="REND852_A" msprop:Generator_ColumnPropNameInTable="REND852_AColumn" msprop:Generator_UserColumnName="REND852_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL1" msprop:Generator_ColumnPropNameInRow="REND_REAL1" msprop:Generator_ColumnPropNameInTable="REND_REAL1Column" msprop:Generator_UserColumnName="REND_REAL1" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL1_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL1_A" msprop:Generator_ColumnPropNameInRow="REND_REAL1_A" msprop:Generator_ColumnPropNameInTable="REND_REAL1_AColumn" msprop:Generator_UserColumnName="REND_REAL1_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL2" msprop:Generator_ColumnPropNameInRow="REND_REAL2" msprop:Generator_ColumnPropNameInTable="REND_REAL2Column" msprop:Generator_UserColumnName="REND_REAL2" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL2_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL2_A" msprop:Generator_ColumnPropNameInRow="REND_REAL2_A" msprop:Generator_ColumnPropNameInTable="REND_REAL2_AColumn" msprop:Generator_UserColumnName="REND_REAL2_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA1" msprop:Generator_ColumnPropNameInRow="EFICIENCIA1" msprop:Generator_ColumnPropNameInTable="EFICIENCIA1Column" msprop:Generator_UserColumnName="EFICIENCIA1" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA2" msprop:Generator_ColumnPropNameInRow="EFICIENCIA2" msprop:Generator_ColumnPropNameInTable="EFICIENCIA2Column" msprop:Generator_UserColumnName="EFICIENCIA2" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL1" msprop:Generator_ColumnPropNameInRow="LBS_REAL1" msprop:Generator_ColumnPropNameInTable="LBS_REAL1Column" msprop:Generator_UserColumnName="LBS_REAL1" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL1_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL1_A" msprop:Generator_ColumnPropNameInRow="LBS_REAL1_A" msprop:Generator_ColumnPropNameInTable="LBS_REAL1_AColumn" msprop:Generator_UserColumnName="LBS_REAL1_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL2" msprop:Generator_ColumnPropNameInRow="LBS_REAL2" msprop:Generator_ColumnPropNameInTable="LBS_REAL2Column" msprop:Generator_UserColumnName="LBS_REAL2" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL2_A" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL2_A" msprop:Generator_ColumnPropNameInRow="LBS_REAL2_A" msprop:Generator_ColumnPropNameInTable="LBS_REAL2_AColumn" msprop:Generator_UserColumnName="LBS_REAL2_A" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_TC_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_TC_PROM" msprop:Generator_ColumnPropNameInRow="DIF_TC_PROM" msprop:Generator_ColumnPropNameInTable="DIF_TC_PROMColumn" msprop:Generator_UserColumnName="DIF_TC_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_TC_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_TC_TOTAL" msprop:Generator_ColumnPropNameInRow="DIF_TC_TOTAL" msprop:Generator_ColumnPropNameInTable="DIF_TC_TOTALColumn" msprop:Generator_UserColumnName="DIF_TC_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZAFR21" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFR21" msprop:Generator_ColumnPropNameInRow="ZAFR21" msprop:Generator_ColumnPropNameInTable="ZAFR21Column" msprop:Generator_UserColumnName="ZAFR21" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DIF_REND85_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_REND85_A_PROM" msprop:Generator_ColumnPropNameInRow="DIF_REND85_A_PROM" msprop:Generator_ColumnPropNameInTable="DIF_REND85_A_PROMColumn" msprop:Generator_UserColumnName="DIF_REND85_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_REND_REAL_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_REND_REAL_A_PROM" msprop:Generator_ColumnPropNameInRow="DIF_REND_REAL_A_PROM" msprop:Generator_ColumnPropNameInTable="DIF_REND_REAL_A_PROMColumn" msprop:Generator_UserColumnName="DIF_REND_REAL_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_EFICIENCIA_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_EFICIENCIA_PROM" msprop:Generator_ColumnPropNameInRow="DIF_EFICIENCIA_PROM" msprop:Generator_ColumnPropNameInTable="DIF_EFICIENCIA_PROMColumn" msprop:Generator_UserColumnName="DIF_EFICIENCIA_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND851_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND851_PROM" msprop:Generator_ColumnPropNameInRow="REND851_PROM" msprop:Generator_ColumnPropNameInTable="REND851_PROMColumn" msprop:Generator_UserColumnName="REND851_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND852_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND852_PROM" msprop:Generator_ColumnPropNameInRow="REND852_PROM" msprop:Generator_ColumnPropNameInTable="REND852_PROMColumn" msprop:Generator_UserColumnName="REND852_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL1_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL1_PROM" msprop:Generator_ColumnPropNameInRow="REND_REAL1_PROM" msprop:Generator_ColumnPropNameInTable="REND_REAL1_PROMColumn" msprop:Generator_UserColumnName="REND_REAL1_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL2_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL2_PROM" msprop:Generator_ColumnPropNameInRow="REND_REAL2_PROM" msprop:Generator_ColumnPropNameInTable="REND_REAL2_PROMColumn" msprop:Generator_UserColumnName="REND_REAL2_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL1_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL1_PROM" msprop:Generator_ColumnPropNameInRow="LBS_REAL1_PROM" msprop:Generator_ColumnPropNameInTable="LBS_REAL1_PROMColumn" msprop:Generator_UserColumnName="LBS_REAL1_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_REAL2_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_REAL2_PROM" msprop:Generator_ColumnPropNameInRow="LBS_REAL2_PROM" msprop:Generator_ColumnPropNameInTable="LBS_REAL2_PROMColumn" msprop:Generator_UserColumnName="LBS_REAL2_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_LBS_REAL_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_LBS_REAL_PROM" msprop:Generator_ColumnPropNameInRow="DIF_LBS_REAL_PROM" msprop:Generator_ColumnPropNameInTable="DIF_LBS_REAL_PROMColumn" msprop:Generator_UserColumnName="DIF_LBS_REAL_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_REND85_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_REND85_PROM" msprop:Generator_ColumnPropNameInRow="DIF_REND85_PROM" msprop:Generator_ColumnPropNameInTable="DIF_REND85_PROMColumn" msprop:Generator_UserColumnName="DIF_REND85_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_REND_REAL_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_REND_REAL_PROM" msprop:Generator_ColumnPropNameInRow="DIF_REND_REAL_PROM" msprop:Generator_ColumnPropNameInTable="DIF_REND_REAL_PROMColumn" msprop:Generator_UserColumnName="DIF_REND_REAL_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND851_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND851_A_PROM" msprop:Generator_ColumnPropNameInRow="REND851_A_PROM" msprop:Generator_ColumnPropNameInTable="REND851_A_PROMColumn" msprop:Generator_UserColumnName="REND851_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND852_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND852_A_PROM" msprop:Generator_ColumnPropNameInRow="REND852_A_PROM" msprop:Generator_ColumnPropNameInTable="REND852_A_PROMColumn" msprop:Generator_UserColumnName="REND852_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL1_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL1_A_PROM" msprop:Generator_ColumnPropNameInRow="REND_REAL1_A_PROM" msprop:Generator_ColumnPropNameInTable="REND_REAL1_A_PROMColumn" msprop:Generator_UserColumnName="REND_REAL1_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL2_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL2_A_PROM" msprop:Generator_ColumnPropNameInRow="REND_REAL2_A_PROM" msprop:Generator_ColumnPropNameInTable="REND_REAL2_A_PROMColumn" msprop:Generator_UserColumnName="REND_REAL2_A_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA1_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA1_PROM" msprop:Generator_ColumnPropNameInRow="EFICIENCIA1_PROM" msprop:Generator_ColumnPropNameInTable="EFICIENCIA1_PROMColumn" msprop:Generator_UserColumnName="EFICIENCIA1_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="EFICIENCIA2_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEFICIENCIA2_PROM" msprop:Generator_ColumnPropNameInRow="EFICIENCIA2_PROM" msprop:Generator_ColumnPropNameInTable="EFICIENCIA2_PROMColumn" msprop:Generator_UserColumnName="EFICIENCIA2_PROM" type="xs:decimal" minOccurs="0" />
              <xs:element name="DIF_LBS_REAL_A_PROM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIF_LBS_REAL_A_PROM" msprop:Generator_ColumnPropNameInRow="DIF_LBS_REAL_A_PROM" msprop:Generator_ColumnPropNameInTable="DIF_LBS_REAL_A_PROMColumn" msprop:Generator_UserColumnName="DIF_LBS_REAL_A_PROM" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC015_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC015_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC015_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC015_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC015_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC015_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC015_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ORDEN_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnORDEN_EDAD" msprop:Generator_ColumnPropNameInRow="ORDEN_EDAD" msprop:Generator_ColumnPropNameInTable="ORDEN_EDADColumn" msprop:Generator_UserColumnName="ORDEN_EDAD" type="xs:int" minOccurs="0" />
              <xs:element name="DESCRIP_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_EDAD" msprop:Generator_ColumnPropNameInRow="DESCRIP_EDAD" msprop:Generator_ColumnPropNameInTable="DESCRIP_EDADColumn" msprop:Generator_UserColumnName="DESCRIP_EDAD" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZONA_NORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA_NORTE" msprop:Generator_ColumnPropNameInRow="ZONA_NORTE" msprop:Generator_ColumnPropNameInTable="ZONA_NORTEColumn" msprop:Generator_UserColumnName="ZONA_NORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZONA_SUR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA_SUR" msprop:Generator_ColumnPropNameInRow="ZONA_SUR" msprop:Generator_ColumnPropNameInTable="ZONA_SURColumn" msprop:Generator_UserColumnName="ZONA_SUR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SEMILLA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_SEMILLA" msprop:Generator_ColumnPropNameInRow="TONEL_SEMILLA" msprop:Generator_ColumnPropNameInTable="TONEL_SEMILLAColumn" msprop:Generator_UserColumnName="TONEL_SEMILLA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SALDO_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInRow="TONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInTable="TONEL_SALDO_VARColumn" msprop:Generator_UserColumnName="TONEL_SALDO_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="PORC_TONEL_CENSO_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_CENSO_V" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_CENSO_V" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_CENSO_VColumn" msprop:Generator_UserColumnName="PORC_TONEL_CENSO_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_V" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_V" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_VColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_H" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_H" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_HColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_ORDEN_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_ORDEN_EDAD" msprop:Generator_ColumnPropNameInRow="REND_85_ORDEN_EDAD" msprop:Generator_ColumnPropNameInTable="REND_85_ORDEN_EDADColumn" msprop:Generator_UserColumnName="REND_85_ORDEN_EDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_ORDEN_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_ORDEN_EDAD" msprop:Generator_ColumnPropNameInRow="REND_REAL_ORDEN_EDAD" msprop:Generator_ColumnPropNameInTable="REND_REAL_ORDEN_EDADColumn" msprop:Generator_UserColumnName="REND_REAL_ORDEN_EDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_TOTAL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_V" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_V" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_VColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_V" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_V" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_VColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_TOTAL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_TOTAL_H" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC017_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC017_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC017_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowChanged" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC017_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowDeleted" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC017_PLAN_COSECHARow" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC017_PLAN_COSECHA" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC017_PLAN_COSECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOM_VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_TIPO" msprop:Generator_ColumnPropNameInRow="SUB_TIPO" msprop:Generator_ColumnPropNameInTable="SUB_TIPOColumn" msprop:Generator_UserColumnName="SUB_TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODICONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZONA_NORTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA_NORTE" msprop:Generator_ColumnPropNameInRow="ZONA_NORTE" msprop:Generator_ColumnPropNameInTable="ZONA_NORTEColumn" msprop:Generator_UserColumnName="ZONA_NORTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZONA_SUR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA_SUR" msprop:Generator_ColumnPropNameInRow="ZONA_SUR" msprop:Generator_ColumnPropNameInTable="ZONA_SURColumn" msprop:Generator_UserColumnName="ZONA_SUR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CALC2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CALC2" msprop:Generator_ColumnPropNameInRow="AZUCAR_CALC2" msprop:Generator_ColumnPropNameInTable="AZUCAR_CALC2Column" msprop:Generator_UserColumnName="AZUCAR_CALC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_CATORCENA_REAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInRow="AZUCAR_CATORCENA_REAL" msprop:Generator_ColumnPropNameInTable="AZUCAR_CATORCENA_REALColumn" msprop:Generator_UserColumnName="AZUCAR_CATORCENA_REAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SEMILLA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_SEMILLA" msprop:Generator_ColumnPropNameInRow="TONEL_SEMILLA" msprop:Generator_ColumnPropNameInTable="TONEL_SEMILLAColumn" msprop:Generator_UserColumnName="TONEL_SEMILLA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_SALDO_VAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInRow="TONEL_SALDO_VAR" msprop:Generator_ColumnPropNameInTable="TONEL_SALDO_VARColumn" msprop:Generator_UserColumnName="TONEL_SALDO_VAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_ENTREGAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGAR" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGAR" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGARColumn" msprop:Generator_UserColumnName="TONEL_ENTREGAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="PORC_TONEL_CENSO_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_TONEL_CENSO_V" msprop:Generator_ColumnPropNameInRow="PORC_TONEL_CENSO_V" msprop:Generator_ColumnPropNameInTable="PORC_TONEL_CENSO_VColumn" msprop:Generator_UserColumnName="PORC_TONEL_CENSO_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_V" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_V" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_VColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_H" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_H" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_HColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_ORDEN_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_ORDEN_EDAD" msprop:Generator_ColumnPropNameInRow="REND_85_ORDEN_EDAD" msprop:Generator_ColumnPropNameInTable="REND_85_ORDEN_EDADColumn" msprop:Generator_UserColumnName="REND_85_ORDEN_EDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_ORDEN_EDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_ORDEN_EDAD" msprop:Generator_ColumnPropNameInRow="REND_REAL_ORDEN_EDAD" msprop:Generator_ColumnPropNameInTable="REND_REAL_ORDEN_EDADColumn" msprop:Generator_UserColumnName="REND_REAL_ORDEN_EDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_NETOTONEL_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_NETOTONEL_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_NETOTONEL_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_NETOTONEL_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_NETOTONEL_TOTAL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_85_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_85_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_85_TOTALColumn" msprop:Generator_UserColumnName="REND_85_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_REAL_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_REAL_TOTAL" msprop:Generator_ColumnPropNameInRow="REND_REAL_TOTAL" msprop:Generator_ColumnPropNameInTable="REND_REAL_TOTALColumn" msprop:Generator_UserColumnName="REND_REAL_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_V" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_V" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_VColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_V" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_V" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_V" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_VColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_V" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_NORTE_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_NORTE_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_NORTE_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_NORTE_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_NORTE_TOTAL_H" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORC_ZONA_SUR_TOTAL_H" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORC_ZONA_SUR_TOTAL_H" msprop:Generator_ColumnPropNameInRow="PORC_ZONA_SUR_TOTAL_H" msprop:Generator_ColumnPropNameInTable="PORC_ZONA_SUR_TOTAL_HColumn" msprop:Generator_UserColumnName="PORC_ZONA_SUR_TOTAL_H" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_SIGESTA_EJEC019_PLAN_COSECHA" msprop:Generator_TableClassName="RPT_SIGESTA_EJEC019_PLAN_COSECHADataTable" msprop:Generator_TableVarName="tableRPT_SIGESTA_EJEC019_PLAN_COSECHA" msprop:Generator_TablePropName="RPT_SIGESTA_EJEC019_PLAN_COSECHA" msprop:Generator_RowDeletingName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowDeleting" msprop:Generator_RowChangingName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowChanging" msprop:Generator_RowEvHandlerName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowDeleted" msprop:Generator_UserTableName="RPT_SIGESTA_EJEC019_PLAN_COSECHA" msprop:Generator_RowChangedName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowChanged" msprop:Generator_RowEvArgName="RPT_SIGESTA_EJEC019_PLAN_COSECHARowChangeEvent" msprop:Generator_RowClassName="RPT_SIGESTA_EJEC019_PLAN_COSECHARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="SUB_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSUB_ZONA" msprop:Generator_ColumnPropNameInRow="SUB_ZONA" msprop:Generator_ColumnPropNameInTable="SUB_ZONAColumn" msprop:Generator_UserColumnName="SUB_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_DEPTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_DEPTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_DEPTOColumn" msprop:Generator_UserColumnName="NOMBRE_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MUNI" msprop:Generator_ColumnPropNameInRow="NOMBRE_MUNI" msprop:Generator_ColumnPropNameInTable="NOMBRE_MUNIColumn" msprop:Generator_UserColumnName="NOMBRE_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CANTON" msprop:Generator_ColumnPropNameInRow="NOMBRE_CANTON" msprop:Generator_ColumnPropNameInTable="NOMBRE_CANTONColumn" msprop:Generator_UserColumnName="NOMBRE_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="TONEL_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_ENTREGADA" msprop:Generator_ColumnPropNameInRow="TONEL_ENTREGADA" msprop:Generator_ColumnPropNameInTable="TONEL_ENTREGADAColumn" msprop:Generator_UserColumnName="TONEL_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_COSECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_COSECHA" msprop:Generator_ColumnPropNameInRow="REND_COSECHA" msprop:Generator_ColumnPropNameInTable="REND_COSECHAColumn" msprop:Generator_UserColumnName="REND_COSECHA" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ENTREGADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_ENTREGADA" msprop:Generator_ColumnPropNameInRow="LBS_ENTREGADA" msprop:Generator_ColumnPropNameInTable="LBS_ENTREGADAColumn" msprop:Generator_UserColumnName="LBS_ENTREGADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODI_DEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_DEPTO" msprop:Generator_ColumnPropNameInRow="CODI_DEPTO" msprop:Generator_ColumnPropNameInTable="CODI_DEPTOColumn" msprop:Generator_UserColumnName="CODI_DEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_MUNI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_MUNI" msprop:Generator_ColumnPropNameInRow="CODI_MUNI" msprop:Generator_ColumnPropNameInTable="CODI_MUNIColumn" msprop:Generator_UserColumnName="CODI_MUNI" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_CANTON" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_CANTON" msprop:Generator_ColumnPropNameInRow="CODI_CANTON" msprop:Generator_ColumnPropNameInTable="CODI_CANTONColumn" msprop:Generator_UserColumnName="CODI_CANTON" type="xs:string" minOccurs="0" />
              <xs:element name="RENDXPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENDXPROVEEDOR" msprop:Generator_ColumnPropNameInRow="RENDXPROVEEDOR" msprop:Generator_ColumnPropNameInTable="RENDXPROVEEDORColumn" msprop:Generator_UserColumnName="RENDXPROVEEDOR" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_GENERAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_GENERAL" msprop:Generator_ColumnPropNameInRow="REND_GENERAL" msprop:Generator_ColumnPropNameInTable="REND_GENERALColumn" msprop:Generator_UserColumnName="REND_GENERAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="AGRUPADOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAGRUPADOR" msprop:Generator_ColumnPropNameInRow="AGRUPADOR" msprop:Generator_ColumnPropNameInTable="AGRUPADORColumn" msprop:Generator_UserColumnName="AGRUPADOR" type="xs:string" minOccurs="0" />
              <xs:element name="ORDEN" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnORDEN" msprop:Generator_ColumnPropNameInRow="ORDEN" msprop:Generator_ColumnPropNameInTable="ORDENColumn" msprop:Generator_UserColumnName="ORDEN" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPRINCIPAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPRINCIPAL" msprop:Generator_ColumnPropNameInRow="CODIPRINCIPAL" msprop:Generator_ColumnPropNameInTable="CODIPRINCIPALColumn" msprop:Generator_UserColumnName="CODIPRINCIPAL" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLICITUD_REQUISICION" msprop:Generator_TableClassName="SOLICITUD_REQUISICIONDataTable" msprop:Generator_TableVarName="tableSOLICITUD_REQUISICION" msprop:Generator_RowChangedName="SOLICITUD_REQUISICIONRowChanged" msprop:Generator_TablePropName="SOLICITUD_REQUISICION" msprop:Generator_RowDeletingName="SOLICITUD_REQUISICIONRowDeleting" msprop:Generator_RowChangingName="SOLICITUD_REQUISICIONRowChanging" msprop:Generator_RowEvHandlerName="SOLICITUD_REQUISICIONRowChangeEventHandler" msprop:Generator_RowDeletedName="SOLICITUD_REQUISICIONRowDeleted" msprop:Generator_RowClassName="SOLICITUD_REQUISICIONRow" msprop:Generator_UserTableName="SOLICITUD_REQUISICION" msprop:Generator_RowEvArgName="SOLICITUD_REQUISICIONRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NO_REQ" msprop:Generator_ColumnVarNameInTable="columnNO_REQ" msprop:Generator_ColumnPropNameInRow="NO_REQ" msprop:Generator_ColumnPropNameInTable="NO_REQColumn" msprop:Generator_UserColumnName="NO_REQ" type="xs:int" minOccurs="0" />
              <xs:element name="DESCRIP_PERIODO" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_PERIODO" msprop:Generator_ColumnPropNameInRow="DESCRIP_PERIODO" msprop:Generator_ColumnPropNameInTable="DESCRIP_PERIODOColumn" msprop:Generator_UserColumnName="DESCRIP_PERIODO" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_EMISION" msprop:Generator_ColumnVarNameInTable="columnFECHA_EMISION" msprop:Generator_ColumnPropNameInRow="FECHA_EMISION" msprop:Generator_ColumnPropNameInTable="FECHA_EMISIONColumn" msprop:Generator_UserColumnName="FECHA_EMISION" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NOMBRE_SECCION" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_SECCION" msprop:Generator_ColumnPropNameInRow="NOMBRE_SECCION" msprop:Generator_ColumnPropNameInTable="NOMBRE_SECCIONColumn" msprop:Generator_UserColumnName="NOMBRE_SECCION" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_SOLICITANTE" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_SOLICITANTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_SOLICITANTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_SOLICITANTEColumn" msprop:Generator_UserColumnName="NOMBRE_SOLICITANTE" type="xs:string" minOccurs="0" />
              <xs:element name="USO" msprop:Generator_ColumnVarNameInTable="columnUSO" msprop:Generator_ColumnPropNameInRow="USO" msprop:Generator_ColumnPropNameInTable="USOColumn" msprop:Generator_UserColumnName="USO" type="xs:string" minOccurs="0" />
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" type="xs:string" minOccurs="0" />
              <xs:element name="CANTIDAD" msprop:Generator_ColumnVarNameInTable="columnCANTIDAD" msprop:Generator_ColumnPropNameInRow="CANTIDAD" msprop:Generator_ColumnPropNameInTable="CANTIDADColumn" msprop:Generator_UserColumnName="CANTIDAD" type="xs:string" minOccurs="0" />
              <xs:element name="UNIDAD" msprop:Generator_ColumnVarNameInTable="columnUNIDAD" msprop:Generator_ColumnPropNameInRow="UNIDAD" msprop:Generator_ColumnPropNameInTable="UNIDADColumn" msprop:Generator_UserColumnName="UNIDAD" type="xs:string" minOccurs="0" />
              <xs:element name="DESCRIPCION" msprop:Generator_ColumnVarNameInTable="columnDESCRIPCION" msprop:Generator_ColumnPropNameInRow="DESCRIPCION" msprop:Generator_ColumnPropNameInTable="DESCRIPCIONColumn" msprop:Generator_UserColumnName="DESCRIPCION" type="xs:string" minOccurs="0" />
              <xs:element name="OBSERVACION" msprop:Generator_ColumnVarNameInTable="columnOBSERVACION" msprop:Generator_ColumnPropNameInRow="OBSERVACION" msprop:Generator_ColumnPropNameInTable="OBSERVACIONColumn" msprop:Generator_UserColumnName="OBSERVACION" type="xs:string" minOccurs="0" />
              <xs:element name="ID_REQDETA" msprop:Generator_ColumnVarNameInTable="columnID_REQDETA" msprop:Generator_ColumnPropNameInRow="ID_REQDETA" msprop:Generator_ColumnPropNameInTable="ID_REQDETAColumn" msprop:Generator_UserColumnName="ID_REQDETA" type="xs:int" minOccurs="0" />
              <xs:element name="CODI_REQ" msprop:Generator_ColumnVarNameInTable="columnCODI_REQ" msprop:Generator_ColumnPropNameInRow="CODI_REQ" msprop:Generator_ColumnPropNameInTable="CODI_REQColumn" msprop:Generator_UserColumnName="CODI_REQ" type="xs:string" minOccurs="0" />
              <xs:element name="SECCION" msprop:Generator_ColumnVarNameInTable="columnSECCION" msprop:Generator_ColumnPropNameInRow="SECCION" msprop:Generator_ColumnPropNameInTable="SECCIONColumn" msprop:Generator_UserColumnName="SECCION" type="xs:string" minOccurs="0" />
              <xs:element name="EQUIPO" msprop:Generator_ColumnVarNameInTable="columnEQUIPO" msprop:Generator_ColumnPropNameInRow="EQUIPO" msprop:Generator_ColumnPropNameInTable="EQUIPOColumn" msprop:Generator_UserColumnName="EQUIPO" type="xs:string" minOccurs="0" />
              <xs:element name="PROPOSITO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROPOSITO" msprop:Generator_ColumnPropNameInRow="PROPOSITO" msprop:Generator_ColumnPropNameInTable="PROPOSITOColumn" msprop:Generator_UserColumnName="PROPOSITO" type="xs:string" minOccurs="0" />
              <xs:element name="COMPRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOMPRA" msprop:Generator_ColumnPropNameInRow="COMPRA" msprop:Generator_ColumnPropNameInTable="COMPRAColumn" msprop:Generator_UserColumnName="COMPRA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_MAX_SUMIN" msprop:Generator_ColumnVarNameInTable="columnFECHA_MAX_SUMIN" msprop:Generator_ColumnPropNameInRow="FECHA_MAX_SUMIN" msprop:Generator_ColumnPropNameInTable="FECHA_MAX_SUMINColumn" msprop:Generator_UserColumnName="FECHA_MAX_SUMIN" type="xs:dateTime" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_REQUISICIONES" msprop:Generator_TableClassName="RPT_REQUISICIONESDataTable" msprop:Generator_TableVarName="tableRPT_REQUISICIONES" msprop:Generator_RowChangedName="RPT_REQUISICIONESRowChanged" msprop:Generator_TablePropName="RPT_REQUISICIONES" msprop:Generator_RowDeletingName="RPT_REQUISICIONESRowDeleting" msprop:Generator_RowChangingName="RPT_REQUISICIONESRowChanging" msprop:Generator_RowEvHandlerName="RPT_REQUISICIONESRowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_REQUISICIONESRowDeleted" msprop:Generator_RowClassName="RPT_REQUISICIONESRow" msprop:Generator_UserTableName="RPT_REQUISICIONES" msprop:Generator_RowEvArgName="RPT_REQUISICIONESRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_REQENCA" msprop:Generator_ColumnVarNameInTable="columnID_REQENCA" msprop:Generator_ColumnPropNameInRow="ID_REQENCA" msprop:Generator_ColumnPropNameInTable="ID_REQENCAColumn" msprop:Generator_UserColumnName="ID_REQENCA" type="xs:int" />
              <xs:element name="ID_PERIODOREQ" msprop:Generator_ColumnVarNameInTable="columnID_PERIODOREQ" msprop:Generator_ColumnPropNameInRow="ID_PERIODOREQ" msprop:Generator_ColumnPropNameInTable="ID_PERIODOREQColumn" msprop:Generator_UserColumnName="ID_PERIODOREQ" type="xs:int" />
              <xs:element name="ID_SECCION" msprop:Generator_ColumnVarNameInTable="columnID_SECCION" msprop:Generator_ColumnPropNameInRow="ID_SECCION" msprop:Generator_ColumnPropNameInTable="ID_SECCIONColumn" msprop:Generator_UserColumnName="ID_SECCION" type="xs:int" />
              <xs:element name="ID_SOLICITANTE" msprop:Generator_ColumnVarNameInTable="columnID_SOLICITANTE" msprop:Generator_ColumnPropNameInRow="ID_SOLICITANTE" msprop:Generator_ColumnPropNameInTable="ID_SOLICITANTEColumn" msprop:Generator_UserColumnName="ID_SOLICITANTE" type="xs:int" />
              <xs:element name="NO_REQ" msprop:Generator_ColumnVarNameInTable="columnNO_REQ" msprop:Generator_ColumnPropNameInRow="NO_REQ" msprop:Generator_ColumnPropNameInTable="NO_REQColumn" msprop:Generator_UserColumnName="NO_REQ" type="xs:int" />
              <xs:element name="FECHA_EMISION" msprop:Generator_ColumnVarNameInTable="columnFECHA_EMISION" msprop:Generator_ColumnPropNameInRow="FECHA_EMISION" msprop:Generator_ColumnPropNameInTable="FECHA_EMISIONColumn" msprop:Generator_UserColumnName="FECHA_EMISION" type="xs:dateTime" />
              <xs:element name="NO_REQ_PH" msprop:Generator_ColumnVarNameInTable="columnNO_REQ_PH" msprop:Generator_ColumnPropNameInRow="NO_REQ_PH" msprop:Generator_ColumnPropNameInTable="NO_REQ_PHColumn" msprop:Generator_UserColumnName="NO_REQ_PH" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_REQ_PH" msprop:Generator_ColumnVarNameInTable="columnFECHA_REQ_PH" msprop:Generator_ColumnPropNameInRow="FECHA_REQ_PH" msprop:Generator_ColumnPropNameInTable="FECHA_REQ_PHColumn" msprop:Generator_UserColumnName="FECHA_REQ_PH" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NO_ORDEN_PH" msprop:Generator_ColumnVarNameInTable="columnNO_ORDEN_PH" msprop:Generator_ColumnPropNameInRow="NO_ORDEN_PH" msprop:Generator_ColumnPropNameInTable="NO_ORDEN_PHColumn" msprop:Generator_UserColumnName="NO_ORDEN_PH" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ORDEN_PH" msprop:Generator_ColumnVarNameInTable="columnFECHA_ORDEN_PH" msprop:Generator_ColumnPropNameInRow="FECHA_ORDEN_PH" msprop:Generator_ColumnPropNameInTable="FECHA_ORDEN_PHColumn" msprop:Generator_UserColumnName="FECHA_ORDEN_PH" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TOTAL_ORDEN_PH" msprop:Generator_ColumnVarNameInTable="columnTOTAL_ORDEN_PH" msprop:Generator_ColumnPropNameInRow="TOTAL_ORDEN_PH" msprop:Generator_ColumnPropNameInTable="TOTAL_ORDEN_PHColumn" msprop:Generator_UserColumnName="TOTAL_ORDEN_PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="AFECTO_ORDEN_PH" msprop:Generator_ColumnVarNameInTable="columnAFECTO_ORDEN_PH" msprop:Generator_ColumnPropNameInRow="AFECTO_ORDEN_PH" msprop:Generator_ColumnPropNameInTable="AFECTO_ORDEN_PHColumn" msprop:Generator_UserColumnName="AFECTO_ORDEN_PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA_ORDEN_PH" msprop:Generator_ColumnVarNameInTable="columnIVA_ORDEN_PH" msprop:Generator_ColumnPropNameInRow="IVA_ORDEN_PH" msprop:Generator_ColumnPropNameInTable="IVA_ORDEN_PHColumn" msprop:Generator_UserColumnName="IVA_ORDEN_PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="NO_INGRESO_ALM" msprop:Generator_ColumnVarNameInTable="columnNO_INGRESO_ALM" msprop:Generator_ColumnPropNameInRow="NO_INGRESO_ALM" msprop:Generator_ColumnPropNameInTable="NO_INGRESO_ALMColumn" msprop:Generator_UserColumnName="NO_INGRESO_ALM" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_INGRESO_ALM" msprop:Generator_ColumnVarNameInTable="columnFECHA_INGRESO_ALM" msprop:Generator_ColumnPropNameInRow="FECHA_INGRESO_ALM" msprop:Generator_ColumnPropNameInTable="FECHA_INGRESO_ALMColumn" msprop:Generator_UserColumnName="FECHA_INGRESO_ALM" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NO_QUEDAN" msprop:Generator_ColumnVarNameInTable="columnNO_QUEDAN" msprop:Generator_ColumnPropNameInRow="NO_QUEDAN" msprop:Generator_ColumnPropNameInTable="NO_QUEDANColumn" msprop:Generator_UserColumnName="NO_QUEDAN" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_QUEDAN" msprop:Generator_ColumnVarNameInTable="columnFECHA_QUEDAN" msprop:Generator_ColumnPropNameInRow="FECHA_QUEDAN" msprop:Generator_ColumnPropNameInTable="FECHA_QUEDANColumn" msprop:Generator_UserColumnName="FECHA_QUEDAN" type="xs:dateTime" minOccurs="0" />
              <xs:element name="ESTADO" msprop:Generator_ColumnVarNameInTable="columnESTADO" msprop:Generator_ColumnPropNameInRow="ESTADO" msprop:Generator_ColumnPropNameInTable="ESTADOColumn" msprop:Generator_UserColumnName="ESTADO" type="xs:string" />
              <xs:element name="USO" msprop:Generator_ColumnVarNameInTable="columnUSO" msprop:Generator_ColumnPropNameInRow="USO" msprop:Generator_ColumnPropNameInTable="USOColumn" msprop:Generator_UserColumnName="USO" type="xs:string" minOccurs="0" />
              <xs:element name="USUARIO_APROB" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_APROB" msprop:Generator_ColumnPropNameInRow="USUARIO_APROB" msprop:Generator_ColumnPropNameInTable="USUARIO_APROBColumn" msprop:Generator_UserColumnName="USUARIO_APROB" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_APROB" msprop:Generator_ColumnVarNameInTable="columnFECHA_APROB" msprop:Generator_ColumnPropNameInRow="FECHA_APROB" msprop:Generator_ColumnPropNameInTable="FECHA_APROBColumn" msprop:Generator_UserColumnName="FECHA_APROB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="USUARIO_NOAPROB" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_NOAPROB" msprop:Generator_ColumnPropNameInRow="USUARIO_NOAPROB" msprop:Generator_ColumnPropNameInTable="USUARIO_NOAPROBColumn" msprop:Generator_UserColumnName="USUARIO_NOAPROB" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_NOAPROB" msprop:Generator_ColumnVarNameInTable="columnFECHA_NOAPROB" msprop:Generator_ColumnPropNameInRow="FECHA_NOAPROB" msprop:Generator_ColumnPropNameInTable="FECHA_NOAPROBColumn" msprop:Generator_UserColumnName="FECHA_NOAPROB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="USUARIO_ANUL" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_ANUL" msprop:Generator_ColumnPropNameInRow="USUARIO_ANUL" msprop:Generator_ColumnPropNameInTable="USUARIO_ANULColumn" msprop:Generator_UserColumnName="USUARIO_ANUL" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ANUL" msprop:Generator_ColumnVarNameInTable="columnFECHA_ANUL" msprop:Generator_ColumnPropNameInRow="FECHA_ANUL" msprop:Generator_ColumnPropNameInTable="FECHA_ANULColumn" msprop:Generator_UserColumnName="FECHA_ANUL" type="xs:dateTime" minOccurs="0" />
              <xs:element name="USUARIO_CREA" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_CREA" msprop:Generator_ColumnPropNameInRow="USUARIO_CREA" msprop:Generator_ColumnPropNameInTable="USUARIO_CREAColumn" msprop:Generator_UserColumnName="USUARIO_CREA" type="xs:string" />
              <xs:element name="FECHA_CREA" msprop:Generator_ColumnVarNameInTable="columnFECHA_CREA" msprop:Generator_ColumnPropNameInRow="FECHA_CREA" msprop:Generator_ColumnPropNameInTable="FECHA_CREAColumn" msprop:Generator_UserColumnName="FECHA_CREA" type="xs:dateTime" />
              <xs:element name="USUARIO_ACT" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_ACT" msprop:Generator_ColumnPropNameInRow="USUARIO_ACT" msprop:Generator_ColumnPropNameInTable="USUARIO_ACTColumn" msprop:Generator_UserColumnName="USUARIO_ACT" type="xs:string" />
              <xs:element name="FECHA_ACT" msprop:Generator_ColumnVarNameInTable="columnFECHA_ACT" msprop:Generator_ColumnPropNameInRow="FECHA_ACT" msprop:Generator_ColumnPropNameInTable="FECHA_ACTColumn" msprop:Generator_UserColumnName="FECHA_ACT" type="xs:dateTime" />
              <xs:element name="CODI_REQ" msprop:Generator_ColumnVarNameInTable="columnCODI_REQ" msprop:Generator_ColumnPropNameInRow="CODI_REQ" msprop:Generator_ColumnPropNameInTable="CODI_REQColumn" msprop:Generator_UserColumnName="CODI_REQ" type="xs:string" minOccurs="0" />
              <xs:element name="ORDEN_LOCAL" msprop:Generator_ColumnVarNameInTable="columnORDEN_LOCAL" msprop:Generator_ColumnPropNameInRow="ORDEN_LOCAL" msprop:Generator_ColumnPropNameInTable="ORDEN_LOCALColumn" msprop:Generator_UserColumnName="ORDEN_LOCAL" type="xs:boolean" minOccurs="0" />
              <xs:element name="FECHA_INGRESO_EST" msprop:Generator_ColumnVarNameInTable="columnFECHA_INGRESO_EST" msprop:Generator_ColumnPropNameInRow="FECHA_INGRESO_EST" msprop:Generator_ColumnPropNameInTable="FECHA_INGRESO_ESTColumn" msprop:Generator_UserColumnName="FECHA_INGRESO_EST" type="xs:dateTime" minOccurs="0" />
              <xs:element name="COMENTARIO_EST" msprop:Generator_ColumnVarNameInTable="columnCOMENTARIO_EST" msprop:Generator_ColumnPropNameInRow="COMENTARIO_EST" msprop:Generator_ColumnPropNameInTable="COMENTARIO_ESTColumn" msprop:Generator_UserColumnName="COMENTARIO_EST" type="xs:string" minOccurs="0" />
              <xs:element name="TOTAL_INGRESO_ALM" msprop:Generator_ColumnVarNameInTable="columnTOTAL_INGRESO_ALM" msprop:Generator_ColumnPropNameInRow="TOTAL_INGRESO_ALM" msprop:Generator_ColumnPropNameInTable="TOTAL_INGRESO_ALMColumn" msprop:Generator_UserColumnName="TOTAL_INGRESO_ALM" type="xs:decimal" minOccurs="0" />
              <xs:element name="AFECTO_INGRESO_ALM" msprop:Generator_ColumnVarNameInTable="columnAFECTO_INGRESO_ALM" msprop:Generator_ColumnPropNameInRow="AFECTO_INGRESO_ALM" msprop:Generator_ColumnPropNameInTable="AFECTO_INGRESO_ALMColumn" msprop:Generator_UserColumnName="AFECTO_INGRESO_ALM" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA_INGRESO_ALM" msprop:Generator_ColumnVarNameInTable="columnIVA_INGRESO_ALM" msprop:Generator_ColumnPropNameInRow="IVA_INGRESO_ALM" msprop:Generator_ColumnPropNameInTable="IVA_INGRESO_ALMColumn" msprop:Generator_UserColumnName="IVA_INGRESO_ALM" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_QUEDAN" msprop:Generator_ColumnVarNameInTable="columnTOTAL_QUEDAN" msprop:Generator_ColumnPropNameInRow="TOTAL_QUEDAN" msprop:Generator_ColumnPropNameInTable="TOTAL_QUEDANColumn" msprop:Generator_UserColumnName="TOTAL_QUEDAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="AFECTO_QUEDAN" msprop:Generator_ColumnVarNameInTable="columnAFECTO_QUEDAN" msprop:Generator_ColumnPropNameInRow="AFECTO_QUEDAN" msprop:Generator_ColumnPropNameInTable="AFECTO_QUEDANColumn" msprop:Generator_UserColumnName="AFECTO_QUEDAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="IVA_QUEDAN" msprop:Generator_ColumnVarNameInTable="columnIVA_QUEDAN" msprop:Generator_ColumnPropNameInRow="IVA_QUEDAN" msprop:Generator_ColumnPropNameInTable="IVA_QUEDANColumn" msprop:Generator_UserColumnName="IVA_QUEDAN" type="xs:decimal" minOccurs="0" />
              <xs:element name="COD_SECCION" msprop:Generator_ColumnVarNameInTable="columnCOD_SECCION" msprop:Generator_ColumnPropNameInRow="COD_SECCION" msprop:Generator_ColumnPropNameInTable="COD_SECCIONColumn" msprop:Generator_UserColumnName="COD_SECCION" type="xs:string" />
              <xs:element name="NOMBRE_SECCION" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_SECCION" msprop:Generator_ColumnPropNameInRow="NOMBRE_SECCION" msprop:Generator_ColumnPropNameInTable="NOMBRE_SECCIONColumn" msprop:Generator_UserColumnName="NOMBRE_SECCION" type="xs:string" />
              <xs:element name="COD_SOLICITANTE" msprop:Generator_ColumnVarNameInTable="columnCOD_SOLICITANTE" msprop:Generator_ColumnPropNameInRow="COD_SOLICITANTE" msprop:Generator_ColumnPropNameInTable="COD_SOLICITANTEColumn" msprop:Generator_UserColumnName="COD_SOLICITANTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_SOLICITANTE" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_SOLICITANTE" msprop:Generator_ColumnPropNameInRow="NOMBRE_SOLICITANTE" msprop:Generator_ColumnPropNameInTable="NOMBRE_SOLICITANTEColumn" msprop:Generator_UserColumnName="NOMBRE_SOLICITANTE" type="xs:string" />
              <xs:element name="DESCRIP_PERIODO" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_PERIODO" msprop:Generator_ColumnPropNameInRow="DESCRIP_PERIODO" msprop:Generator_ColumnPropNameInTable="DESCRIP_PERIODOColumn" msprop:Generator_UserColumnName="DESCRIP_PERIODO">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="500" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CONTRATO_ZAFRA" msprop:Generator_TableClassName="CONTRATO_ZAFRADataTable" msprop:Generator_TableVarName="tableCONTRATO_ZAFRA" msprop:Generator_TablePropName="CONTRATO_ZAFRA" msprop:Generator_RowDeletingName="CONTRATO_ZAFRARowDeleting" msprop:Generator_RowChangingName="CONTRATO_ZAFRARowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_ZAFRARowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_ZAFRARowDeleted" msprop:Generator_UserTableName="CONTRATO_ZAFRA" msprop:Generator_RowChangedName="CONTRATO_ZAFRARowChanged" msprop:Generator_RowEvArgName="CONTRATO_ZAFRARowChangeEvent" msprop:Generator_RowClassName="CONTRATO_ZAFRARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CORRELATIVO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORRELATIVO" msprop:Generator_ColumnPropNameInRow="CORRELATIVO" msprop:Generator_ColumnPropNameInTable="CORRELATIVOColumn" msprop:Generator_UserColumnName="CORRELATIVO" type="xs:int" minOccurs="0" />
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBRE_PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInRow="NOMBRE_PROVEEDOR" msprop:Generator_ColumnPropNameInTable="NOMBRE_PROVEEDORColumn" msprop:Generator_UserColumnName="NOMBRE_PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="APODERADO" msprop:Generator_ColumnVarNameInTable="columnAPODERADO" msprop:Generator_ColumnPropNameInRow="APODERADO" msprop:Generator_ColumnPropNameInTable="APODERADOColumn" msprop:Generator_UserColumnName="APODERADO" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="NO_CONTRATO" msprop:Generator_ColumnVarNameInTable="columnNO_CONTRATO" msprop:Generator_ColumnPropNameInRow="NO_CONTRATO" msprop:Generator_ColumnPropNameInTable="NO_CONTRATOColumn" msprop:Generator_UserColumnName="NO_CONTRATO" type="xs:int" minOccurs="0" />
              <xs:element name="DIRECCION" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" type="xs:string" minOccurs="0" />
              <xs:element name="NIT_APODERADO" msprop:Generator_ColumnVarNameInTable="columnNIT_APODERADO" msprop:Generator_ColumnPropNameInRow="NIT_APODERADO" msprop:Generator_ColumnPropNameInTable="NIT_APODERADOColumn" msprop:Generator_UserColumnName="NIT_APODERADO" type="xs:string" minOccurs="0" />
              <xs:element name="NIT" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
              <xs:element name="DUI_APODERADO" msprop:Generator_ColumnVarNameInTable="columnDUI_APODERADO" msprop:Generator_ColumnPropNameInRow="DUI_APODERADO" msprop:Generator_ColumnPropNameInTable="DUI_APODERADOColumn" msprop:Generator_UserColumnName="DUI_APODERADO" type="xs:string" minOccurs="0" />
              <xs:element name="CREDITFISCAL" msprop:Generator_ColumnVarNameInTable="columnCREDITFISCAL" msprop:Generator_ColumnPropNameInRow="CREDITFISCAL" msprop:Generator_ColumnPropNameInTable="CREDITFISCALColumn" msprop:Generator_UserColumnName="CREDITFISCAL" type="xs:string" minOccurs="0" />
              <xs:element name="TELEFONO" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" type="xs:string" minOccurs="0" />
              <xs:element name="FINANCOADO" msprop:Generator_ColumnVarNameInTable="columnFINANCOADO" msprop:Generator_ColumnPropNameInRow="FINANCOADO" msprop:Generator_ColumnPropNameInTable="FINANCOADOColumn" msprop:Generator_UserColumnName="FINANCOADO" type="xs:string" minOccurs="0" />
              <xs:element name="FINAN_NUMERO" msprop:Generator_ColumnVarNameInTable="columnFINAN_NUMERO" msprop:Generator_ColumnPropNameInRow="FINAN_NUMERO" msprop:Generator_ColumnPropNameInTable="FINAN_NUMEROColumn" msprop:Generator_UserColumnName="FINAN_NUMERO" type="xs:string" minOccurs="0" />
              <xs:element name="TOTALMZ_CONTRATOCB" msprop:Generator_ColumnVarNameInTable="columnTOTALMZ_CONTRATOCB" msprop:Generator_ColumnPropNameInRow="TOTALMZ_CONTRATOCB" msprop:Generator_ColumnPropNameInTable="TOTALMZ_CONTRATOCBColumn" msprop:Generator_UserColumnName="TOTALMZ_CONTRATOCB" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONELADAS_CONTRATOCB" msprop:Generator_ColumnVarNameInTable="columnTONELADAS_CONTRATOCB" msprop:Generator_ColumnPropNameInRow="TONELADAS_CONTRATOCB" msprop:Generator_ColumnPropNameInTable="TONELADAS_CONTRATOCBColumn" msprop:Generator_UserColumnName="TONELADAS_CONTRATOCB" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="AREA" msprop:Generator_ColumnVarNameInTable="columnAREA" msprop:Generator_ColumnPropNameInRow="AREA" msprop:Generator_ColumnPropNameInTable="AREAColumn" msprop:Generator_UserColumnName="AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AREA_CANA" msprop:Generator_ColumnVarNameInTable="columnAREA_CANA" msprop:Generator_ColumnPropNameInRow="AREA_CANA" msprop:Generator_ColumnPropNameInTable="AREA_CANAColumn" msprop:Generator_UserColumnName="AREA_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONELADAS" msprop:Generator_ColumnVarNameInTable="columnTONELADAS" msprop:Generator_ColumnPropNameInRow="TONELADAS" msprop:Generator_ColumnPropNameInTable="TONELADASColumn" msprop:Generator_UserColumnName="TONELADAS" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONEL_TC" msprop:Generator_ColumnVarNameInTable="columnTONEL_TC" msprop:Generator_ColumnPropNameInRow="TONEL_TC" msprop:Generator_ColumnPropNameInTable="TONEL_TCColumn" msprop:Generator_UserColumnName="TONEL_TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="EDAD_LOTE" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOM_VARIEDAD" msprop:Generator_ColumnVarNameInTable="columnNOM_VARIEDAD" msprop:Generator_ColumnPropNameInRow="NOM_VARIEDAD" msprop:Generator_ColumnPropNameInTable="NOM_VARIEDADColumn" msprop:Generator_UserColumnName="NOM_VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="PROCEDENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROCEDENCIA" msprop:Generator_ColumnPropNameInRow="PROCEDENCIA" msprop:Generator_ColumnPropNameInTable="PROCEDENCIAColumn" msprop:Generator_UserColumnName="PROCEDENCIA" type="xs:string" minOccurs="0" />
              <xs:element name="CODPROCEDENCIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODPROCEDENCIA" msprop:Generator_ColumnPropNameInRow="CODPROCEDENCIA" msprop:Generator_ColumnPropNameInTable="CODPROCEDENCIAColumn" msprop:Generator_UserColumnName="CODPROCEDENCIA" type="xs:string" minOccurs="0" />
              <xs:element name="TENENCIA_TIERRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTENENCIA_TIERRA" msprop:Generator_ColumnPropNameInRow="TENENCIA_TIERRA" msprop:Generator_ColumnPropNameInTable="TENENCIA_TIERRAColumn" msprop:Generator_UserColumnName="TENENCIA_TIERRA" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="DUI" msprop:Generator_ColumnVarNameInTable="columnDUI" msprop:Generator_ColumnPropNameInRow="DUI" msprop:Generator_ColumnPropNameInTable="DUIColumn" msprop:Generator_UserColumnName="DUI" type="xs:string" minOccurs="0" />
              <xs:element name="CELULAR" msprop:Generator_ColumnVarNameInTable="columnCELULAR" msprop:Generator_ColumnPropNameInRow="CELULAR" msprop:Generator_ColumnPropNameInTable="CELULARColumn" msprop:Generator_UserColumnName="CELULAR" type="xs:string" minOccurs="0" />
              <xs:element name="PROFESION" msprop:Generator_ColumnVarNameInTable="columnPROFESION" msprop:Generator_ColumnPropNameInRow="PROFESION" msprop:Generator_ColumnPropNameInTable="PROFESIONColumn" msprop:Generator_UserColumnName="PROFESION" type="xs:string" minOccurs="0" />
              <xs:element name="EDAD" msprop:Generator_ColumnVarNameInTable="columnEDAD" msprop:Generator_ColumnPropNameInRow="EDAD" msprop:Generator_ColumnPropNameInTable="EDADColumn" msprop:Generator_UserColumnName="EDAD" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_CONTRATOCB" msprop:Generator_ColumnVarNameInTable="columnFECHA_CONTRATOCB" msprop:Generator_ColumnPropNameInRow="FECHA_CONTRATOCB" msprop:Generator_ColumnPropNameInTable="FECHA_CONTRATOCBColumn" msprop:Generator_UserColumnName="FECHA_CONTRATOCB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="OBSERVACIONES_CONTRATOCB" msprop:Generator_ColumnVarNameInTable="columnOBSERVACIONES_CONTRATOCB" msprop:Generator_ColumnPropNameInRow="OBSERVACIONES_CONTRATOCB" msprop:Generator_ColumnPropNameInTable="OBSERVACIONES_CONTRATOCBColumn" msprop:Generator_UserColumnName="OBSERVACIONES_CONTRATOCB" type="xs:string" minOccurs="0" />
              <xs:element name="TC_ZAFRA_ANT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_ZAFRA_ANT" msprop:Generator_ColumnPropNameInRow="TC_ZAFRA_ANT" msprop:Generator_ColumnPropNameInTable="TC_ZAFRA_ANTColumn" msprop:Generator_UserColumnName="TC_ZAFRA_ANT" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_ZAFRA_ANT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_ZAFRA_ANT" msprop:Generator_ColumnPropNameInRow="REND_ZAFRA_ANT" msprop:Generator_ColumnPropNameInTable="REND_ZAFRA_ANTColumn" msprop:Generator_UserColumnName="REND_ZAFRA_ANT" type="xs:decimal" minOccurs="0" />
              <xs:element name="LBS_ZAFRA_ANT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_ZAFRA_ANT" msprop:Generator_ColumnPropNameInRow="LBS_ZAFRA_ANT" msprop:Generator_ColumnPropNameInTable="LBS_ZAFRA_ANTColumn" msprop:Generator_UserColumnName="LBS_ZAFRA_ANT" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CONTRATO_CTAS" msprop:Generator_TableClassName="CONTRATO_CTASDataTable" msprop:Generator_TableVarName="tableCONTRATO_CTAS" msprop:Generator_RowChangedName="CONTRATO_CTASRowChanged" msprop:Generator_TablePropName="CONTRATO_CTAS" msprop:Generator_RowDeletingName="CONTRATO_CTASRowDeleting" msprop:Generator_RowChangingName="CONTRATO_CTASRowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_CTASRowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_CTASRowDeleted" msprop:Generator_RowClassName="CONTRATO_CTASRow" msprop:Generator_UserTableName="CONTRATO_CTAS" msprop:Generator_RowEvArgName="CONTRATO_CTASRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_CONTRATO_CTAS" msprop:Generator_ColumnVarNameInTable="columnID_CONTRATO_CTAS" msprop:Generator_ColumnPropNameInRow="ID_CONTRATO_CTAS" msprop:Generator_ColumnPropNameInTable="ID_CONTRATO_CTASColumn" msprop:Generator_UserColumnName="ID_CONTRATO_CTAS" type="xs:int" minOccurs="0" />
              <xs:element name="ID_CONTRATO_FINAN" msprop:Generator_ColumnVarNameInTable="columnID_CONTRATO_FINAN" msprop:Generator_ColumnPropNameInRow="ID_CONTRATO_FINAN" msprop:Generator_ColumnPropNameInTable="ID_CONTRATO_FINANColumn" msprop:Generator_UserColumnName="ID_CONTRATO_FINAN" type="xs:int" minOccurs="0" />
              <xs:element name="CODICONTRATO" msprop:Generator_ColumnVarNameInTable="columnCODICONTRATO" msprop:Generator_ColumnPropNameInRow="CODICONTRATO" msprop:Generator_ColumnPropNameInTable="CODICONTRATOColumn" msprop:Generator_UserColumnName="CODICONTRATO" type="xs:string" minOccurs="0" />
              <xs:element name="ID_ZAFRA" msprop:Generator_ColumnVarNameInTable="columnID_ZAFRA" msprop:Generator_ColumnPropNameInRow="ID_ZAFRA" msprop:Generator_ColumnPropNameInTable="ID_ZAFRAColumn" msprop:Generator_UserColumnName="ID_ZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="ID_CUENTA_FINAN" msprop:Generator_ColumnVarNameInTable="columnID_CUENTA_FINAN" msprop:Generator_ColumnPropNameInRow="ID_CUENTA_FINAN" msprop:Generator_ColumnPropNameInTable="ID_CUENTA_FINANColumn" msprop:Generator_UserColumnName="ID_CUENTA_FINAN" type="xs:int" minOccurs="0" />
              <xs:element name="NO_DOCTO_REFERENCIA" msprop:Generator_ColumnVarNameInTable="columnNO_DOCTO_REFERENCIA" msprop:Generator_ColumnPropNameInRow="NO_DOCTO_REFERENCIA" msprop:Generator_ColumnPropNameInTable="NO_DOCTO_REFERENCIAColumn" msprop:Generator_UserColumnName="NO_DOCTO_REFERENCIA" type="xs:string" minOccurs="0" />
              <xs:element name="UID_REFERENCIA" msdata:DataType="System.Guid, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" msprop:Generator_ColumnVarNameInTable="columnUID_REFERENCIA" msprop:Generator_ColumnPropNameInRow="UID_REFERENCIA" msprop:Generator_ColumnPropNameInTable="UID_REFERENCIAColumn" msprop:Generator_UserColumnName="UID_REFERENCIA" type="xs:string" minOccurs="0" />
              <xs:element name="CARGO" msprop:Generator_ColumnVarNameInTable="columnCARGO" msprop:Generator_ColumnPropNameInRow="CARGO" msprop:Generator_ColumnPropNameInTable="CARGOColumn" msprop:Generator_UserColumnName="CARGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ABONO" msprop:Generator_ColumnVarNameInTable="columnABONO" msprop:Generator_ColumnPropNameInRow="ABONO" msprop:Generator_ColumnPropNameInTable="ABONOColumn" msprop:Generator_UserColumnName="ABONO" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO" msprop:Generator_ColumnVarNameInTable="columnSALDO" msprop:Generator_ColumnPropNameInRow="SALDO" msprop:Generator_ColumnPropNameInTable="SALDOColumn" msprop:Generator_UserColumnName="SALDO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ZAFRA" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="USUARIO_CREA" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_CREA" msprop:Generator_ColumnPropNameInRow="USUARIO_CREA" msprop:Generator_ColumnPropNameInTable="USUARIO_CREAColumn" msprop:Generator_UserColumnName="USUARIO_CREA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_CREA" msprop:Generator_ColumnVarNameInTable="columnFECHA_CREA" msprop:Generator_ColumnPropNameInRow="FECHA_CREA" msprop:Generator_ColumnPropNameInTable="FECHA_CREAColumn" msprop:Generator_UserColumnName="FECHA_CREA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="USUARIO_ACT" msprop:Generator_ColumnVarNameInTable="columnUSUARIO_ACT" msprop:Generator_ColumnPropNameInRow="USUARIO_ACT" msprop:Generator_ColumnPropNameInTable="USUARIO_ACTColumn" msprop:Generator_UserColumnName="USUARIO_ACT" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA_ACT" msprop:Generator_ColumnVarNameInTable="columnFECHA_ACT" msprop:Generator_ColumnPropNameInRow="FECHA_ACT" msprop:Generator_ColumnPropNameInTable="FECHA_ACTColumn" msprop:Generator_UserColumnName="FECHA_ACT" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NOMBRE_CUENTA" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_CUENTA" msprop:Generator_ColumnPropNameInRow="NOMBRE_CUENTA" msprop:Generator_ColumnPropNameInTable="NOMBRE_CUENTAColumn" msprop:Generator_UserColumnName="NOMBRE_CUENTA" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="INVENTARIO_CANA" msprop:Generator_TableClassName="INVENTARIO_CANADataTable" msprop:Generator_TableVarName="tableINVENTARIO_CANA" msprop:Generator_RowChangedName="INVENTARIO_CANARowChanged" msprop:Generator_TablePropName="INVENTARIO_CANA" msprop:Generator_RowDeletingName="INVENTARIO_CANARowDeleting" msprop:Generator_RowChangingName="INVENTARIO_CANARowChanging" msprop:Generator_RowEvHandlerName="INVENTARIO_CANARowChangeEventHandler" msprop:Generator_RowDeletedName="INVENTARIO_CANARowDeleted" msprop:Generator_RowClassName="INVENTARIO_CANARow" msprop:Generator_UserTableName="INVENTARIO_CANA" msprop:Generator_RowEvArgName="INVENTARIO_CANARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ORDEN" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnORDEN" msprop:Generator_ColumnPropNameInRow="ORDEN" msprop:Generator_ColumnPropNameInTable="ORDENColumn" msprop:Generator_UserColumnName="ORDEN" type="xs:int" minOccurs="0" />
              <xs:element name="ES_ENCA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnES_ENCA" msprop:Generator_ColumnPropNameInRow="ES_ENCA" msprop:Generator_ColumnPropNameInTable="ES_ENCAColumn" msprop:Generator_UserColumnName="ES_ENCA" type="xs:int" minOccurs="0" />
              <xs:element name="DESCRIP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP" msprop:Generator_ColumnPropNameInRow="DESCRIP" msprop:Generator_ColumnPropNameInTable="DESCRIPColumn" msprop:Generator_UserColumnName="DESCRIP" type="xs:string" minOccurs="0" />
              <xs:element name="MONTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMONTO" msprop:Generator_ColumnPropNameInRow="MONTO" msprop:Generator_ColumnPropNameInTable="MONTOColumn" msprop:Generator_UserColumnName="MONTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="UNI_CAMION7" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnUNI_CAMION7" msprop:Generator_ColumnPropNameInRow="UNI_CAMION7" msprop:Generator_ColumnPropNameInTable="UNI_CAMION7Column" msprop:Generator_UserColumnName="UNI_CAMION7" type="xs:int" minOccurs="0" />
              <xs:element name="TC_CAMION7" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_CAMION7" msprop:Generator_ColumnPropNameInRow="TC_CAMION7" msprop:Generator_ColumnPropNameInTable="TC_CAMION7Column" msprop:Generator_UserColumnName="TC_CAMION7" type="xs:decimal" minOccurs="0" />
              <xs:element name="UNI_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnUNI_CAMION" msprop:Generator_ColumnPropNameInRow="UNI_CAMION" msprop:Generator_ColumnPropNameInTable="UNI_CAMIONColumn" msprop:Generator_UserColumnName="UNI_CAMION" type="xs:int" minOccurs="0" />
              <xs:element name="TC_CAMION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_CAMION" msprop:Generator_ColumnPropNameInRow="TC_CAMION" msprop:Generator_ColumnPropNameInTable="TC_CAMIONColumn" msprop:Generator_UserColumnName="TC_CAMION" type="xs:decimal" minOccurs="0" />
              <xs:element name="UNI_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnUNI_3EJES" msprop:Generator_ColumnPropNameInRow="UNI_3EJES" msprop:Generator_ColumnPropNameInTable="UNI_3EJESColumn" msprop:Generator_UserColumnName="UNI_3EJES" type="xs:int" minOccurs="0" />
              <xs:element name="TC_3EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_3EJES" msprop:Generator_ColumnPropNameInRow="TC_3EJES" msprop:Generator_ColumnPropNameInTable="TC_3EJESColumn" msprop:Generator_UserColumnName="TC_3EJES" type="xs:decimal" minOccurs="0" />
              <xs:element name="UNI_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnUNI_RASTRA" msprop:Generator_ColumnPropNameInRow="UNI_RASTRA" msprop:Generator_ColumnPropNameInTable="UNI_RASTRAColumn" msprop:Generator_UserColumnName="UNI_RASTRA" type="xs:int" minOccurs="0" />
              <xs:element name="TC_RASTRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_RASTRA" msprop:Generator_ColumnPropNameInRow="TC_RASTRA" msprop:Generator_ColumnPropNameInTable="TC_RASTRAColumn" msprop:Generator_UserColumnName="TC_RASTRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="N1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnN1" msprop:Generator_ColumnPropNameInRow="N1" msprop:Generator_ColumnPropNameInTable="N1Column" msprop:Generator_UserColumnName="N1" type="xs:decimal" minOccurs="0" />
              <xs:element name="N2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnN2" msprop:Generator_ColumnPropNameInRow="N2" msprop:Generator_ColumnPropNameInTable="N2Column" msprop:Generator_UserColumnName="N2" type="xs:decimal" minOccurs="0" />
              <xs:element name="N3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnN3" msprop:Generator_ColumnPropNameInRow="N3" msprop:Generator_ColumnPropNameInTable="N3Column" msprop:Generator_UserColumnName="N3" type="xs:decimal" minOccurs="0" />
              <xs:element name="S1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnS1" msprop:Generator_ColumnPropNameInRow="S1" msprop:Generator_ColumnPropNameInTable="S1Column" msprop:Generator_UserColumnName="S1" type="xs:decimal" minOccurs="0" />
              <xs:element name="S2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnS2" msprop:Generator_ColumnPropNameInRow="S2" msprop:Generator_ColumnPropNameInTable="S2Column" msprop:Generator_UserColumnName="S2" type="xs:decimal" minOccurs="0" />
              <xs:element name="S3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnS3" msprop:Generator_ColumnPropNameInRow="S3" msprop:Generator_ColumnPropNameInTable="S3Column" msprop:Generator_UserColumnName="S3" type="xs:decimal" minOccurs="0" />
              <xs:element name="S4" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnS4" msprop:Generator_ColumnPropNameInRow="S4" msprop:Generator_ColumnPropNameInTable="S4Column" msprop:Generator_UserColumnName="S4" type="xs:decimal" minOccurs="0" />
              <xs:element name="UNI_4EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnUNI_4EJES" msprop:Generator_ColumnPropNameInRow="UNI_4EJES" msprop:Generator_ColumnPropNameInTable="UNI_4EJESColumn" msprop:Generator_UserColumnName="UNI_4EJES" type="xs:int" minOccurs="0" />
              <xs:element name="TC_4EJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_4EJES" msprop:Generator_ColumnPropNameInRow="TC_4EJES" msprop:Generator_ColumnPropNameInTable="TC_4EJESColumn" msprop:Generator_UserColumnName="TC_4EJES" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="INVENTARIO_ROZA_DIARIA" msprop:Generator_TableClassName="INVENTARIO_ROZA_DIARIADataTable" msprop:Generator_TableVarName="tableINVENTARIO_ROZA_DIARIA" msprop:Generator_TablePropName="INVENTARIO_ROZA_DIARIA" msprop:Generator_RowDeletingName="INVENTARIO_ROZA_DIARIARowDeleting" msprop:Generator_RowChangingName="INVENTARIO_ROZA_DIARIARowChanging" msprop:Generator_RowEvHandlerName="INVENTARIO_ROZA_DIARIARowChangeEventHandler" msprop:Generator_RowDeletedName="INVENTARIO_ROZA_DIARIARowDeleted" msprop:Generator_UserTableName="INVENTARIO_ROZA_DIARIA" msprop:Generator_RowChangedName="INVENTARIO_ROZA_DIARIARowChanged" msprop:Generator_RowEvArgName="INVENTARIO_ROZA_DIARIARowChangeEvent" msprop:Generator_RowClassName="INVENTARIO_ROZA_DIARIARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_ACUM" msprop:Generator_ColumnPropNameInRow="ROZA_ACUM" msprop:Generator_ColumnPropNameInTable="ROZA_ACUMColumn" msprop:Generator_UserColumnName="ROZA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_DIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_DIA" msprop:Generator_ColumnPropNameInRow="ROZA_DIA" msprop:Generator_ColumnPropNameInTable="ROZA_DIAColumn" msprop:Generator_UserColumnName="ROZA_DIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_TOTAL" msprop:Generator_ColumnPropNameInRow="ROZA_TOTAL" msprop:Generator_ColumnPropNameInTable="ROZA_TOTALColumn" msprop:Generator_UserColumnName="ROZA_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_ROZA" msprop:Generator_ColumnPropNameInRow="SALDO_ROZA" msprop:Generator_ColumnPropNameInTable="SALDO_ROZAColumn" msprop:Generator_UserColumnName="SALDO_ROZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QP_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQP_CORTA" msprop:Generator_ColumnPropNameInRow="QP_CORTA" msprop:Generator_ColumnPropNameInTable="QP_CORTAColumn" msprop:Generator_UserColumnName="QP_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QP_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQP_LARGA" msprop:Generator_ColumnPropNameInRow="QP_LARGA" msprop:Generator_ColumnPropNameInTable="QP_LARGAColumn" msprop:Generator_UserColumnName="QP_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QP_MECA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQP_MECA" msprop:Generator_ColumnPropNameInRow="QP_MECA" msprop:Generator_ColumnPropNameInTable="QP_MECAColumn" msprop:Generator_UserColumnName="QP_MECA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QNP_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQNP_CORTA" msprop:Generator_ColumnPropNameInRow="QNP_CORTA" msprop:Generator_ColumnPropNameInTable="QNP_CORTAColumn" msprop:Generator_UserColumnName="QNP_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QNP_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQNP_LARGA" msprop:Generator_ColumnPropNameInRow="QNP_LARGA" msprop:Generator_ColumnPropNameInTable="QNP_LARGAColumn" msprop:Generator_UserColumnName="QNP_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QNP_MECA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQNP_MECA" msprop:Generator_ColumnPropNameInRow="QNP_MECA" msprop:Generator_ColumnPropNameInTable="QNP_MECAColumn" msprop:Generator_UserColumnName="QNP_MECA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_CORTA" msprop:Generator_ColumnPropNameInRow="VERDE_CORTA" msprop:Generator_ColumnPropNameInTable="VERDE_CORTAColumn" msprop:Generator_UserColumnName="VERDE_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_LARGA" msprop:Generator_ColumnPropNameInRow="VERDE_LARGA" msprop:Generator_ColumnPropNameInTable="VERDE_LARGAColumn" msprop:Generator_UserColumnName="VERDE_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_MECA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_MECA" msprop:Generator_ColumnPropNameInRow="VERDE_MECA" msprop:Generator_ColumnPropNameInTable="VERDE_MECAColumn" msprop:Generator_UserColumnName="VERDE_MECA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CUOTA_DIARIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCUOTA_DIARIA" msprop:Generator_ColumnPropNameInRow="CUOTA_DIARIA" msprop:Generator_ColumnPropNameInTable="CUOTA_DIARIAColumn" msprop:Generator_UserColumnName="CUOTA_DIARIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MOLIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MOLIDA" msprop:Generator_ColumnPropNameInRow="TC_MOLIDA" msprop:Generator_ColumnPropNameInTable="TC_MOLIDAColumn" msprop:Generator_UserColumnName="TC_MOLIDA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="INVENTARIO_ROZA_DIARIA_PROVEEDOR" msprop:Generator_TableClassName="INVENTARIO_ROZA_DIARIA_PROVEEDORDataTable" msprop:Generator_TableVarName="tableINVENTARIO_ROZA_DIARIA_PROVEEDOR" msprop:Generator_TablePropName="INVENTARIO_ROZA_DIARIA_PROVEEDOR" msprop:Generator_RowDeletingName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowDeleting" msprop:Generator_RowChangingName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowChanging" msprop:Generator_RowEvHandlerName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowChangeEventHandler" msprop:Generator_RowDeletedName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowDeleted" msprop:Generator_UserTableName="INVENTARIO_ROZA_DIARIA_PROVEEDOR" msprop:Generator_RowChangedName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowChanged" msprop:Generator_RowEvArgName="INVENTARIO_ROZA_DIARIA_PROVEEDORRowChangeEvent" msprop:Generator_RowClassName="INVENTARIO_ROZA_DIARIA_PROVEEDORRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ACCESLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODI_PROVEEDOR_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODI_PROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInRow="CODI_PROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInTable="CODI_PROVEEDOR_ROZAColumn" msprop:Generator_UserColumnName="CODI_PROVEEDOR_ROZA" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInRow="PROVEEDOR_ROZA" msprop:Generator_ColumnPropNameInTable="PROVEEDOR_ROZAColumn" msprop:Generator_UserColumnName="PROVEEDOR_ROZA" type="xs:string" minOccurs="0" />
              <xs:element name="TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC" msprop:Generator_ColumnPropNameInRow="TC" msprop:Generator_ColumnPropNameInTable="TCColumn" msprop:Generator_UserColumnName="TC" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="INVENTARIO_ROZA_SALDOS" msprop:Generator_TableClassName="INVENTARIO_ROZA_SALDOSDataTable" msprop:Generator_TableVarName="tableINVENTARIO_ROZA_SALDOS" msprop:Generator_RowChangedName="INVENTARIO_ROZA_SALDOSRowChanged" msprop:Generator_TablePropName="INVENTARIO_ROZA_SALDOS" msprop:Generator_RowDeletingName="INVENTARIO_ROZA_SALDOSRowDeleting" msprop:Generator_RowChangingName="INVENTARIO_ROZA_SALDOSRowChanging" msprop:Generator_RowEvHandlerName="INVENTARIO_ROZA_SALDOSRowChangeEventHandler" msprop:Generator_RowDeletedName="INVENTARIO_ROZA_SALDOSRowDeleted" msprop:Generator_RowClassName="INVENTARIO_ROZA_SALDOSRow" msprop:Generator_UserTableName="INVENTARIO_ROZA_SALDOS" msprop:Generator_RowEvArgName="INVENTARIO_ROZA_SALDOSRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CUOTA_DIARIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCUOTA_DIARIA" msprop:Generator_ColumnPropNameInRow="CUOTA_DIARIA" msprop:Generator_ColumnPropNameInTable="CUOTA_DIARIAColumn" msprop:Generator_UserColumnName="CUOTA_DIARIA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MOLIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MOLIDA" msprop:Generator_ColumnPropNameInRow="TC_MOLIDA" msprop:Generator_ColumnPropNameInTable="TC_MOLIDAColumn" msprop:Generator_UserColumnName="TC_MOLIDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HORAS_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_QUEMA" msprop:Generator_ColumnPropNameInRow="HORAS_QUEMA" msprop:Generator_ColumnPropNameInTable="HORAS_QUEMAColumn" msprop:Generator_UserColumnName="HORAS_QUEMA" type="xs:int" minOccurs="0" />
              <xs:element name="HORAS_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnHORAS_ROZA" msprop:Generator_ColumnPropNameInRow="HORAS_ROZA" msprop:Generator_ColumnPropNameInTable="HORAS_ROZAColumn" msprop:Generator_UserColumnName="HORAS_ROZA" type="xs:int" minOccurs="0" />
              <xs:element name="TONEL_CENSO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONEL_CENSO" msprop:Generator_ColumnPropNameInRow="TONEL_CENSO" msprop:Generator_ColumnPropNameInTable="TONEL_CENSOColumn" msprop:Generator_UserColumnName="TONEL_CENSO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_ACUM" msprop:Generator_ColumnPropNameInRow="ROZA_ACUM" msprop:Generator_ColumnPropNameInTable="ROZA_ACUMColumn" msprop:Generator_UserColumnName="ROZA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_ROZA" msprop:Generator_ColumnPropNameInRow="SALDO_ROZA" msprop:Generator_ColumnPropNameInTable="SALDO_ROZAColumn" msprop:Generator_UserColumnName="SALDO_ROZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="INVEN_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnINVEN_TOTAL" msprop:Generator_ColumnPropNameInRow="INVEN_TOTAL" msprop:Generator_ColumnPropNameInTable="INVEN_TOTALColumn" msprop:Generator_UserColumnName="INVEN_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_QUEMA" msprop:Generator_ColumnPropNameInRow="TOTAL_QUEMA" msprop:Generator_ColumnPropNameInTable="TOTAL_QUEMAColumn" msprop:Generator_UserColumnName="TOTAL_QUEMA" type="xs:decimal" minOccurs="0" />
              <xs:element name="QUEMA_PROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQUEMA_PROG" msprop:Generator_ColumnPropNameInRow="QUEMA_PROG" msprop:Generator_ColumnPropNameInTable="QUEMA_PROGColumn" msprop:Generator_UserColumnName="QUEMA_PROG" type="xs:decimal" minOccurs="0" />
              <xs:element name="QUEMA_NOPROG" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQUEMA_NOPROG" msprop:Generator_ColumnPropNameInRow="QUEMA_NOPROG" msprop:Generator_ColumnPropNameInTable="QUEMA_NOPROGColumn" msprop:Generator_UserColumnName="QUEMA_NOPROG" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_ROZA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_ROZA" msprop:Generator_ColumnPropNameInRow="TOTAL_ROZA" msprop:Generator_ColumnPropNameInTable="TOTAL_ROZAColumn" msprop:Generator_UserColumnName="TOTAL_ROZA" type="xs:decimal" minOccurs="0" />
              <xs:element name="Q_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQ_CORTA" msprop:Generator_ColumnPropNameInRow="Q_CORTA" msprop:Generator_ColumnPropNameInTable="Q_CORTAColumn" msprop:Generator_UserColumnName="Q_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="Q_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQ_LARGA" msprop:Generator_ColumnPropNameInRow="Q_LARGA" msprop:Generator_ColumnPropNameInTable="Q_LARGAColumn" msprop:Generator_UserColumnName="Q_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="Q_MECA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQ_MECA" msprop:Generator_ColumnPropNameInRow="Q_MECA" msprop:Generator_ColumnPropNameInTable="Q_MECAColumn" msprop:Generator_UserColumnName="Q_MECA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_CORTA" msprop:Generator_ColumnPropNameInRow="VERDE_CORTA" msprop:Generator_ColumnPropNameInTable="VERDE_CORTAColumn" msprop:Generator_UserColumnName="VERDE_CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_LARGA" msprop:Generator_ColumnPropNameInRow="VERDE_LARGA" msprop:Generator_ColumnPropNameInTable="VERDE_LARGAColumn" msprop:Generator_UserColumnName="VERDE_LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="VERDE_MECA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVERDE_MECA" msprop:Generator_ColumnPropNameInRow="VERDE_MECA" msprop:Generator_ColumnPropNameInTable="VERDE_MECAColumn" msprop:Generator_UserColumnName="VERDE_MECA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ANALISIS_VMT" msprop:Generator_TableClassName="ANALISIS_VMTDataTable" msprop:Generator_TableVarName="tableANALISIS_VMT" msprop:Generator_TablePropName="ANALISIS_VMT" msprop:Generator_RowDeletingName="ANALISIS_VMTRowDeleting" msprop:Generator_RowChangingName="ANALISIS_VMTRowChanging" msprop:Generator_RowEvHandlerName="ANALISIS_VMTRowChangeEventHandler" msprop:Generator_RowDeletedName="ANALISIS_VMTRowDeleted" msprop:Generator_UserTableName="ANALISIS_VMT" msprop:Generator_RowChangedName="ANALISIS_VMTRowChanged" msprop:Generator_RowEvArgName="ANALISIS_VMTRowChangeEvent" msprop:Generator_RowClassName="ANALISIS_VMTRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="REGULADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGULADO" msprop:Generator_ColumnPropNameInRow="REGULADO" msprop:Generator_ColumnPropNameInTable="REGULADOColumn" msprop:Generator_UserColumnName="REGULADO" type="xs:string" minOccurs="0" />
              <xs:element name="VEHICULO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVEHICULO" msprop:Generator_ColumnPropNameInRow="VEHICULO" msprop:Generator_ColumnPropNameInTable="VEHICULOColumn" msprop:Generator_UserColumnName="VEHICULO" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" type="xs:string" minOccurs="0" />
              <xs:element name="DESCRIP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP" msprop:Generator_ColumnPropNameInRow="DESCRIP" msprop:Generator_ColumnPropNameInTable="DESCRIPColumn" msprop:Generator_UserColumnName="DESCRIP" type="xs:string" minOccurs="0" />
              <xs:element name="TIPO_QUEMA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_QUEMA" msprop:Generator_ColumnPropNameInRow="TIPO_QUEMA" msprop:Generator_ColumnPropNameInTable="TIPO_QUEMAColumn" msprop:Generator_UserColumnName="TIPO_QUEMA" type="xs:string" minOccurs="0" />
              <xs:element name="VMT_RESO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVMT_RESO" msprop:Generator_ColumnPropNameInRow="VMT_RESO" msprop:Generator_ColumnPropNameInTable="VMT_RESOColumn" msprop:Generator_UserColumnName="VMT_RESO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_BRUTO" msprop:Generator_ColumnPropNameInRow="TC_BRUTO" msprop:Generator_ColumnPropNameInTable="TC_BRUTOColumn" msprop:Generator_UserColumnName="TC_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_NETO" msprop:Generator_ColumnPropNameInRow="TC_NETO" msprop:Generator_ColumnPropNameInTable="TC_NETOColumn" msprop:Generator_UserColumnName="TC_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="NO_VIAJES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_VIAJES" msprop:Generator_ColumnPropNameInRow="NO_VIAJES" msprop:Generator_ColumnPropNameInTable="NO_VIAJESColumn" msprop:Generator_UserColumnName="NO_VIAJES" type="xs:int" minOccurs="0" />
              <xs:element name="PROM_TC_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROM_TC_BRUTO" msprop:Generator_ColumnPropNameInRow="PROM_TC_BRUTO" msprop:Generator_ColumnPropNameInTable="PROM_TC_BRUTOColumn" msprop:Generator_UserColumnName="PROM_TC_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="PROM_TC_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROM_TC_NETO" msprop:Generator_ColumnPropNameInRow="PROM_TC_NETO" msprop:Generator_ColumnPropNameInTable="PROM_TC_NETOColumn" msprop:Generator_UserColumnName="PROM_TC_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_SOBREPESO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_SOBREPESO" msprop:Generator_ColumnPropNameInRow="TC_SOBREPESO" msprop:Generator_ColumnPropNameInTable="TC_SOBREPESOColumn" msprop:Generator_UserColumnName="TC_SOBREPESO" type="xs:decimal" minOccurs="0" />
              <xs:element name="SOBRE_PESO_PORC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSOBRE_PESO_PORC" msprop:Generator_ColumnPropNameInRow="SOBRE_PESO_PORC" msprop:Generator_ColumnPropNameInTable="SOBRE_PESO_PORCColumn" msprop:Generator_UserColumnName="SOBRE_PESO_PORC" type="xs:decimal" minOccurs="0" />
              <xs:element name="RANGO1_2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO1_2" msprop:Generator_ColumnPropNameInRow="RANGO1_2" msprop:Generator_ColumnPropNameInTable="RANGO1_2Column" msprop:Generator_UserColumnName="RANGO1_2" type="xs:int" minOccurs="0" />
              <xs:element name="RANGO3_4" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO3_4" msprop:Generator_ColumnPropNameInRow="RANGO3_4" msprop:Generator_ColumnPropNameInTable="RANGO3_4Column" msprop:Generator_UserColumnName="RANGO3_4" type="xs:int" minOccurs="0" />
              <xs:element name="RANGO5_6" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO5_6" msprop:Generator_ColumnPropNameInRow="RANGO5_6" msprop:Generator_ColumnPropNameInTable="RANGO5_6Column" msprop:Generator_UserColumnName="RANGO5_6" type="xs:int" minOccurs="0" />
              <xs:element name="RANGO7_8" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO7_8" msprop:Generator_ColumnPropNameInRow="RANGO7_8" msprop:Generator_ColumnPropNameInTable="RANGO7_8Column" msprop:Generator_UserColumnName="RANGO7_8" type="xs:int" minOccurs="0" />
              <xs:element name="RANGO9_10" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRANGO9_10" msprop:Generator_ColumnPropNameInRow="RANGO9_10" msprop:Generator_ColumnPropNameInTable="RANGO9_10Column" msprop:Generator_UserColumnName="RANGO9_10" type="xs:int" minOccurs="0" />
              <xs:element name="TIPO_DESCRIP_PROM_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_DESCRIP_PROM_BRUTO" msprop:Generator_ColumnPropNameInRow="TIPO_DESCRIP_PROM_BRUTO" msprop:Generator_ColumnPropNameInTable="TIPO_DESCRIP_PROM_BRUTOColumn" msprop:Generator_UserColumnName="TIPO_DESCRIP_PROM_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_DESCRIP_TC_SOBREPESO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_DESCRIP_TC_SOBREPESO" msprop:Generator_ColumnPropNameInRow="TIPO_DESCRIP_TC_SOBREPESO" msprop:Generator_ColumnPropNameInTable="TIPO_DESCRIP_TC_SOBREPESOColumn" msprop:Generator_UserColumnName="TIPO_DESCRIP_TC_SOBREPESO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_DESCRIP_SOBREPESO_PORC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_DESCRIP_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInRow="TIPO_DESCRIP_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInTable="TIPO_DESCRIP_SOBREPESO_PORCColumn" msprop:Generator_UserColumnName="TIPO_DESCRIP_SOBREPESO_PORC" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_DESCRIP_PROM_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_DESCRIP_PROM_NETO" msprop:Generator_ColumnPropNameInRow="TIPO_DESCRIP_PROM_NETO" msprop:Generator_ColumnPropNameInTable="TIPO_DESCRIP_PROM_NETOColumn" msprop:Generator_UserColumnName="TIPO_DESCRIP_PROM_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_PROM_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_PROM_BRUTO" msprop:Generator_ColumnPropNameInRow="TIPO_PROM_BRUTO" msprop:Generator_ColumnPropNameInTable="TIPO_PROM_BRUTOColumn" msprop:Generator_UserColumnName="TIPO_PROM_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_TC_SOBREPESO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_TC_SOBREPESO" msprop:Generator_ColumnPropNameInRow="TIPO_TC_SOBREPESO" msprop:Generator_ColumnPropNameInTable="TIPO_TC_SOBREPESOColumn" msprop:Generator_UserColumnName="TIPO_TC_SOBREPESO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_SOBREPESO_PORC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInRow="TIPO_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInTable="TIPO_SOBREPESO_PORCColumn" msprop:Generator_UserColumnName="TIPO_SOBREPESO_PORC" type="xs:decimal" minOccurs="0" />
              <xs:element name="TIPO_PROM_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO_PROM_NETO" msprop:Generator_ColumnPropNameInRow="TIPO_PROM_NETO" msprop:Generator_ColumnPropNameInTable="TIPO_PROM_NETOColumn" msprop:Generator_UserColumnName="TIPO_PROM_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REGULADO_PROM_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGULADO_PROM_BRUTO" msprop:Generator_ColumnPropNameInRow="REGULADO_PROM_BRUTO" msprop:Generator_ColumnPropNameInTable="REGULADO_PROM_BRUTOColumn" msprop:Generator_UserColumnName="REGULADO_PROM_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REGULADO_TC_SOBREPESO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGULADO_TC_SOBREPESO" msprop:Generator_ColumnPropNameInRow="REGULADO_TC_SOBREPESO" msprop:Generator_ColumnPropNameInTable="REGULADO_TC_SOBREPESOColumn" msprop:Generator_UserColumnName="REGULADO_TC_SOBREPESO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REGULADO_SOBREPESO_PORC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGULADO_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInRow="REGULADO_SOBREPESO_PORC" msprop:Generator_ColumnPropNameInTable="REGULADO_SOBREPESO_PORCColumn" msprop:Generator_UserColumnName="REGULADO_SOBREPESO_PORC" type="xs:decimal" minOccurs="0" />
              <xs:element name="REGULADO_PROM_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREGULADO_PROM_NETO" msprop:Generator_ColumnPropNameInRow="REGULADO_PROM_NETO" msprop:Generator_ColumnPropNameInTable="REGULADO_PROM_NETOColumn" msprop:Generator_UserColumnName="REGULADO_PROM_NETO" type="xs:decimal" minOccurs="0" />
              <xs:element name="GRANTOTAL_PROM_BRUTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnGRANTOTAL_PROM_BRUTO" msprop:Generator_ColumnPropNameInRow="GRANTOTAL_PROM_BRUTO" msprop:Generator_ColumnPropNameInTable="GRANTOTAL_PROM_BRUTOColumn" msprop:Generator_UserColumnName="GRANTOTAL_PROM_BRUTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="GRANTOTAL_PROM_NETO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnGRANTOTAL_PROM_NETO" msprop:Generator_ColumnPropNameInRow="GRANTOTAL_PROM_NETO" msprop:Generator_ColumnPropNameInTable="GRANTOTAL_PROM_NETOColumn" msprop:Generator_UserColumnName="GRANTOTAL_PROM_NETO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="INVENTARIO_CANA_SEGUINTEGRAL" msprop:Generator_TableClassName="INVENTARIO_CANA_SEGUINTEGRALDataTable" msprop:Generator_TableVarName="tableINVENTARIO_CANA_SEGUINTEGRAL" msprop:Generator_RowChangedName="INVENTARIO_CANA_SEGUINTEGRALRowChanged" msprop:Generator_TablePropName="INVENTARIO_CANA_SEGUINTEGRAL" msprop:Generator_RowDeletingName="INVENTARIO_CANA_SEGUINTEGRALRowDeleting" msprop:Generator_RowChangingName="INVENTARIO_CANA_SEGUINTEGRALRowChanging" msprop:Generator_RowEvHandlerName="INVENTARIO_CANA_SEGUINTEGRALRowChangeEventHandler" msprop:Generator_RowDeletedName="INVENTARIO_CANA_SEGUINTEGRALRowDeleted" msprop:Generator_RowClassName="INVENTARIO_CANA_SEGUINTEGRALRow" msprop:Generator_UserTableName="INVENTARIO_CANA_SEGUINTEGRAL" msprop:Generator_RowEvArgName="INVENTARIO_CANA_SEGUINTEGRALRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="ESTADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnESTADO" msprop:Generator_ColumnPropNameInRow="ESTADO" msprop:Generator_ColumnPropNameInTable="ESTADOColumn" msprop:Generator_UserColumnName="ESTADO" type="xs:string" minOccurs="0" />
              <xs:element name="TC_ESTICANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_ESTICANA" msprop:Generator_ColumnPropNameInRow="TC_ESTICANA" msprop:Generator_ColumnPropNameInTable="TC_ESTICANAColumn" msprop:Generator_UserColumnName="TC_ESTICANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MOLIDA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MOLIDA_ACUM" msprop:Generator_ColumnPropNameInRow="TC_MOLIDA_ACUM" msprop:Generator_ColumnPropNameInTable="TC_MOLIDA_ACUMColumn" msprop:Generator_UserColumnName="TC_MOLIDA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_X_MOLER" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_X_MOLER" msprop:Generator_ColumnPropNameInRow="SALDO_X_MOLER" msprop:Generator_ColumnPropNameInTable="SALDO_X_MOLERColumn" msprop:Generator_UserColumnName="SALDO_X_MOLER" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_ACUM" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_ACUM" msprop:Generator_ColumnPropNameInRow="ROZA_ACUM" msprop:Generator_ColumnPropNameInTable="ROZA_ACUMColumn" msprop:Generator_UserColumnName="ROZA_ACUM" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_X_ROZAR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_X_ROZAR" msprop:Generator_ColumnPropNameInRow="SALDO_X_ROZAR" msprop:Generator_ColumnPropNameInTable="SALDO_X_ROZARColumn" msprop:Generator_UserColumnName="SALDO_X_ROZAR" type="xs:decimal" minOccurs="0" />
              <xs:element name="SDO_1_2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSDO_1_2" msprop:Generator_ColumnPropNameInRow="SDO_1_2" msprop:Generator_ColumnPropNameInTable="SDO_1_2Column" msprop:Generator_UserColumnName="SDO_1_2" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALDO_AJUSTADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALDO_AJUSTADO" msprop:Generator_ColumnPropNameInRow="SALDO_AJUSTADO" msprop:Generator_ColumnPropNameInTable="SALDO_AJUSTADOColumn" msprop:Generator_UserColumnName="SALDO_AJUSTADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="INVE_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnINVE_TOTAL" msprop:Generator_ColumnPropNameInRow="INVE_TOTAL" msprop:Generator_ColumnPropNameInTable="INVE_TOTALColumn" msprop:Generator_UserColumnName="INVE_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_PIE_ROZA_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_PIE_ROZA_TOTAL" msprop:Generator_ColumnPropNameInRow="CANA_PIE_ROZA_TOTAL" msprop:Generator_ColumnPropNameInTable="CANA_PIE_ROZA_TOTALColumn" msprop:Generator_UserColumnName="CANA_PIE_ROZA_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="QUEMA_SALDO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQUEMA_SALDO" msprop:Generator_ColumnPropNameInRow="QUEMA_SALDO" msprop:Generator_ColumnPropNameInTable="QUEMA_SALDOColumn" msprop:Generator_UserColumnName="QUEMA_SALDO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_VERDE_SALDO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_VERDE_SALDO" msprop:Generator_ColumnPropNameInRow="CANA_VERDE_SALDO" msprop:Generator_ColumnPropNameInTable="CANA_VERDE_SALDOColumn" msprop:Generator_UserColumnName="CANA_VERDE_SALDO" type="xs:decimal" minOccurs="0" />
              <xs:element name="ROZA_SALDO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnROZA_SALDO" msprop:Generator_ColumnPropNameInRow="ROZA_SALDO" msprop:Generator_ColumnPropNameInTable="ROZA_SALDOColumn" msprop:Generator_UserColumnName="ROZA_SALDO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_TRANSPO_TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_TRANSPO_TOTAL" msprop:Generator_ColumnPropNameInRow="CANA_TRANSPO_TOTAL" msprop:Generator_ColumnPropNameInTable="CANA_TRANSPO_TOTALColumn" msprop:Generator_UserColumnName="CANA_TRANSPO_TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_TRANSITO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_TRANSITO" msprop:Generator_ColumnPropNameInRow="CANA_TRANSITO" msprop:Generator_ColumnPropNameInTable="CANA_TRANSITOColumn" msprop:Generator_UserColumnName="CANA_TRANSITO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_RUEDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_RUEDA" msprop:Generator_ColumnPropNameInRow="CANA_RUEDA" msprop:Generator_ColumnPropNameInTable="CANA_RUEDAColumn" msprop:Generator_UserColumnName="CANA_RUEDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CANA_PATIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANA_PATIO" msprop:Generator_ColumnPropNameInRow="CANA_PATIO" msprop:Generator_ColumnPropNameInTable="CANA_PATIOColumn" msprop:Generator_UserColumnName="CANA_PATIO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ANALISIS_LAB_PROVEEDOR" msprop:Generator_TableClassName="ANALISIS_LAB_PROVEEDORDataTable" msprop:Generator_TableVarName="tableANALISIS_LAB_PROVEEDOR" msprop:Generator_TablePropName="ANALISIS_LAB_PROVEEDOR" msprop:Generator_RowDeletingName="ANALISIS_LAB_PROVEEDORRowDeleting" msprop:Generator_RowChangingName="ANALISIS_LAB_PROVEEDORRowChanging" msprop:Generator_RowEvHandlerName="ANALISIS_LAB_PROVEEDORRowChangeEventHandler" msprop:Generator_RowDeletedName="ANALISIS_LAB_PROVEEDORRowDeleted" msprop:Generator_UserTableName="ANALISIS_LAB_PROVEEDOR" msprop:Generator_RowChangedName="ANALISIS_LAB_PROVEEDORRowChanged" msprop:Generator_RowEvArgName="ANALISIS_LAB_PROVEEDORRowChangeEvent" msprop:Generator_RowClassName="ANALISIS_LAB_PROVEEDORRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="ACCESLOTE" msprop:Generator_ColumnVarNameInTable="columnACCESLOTE" msprop:Generator_ColumnPropNameInRow="ACCESLOTE" msprop:Generator_ColumnPropNameInTable="ACCESLOTEColumn" msprop:Generator_UserColumnName="ACCESLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:int" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="VARIEDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVARIEDAD" msprop:Generator_ColumnPropNameInRow="VARIEDAD" msprop:Generator_ColumnPropNameInTable="VARIEDADColumn" msprop:Generator_UserColumnName="VARIEDAD" type="xs:string" minOccurs="0" />
              <xs:element name="EDAD_LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnEDAD_LOTE" msprop:Generator_ColumnPropNameInRow="EDAD_LOTE" msprop:Generator_ColumnPropNameInTable="EDAD_LOTEColumn" msprop:Generator_UserColumnName="EDAD_LOTE" type="xs:int" minOccurs="0" />
              <xs:element name="FECHA_LEE_TARA" msprop:Generator_ColumnVarNameInTable="columnFECHA_LEE_TARA" msprop:Generator_ColumnPropNameInRow="FECHA_LEE_TARA" msprop:Generator_ColumnPropNameInTable="FECHA_LEE_TARAColumn" msprop:Generator_UserColumnName="FECHA_LEE_TARA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="COMPTENVIO" msprop:Generator_ColumnVarNameInTable="columnCOMPTENVIO" msprop:Generator_ColumnPropNameInRow="COMPTENVIO" msprop:Generator_ColumnPropNameInTable="COMPTENVIOColumn" msprop:Generator_UserColumnName="COMPTENVIO" type="xs:int" minOccurs="0" />
              <xs:element name="NROBOLETA" msprop:Generator_ColumnVarNameInTable="columnNROBOLETA" msprop:Generator_ColumnPropNameInRow="NROBOLETA" msprop:Generator_ColumnPropNameInTable="NROBOLETAColumn" msprop:Generator_UserColumnName="NROBOLETA" type="xs:int" minOccurs="0" />
              <xs:element name="NUMRECIBO_CANA" msprop:Generator_ColumnVarNameInTable="columnNUMRECIBO_CANA" msprop:Generator_ColumnPropNameInRow="NUMRECIBO_CANA" msprop:Generator_ColumnPropNameInTable="NUMRECIBO_CANAColumn" msprop:Generator_UserColumnName="NUMRECIBO_CANA" type="xs:int" minOccurs="0" />
              <xs:element name="NETOTONEL" msprop:Generator_ColumnVarNameInTable="columnNETOTONEL" msprop:Generator_ColumnPropNameInRow="NETOTONEL" msprop:Generator_ColumnPropNameInTable="NETOTONELColumn" msprop:Generator_UserColumnName="NETOTONEL" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_85" msprop:Generator_ColumnVarNameInTable="columnREND_85" msprop:Generator_ColumnPropNameInRow="REND_85" msprop:Generator_ColumnPropNameInTable="REND_85Column" msprop:Generator_UserColumnName="REND_85" type="xs:decimal" minOccurs="0" />
              <xs:element name="PBH" msprop:Generator_ColumnVarNameInTable="columnPBH" msprop:Generator_ColumnPropNameInRow="PBH" msprop:Generator_ColumnPropNameInTable="PBHColumn" msprop:Generator_UserColumnName="PBH" type="xs:decimal" minOccurs="0" />
              <xs:element name="BRIX" msprop:Generator_ColumnVarNameInTable="columnBRIX" msprop:Generator_ColumnPropNameInRow="BRIX" msprop:Generator_ColumnPropNameInTable="BRIXColumn" msprop:Generator_UserColumnName="BRIX" type="xs:decimal" minOccurs="0" />
              <xs:element name="POL" msprop:Generator_ColumnVarNameInTable="columnPOL" msprop:Generator_ColumnPropNameInRow="POL" msprop:Generator_ColumnPropNameInTable="POLColumn" msprop:Generator_UserColumnName="POL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PUREZA_JUGO" msprop:Generator_ColumnVarNameInTable="columnPUREZA_JUGO" msprop:Generator_ColumnPropNameInRow="PUREZA_JUGO" msprop:Generator_ColumnPropNameInTable="PUREZA_JUGOColumn" msprop:Generator_UserColumnName="PUREZA_JUGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FIBRA_CANA" msprop:Generator_ColumnVarNameInTable="columnFIBRA_CANA" msprop:Generator_ColumnPropNameInRow="FIBRA_CANA" msprop:Generator_ColumnPropNameInTable="FIBRA_CANAColumn" msprop:Generator_UserColumnName="FIBRA_CANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEXTRANA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEXTRANA" msprop:Generator_ColumnPropNameInRow="DEXTRANA" msprop:Generator_ColumnPropNameInTable="DEXTRANAColumn" msprop:Generator_UserColumnName="DEXTRANA" type="xs:decimal" minOccurs="0" />
              <xs:element name="HUMEDAD" msprop:Generator_ColumnVarNameInTable="columnHUMEDAD" msprop:Generator_ColumnPropNameInRow="HUMEDAD" msprop:Generator_ColumnPropNameInTable="HUMEDADColumn" msprop:Generator_UserColumnName="HUMEDAD" type="xs:decimal" minOccurs="0" />
              <xs:element name="PH" msprop:Generator_ColumnVarNameInTable="columnPH" msprop:Generator_ColumnPropNameInRow="PH" msprop:Generator_ColumnPropNameInTable="PHColumn" msprop:Generator_UserColumnName="PH" type="xs:decimal" minOccurs="0" />
              <xs:element name="AZUCAR_REDUCTORES" msprop:Generator_ColumnVarNameInTable="columnAZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInRow="AZUCAR_REDUCTORES" msprop:Generator_ColumnPropNameInTable="AZUCAR_REDUCTORESColumn" msprop:Generator_UserColumnName="AZUCAR_REDUCTORES" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="CONTRATO_CANA_ZONA" msprop:Generator_TableClassName="CONTRATO_CANA_ZONADataTable" msprop:Generator_TableVarName="tableCONTRATO_CANA_ZONA" msprop:Generator_RowChangedName="CONTRATO_CANA_ZONARowChanged" msprop:Generator_TablePropName="CONTRATO_CANA_ZONA" msprop:Generator_RowDeletingName="CONTRATO_CANA_ZONARowDeleting" msprop:Generator_RowChangingName="CONTRATO_CANA_ZONARowChanging" msprop:Generator_RowEvHandlerName="CONTRATO_CANA_ZONARowChangeEventHandler" msprop:Generator_RowDeletedName="CONTRATO_CANA_ZONARowDeleted" msprop:Generator_RowClassName="CONTRATO_CANA_ZONARow" msprop:Generator_UserTableName="CONTRATO_CANA_ZONA" msprop:Generator_RowEvArgName="CONTRATO_CANA_ZONARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ANIOZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANIOZAFRA" msprop:Generator_ColumnPropNameInRow="ANIOZAFRA" msprop:Generator_ColumnPropNameInTable="ANIOZAFRAColumn" msprop:Generator_UserColumnName="ANIOZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="DESCRIP_ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCRIP_ZONA" msprop:Generator_ColumnPropNameInRow="DESCRIP_ZONA" msprop:Generator_ColumnPropNameInTable="DESCRIP_ZONAColumn" msprop:Generator_UserColumnName="DESCRIP_ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="CANT_PROVEEDORES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_PROVEEDORES" msprop:Generator_ColumnPropNameInRow="CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInTable="CANT_PROVEEDORESColumn" msprop:Generator_UserColumnName="CANT_PROVEEDORES" type="xs:int" minOccurs="0" />
              <xs:element name="CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="CANT_CONTRATOS" type="xs:int" minOccurs="0" />
              <xs:element name="CANT_LOTES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCANT_LOTES" msprop:Generator_ColumnPropNameInRow="CANT_LOTES" msprop:Generator_ColumnPropNameInTable="CANT_LOTESColumn" msprop:Generator_UserColumnName="CANT_LOTES" type="xs:int" minOccurs="0" />
              <xs:element name="LBS_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLBS_CONTRATADO" msprop:Generator_ColumnPropNameInRow="LBS_CONTRATADO" msprop:Generator_ColumnPropNameInTable="LBS_CONTRATADOColumn" msprop:Generator_UserColumnName="LBS_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="REND_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="REND_CONTRATADOColumn" msprop:Generator_UserColumnName="REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="MZ_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_MZ_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TC_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TC_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TC_CONTRATADOColumn" msprop:Generator_UserColumnName="TC_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_REND_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_REND_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TOTAL_REND_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TOTAL_REND_CONTRATADOColumn" msprop:Generator_UserColumnName="TOTAL_REND_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_TC_MZ_CONTRATADO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInRow="TOTAL_TC_MZ_CONTRATADO" msprop:Generator_ColumnPropNameInTable="TOTAL_TC_MZ_CONTRATADOColumn" msprop:Generator_UserColumnName="TOTAL_TC_MZ_CONTRATADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL_CANT_PROVEEDORES" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInRow="TOTAL_CANT_PROVEEDORES" msprop:Generator_ColumnPropNameInTable="TOTAL_CANT_PROVEEDORESColumn" msprop:Generator_UserColumnName="TOTAL_CANT_PROVEEDORES" type="xs:int" minOccurs="0" />
              <xs:element name="TOTAL_CANT_CONTRATOS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL_CANT_CONTRATOS" msprop:Generator_ColumnPropNameInRow="TOTAL_CANT_CONTRATOS" msprop:Generator_ColumnPropNameInTable="TOTAL_CANT_CONTRATOSColumn" msprop:Generator_UserColumnName="TOTAL_CANT_CONTRATOS" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="TERCIO_ENTREGA_CANA" msprop:Generator_TableClassName="TERCIO_ENTREGA_CANADataTable" msprop:Generator_TableVarName="tableTERCIO_ENTREGA_CANA" msprop:Generator_RowChangedName="TERCIO_ENTREGA_CANARowChanged" msprop:Generator_TablePropName="TERCIO_ENTREGA_CANA" msprop:Generator_RowDeletingName="TERCIO_ENTREGA_CANARowDeleting" msprop:Generator_RowChangingName="TERCIO_ENTREGA_CANARowChanging" msprop:Generator_RowEvHandlerName="TERCIO_ENTREGA_CANARowChangeEventHandler" msprop:Generator_RowDeletedName="TERCIO_ENTREGA_CANARowDeleted" msprop:Generator_RowClassName="TERCIO_ENTREGA_CANARow" msprop:Generator_UserTableName="TERCIO_ENTREGA_CANA" msprop:Generator_RowEvArgName="TERCIO_ENTREGA_CANARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="grupo" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columngrupo" msprop:Generator_ColumnPropNameInRow="grupo" msprop:Generator_ColumnPropNameInTable="grupoColumn" msprop:Generator_UserColumnName="grupo" type="xs:int" minOccurs="0" />
              <xs:element name="orden" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnorden" msprop:Generator_ColumnPropNameInRow="orden" msprop:Generator_ColumnPropNameInTable="ordenColumn" msprop:Generator_UserColumnName="orden" type="xs:int" minOccurs="0" />
              <xs:element name="zona" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnzona" msprop:Generator_ColumnPropNameInRow="zona" msprop:Generator_ColumnPropNameInTable="zonaColumn" msprop:Generator_UserColumnName="zona" type="xs:string" minOccurs="0" />
              <xs:element name="tc_esticana" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_esticana" msprop:Generator_ColumnPropNameInRow="tc_esticana" msprop:Generator_ColumnPropNameInTable="tc_esticanaColumn" msprop:Generator_UserColumnName="tc_esticana" type="xs:decimal" minOccurs="0" />
              <xs:element name="tipo" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntipo" msprop:Generator_ColumnPropNameInRow="tipo" msprop:Generator_ColumnPropNameInTable="tipoColumn" msprop:Generator_UserColumnName="tipo" type="xs:string" minOccurs="0" />
              <xs:element name="tc_1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_1" msprop:Generator_ColumnPropNameInRow="tc_1" msprop:Generator_ColumnPropNameInTable="tc_1Column" msprop:Generator_UserColumnName="tc_1" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_1" msprop:Generator_ColumnPropNameInRow="cuota_1" msprop:Generator_ColumnPropNameInTable="cuota_1Column" msprop:Generator_UserColumnName="cuota_1" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_2" msprop:Generator_ColumnPropNameInRow="tc_2" msprop:Generator_ColumnPropNameInTable="tc_2Column" msprop:Generator_UserColumnName="tc_2" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_2" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_2" msprop:Generator_ColumnPropNameInRow="cuota_2" msprop:Generator_ColumnPropNameInTable="cuota_2Column" msprop:Generator_UserColumnName="cuota_2" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_3" msprop:Generator_ColumnPropNameInRow="tc_3" msprop:Generator_ColumnPropNameInTable="tc_3Column" msprop:Generator_UserColumnName="tc_3" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_3" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_3" msprop:Generator_ColumnPropNameInRow="cuota_3" msprop:Generator_ColumnPropNameInTable="cuota_3Column" msprop:Generator_UserColumnName="cuota_3" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_4" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_4" msprop:Generator_ColumnPropNameInRow="tc_4" msprop:Generator_ColumnPropNameInTable="tc_4Column" msprop:Generator_UserColumnName="tc_4" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_4" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_4" msprop:Generator_ColumnPropNameInRow="cuota_4" msprop:Generator_ColumnPropNameInTable="cuota_4Column" msprop:Generator_UserColumnName="cuota_4" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_5" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_5" msprop:Generator_ColumnPropNameInRow="tc_5" msprop:Generator_ColumnPropNameInTable="tc_5Column" msprop:Generator_UserColumnName="tc_5" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_5" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_5" msprop:Generator_ColumnPropNameInRow="cuota_5" msprop:Generator_ColumnPropNameInTable="cuota_5Column" msprop:Generator_UserColumnName="cuota_5" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_6" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_6" msprop:Generator_ColumnPropNameInRow="tc_6" msprop:Generator_ColumnPropNameInTable="tc_6Column" msprop:Generator_UserColumnName="tc_6" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_6" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_6" msprop:Generator_ColumnPropNameInRow="cuota_6" msprop:Generator_ColumnPropNameInTable="cuota_6Column" msprop:Generator_UserColumnName="cuota_6" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_7" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_7" msprop:Generator_ColumnPropNameInRow="tc_7" msprop:Generator_ColumnPropNameInTable="tc_7Column" msprop:Generator_UserColumnName="tc_7" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_7" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_7" msprop:Generator_ColumnPropNameInRow="cuota_7" msprop:Generator_ColumnPropNameInTable="cuota_7Column" msprop:Generator_UserColumnName="cuota_7" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_8" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_8" msprop:Generator_ColumnPropNameInRow="tc_8" msprop:Generator_ColumnPropNameInTable="tc_8Column" msprop:Generator_UserColumnName="tc_8" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_8" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_8" msprop:Generator_ColumnPropNameInRow="cuota_8" msprop:Generator_ColumnPropNameInTable="cuota_8Column" msprop:Generator_UserColumnName="cuota_8" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_9" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_9" msprop:Generator_ColumnPropNameInRow="tc_9" msprop:Generator_ColumnPropNameInTable="tc_9Column" msprop:Generator_UserColumnName="tc_9" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_9" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_9" msprop:Generator_ColumnPropNameInRow="cuota_9" msprop:Generator_ColumnPropNameInTable="cuota_9Column" msprop:Generator_UserColumnName="cuota_9" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_10" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_10" msprop:Generator_ColumnPropNameInRow="tc_10" msprop:Generator_ColumnPropNameInTable="tc_10Column" msprop:Generator_UserColumnName="tc_10" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_10" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_10" msprop:Generator_ColumnPropNameInRow="cuota_10" msprop:Generator_ColumnPropNameInTable="cuota_10Column" msprop:Generator_UserColumnName="cuota_10" type="xs:decimal" minOccurs="0" />
              <xs:element name="tc_11" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columntc_11" msprop:Generator_ColumnPropNameInRow="tc_11" msprop:Generator_ColumnPropNameInTable="tc_11Column" msprop:Generator_UserColumnName="tc_11" type="xs:decimal" minOccurs="0" />
              <xs:element name="cuota_11" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columncuota_11" msprop:Generator_ColumnPropNameInRow="cuota_11" msprop:Generator_ColumnPropNameInTable="cuota_11Column" msprop:Generator_UserColumnName="cuota_11" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLIC_ANTICIPO" msprop:Generator_TableClassName="SOLIC_ANTICIPODataTable" msprop:Generator_TableVarName="tableSOLIC_ANTICIPO" msprop:Generator_RowChangedName="SOLIC_ANTICIPORowChanged" msprop:Generator_TablePropName="SOLIC_ANTICIPO" msprop:Generator_RowDeletingName="SOLIC_ANTICIPORowDeleting" msprop:Generator_RowChangingName="SOLIC_ANTICIPORowChanging" msprop:Generator_RowEvHandlerName="SOLIC_ANTICIPORowChangeEventHandler" msprop:Generator_RowDeletedName="SOLIC_ANTICIPORowDeleted" msprop:Generator_RowClassName="SOLIC_ANTICIPORow" msprop:Generator_UserTableName="SOLIC_ANTICIPO" msprop:Generator_RowEvArgName="SOLIC_ANTICIPORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_ANTICIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_ANTICIPO" msprop:Generator_ColumnPropNameInRow="ID_ANTICIPO" msprop:Generator_ColumnPropNameInTable="ID_ANTICIPOColumn" msprop:Generator_UserColumnName="ID_ANTICIPO" type="xs:int" minOccurs="0" />
              <xs:element name="ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZAFRA" msprop:Generator_ColumnPropNameInRow="ZAFRA" msprop:Generator_ColumnPropNameInTable="ZAFRAColumn" msprop:Generator_UserColumnName="ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="FECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHA" msprop:Generator_ColumnPropNameInRow="FECHA" msprop:Generator_ColumnPropNameInTable="FECHAColumn" msprop:Generator_UserColumnName="FECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NOMBRE_EMPRESA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_EMPRESA" msprop:Generator_ColumnPropNameInRow="NOMBRE_EMPRESA" msprop:Generator_ColumnPropNameInTable="NOMBRE_EMPRESAColumn" msprop:Generator_UserColumnName="NOMBRE_EMPRESA" type="xs:string" minOccurs="0" />
              <xs:element name="REPRESENTANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREPRESENTANTE" msprop:Generator_ColumnPropNameInRow="REPRESENTANTE" msprop:Generator_ColumnPropNameInTable="REPRESENTANTEColumn" msprop:Generator_UserColumnName="REPRESENTANTE" type="xs:string" minOccurs="0" />
              <xs:element name="CODIGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" type="xs:string" minOccurs="0" />
              <xs:element name="ZONA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnZONA" msprop:Generator_ColumnPropNameInRow="ZONA" msprop:Generator_ColumnPropNameInTable="ZONAColumn" msprop:Generator_UserColumnName="ZONA" type="xs:string" minOccurs="0" />
              <xs:element name="AREA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAREA" msprop:Generator_ColumnPropNameInRow="AREA" msprop:Generator_ColumnPropNameInTable="AREAColumn" msprop:Generator_UserColumnName="AREA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONELADAS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONELADAS" msprop:Generator_ColumnPropNameInRow="TONELADAS" msprop:Generator_ColumnPropNameInTable="TONELADASColumn" msprop:Generator_UserColumnName="TONELADAS" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="DUI" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDUI" msprop:Generator_ColumnPropNameInRow="DUI" msprop:Generator_ColumnPropNameInTable="DUIColumn" msprop:Generator_UserColumnName="DUI" type="xs:string" minOccurs="0" />
              <xs:element name="CREDITFISCAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCREDITFISCAL" msprop:Generator_ColumnPropNameInRow="CREDITFISCAL" msprop:Generator_ColumnPropNameInTable="CREDITFISCALColumn" msprop:Generator_UserColumnName="CREDITFISCAL" type="xs:string" minOccurs="0" />
              <xs:element name="CONCEPTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCONCEPTO" msprop:Generator_ColumnPropNameInRow="CONCEPTO" msprop:Generator_ColumnPropNameInTable="CONCEPTOColumn" msprop:Generator_UserColumnName="CONCEPTO" type="xs:string" minOccurs="0" />
              <xs:element name="TECNICO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTECNICO" msprop:Generator_ColumnPropNameInRow="TECNICO" msprop:Generator_ColumnPropNameInTable="TECNICOColumn" msprop:Generator_UserColumnName="TECNICO" type="xs:string" minOccurs="0" />
              <xs:element name="NUM_ANTICIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUM_ANTICIPO" msprop:Generator_ColumnPropNameInRow="NUM_ANTICIPO" msprop:Generator_ColumnPropNameInTable="NUM_ANTICIPOColumn" msprop:Generator_UserColumnName="NUM_ANTICIPO" type="xs:int" minOccurs="0" />
              <xs:element name="NIT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNIT" msprop:Generator_ColumnPropNameInRow="NIT" msprop:Generator_ColumnPropNameInTable="NITColumn" msprop:Generator_UserColumnName="NIT" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="REPORTE_ENTREGA_ANOMALO" msprop:Generator_TableClassName="REPORTE_ENTREGA_ANOMALODataTable" msprop:Generator_TableVarName="tableREPORTE_ENTREGA_ANOMALO" msprop:Generator_TablePropName="REPORTE_ENTREGA_ANOMALO" msprop:Generator_RowDeletingName="REPORTE_ENTREGA_ANOMALORowDeleting" msprop:Generator_RowChangingName="REPORTE_ENTREGA_ANOMALORowChanging" msprop:Generator_RowEvHandlerName="REPORTE_ENTREGA_ANOMALORowChangeEventHandler" msprop:Generator_RowDeletedName="REPORTE_ENTREGA_ANOMALORowDeleted" msprop:Generator_UserTableName="REPORTE_ENTREGA_ANOMALO" msprop:Generator_RowChangedName="REPORTE_ENTREGA_ANOMALORowChanged" msprop:Generator_RowEvArgName="REPORTE_ENTREGA_ANOMALORowChangeEvent" msprop:Generator_RowClassName="REPORTE_ENTREGA_ANOMALORow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="DIAZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIAZAFRA" msprop:Generator_ColumnPropNameInRow="DIAZAFRA" msprop:Generator_ColumnPropNameInTable="DIAZAFRAColumn" msprop:Generator_UserColumnName="DIAZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="NO_RECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNO_RECIBO" msprop:Generator_ColumnPropNameInRow="NO_RECIBO" msprop:Generator_ColumnPropNameInTable="NO_RECIBOColumn" msprop:Generator_UserColumnName="NO_RECIBO" type="xs:int" minOccurs="0" />
              <xs:element name="TACO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTACO" msprop:Generator_ColumnPropNameInRow="TACO" msprop:Generator_ColumnPropNameInTable="TACOColumn" msprop:Generator_UserColumnName="TACO" type="xs:int" minOccurs="0" />
              <xs:element name="CODIPROVEE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEE" msprop:Generator_ColumnPropNameInRow="CODIPROVEE" msprop:Generator_ColumnPropNameInTable="CODIPROVEEColumn" msprop:Generator_UserColumnName="CODIPROVEE" type="xs:string" minOccurs="0" />
              <xs:element name="CODISOCIO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODISOCIO" msprop:Generator_ColumnPropNameInRow="CODISOCIO" msprop:Generator_ColumnPropNameInTable="CODISOCIOColumn" msprop:Generator_UserColumnName="CODISOCIO" type="xs:string" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODIGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" type="xs:string" minOccurs="0" />
              <xs:element name="LOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLOTE" msprop:Generator_ColumnPropNameInRow="LOTE" msprop:Generator_ColumnPropNameInTable="LOTEColumn" msprop:Generator_UserColumnName="LOTE" type="xs:string" minOccurs="0" />
              <xs:element name="REND85" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnREND85" msprop:Generator_ColumnPropNameInRow="REND85" msprop:Generator_ColumnPropNameInTable="REND85Column" msprop:Generator_UserColumnName="REND85" type="xs:decimal" minOccurs="0" />
              <xs:element name="TONELADAS" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTONELADAS" msprop:Generator_ColumnPropNameInRow="TONELADAS" msprop:Generator_ColumnPropNameInTable="TONELADASColumn" msprop:Generator_UserColumnName="TONELADAS" type="xs:decimal" minOccurs="0" />
              <xs:element name="ES_ANOMALO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnES_ANOMALO" msprop:Generator_ColumnPropNameInRow="ES_ANOMALO" msprop:Generator_ColumnPropNameInTable="ES_ANOMALOColumn" msprop:Generator_UserColumnName="ES_ANOMALO" type="xs:int" minOccurs="0" />
              <xs:element name="RENDIA85_ANOMALO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnRENDIA85_ANOMALO" msprop:Generator_ColumnPropNameInRow="RENDIA85_ANOMALO" msprop:Generator_ColumnPropNameInTable="RENDIA85_ANOMALOColumn" msprop:Generator_UserColumnName="RENDIA85_ANOMALO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RPT_AUTOVOLTEO_TRACTORISTA" msprop:Generator_TableClassName="RPT_AUTOVOLTEO_TRACTORISTADataTable" msprop:Generator_TableVarName="tableRPT_AUTOVOLTEO_TRACTORISTA" msprop:Generator_TablePropName="RPT_AUTOVOLTEO_TRACTORISTA" msprop:Generator_RowDeletingName="RPT_AUTOVOLTEO_TRACTORISTARowDeleting" msprop:Generator_RowChangingName="RPT_AUTOVOLTEO_TRACTORISTARowChanging" msprop:Generator_RowEvHandlerName="RPT_AUTOVOLTEO_TRACTORISTARowChangeEventHandler" msprop:Generator_RowDeletedName="RPT_AUTOVOLTEO_TRACTORISTARowDeleted" msprop:Generator_UserTableName="RPT_AUTOVOLTEO_TRACTORISTA" msprop:Generator_RowChangedName="RPT_AUTOVOLTEO_TRACTORISTARowChanged" msprop:Generator_RowEvArgName="RPT_AUTOVOLTEO_TRACTORISTARowChangeEvent" msprop:Generator_RowClassName="RPT_AUTOVOLTEO_TRACTORISTARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="ID_CARGADOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_CARGADOR" msprop:Generator_ColumnPropNameInRow="ID_CARGADOR" msprop:Generator_ColumnPropNameInTable="ID_CARGADORColumn" msprop:Generator_UserColumnName="ID_CARGADOR" type="xs:int" minOccurs="0" />
              <xs:element name="TRACTORISTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRACTORISTA" msprop:Generator_ColumnPropNameInRow="TRACTORISTA" msprop:Generator_ColumnPropNameInTable="TRACTORISTAColumn" msprop:Generator_UserColumnName="TRACTORISTA" type="xs:string" minOccurs="0" />
              <xs:element name="TARIFA_TRACTORISTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTARIFA_TRACTORISTA" msprop:Generator_ColumnPropNameInRow="TARIFA_TRACTORISTA" msprop:Generator_ColumnPropNameInTable="TARIFA_TRACTORISTAColumn" msprop:Generator_UserColumnName="TARIFA_TRACTORISTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PRODUCTOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTOR" msprop:Generator_ColumnPropNameInRow="PRODUCTOR" msprop:Generator_ColumnPropNameInTable="PRODUCTORColumn" msprop:Generator_UserColumnName="PRODUCTOR" type="xs:string" minOccurs="0" />
              <xs:element name="CODILOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODILOTE" msprop:Generator_ColumnPropNameInRow="CODILOTE" msprop:Generator_ColumnPropNameInTable="CODILOTEColumn" msprop:Generator_UserColumnName="CODILOTE" type="xs:string" minOccurs="0" />
              <xs:element name="NOMBLOTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBLOTE" msprop:Generator_ColumnPropNameInRow="NOMBLOTE" msprop:Generator_ColumnPropNameInTable="NOMBLOTEColumn" msprop:Generator_UserColumnName="NOMBLOTE" type="xs:string" minOccurs="0" />
              <xs:element name="COSECHADORA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOSECHADORA" msprop:Generator_ColumnPropNameInRow="COSECHADORA" msprop:Generator_ColumnPropNameInTable="COSECHADORAColumn" msprop:Generator_UserColumnName="COSECHADORA" type="xs:string" minOccurs="0" />
              <xs:element name="TC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTC" msprop:Generator_ColumnPropNameInRow="TC" msprop:Generator_ColumnPropNameInTable="TCColumn" msprop:Generator_UserColumnName="TC" type="xs:decimal" minOccurs="0" />
              <xs:element name="PAGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPAGO" msprop:Generator_ColumnPropNameInRow="PAGO" msprop:Generator_ColumnPropNameInTable="PAGOColumn" msprop:Generator_UserColumnName="PAGO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIPROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODIPROVEEDOR" msprop:Generator_ColumnPropNameInRow="CODIPROVEEDOR" msprop:Generator_ColumnPropNameInTable="CODIPROVEEDORColumn" msprop:Generator_UserColumnName="CODIPROVEEDOR" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="TIPOCANA_POR_DIAZAFRA" msprop:Generator_TableClassName="TIPOCANA_POR_DIAZAFRADataTable" msprop:Generator_TableVarName="tableTIPOCANA_POR_DIAZAFRA" msprop:Generator_TablePropName="TIPOCANA_POR_DIAZAFRA" msprop:Generator_RowDeletingName="TIPOCANA_POR_DIAZAFRARowDeleting" msprop:Generator_RowChangingName="TIPOCANA_POR_DIAZAFRARowChanging" msprop:Generator_RowEvHandlerName="TIPOCANA_POR_DIAZAFRARowChangeEventHandler" msprop:Generator_RowDeletedName="TIPOCANA_POR_DIAZAFRARowDeleted" msprop:Generator_UserTableName="TIPOCANA_POR_DIAZAFRA" msprop:Generator_RowChangedName="TIPOCANA_POR_DIAZAFRARowChanged" msprop:Generator_RowEvArgName="TIPOCANA_POR_DIAZAFRARowChangeEvent" msprop:Generator_RowClassName="TIPOCANA_POR_DIAZAFRARow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnID_ZAFRA" msprop:Generator_ColumnPropNameInRow="ID_ZAFRA" msprop:Generator_ColumnPropNameInTable="ID_ZAFRAColumn" msprop:Generator_UserColumnName="ID_ZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBRE_ZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInRow="NOMBRE_ZAFRA" msprop:Generator_ColumnPropNameInTable="NOMBRE_ZAFRAColumn" msprop:Generator_UserColumnName="NOMBRE_ZAFRA" type="xs:string" minOccurs="0" />
              <xs:element name="DIAZAFRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIAZAFRA" msprop:Generator_ColumnPropNameInRow="DIAZAFRA" msprop:Generator_ColumnPropNameInTable="DIAZAFRAColumn" msprop:Generator_UserColumnName="DIAZAFRA" type="xs:int" minOccurs="0" />
              <xs:element name="LARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLARGA" msprop:Generator_ColumnPropNameInRow="LARGA" msprop:Generator_ColumnPropNameInTable="LARGAColumn" msprop:Generator_UserColumnName="LARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORTA" msprop:Generator_ColumnPropNameInRow="CORTA" msprop:Generator_ColumnPropNameInTable="CORTAColumn" msprop:Generator_UserColumnName="CORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PICADA_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPICADA_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PICADA_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PICADA_MECANIZADAColumn" msprop:Generator_UserColumnName="PICADA_MECANIZADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTAL" msprop:Generator_ColumnPropNameInRow="TOTAL" msprop:Generator_ColumnPropNameInTable="TOTALColumn" msprop:Generator_UserColumnName="TOTAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="PLARGA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPLARGA" msprop:Generator_ColumnPropNameInRow="PLARGA" msprop:Generator_ColumnPropNameInTable="PLARGAColumn" msprop:Generator_UserColumnName="PLARGA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PCORTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPCORTA" msprop:Generator_ColumnPropNameInRow="PCORTA" msprop:Generator_ColumnPropNameInTable="PCORTAColumn" msprop:Generator_UserColumnName="PCORTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PPICADA_MECANIZADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPPICADA_MECANIZADA" msprop:Generator_ColumnPropNameInRow="PPICADA_MECANIZADA" msprop:Generator_ColumnPropNameInTable="PPICADA_MECANIZADAColumn" msprop:Generator_UserColumnName="PPICADA_MECANIZADA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SOLIC_AGRICOLA_PRODUCTO" msprop:Generator_TableClassName="SOLIC_AGRICOLA_PRODUCTODataTable" msprop:Generator_TableVarName="tableSOLIC_AGRICOLA_PRODUCTO" msprop:Generator_RowChangedName="SOLIC_AGRICOLA_PRODUCTORowChanged" msprop:Generator_TablePropName="SOLIC_AGRICOLA_PRODUCTO" msprop:Generator_RowDeletingName="SOLIC_AGRICOLA_PRODUCTORowDeleting" msprop:Generator_RowChangingName="SOLIC_AGRICOLA_PRODUCTORowChanging" msprop:Generator_RowEvHandlerName="SOLIC_AGRICOLA_PRODUCTORowChangeEventHandler" msprop:Generator_RowDeletedName="SOLIC_AGRICOLA_PRODUCTORowDeleted" msprop:Generator_RowClassName="SOLIC_AGRICOLA_PRODUCTORow" msprop:Generator_UserTableName="SOLIC_AGRICOLA_PRODUCTO" msprop:Generator_RowEvArgName="SOLIC_AGRICOLA_PRODUCTORowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NOMBRE_PRODUCTO" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_PRODUCTO" msprop:Generator_ColumnPropNameInRow="NOMBRE_PRODUCTO" msprop:Generator_ColumnPropNameInTable="NOMBRE_PRODUCTOColumn" msprop:Generator_UserColumnName="NOMBRE_PRODUCTO">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CANT_X_MZ" msprop:Generator_ColumnVarNameInTable="columnCANT_X_MZ" msprop:Generator_ColumnPropNameInRow="CANT_X_MZ" msprop:Generator_ColumnPropNameInTable="CANT_X_MZColumn" msprop:Generator_UserColumnName="CANT_X_MZ" type="xs:decimal" />
              <xs:element name="TOTAL_PRODUCTO" msprop:Generator_ColumnVarNameInTable="columnTOTAL_PRODUCTO" msprop:Generator_ColumnPropNameInRow="TOTAL_PRODUCTO" msprop:Generator_ColumnPropNameInTable="TOTAL_PRODUCTOColumn" msprop:Generator_UserColumnName="TOTAL_PRODUCTO" type="xs:decimal" />
              <xs:element name="PRECIO_UNITARIO" msprop:Generator_ColumnVarNameInTable="columnPRECIO_UNITARIO" msprop:Generator_ColumnPropNameInRow="PRECIO_UNITARIO" msprop:Generator_ColumnPropNameInTable="PRECIO_UNITARIOColumn" msprop:Generator_UserColumnName="PRECIO_UNITARIO" type="xs:decimal" />
              <xs:element name="PRECIO_TOTAL" msprop:Generator_ColumnVarNameInTable="columnPRECIO_TOTAL" msprop:Generator_ColumnPropNameInRow="PRECIO_TOTAL" msprop:Generator_ColumnPropNameInTable="PRECIO_TOTALColumn" msprop:Generator_UserColumnName="PRECIO_TOTAL" type="xs:decimal" />
              <xs:element name="ID_SOLICITUD" msprop:Generator_ColumnVarNameInTable="columnID_SOLICITUD" msprop:Generator_ColumnPropNameInRow="ID_SOLICITUD" msprop:Generator_ColumnPropNameInTable="ID_SOLICITUDColumn" msprop:Generator_UserColumnName="ID_SOLICITUD" type="xs:int" />
              <xs:element name="CORRELATIVO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCORRELATIVO" msprop:Generator_ColumnPropNameInRow="CORRELATIVO" msprop:Generator_ColumnPropNameInTable="CORRELATIVOColumn" msprop:Generator_UserColumnName="CORRELATIVO" type="xs:int" minOccurs="0" />
              <xs:element name="PROVEEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPROVEEDOR" msprop:Generator_ColumnPropNameInRow="PROVEEDOR" msprop:Generator_ColumnPropNameInTable="PROVEEDORColumn" msprop:Generator_UserColumnName="PROVEEDOR" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>